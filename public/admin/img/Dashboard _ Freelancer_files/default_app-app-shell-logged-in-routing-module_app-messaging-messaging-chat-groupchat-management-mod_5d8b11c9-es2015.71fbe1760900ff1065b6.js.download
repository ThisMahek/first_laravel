(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{"0RCC":function(e,t,n){"use strict";n.r(t),n.d(t,"MessagingGroupMembersModalModule",function(){return c});var i=n("SVse"),s=n("oA5+"),a=n("cokP"),o=n("VOe3"),r=n("8Y7J");let c=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=r.Qb({type:e}),e.\u0275inj=r.Pb({imports:[[s.a,i.c,o.a,a.a]]}),e})()},"1YM7":function(e,t,n){"use strict";n.d(t,"a",function(){return K});var i=n("8Y7J"),s=n("riYv"),a=n("HsDr"),o=n("lDT0"),r=n("9Aot"),c=n("Rnop"),l=n("o9eT"),d=n("71eJ"),h=n("dJr3"),g=n("tsv4"),u=n("n0rP"),b=n("puO/"),f=n("SVse"),p=n("w13q"),m=n("tbiQ"),M=n("DSso"),C=n("SMHo");function S(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-icon",4),i.nc("click",function(){return i.Pc(e),i.rc(2).toggleSize.emit()}),i.Xb()}if(2&e){const e=i.rc(2);i.zc("flMarginRight",e.Margin.XSMALL)("name","ui-unfold-more")("color",e.iconColor)}}function T(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-icon",7),i.nc("click",function(t){return i.Pc(e),i.rc(3).handleVideoCallClick(t)}),i.Xb()}if(2&e){const e=i.rc(3);i.zc("flHideMobile",!0)("flMarginRight",e.Margin.XSMALL)("name","ui-video-camera-v2")("color",e.iconColor)}}function x(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Zc(1,T,1,4,"fl-icon",5),i.Yb(2,"fl-icon",6),i.nc("click",function(t){i.Pc(e);const n=i.rc(2);return n.handleAudioCallClick(t,null==n.callsEnabled?null:n.callsEnabled.audio.recorded)}),i.Xb(),i.Vb()}if(2&e){const e=i.rc(2);i.Gb(1),i.zc("ngIf",null==e.callsEnabled?null:e.callsEnabled.video.enabled),i.Gb(1),i.zc("flHideMobile",!0)("flMarginRight",e.Margin.XSMALL)("name","ui-phone")("color",e.iconColor)}}function y(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Zc(1,S,1,3,"fl-icon",2),i.Zc(2,x,3,5,"ng-container",0),i.Yb(3,"fl-icon",3),i.nc("click",function(t){i.Pc(e);const n=i.rc();return t.stopPropagation(),n.showChatDetails.emit()}),i.Xb(),i.Vb()}if(2&e){const e=i.rc();i.Gb(1),i.zc("ngIf",e.chatboxMode),i.Gb(1),i.zc("ngIf",!e.chatboxMode&&(null==e.callsEnabled?null:e.callsEnabled.audio.enabled)),i.Gb(1),i.zc("flMarginRight",e.chatboxMode?e.Margin.XSMALL:e.Margin.NONE)("name","ui-info-v2")("color",e.iconColor)}}function I(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-icon",8),i.nc("click",function(){return i.Pc(e),i.rc().closeChat.emit()}),i.Xb()}if(2&e){const e=i.rc();i.zc("name","ui-close")("color",e.iconColor)}}let O=(()=>{class e{constructor(e){this.videochat=e,this.Margin=r.a,this.isMinimised=!1,this.isOnboarding=!1,this.closeChat=new i.n,this.makingCall=new i.n,this.showChatDetails=new i.n,this.toggleSize=new i.n}handleAudioCallClick(e,t){e.stopPropagation(),this.startCall(m.a.AUDIO,t),this.makingCall.emit(!0)}handleVideoCallClick(e){e.stopPropagation(),this.startCall(m.a.VIDEO),this.makingCall.emit(!0)}startCall(e,t=!1){this.videochat.openCallWindow({action:e,threadId:this.thread.id,accepting:!1,recorded:t})}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(m.b))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-header-controls"]],inputs:{callsEnabled:"callsEnabled",chatboxMode:"chatboxMode",iconColor:"iconColor",isMinimised:"isMinimised",isOnboarding:"isOnboarding",thread:"thread"},outputs:{closeChat:"closeChat",makingCall:"makingCall",showChatDetails:"showChatDetails",toggleSize:"toggleSize"},decls:2,vars:2,consts:[[4,"ngIf"],["flTrackingLabel","CloseChatBox",3,"name","color","click",4,"ngIf"],["flTrackingLabel","ToggleChatBoxSize",3,"flMarginRight","name","color","click",4,"ngIf"],["flTrackingLabel","OpenSettingsChatBox",3,"flMarginRight","name","color","click"],["flTrackingLabel","ToggleChatBoxSize",3,"flMarginRight","name","color","click"],["flTrackingLabel","VideoChatUser",3,"flHideMobile","flMarginRight","name","color","click",4,"ngIf"],["flTrackingLabel","CallUser",3,"flHideMobile","flMarginRight","name","color","click"],["flTrackingLabel","VideoChatUser",3,"flHideMobile","flMarginRight","name","color","click"],["flTrackingLabel","CloseChatBox",3,"name","color","click"]],template:function(e,t){1&e&&(i.Zc(0,y,4,5,"ng-container",0),i.Zc(1,I,1,2,"fl-icon",1)),2&e&&(i.zc("ngIf",!t.isMinimised&&!t.isOnboarding),i.Gb(1),i.zc("ngIf",t.chatboxMode))},directives:[f.q,a.d,M.a,r.b,C.a],styles:["[_nghost-%COMP%]{display:flex}"],changeDetection:0}),e})();function A(e,t){if(1&e&&i.Tb(0,"fl-user-avatar",9),2&e){const e=i.rc(2);i.zc("flMarginRight",e.Margin.XSMALL)("isOnline",e.isOnline)("size",e.chatboxMode?e.AvatarSize.SMALL:e.AvatarSize.MID)("users",e.otherMembers)}}function v(e,t){1&e&&(i.Wb(0),i.cc(1,12),i.Vb())}function w(e,t){if(1&e&&(i.Wb(0),i.cc(1,13),i.Vb()),2&e){const e=i.rc(3);i.Gb(1),i.gc(e.otherMembers[0].displayName)(e.otherMembers.length-1),i.dc(1)}}function E(e,t){if(1&e&&(i.Yb(0,"fl-link",16),i.nc("click",function(e){return e.stopPropagation()}),i.bd(1),i.Xb()),2&e){const e=i.rc(4);i.zc("color",e.LinkColor.INHERIT)("hoverColor",e.chatboxMode?e.LinkHoverColor.LIGHT:e.LinkHoverColor.DEFAULT)("queryParams",e.headerDetails.titleLinkParams)("link",e.headerDetails.titleLink)("size",e.TextSize.INHERIT),i.Gb(1),i.dd(" ",e.headerDetails.title," ")}}function z(e,t){if(1&e&&i.bd(0),2&e){const e=i.rc(4);i.cd(e.headerDetails.title)}}function L(e,t){if(1&e&&(i.Wb(0),i.Zc(1,E,2,6,"fl-link",14),i.Zc(2,z,1,1,"ng-template",null,15,i.ad),i.Vb()),2&e){const e=i.Mc(3),t=i.rc(3);i.Gb(1),i.zc("ngIf",null==t.headerDetails?null:t.headerDetails.titleLink)("ngIfElse",e)}}function k(e,t){if(1&e&&(i.Yb(0,"fl-text",10),i.Zc(1,v,2,0,"ng-container",11),i.Zc(2,w,2,2,"ng-container",11),i.Zc(3,L,4,2,"ng-container",11),i.Xb()),2&e){const e=i.rc(2);i.zc("color",e.chatboxMode?e.FontColor.LIGHT:e.FontColor.DARK)("maxLines",1)("size",e.chatboxMode?e.TextSize.XSMALL:e.titleTextSize)("weight",e.FontWeight.BOLD),i.Gb(1),i.zc("ngIf",e.headerDetails.titleType===e.TitleType.DEFAULT),i.Gb(1),i.zc("ngIf",e.headerDetails.titleType===e.TitleType.MOBILE_GROUP),i.Gb(1),i.zc("ngIf",e.headerDetails.titleType===e.TitleType.CUSTOM||e.chatboxMode&&e.headerDetails.titleType===e.TitleType.USER)}}function P(e,t){if(1&e&&(i.Yb(0,"fl-username",17),i.nc("click",function(e){return e.stopPropagation()}),i.Xb()),2&e){const e=i.rc(2);i.zc("displayName",null==e.headerDetails.user?null:e.headerDetails.user.displayName)("username",null==e.headerDetails.user?null:e.headerDetails.user.username)("link",e.headerDetails.titleLink)("queryParams",e.headerDetails.titleLinkParams)("size",e.UsernameSize.LARGE)}}function _(e,t){if(1&e&&(i.Wb(0),i.cc(1,24),i.Vb()),2&e){const e=i.rc(4);i.Gb(1),i.gc(e.headerDetails.secondaryTitle),i.dc(1)}}function R(e,t){1&e&&(i.Wb(0),i.cc(1,25),i.Vb())}function j(e,t){1&e&&(i.Wb(0),i.cc(1,26),i.Vb())}function U(e,t){if(1&e&&(i.Yb(0,"fl-link",21),i.nc("click",function(e){return e.stopPropagation()}),i.Wb(1,22),i.Zc(2,_,2,1,"ng-container",23),i.Zc(3,R,2,0,"ng-container",23),i.Zc(4,j,2,0,"ng-container",23),i.Vb(),i.Xb()),2&e){const e=i.rc(3);i.zc("color",e.LinkColor.INHERIT)("hoverColor",e.chatboxMode?e.LinkHoverColor.LIGHT:e.LinkHoverColor.DEFAULT)("link",e.headerDetails.secondaryTitleLink)("size",e.TextSize.INHERIT),i.Gb(1),i.zc("ngSwitch",e.headerDetails.secondaryTitleType),i.Gb(1),i.zc("ngSwitchCase",e.SecondaryTitleType.CUSTOM),i.Gb(1),i.zc("ngSwitchCase",e.SecondaryTitleType.GENERIC_AGENT_TITLE),i.Gb(1),i.zc("ngSwitchCase",e.SecondaryTitleType.TEAM_CHAT)}}function B(e,t){if(1&e&&(i.Wb(0),i.cc(1,27),i.Vb()),2&e){const e=i.rc(4);i.Gb(1),i.gc(e.headerDetails.secondaryTitle),i.dc(1)}}function $(e,t){1&e&&(i.Wb(0),i.cc(1,28),i.Vb())}function G(e,t){1&e&&(i.Wb(0),i.cc(1,29),i.Vb())}function F(e,t){if(1&e&&(i.Wb(0,22),i.Zc(1,B,2,1,"ng-container",23),i.Zc(2,$,2,0,"ng-container",23),i.Zc(3,G,2,0,"ng-container",23),i.Vb()),2&e){const e=i.rc(3);i.zc("ngSwitch",e.headerDetails.secondaryTitleType),i.Gb(1),i.zc("ngSwitchCase",e.SecondaryTitleType.CUSTOM),i.Gb(1),i.zc("ngSwitchCase",e.SecondaryTitleType.GENERIC_AGENT_TITLE),i.Gb(1),i.zc("ngSwitchCase",e.SecondaryTitleType.TEAM_CHAT)}}function D(e,t){if(1&e&&(i.Yb(0,"fl-text",18),i.Zc(1,U,5,8,"fl-link",19),i.Zc(2,F,4,4,"ng-template",null,20,i.ad),i.Xb()),2&e){const e=i.Mc(3),t=i.rc(2);i.zc("color",t.chatboxMode?t.FontColor.LIGHT:t.FontColor.DARK)("maxLines",1)("size",t.chatboxMode?t.TextSize.XSMALL:t.secondaryTitleTextSize),i.Gb(1),i.zc("ngIf",null==t.headerDetails?null:t.headerDetails.secondaryTitleLink)("ngIfElse",e)}}function N(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Yb(1,"fl-bit",2),i.Zc(2,A,1,4,"fl-user-avatar",3),i.Yb(3,"fl-bit",4),i.Zc(4,k,4,7,"fl-text",5),i.Zc(5,P,1,5,"ng-template",null,6,i.ad),i.Zc(7,D,4,5,"fl-text",7),i.Xb(),i.Xb(),i.Yb(8,"app-messaging-header-controls",8),i.nc("click",function(e){return e.stopPropagation()})("closeChat",function(){return i.Pc(e),i.rc().closeChat.emit()})("makingCall",function(t){return i.Pc(e),i.rc().makingCall.emit(t)})("showChatDetails",function(){return i.Pc(e),i.rc().showChatDetails.emit()})("toggleSize",function(){return i.Pc(e),i.rc().toggleSize.emit()}),i.Xb(),i.Vb()}if(2&e){const e=i.Mc(6),t=i.rc();i.Gb(1),i.zc("flMarginRight",t.Margin.MID),i.Gb(1),i.zc("ngIf",!t.mobileMode),i.Gb(2),i.zc("ngIf",t.chatboxMode||t.headerDetails.titleType!==t.TitleType.USER)("ngIfElse",e),i.Gb(3),i.zc("ngIf",t.headerDetails.secondaryTitleType!==t.SecondaryTitleType.NONE),i.Gb(1),i.zc("callsEnabled",t.callsEnabled)("chatboxMode",t.chatboxMode)("iconColor",t.chatboxMode?t.IconColor.LIGHT:t.IconColor.INHERIT)("isMinimised",t.isMinimised)("isOnboarding",t.isOnboarding)("thread",t.thread)}}function X(e,t){1&e&&(i.Wb(0),i.cc(1,33),i.Vb())}function Y(e,t){1&e&&(i.Wb(0),i.cc(1,34),i.Vb())}function H(e,t){1&e&&(i.Wb(0),i.cc(1,35),i.Vb())}function V(e,t){1&e&&(i.Wb(0),i.cc(1,36),i.Vb())}function Z(e,t){1&e&&(i.Wb(0),i.cc(1,37),i.Vb())}function W(e,t){if(1&e){const e=i.Zb();i.Wb(0,22),i.Yb(1,"fl-bit",30),i.Yb(2,"fl-icon",31),i.nc("click",function(t){i.Pc(e);const n=i.rc();return t.stopPropagation(),n.back.emit()}),i.Xb(),i.Yb(3,"fl-text",32),i.Zc(4,X,2,0,"ng-container",23),i.Zc(5,Y,2,0,"ng-container",23),i.Zc(6,H,2,0,"ng-container",23),i.Zc(7,V,2,0,"ng-container",23),i.Zc(8,Z,2,0,"ng-container",23),i.Xb(),i.Xb(),i.Vb()}if(2&e){const e=i.rc();i.zc("ngSwitch",e.currentScreen),i.Gb(1),i.zc("flMarginRight",e.Margin.MID),i.Gb(1),i.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("flMarginRight",e.Margin.SMALL)("name","ui-arrow-left-alt"),i.Gb(1),i.zc("ngSwitch",e.currentScreen)("color",e.FontColor.LIGHT)("size",e.TextSize.SMALL),i.Gb(1),i.zc("ngSwitchCase",e.CurrentScreen.CHAT_DETAILS),i.Gb(1),i.zc("ngSwitchCase",e.CurrentScreen.ADD_PEOPLE),i.Gb(1),i.zc("ngSwitchCase",e.CurrentScreen.ALL_GROUP_MEMBERS),i.Gb(1),i.zc("ngSwitchCase",e.CurrentScreen.REMOVE_MEMBER),i.Gb(1),i.zc("ngSwitchCase",e.CurrentScreen.LEAVE_CHAT)}}var q=function(e){return e[e.CUSTOM=0]="CUSTOM",e[e.DEFAULT=1]="DEFAULT",e[e.USER=2]="USER",e[e.MOBILE_GROUP=3]="MOBILE_GROUP",e}({}),Q=function(e){return e[e.CUSTOM=0]="CUSTOM",e[e.GENERIC_AGENT_TITLE=1]="GENERIC_AGENT_TITLE",e[e.NONE=2]="NONE",e[e.TEAM_CHAT=3]="TEAM_CHAT",e}({});let K=(()=>{class e{constructor(){this.AvatarSize=d.a,this.FontColor=c.a,this.FontWeight=l.c,this.IconColor=a.c,this.IconSize=a.e,this.LinkColor=o.a,this.LinkHoverColor=o.c,this.Margin=r.a,this.TextSize=l.f,this.UsernameSize=h.c,this.CurrentScreen=b.a,this.SecondaryTitleType=Q,this.SupportTypeApi=u.SupportTypeApi,this.TitleType=q,this.isOnboarding=!1,this.isMinimised=!1,this.closeChat=new i.n,this.back=new i.n,this.showChatDetails=new i.n,this.toggleSize=new i.n,this.makingCall=new i.n,this.chatboxMode=!0,this.mobileMode=!1}ngOnChanges(e){this.otherMembers&&this.loggedInUser&&this.membersActivityStatus&&("membersActivityStatus"in e||"loggedInUser"in e||"otherMembers"in e)&&(this.isOnline=1===this.otherMembers.length?this.membersActivityStatus.filter(e=>e.id!==this.loggedInUser.id).map(e=>e.status).includes(s.OnlineOfflineStatusApi.ONLINE):void 0),("contextBoxState"in e||"loggedInUser"in e||"otherMembers"in e||"project"in e||"supportAgent"in e||"team"in e||"thread"in e)&&(this.headerDetails=this.getHeaderDetails()),"mobileMode"in e&&!this.chatboxMode&&(this.titleTextSize=this.mobileMode?l.f.XSMALL:l.f.SMALL,this.secondaryTitleTextSize=this.mobileMode?l.f.XXXSMALL:l.f.SMALL)}getHeaderDetails(){var e,t,n,i,s,a,o,r,c,l,d,h,u,b,f,p;if(!this.otherMembers||0===this.otherMembers.length||!this.loggedInUser)return{titleType:q.DEFAULT,secondaryTitleType:Q.NONE};const[m]=this.otherMembers;if(this.thread.threadType===g.ThreadTypeApi.GROUP||this.thread.threadType===g.ThreadTypeApi.TEAM){const c=this.otherMembers.map(e=>e.displayName).join(", ");return this.mobileMode&&this.otherMembers.length>1?(null===(e=this.contextBoxState)||void 0===e?void 0:e.linkText)&&(null===(t=this.contextBoxState)||void 0===t?void 0:t.linkUrl)?{titleType:q.MOBILE_GROUP,secondaryTitleType:Q.CUSTOM,secondaryTitle:null===(n=this.contextBoxState)||void 0===n?void 0:n.linkText,secondaryTitleLink:null===(i=this.contextBoxState)||void 0===i?void 0:i.linkUrl}:{titleType:q.MOBILE_GROUP,secondaryTitleType:Q.NONE}:(null===(s=this.contextBoxState)||void 0===s?void 0:s.linkText)&&(null===(a=this.contextBoxState)||void 0===a?void 0:a.linkUrl)?{titleType:q.CUSTOM,title:null===(o=this.contextBoxState)||void 0===o?void 0:o.linkText,titleLink:null===(r=this.contextBoxState)||void 0===r?void 0:r.linkUrl,secondaryTitleType:Q.CUSTOM,secondaryTitle:c}:{titleType:q.CUSTOM,title:c,secondaryTitleType:Q.NONE}}if(this.thread.threadType===g.ThreadTypeApi.ADMIN_PREFERRED_CHAT&&this.supportAgent){if(this.loggedInUser.id===this.supportAgent.userId)return{titleType:q.USER,title:m.displayName,titleLink:m.profileUrl,user:m,secondaryTitleType:Q.CUSTOM,secondaryTitle:m.username===m.displayName?this.getSupportQueueTitle(this.supportAgent):`(${m.username})`};const e=this.otherMembers.find(e=>{var t;return(null===(t=this.supportAgent)||void 0===t?void 0:t.userId)===e.id});if(e)return{titleType:q.USER,title:e.displayName,titleLink:e.profileUrl,user:e,secondaryTitleType:Q.GENERIC_AGENT_TITLE}}if(this.thread.threadType===g.ThreadTypeApi.TEAM_OFFICIAL&&this.team)return{titleType:q.CUSTOM,title:this.team.name,titleLink:`/teams/${this.team.id}`,secondaryTitleType:Q.TEAM_CHAT};const M=(null===(c=this.project)||void 0===c?void 0:c.skills.length)&&(null===(l=this.project)||void 0===l?void 0:l.ownerId)!==m.id?{reviewSkills:null===(d=this.project)||void 0===d?void 0:d.skills.map(e=>e.id).join(",")}:{};return{titleType:q.USER,title:m.displayName,titleLink:m.profileUrl,user:m,titleLinkParams:this.thread.context.type===g.ContextTypeApi.PROJECT&&(null===(h=this.contextBoxState)||void 0===h?void 0:h.contextId)?Object.assign({ref_project_id:this.contextBoxState.contextId},M):void 0,secondaryTitleType:(null===(u=this.contextBoxState)||void 0===u?void 0:u.linkText)&&(null===(b=this.contextBoxState)||void 0===b?void 0:b.linkUrl)?Q.CUSTOM:Q.NONE,secondaryTitle:null===(f=this.contextBoxState)||void 0===f?void 0:f.linkText,secondaryTitleLink:null===(p=this.contextBoxState)||void 0===p?void 0:p.linkUrl}}getSupportQueueTitle(e){switch(e.type){case u.SupportTypeApi.RECRUITER:return"Recruiter Chat";case u.SupportTypeApi.GENERAL:return"General Chat";case u.SupportTypeApi.LOCAL:return"Local Jobs";default:return e.type.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-header"]],hostVars:4,hostBindings:function(e,t){2&e&&i.Kb("ChatboxMode",t.chatboxMode)("MobileMode",t.mobileMode)},inputs:{callsEnabled:"callsEnabled",contextBoxState:"contextBoxState",currentScreen:"currentScreen",isOnboarding:"isOnboarding",isMinimised:"isMinimised",loggedInUser:"loggedInUser",membersActivityStatus:"membersActivityStatus",otherMembers:"otherMembers",project:"project",supportAgent:"supportAgent",team:"team",thread:"thread",chatboxMode:"chatboxMode",mobileMode:"mobileMode"},outputs:{closeChat:"closeChat",back:"back",showChatDetails:"showChatDetails",toggleSize:"toggleSize",makingCall:"makingCall"},features:[i.Eb],decls:3,vars:2,consts:function(){let e,t,n,i,s,a,o,r,c,l,d,h,g;return e=" Private Chat ",t=" " + "\ufffd0\ufffd" + " + " + "\ufffd1\ufffd" + " More ",n=" " + "\ufffd0\ufffd" + " ",i=" Freelancer Staff ",s=" Official Group Chat ",a=" " + "\ufffd0\ufffd" + " ",o=" Freelancer Staff ",r=" Official Group Chat ",c=" Chat Details ",l=" Add People ",d=" Group Members ",h=" Remove Member ",g=" Leave chat ",[[4,"ngIf","ngIfElse"],["alternateHeader",""],[1,"Header-details",3,"flMarginRight"],[3,"flMarginRight","isOnline","size","users",4,"ngIf"],[1,"Header-details-text"],[3,"color","maxLines","size","weight",4,"ngIf","ngIfElse"],["username",""],[3,"color","maxLines","size",4,"ngIf"],[3,"callsEnabled","chatboxMode","iconColor","isMinimised","isOnboarding","thread","click","closeChat","makingCall","showChatDetails","toggleSize"],[3,"flMarginRight","isOnline","size","users"],[3,"color","maxLines","size","weight"],[4,"ngIf"],e,t,["flTrackingLabel","ChatboxHeaderTitle",3,"color","hoverColor","queryParams","link","size","click",4,"ngIf","ngIfElse"],["plainTitle",""],["flTrackingLabel","ChatboxHeaderTitle",3,"color","hoverColor","queryParams","link","size","click"],["flTrackingLabel","ChatboxHeaderTitle",3,"displayName","username","link","queryParams","size","click"],[3,"color","maxLines","size"],["flTrackingLabel","ChatboxHeaderSecondaryTitle",3,"color","hoverColor","link","size","click",4,"ngIf","ngIfElse"],["plainSecondaryTitle",""],["flTrackingLabel","ChatboxHeaderSecondaryTitle",3,"color","hoverColor","link","size","click"],[3,"ngSwitch"],[4,"ngSwitchCase"],n,i,s,a,o,r,[1,"Header-details","Header-chatDetails",3,"flMarginRight"],["flTrackingLabel","HeaderBackCta",3,"color","size","flMarginRight","name","click"],[3,"ngSwitch","color","size"],c,l,d,h,g]},template:function(e,t){if(1&e&&(i.Zc(0,N,9,11,"ng-container",0),i.Zc(1,W,9,14,"ng-template",null,1,i.ad)),2&e){const e=i.Mc(2);i.zc("ngIf",!t.chatboxMode||t.currentScreen===t.CurrentScreen.THREAD_VIEW||t.isMinimised)("ngIfElse",e)}},directives:[f.q,p.a,r.b,O,d.b,l.e,o.b,M.a,h.b,f.s,f.t,a.d],styles:["[_nghost-%COMP%]{align-items:center;cursor:pointer;display:flex;justify-content:space-between;padding:16px 24px}.ChatboxMode[_nghost-%COMP%]{height:56px;padding:8px 16px}.MobileMode[_nghost-%COMP%]{padding:0}.Header-details[_ngcontent-%COMP%]{align-items:center;display:flex;overflow:hidden}.Header-details-text[_ngcontent-%COMP%]{overflow:hidden}.Header-chatDetails[_ngcontent-%COMP%]{padding:16px 0}"],changeDetection:0}),e})()},"23iI":function(e,t,n){"use strict";n.d(t,"a",function(){return Re});var i=n("8Y7J"),s=n("HsDr"),a=n("lDT0"),o=n("9Aot"),r=n("4ykm"),c=n("Rnop"),l=n("o9eT"),d=n("tsv4"),h=n("riYv"),g=n("eCtd"),u=n("3A0Z"),b=n("iInd"),f=n("HLWz"),p=n("KUXl"),m=n("SVse"),M=n("3bYl"),C=n("SMHo"),S=n("wZbG"),T=n("s7LF"),x=n("KtYJ"),y=n("3cJa"),I=n("w13q"),O=n("DSso"),A=n("a293");function v(e,t){if(1&e&&(i.Yb(0,"fl-generic-error",13),i.cc(1,14),i.Xb()),2&e){const e=i.rc();i.zc("error",e.archiveError)}}function w(e,t){if(1&e&&(i.Yb(0,"fl-generic-error",13),i.cc(1,15),i.Xb()),2&e){const e=i.rc();i.zc("error",e.muteError)}}function E(e,t){if(1&e&&(i.Yb(0,"fl-generic-error",21),i.cc(1,22),i.Xb()),2&e){const e=i.rc(2);i.zc("error",e.blockError)}}function z(e,t){if(1&e&&(i.Wb(0),i.Tb(1,"fl-hr"),i.Yb(2,"fl-bit",0),i.Yb(3,"fl-bit",1),i.Yb(4,"fl-text",16),i.cc(5,17),i.Xb(),i.Yb(6,"fl-text",4),i.cc(7,18),i.Xb(),i.Xb(),i.Tb(8,"fl-toggle",19),i.Xb(),i.Yb(9,"fl-bit",7),i.Zc(10,E,2,1,"fl-generic-error",20),i.Xb(),i.Vb()),2&e){const e=i.rc();i.Gb(4),i.zc("weight",e.FontWeight.BOLD)("color",e.FontColor.ERROR),i.Gb(2),i.zc("color",e.FontColor.MID),i.Gb(2),i.zc("busy",e.isBlockToggleBusy)("control",e.blockControl)("size",e.ToggleSize.MID),i.Gb(1),i.zc("flMarginBottom",e.Margin.SMALL),i.Gb(1),i.zc("ngIf",!!e.blockError)}}function L(e,t){if(1&e&&(i.Yb(0,"fl-text",4),i.cc(1,28),i.Xb()),2&e){const e=i.rc(2);i.zc("color",e.FontColor.MID)}}function k(e,t){if(1&e&&(i.Yb(0,"fl-text",4),i.cc(1,29),i.Xb()),2&e){const e=i.rc(2);i.zc("color",e.FontColor.MID)}}function P(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Tb(1,"fl-hr",23),i.Yb(2,"fl-bit",24),i.nc("click",function(){return i.Pc(e),i.rc().leaveChat.emit()}),i.Yb(3,"fl-text",16),i.cc(4,25),i.Xb(),i.Zc(5,L,2,1,"fl-text",26),i.Zc(6,k,2,1,"ng-template",null,27,i.ad),i.Xb(),i.Vb()}if(2&e){const e=i.Mc(7),t=i.rc();i.Gb(1),i.zc("flMarginBottom",t.Margin.XXSMALL),i.Gb(2),i.zc("weight",t.FontWeight.BOLD)("color",t.FontColor.ERROR),i.Gb(2),i.zc("ngIf",t.isLoggedInUserThreadOwner)("ngIfElse",e)}}function _(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Tb(1,"fl-hr",23),i.Yb(2,"fl-bit",30),i.nc("click",function(){return i.Pc(e),i.rc().reportChat.emit()}),i.Yb(3,"fl-text",2),i.cc(4,31),i.Xb(),i.Yb(5,"fl-text",4),i.cc(6,32),i.Xb(),i.Xb(),i.Vb()}if(2&e){const e=i.rc();i.Gb(1),i.zc("flMarginBottom",e.Margin.XXSMALL),i.Gb(2),i.zc("weight",e.FontWeight.BOLD),i.Gb(2),i.zc("color",e.FontColor.MID)}}let R=(()=>{class e{constructor(){this.FontColor=c.a,this.FontWeight=l.c,this.ListItemPadding=x.e,this.ListItemType=x.f,this.Margin=o.a,this.ToggleSize=y.b,this.archiveControl=new T.f,this.muteControl=new T.f,this.blockControl=new T.f,this.isGroupChat=!1,this.isReportSettingEnabled=!1,this.reportChat=new i.n,this.leaveChat=new i.n,this.toggleArchive=new i.n,this.toggleMute=new i.n,this.toggleBlock=new i.n}ngOnInit(){this.archiveControl.setValue(this.archived),this.blockControl.setValue(this.blocked),this.muteControl.setValue(this.muted),this.archiveControlSubscription$=this.archiveControl.valueChanges.subscribe(e=>{e!==this.archived&&this.toggleArchive.emit(e)}),this.blockControlSubscription$=this.blockControl.valueChanges.subscribe(e=>{e!==this.blocked&&this.toggleBlock.emit(e)}),this.muteControlSubscription$=this.muteControl.valueChanges.subscribe(e=>{e!==this.muted&&this.toggleMute.emit(e)})}ngOnDestroy(){var e,t,n;null===(e=this.archiveControlSubscription$)||void 0===e||e.unsubscribe(),null===(t=this.blockControlSubscription$)||void 0===t||t.unsubscribe(),null===(n=this.muteControlSubscription$)||void 0===n||n.unsubscribe()}ngOnChanges(e){(e.archived||e.archiveError)&&this.archiveControl.value!==this.archived&&this.archiveControl.setValue(this.archived),(e.muted||e.muteError)&&this.muteControl.value!==this.muted&&this.muteControl.setValue(this.muted),(e.blocked||e.blockError)&&this.blockControl.value!==this.blocked&&this.blockControl.setValue(this.blocked)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-details-settings"]],inputs:{archived:"archived",blocked:"blocked",muted:"muted",isLoggedInUserThreadOwner:"isLoggedInUserThreadOwner",isGroupChat:"isGroupChat",isBlockSettingEnabled:"isBlockSettingEnabled",isReportSettingEnabled:"isReportSettingEnabled",isArchiveToggleBusy:"isArchiveToggleBusy",isBlockToggleBusy:"isBlockToggleBusy",isMuteToggleBusy:"isMuteToggleBusy",archiveError:"archiveError",blockError:"blockError",muteError:"muteError"},outputs:{reportChat:"reportChat",leaveChat:"leaveChat",toggleArchive:"toggleArchive",toggleMute:"toggleMute",toggleBlock:"toggleBlock"},features:[i.Eb],decls:22,vars:17,consts:function(){let e,t,n,i,s,a,o,r,c,l,d,h,g,u;return e=" Archive ",t=" Hide this chat from your active list ",n=" Mute ",i=" Turn off notifications from this chat ",s=" Error archiving this chat. ",a=" Error muting this chat. ",o=" Block ",r=" Restrict members from sending messages ",c=" Error blocking this chat. ",l=" Leave ",d=" Leave and close this group chat ",h=" Stop receiving messages from this group and remove chat from your inbox ",g=" Report ",u=" There is something wrong with this conversation ",[[1,"ChatSettings-item"],[1,"ChatSettings-item-title"],[3,"weight"],e,[3,"color"],t,["flTrackingLabel","MessagingArchiveThread",1,"ChatSettings-toggle",3,"busy","size","control"],[1,"ChatSettings-error",3,"flMarginBottom"],[3,"error",4,"ngIf"],n,i,["flTrackingLabel","MessagingMuteThread",1,"ChatSettings-toggle",3,"busy","size","control"],[4,"ngIf"],[3,"error"],s,a,[3,"weight","color"],o,r,["flTrackingLabel","MessagingBlockThread",1,"ChatSettings-toggle",3,"busy","control","size"],["class","ChatSettings-error-message",3,"error",4,"ngIf"],[1,"ChatSettings-error-message",3,"error"],c,[3,"flMarginBottom"],["flTrackingLabel","MessagingLeaveChat",1,"ChatSettings-leave",3,"click"],l,[3,"color",4,"ngIf","ngIfElse"],["nonThreadOwnerLeaveCopy",""],d,h,["flTrackingLabel","MessagingReportChat",1,"ChatSettings-report",3,"click"],g,u]},template:function(e,t){1&e&&(i.Yb(0,"fl-bit",0),i.Yb(1,"fl-bit",1),i.Yb(2,"fl-text",2),i.cc(3,3),i.Xb(),i.Yb(4,"fl-text",4),i.cc(5,5),i.Xb(),i.Xb(),i.Tb(6,"fl-toggle",6),i.Xb(),i.Yb(7,"fl-bit",7),i.Zc(8,v,2,1,"fl-generic-error",8),i.Xb(),i.Tb(9,"fl-hr"),i.Yb(10,"fl-bit",0),i.Yb(11,"fl-bit",1),i.Yb(12,"fl-text",2),i.cc(13,9),i.Xb(),i.Yb(14,"fl-text",4),i.cc(15,10),i.Xb(),i.Xb(),i.Tb(16,"fl-toggle",11),i.Xb(),i.Yb(17,"fl-bit",7),i.Zc(18,w,2,1,"fl-generic-error",8),i.Xb(),i.Zc(19,z,11,8,"ng-container",12),i.Zc(20,P,8,5,"ng-container",12),i.Zc(21,_,7,3,"ng-container",12)),2&e&&(i.Gb(2),i.zc("weight",t.FontWeight.BOLD),i.Gb(2),i.zc("color",t.FontColor.MID),i.Gb(2),i.zc("busy",t.isArchiveToggleBusy)("size",t.ToggleSize.MID)("control",t.archiveControl),i.Gb(1),i.zc("flMarginBottom",t.Margin.SMALL),i.Gb(1),i.zc("ngIf",!!t.archiveError),i.Gb(4),i.zc("weight",t.FontWeight.BOLD),i.Gb(2),i.zc("color",t.FontColor.MID),i.Gb(2),i.zc("busy",t.isMuteToggleBusy)("size",t.ToggleSize.MID)("control",t.muteControl),i.Gb(1),i.zc("flMarginBottom",t.Margin.SMALL),i.Gb(1),i.zc("ngIf",!!t.muteError),i.Gb(1),i.zc("ngIf",t.isBlockSettingEnabled),i.Gb(1),i.zc("ngIf",t.isGroupChat),i.Gb(1),i.zc("ngIf",t.isReportSettingEnabled))},directives:[I.a,l.e,y.a,O.a,o.b,m.q,S.a,A.b],styles:["[_nghost-%COMP%]{display:block}.ChatSettings-item[_ngcontent-%COMP%]{display:flex;padding-left:8px;padding-top:16px}.ChatSettings-item-title[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column}.ChatSettings-toggle[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center}.ChatSettings-error[_ngcontent-%COMP%]{padding-left:8px}.ChatSettings-leave[_ngcontent-%COMP%], .ChatSettings-report[_ngcontent-%COMP%]{padding:8px}.ChatSettings-leave[_ngcontent-%COMP%]:hover, .ChatSettings-report[_ngcontent-%COMP%]:hover{background:#f0f0f0;cursor:pointer}"],changeDetection:0}),e})();var j=n("71eJ"),U=n("dJr3"),B=n("pZRy");function $(e,t){if(1&e&&(i.Yb(0,"fl-text",8),i.ic(1,9),i.Tb(2,"fl-relative-time",10),i.fc(),i.Xb()),2&e){const e=i.rc(2);i.zc("fontType",e.FontType.SPAN)("color",e.FontColor.MID),i.Gb(2),i.zc("color",e.FontColor.INHERIT)("date",null==e.otherMembers[0].onlineOfflineStatus?null:e.otherMembers[0].onlineOfflineStatus.lastUpdatedTimestamp)("includeSeconds",!1)("size",e.TextSize.INHERIT)("strict",!0)("suffix",!0)("weight",e.FontWeight.INHERIT)}}function G(e,t){if(1&e&&(i.Yb(0,"fl-text",8),i.cc(1,11),i.Xb()),2&e){const e=i.rc(2);i.zc("fontType",e.FontType.SPAN)("color",e.FontColor.MID)}}const F=function(e){return{"ChatMembers-username--fullInbox":e}};function D(e,t){if(1&e&&(i.Yb(0,"fl-bit",5),i.Tb(1,"fl-username",6),i.Zc(2,$,3,9,"fl-text",7),i.Zc(3,G,2,2,"fl-text",7),i.Xb()),2&e){const e=i.rc();i.Gb(1),i.zc("ngClass",i.Ec(7,F,!e.compactLayout))("displayName",e.otherMembers[0].displayName)("flMarginBottom",e.compactLayout?e.Margin.NONE:e.Margin.XXSMALL)("link",e.otherMembers[0].profileUrl)("username",e.otherMembers[0].username),i.Gb(1),i.zc("ngIf",(null==e.otherMembers[0].onlineOfflineStatus?null:e.otherMembers[0].onlineOfflineStatus.status)===e.OnlineOfflineStatusApi.OFFLINE&&(null==e.otherMembers[0].onlineOfflineStatus?null:e.otherMembers[0].onlineOfflineStatus.lastUpdatedTimestamp)),i.Gb(1),i.zc("ngIf",(null==e.otherMembers[0].onlineOfflineStatus?null:e.otherMembers[0].onlineOfflineStatus.status)===e.OnlineOfflineStatusApi.ONLINE)}}function N(e,t){if(1&e&&(i.ic(0,14,1),i.Tb(1,"fl-text",18),i.fc()),2&e){const e=i.rc(2);i.Gb(1),i.zc("fontType",e.FontType.SPAN)("weight",e.FontWeight.BOLD),i.gc(e.otherMembers.length-1),i.dc(0)}}function X(e,t){if(1&e&&(i.Yb(0,"fl-bit",12),i.Yb(1,"fl-text",13),i.ic(2,14),i.Zc(3,N,2,3,"fl-text",15),i.fc(),i.Xb(),i.Yb(4,"fl-text",16),i.cc(5,17),i.Xb(),i.Xb()),2&e){const e=i.rc();i.zc("flMarginRight",e.compactLayout?e.Margin.SMALL:e.Margin.NONE),i.Gb(1),i.zc("flMarginBottom",e.compactLayout?e.Margin.NONE:e.Margin.XXSMALL)("weight",e.FontWeight.BOLD),i.Gb(2),i.zc("ngIf",e.otherMembers.length>1),i.gc(e.otherMembers[0].displayName),i.dc(2),i.Gb(1),i.zc("color",e.FontColor.MID),i.Gb(1),i.gc(e.otherMembers.length+1),i.dc(5)}}function Y(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-link",19),i.nc("click",function(){return i.Pc(e),i.rc().showAllMembers.emit()}),i.cc(1,20),i.Xb()}if(2&e){const e=i.rc();i.zc("flHideMobile",!0)("textTransform",e.TextTransform.UPPERCASE)}}const H=function(e){return{"ChatMembers--fullInbox":e}},V=function(e){return{"ChatMembers-avatar--fullInbox":e}};let Z=(()=>{class e{constructor(){this.AvatarSize=j.a,this.FontColor=c.a,this.FontType=l.b,this.FontWeight=l.c,this.IconColor=s.c,this.LinkColor=a.a,this.LinkWeight=a.f,this.Margin=o.a,this.OnlineOfflineStatusApi=h.OnlineOfflineStatusApi,this.TextSize=l.f,this.TextTransform=l.g,this.showAllMembers=new i.n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-details-members-summary"]],inputs:{compactLayout:"compactLayout",isGroupChat:"isGroupChat",otherMembers:"otherMembers"},outputs:{showAllMembers:"showAllMembers"},decls:6,vars:14,consts:function(){let e,t,n,i,s;return e=" Active " + "\ufffd#2\ufffd" + "" + "\ufffd/#2\ufffd" + "",t=" Active now ",n=" " + "\ufffd0\ufffd" + " members ",i=" " + "\ufffd0\ufffd" + " " + "\ufffd*3:1\ufffd\ufffd#1:1\ufffd" + " + " + "\ufffd0:1\ufffd" + " More " + "\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd" + "",s=" See members ",[[1,"ChatMembers",3,"ngClass"],[3,"ngClass","flMarginBottom","flMarginRight","isOnline","size","users"],["class","ChatMembers-title",4,"ngIf","ngIfElse"],["groupChatTitle",""],["class","ChatMembers-link","flTrackingLabel","SeeMembers",3,"flHideMobile","textTransform","click",4,"ngIf"],[1,"ChatMembers-title"],["flTrackingLabel","OtherPartyUsername",3,"ngClass","displayName","flMarginBottom","link","username"],[3,"fontType","color",4,"ngIf"],[3,"fontType","color"],e,[3,"color","date","includeSeconds","size","strict","suffix","weight"],t,[1,"ChatMembers-title",3,"flMarginRight"],[3,"flMarginBottom","weight"],i,[3,"fontType","weight",4,"ngIf"],[3,"color"],n,[3,"fontType","weight"],["flTrackingLabel","SeeMembers",1,"ChatMembers-link",3,"flHideMobile","textTransform","click"],s]},template:function(e,t){if(1&e&&(i.Yb(0,"fl-bit",0),i.Tb(1,"fl-user-avatar",1),i.Zc(2,D,4,9,"fl-bit",2),i.Xb(),i.Zc(3,X,6,7,"ng-template",null,3,i.ad),i.Zc(5,Y,2,2,"fl-link",4)),2&e){const e=i.Mc(4);i.zc("ngClass",i.Ec(10,H,!t.compactLayout)),i.Gb(1),i.zc("ngClass",i.Ec(12,V,!t.compactLayout))("flMarginBottom",t.compactLayout?t.Margin.NONE:t.Margin.SMALL)("flMarginRight",t.compactLayout?t.Margin.SMALL:t.Margin.NONE)("isOnline",t.isGroupChat?void 0:(null==t.otherMembers[0].onlineOfflineStatus?null:t.otherMembers[0].onlineOfflineStatus.status)===t.OnlineOfflineStatusApi.ONLINE)("size",t.compactLayout?t.AvatarSize.MID:t.AvatarSize.XLARGE)("users",t.otherMembers),i.Gb(1),i.zc("ngIf",!t.isGroupChat)("ngIfElse",e),i.Gb(3),i.zc("ngIf",t.isGroupChat&&t.compactLayout)}},directives:[I.a,m.o,j.b,o.b,m.q,U.b,O.a,l.e,B.b,a.b,C.a],styles:[".ChatMembers[_ngcontent-%COMP%], [_nghost-%COMP%]{display:flex}.ChatMembers-title[_ngcontent-%COMP%]{display:flex;flex:1;flex-direction:column;justify-content:space-between}.ChatMembers-link[_ngcontent-%COMP%], .ChatMembers-title[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word}.ChatMembers-link[_ngcontent-%COMP%]{margin-left:auto;margin-top:6px;max-width:30%}.ChatMembers-avatar--fullInbox[_ngcontent-%COMP%], .ChatMembers-username--fullInbox[_ngcontent-%COMP%]{justify-content:center}.ChatMembers--fullInbox[_ngcontent-%COMP%]{align-items:center;flex-direction:column;justify-content:center;text-align:center;width:100%}"],changeDetection:0}),e})();var W=n("tbiQ"),q=n("/zj7");function Q(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-list-item",9),i.nc("click",function(t){return i.Pc(e),i.rc(2).handleVideoCallClick(t)}),i.ic(1,10),i.Yb(2,"fl-bit",6),i.Tb(3,"fl-icon",7),i.Tb(4,"fl-text",8),i.Xb(),i.fc(),i.Xb()}if(2&e){const e=i.rc(2);i.Gb(3),i.zc("name","ui-video-camera-v2")("color",e.IconColor.PRIMARY)("flMarginRight",e.Margin.XSMALL)}}function K(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Zc(1,Q,5,3,"fl-list-item",3),i.Yb(2,"fl-list-item",4),i.nc("click",function(t){i.Pc(e);const n=i.rc();return n.handleAudioCallClick(t,null==n.callsEnabled?null:n.callsEnabled.audio.recorded)}),i.ic(3,5),i.Yb(4,"fl-bit",6),i.Tb(5,"fl-icon",7),i.Tb(6,"fl-text",8),i.Xb(),i.fc(),i.Xb(),i.Vb()}if(2&e){const e=i.rc();i.Gb(1),i.zc("ngIf",null==e.callsEnabled?null:e.callsEnabled.video.enabled),i.Gb(4),i.zc("name","ui-phone")("color",e.IconColor.PRIMARY)("flMarginRight",e.Margin.XSMALL)}}function J(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-list-item",11),i.nc("click",function(){return i.Pc(e),i.rc().showAddPeopleScreen.emit()}),i.ic(1,12),i.Yb(2,"fl-bit",6),i.Tb(3,"fl-icon",7),i.Tb(4,"fl-text",8),i.Xb(),i.fc(),i.Xb()}if(2&e){const e=i.rc();i.Gb(3),i.zc("name","ui-plus-thin")("color",e.IconColor.PRIMARY)("flMarginRight",e.Margin.XSMALL)}}let ee=(()=>{class e{constructor(e){this.videochat=e,this.IconColor=s.c,this.ListItemType=x.f,this.Margin=o.a,this.makingCall=new i.n,this.showAddPeopleScreen=new i.n}handleAudioCallClick(e,t){e.stopPropagation(),this.startCall(W.a.AUDIO,t),this.makingCall.emit(!0)}handleVideoCallClick(e){e.stopPropagation(),this.startCall(W.a.VIDEO),this.makingCall.emit(!0)}startCall(e,t=!1){this.videochat.openCallWindow({action:e,threadId:this.thread.id,accepting:!1,recorded:t})}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(W.b))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-details-actions"]],inputs:{callsEnabled:"callsEnabled",showAddPeopleCta:"showAddPeopleCta",chatboxMode:"chatboxMode",thread:"thread"},outputs:{makingCall:"makingCall",showAddPeopleScreen:"showAddPeopleScreen"},decls:3,vars:4,consts:function(){let e,t,n;return e="" + "\ufffd#4\ufffd" + "" + "\ufffd#5\ufffd" + "" + "\ufffd/#5\ufffd" + "" + "\ufffd#6\ufffd" + " Call " + "\ufffd/#6\ufffd" + "" + "\ufffd/#4\ufffd" + "",t="" + "\ufffd#2\ufffd" + "" + "\ufffd#3\ufffd" + "" + "\ufffd/#3\ufffd" + "" + "\ufffd#4\ufffd" + " Video " + "\ufffd/#4\ufffd" + "" + "\ufffd/#2\ufffd" + "",n="" + "\ufffd#2\ufffd" + "" + "\ufffd#3\ufffd" + "" + "\ufffd/#3\ufffd" + "" + "\ufffd#4\ufffd" + " Add People " + "\ufffd/#4\ufffd" + "" + "\ufffd/#2\ufffd" + "",[[3,"clickable","type"],[4,"ngIf"],["flTrackingLabel","AddPeopleCta",3,"click",4,"ngIf"],["flTrackingLabel","VideoCallCta",3,"click",4,"ngIf"],["flTrackingLabel","AudioCallCta",3,"click"],e,[1,"ChatAction"],[3,"name","color","flMarginRight"],[1,"ChatAction-text"],["flTrackingLabel","VideoCallCta",3,"click"],t,["flTrackingLabel","AddPeopleCta",3,"click"],n]},template:function(e,t){1&e&&(i.Yb(0,"fl-list",0),i.Zc(1,K,7,4,"ng-container",1),i.Zc(2,J,5,3,"fl-list-item",2),i.Xb()),2&e&&(i.zc("clickable",!0)("type",t.ListItemType.NON_BORDERED),i.Gb(1),i.zc("ngIf",null==t.callsEnabled?null:t.callsEnabled.audio.enabled),i.Gb(1),i.zc("ngIf",t.showAddPeopleCta))},directives:[q.a,m.q,x.b,O.a,I.a,s.d,o.b,l.e],styles:["[_nghost-%COMP%]{display:block}.ChatAction[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;display:flex}.ChatAction-text[_ngcontent-%COMP%]{align-items:center;display:flex}"],changeDetection:0}),e})();var te=n("B23V"),ne=n("dO68"),ie=n("MmDv"),se=n("g6qU");function ae(e,t){if(1&e&&(i.Yb(0,"fl-bit",9),i.Yb(1,"app-messaging-context-button",10),i.nc("click",function(e){return e.stopPropagation()}),i.Xb(),i.Xb()),2&e){const e=i.rc();i.Gb(1),i.zc("contextBoxState",e.contextBoxState)}}let oe=(()=>{class e{constructor(e){this.activatedRoute=e,this.ButtonColor=te.a,this.ButtonSize=ne.a,this.LinkWeight=a.f,this.FontColor=c.a,this.IconColor=s.c,this.Margin=o.a,this.NON_CTA_CONTEXT_BOX_STATE_NAME=ie.a}ngOnChanges(e){var t;if("contextBoxState"in e){const e=this.activatedRoute.snapshot.queryParams;this.linkQueryParams=Object.assign(Object.assign({},null===(t=this.contextBoxState)||void 0===t?void 0:t.linkQueryParams),e)}}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(b.a))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-details-context"]],inputs:{contextBoxState:"contextBoxState",thread:"thread"},features:[i.Eb],decls:9,vars:11,consts:function(){let e,t;return e=" " + "\ufffd0\ufffd" + " ",t=" Posted " + "\ufffd#7\ufffd" + "" + "\ufffd/#7\ufffd" + "",[[1,"ChatContext-preview",3,"flMarginRight"],[3,"color","name"],[1,"ChatContext-title",3,"flMarginRight"],["flTrackingLabel","Context link",3,"link","queryParams","weight","click"],e,[3,"color"],t,[3,"date"],["class","ChatContext-cta-container",4,"ngIf"],[1,"ChatContext-cta-container"],[3,"contextBoxState","click"]]},template:function(e,t){1&e&&(i.Yb(0,"fl-bit",0),i.Tb(1,"fl-icon",1),i.Xb(),i.Yb(2,"fl-bit",2),i.Yb(3,"fl-link",3),i.nc("click",function(e){return e.stopPropagation()}),i.cc(4,4),i.Xb(),i.Yb(5,"fl-text",5),i.ic(6,6),i.Tb(7,"fl-relative-time",7),i.fc(),i.Xb(),i.Xb(),i.Zc(8,ae,2,1,"fl-bit",8)),2&e&&(i.zc("flMarginRight",t.Margin.SMALL),i.Gb(1),i.zc("color",t.IconColor.LIGHT)("name","ui-suitcase-outline"),i.Gb(1),i.zc("flMarginRight",t.Margin.SMALL),i.Gb(1),i.zc("link",null==t.contextBoxState?null:t.contextBoxState.linkUrl)("queryParams",t.linkQueryParams)("weight",t.LinkWeight.BOLD),i.Gb(1),i.gc(null==t.contextBoxState?null:t.contextBoxState.linkText),i.dc(4),i.Gb(1),i.zc("color",t.FontColor.MID),i.Gb(2),i.zc("date",null==t.contextBoxState?null:t.contextBoxState.timeSubmitted),i.Gb(1),i.zc("ngIf",!t.NON_CTA_CONTEXT_BOX_STATE_NAME.includes(null==t.contextBoxState?null:t.contextBoxState.name)))},directives:[I.a,o.b,s.d,a.b,O.a,l.e,B.b,m.q,se.a],styles:["[_nghost-%COMP%]{display:flex;padding:16px 8px}.ChatContext-preview[_ngcontent-%COMP%]{align-items:center;background-color:#007fed;display:flex;height:46px;justify-content:center;width:46px}.ChatContext-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:flex;flex:1 1 0%;flex-direction:column;justify-content:center}.ChatContext-cta-container[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;display:flex;max-width:25%;padding:4px 0}.ChatContext-cta-button[_ngcontent-%COMP%]{align-items:center;display:flex}"],changeDetection:0}),e})();var re=n("fYbj"),ce=n("5i9J");let le=(()=>{class e{constructor(){this.FontColor=c.a,this.Margin=o.a,this.TextSize=l.f,this.TextTransform=l.g,this.trackById=re.m,this.showAllMembers=new i.n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-details-group-members"]],inputs:{loggedInUser:"loggedInUser",otherMembers:"otherMembers"},outputs:{showAllMembers:"showAllMembers"},decls:8,vars:15,consts:function(){let e,t;return e=" Group Members ",t=" See all ",[[1,"MessagingGroupMembers-header"],[3,"color","size","textTransform"],e,["flTrackingLabel","MessageGroupMembersSeeAll",3,"size","textTransform","click"],t,[3,"flMarginBottom"],[1,"MessagingGroupMembers-content",3,"chatboxMode","loggedInUser","otherMembers","showAddPeopleCta","showRemoveCta"]]},template:function(e,t){1&e&&(i.Yb(0,"fl-bit",0),i.Yb(1,"fl-text",1),i.cc(2,2),i.Xb(),i.Yb(3,"fl-link",3),i.nc("click",function(){return t.showAllMembers.emit()}),i.cc(4,4),i.Xb(),i.Xb(),i.Tb(5,"fl-hr",5),i.Tb(6,"app-messaging-group-members",6),i.sc(7,"slice")),2&e&&(i.Gb(1),i.zc("color",t.FontColor.MID)("size",t.TextSize.XXXSMALL)("textTransform",t.TextTransform.UPPERCASE),i.Gb(2),i.zc("size",t.TextSize.XXXSMALL)("textTransform",t.TextTransform.UPPERCASE),i.Gb(2),i.zc("flMarginBottom",t.Margin.MID),i.Gb(1),i.zc("chatboxMode",!1)("loggedInUser",t.loggedInUser)("otherMembers",i.vc(7,11,t.otherMembers,0,2))("showAddPeopleCta",!1)("showRemoveCta",!1))},directives:[I.a,l.e,a.b,O.a,S.a,o.b,ce.a],pipes:[m.z],styles:["[_nghost-%COMP%]{display:block}.MessagingGroupMembers-header[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:space-between;padding:16px 8px}.MessagingGroupMembers-content[_ngcontent-%COMP%]{padding:0 8px}"],changeDetection:0}),e})();var de=n("jASZ"),he=n("os2j"),ge=n("KrVf"),ue=n("2Gc0"),be=n("al+g");let fe=(()=>{class e{constructor(e){this.fileStorage=e,this.FontColor=c.a,this.Margin=o.a,this.TextSize=l.f,this.TextTransform=l.g,this.trackById=re.m}ngOnChanges(e){e.attachment&&this.attachment&&(this.pathPromise=this.fileStorage.getDownloadURL(he.a.MESSAGING_ATTACHMENTS,this.attachment.filename,{messageId:this.attachment.messageId.toString()}).then(e=>"success"===e.status?e.downloadURL:void 0),this.dateUploaded=new Date(this.attachment.timeCreated))}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(ge.a))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-details-attachment-item"]],inputs:{attachment:"attachment"},features:[i.Eb],decls:9,vars:11,consts:function(){let e;return e=" Uploaded " + "\ufffd0\ufffd" + " ",[[1,"MessagingAttachmentItem-image"],[3,"alt","flMarginRight","src"],[1,"MessagingAttachmentItem-content"],[1,"MessagingAttachmentItem-title"],[3,"color","size"],e]},template:function(e,t){1&e&&(i.Yb(0,"fl-bit",0),i.Tb(1,"fl-file-display",1),i.sc(2,"flAsync"),i.Xb(),i.Yb(3,"fl-bit",2),i.Yb(4,"fl-text",3),i.bd(5),i.Xb(),i.Yb(6,"fl-text",4),i.cc(7,5),i.sc(8,"date"),i.Xb(),i.Xb()),2&e&&(i.Gb(1),i.zc("alt",t.attachment.filename)("flMarginRight",t.Margin.XXSMALL)("src",i.tc(2,7,t.pathPromise)),i.Gb(4),i.dd(" ",t.attachment.filename," "),i.Gb(1),i.zc("color",t.FontColor.INHERIT)("size",t.TextSize.XXXSMALL),i.Gb(2),i.gc(i.tc(8,9,t.dateUploaded)),i.dc(7))},directives:[I.a,ue.a,o.b,l.e],pipes:[be.a,m.f],styles:["[_nghost-%COMP%]{align-items:center;display:flex}.MessagingAttachmentItem-image[_ngcontent-%COMP%]{position:relative}.MessagingAttachmentItem-content[_ngcontent-%COMP%]{display:flex;flex:1 1 0%;flex-direction:column;overflow:hidden}.MessagingAttachmentItem-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1 1 0%}"],changeDetection:0}),e})();var pe=n("565b");const me=function(e){return{"MessagingAttachmentList--firstItem":e}};function Me(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-list-item",3),i.nc("click",function(){i.Pc(e);const n=t.$implicit;return i.rc().viewAttachment(n)}),i.Tb(1,"app-messaging-chat-details-attachment-item",4),i.Xb()}if(2&e){const e=t.$implicit,n=t.first;i.Gb(1),i.zc("ngClass",i.Ec(2,me,n))("attachment",e)}}function Ce(e,t){if(1&e&&i.Tb(0,"fl-spinner",8),2&e){const e=i.rc(2);i.zc("size",e.SpinnerSize.SMALL)("flMarginBottom",e.Margin.SMALL)}}function Se(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-link",9),i.nc("click",function(){return i.Pc(e),i.rc(2).loadMoreAttachments.emit()}),i.cc(1,10),i.Xb()}if(2&e){const e=i.rc(2);i.zc("flMarginBottom",e.Margin.SMALL)}}function Te(e,t){if(1&e&&(i.Yb(0,"fl-bit",5),i.Zc(1,Ce,1,2,"fl-spinner",6),i.Zc(2,Se,2,1,"fl-link",7),i.Xb()),2&e){const e=i.rc();i.Gb(1),i.zc("ngIf",!e.attachmentsFetchStatus.ready&&!e.attachmentsFetchStatus.error),i.Gb(1),i.zc("ngIf",e.attachmentsFetchStatus.ready&&!e.attachmentsFetchStatus.error&&e.hasMoreAttachments)}}let xe=(()=>{class e{constructor(e){this.modalService=e,this.ListItemPadding=x.e,this.ListItemType=x.f,this.Margin=o.a,this.SpinnerSize=de.d,this.trackById=re.m,this.hasMoreAttachments=!1,this.showFullList=!1,this.loadMoreAttachments=new i.n}viewAttachment(e){const t=Object(re.f)(e.filename);this.modalService.open("FileViewerModal",{inputs:{filename:e.filename,filetype:t,messageId:e.messageId},edgeToEdge:!0,size:r.a.XLARGE})}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(u.b))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-details-attachment-list"]],inputs:{attachments:"attachments",attachmentsFetchStatus:"attachmentsFetchStatus",hasMoreAttachments:"hasMoreAttachments",showFullList:"showFullList"},outputs:{loadMoreAttachments:"loadMoreAttachments"},decls:3,vars:8,consts:function(){let e;return e=" Load more ",[[3,"clickable","flMarginBottom","outerPadding","padding","type"],["flTrackingLabel","MessageAttachmentListItem",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["class","MessagingAttachmentList-loadMore",4,"ngIf"],["flTrackingLabel","MessageAttachmentListItem",3,"click"],[1,"MessagingAttachmentList-item",3,"ngClass","attachment"],[1,"MessagingAttachmentList-loadMore"],["flTrackingLabel","LoadingMoreThreadsSpinner",3,"size","flMarginBottom",4,"ngIf"],["flTrackingLabel","LoadMoreThreadsLink",3,"flMarginBottom","click",4,"ngIf"],["flTrackingLabel","LoadingMoreThreadsSpinner",3,"size","flMarginBottom"],["flTrackingLabel","LoadMoreThreadsLink",3,"flMarginBottom","click"],e]},template:function(e,t){1&e&&(i.Yb(0,"fl-list",0),i.Zc(1,Me,2,4,"fl-list-item",1),i.Xb(),i.Zc(2,Te,3,2,"fl-bit",2)),2&e&&(i.zc("clickable",!0)("flMarginBottom",t.Margin.XSMALL)("outerPadding",!1)("padding",t.ListItemPadding.XXSMALL)("type",t.ListItemType.NON_BORDERED),i.Gb(1),i.zc("ngForOf",t.attachments)("ngForTrackBy",t.trackById),i.Gb(1),i.zc("ngIf",t.showFullList))},directives:[q.a,o.b,m.p,m.q,x.b,O.a,fe,m.o,I.a,pe.a,de.c,a.b],styles:["[_nghost-%COMP%]{display:block}.MessagingAttachmentList-loadMore[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center}.MessagingAttachmentList-item[_ngcontent-%COMP%]{padding:0 8px}.MessagingAttachmentList--firstItem[_ngcontent-%COMP%]{padding-top:8px}"],changeDetection:0}),e})();const ye=["attachmentsDrawer"],Ie=["scrollableContent"];function Oe(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Yb(1,"fl-bit",9),i.Tb(2,"fl-icon",10),i.Yb(3,"fl-link",11),i.nc("click",function(t){return i.Pc(e),i.rc(2).handleRedirectToInbox(t)}),i.cc(4,12),i.Xb(),i.Xb(),i.Tb(5,"fl-hr"),i.Vb()}if(2&e){const e=i.rc(2);i.Gb(1),i.zc("flMarginBottom",e.Margin.SMALL),i.Gb(1),i.zc("name","ui-chat")("color",e.IconColor.PRIMARY)("flMarginRight",e.Margin.XXSMALL),i.Gb(1),i.zc("color",e.LinkColor.INHERIT)("weight",e.LinkWeight.BOLD)}}function Ae(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Yb(1,"app-messaging-chat-details-members-summary",13),i.nc("showAllMembers",function(){return i.Pc(e),i.rc(2).showAllMembers.emit()}),i.Xb(),i.Yb(2,"app-messaging-chat-details-members-summary",14),i.nc("showAllMembers",function(){return i.Pc(e),i.rc(2).showAllMembers.emit()}),i.Xb(),i.Vb()}if(2&e){const e=i.rc(2);i.Gb(1),i.zc("compactLayout",e.chatboxMode)("isGroupChat",e.thread.threadType===e.ThreadTypeApi.GROUP)("flHideMobile",!0)("otherMembers",e.otherMembers),i.Gb(1),i.zc("compactLayout",!0)("isGroupChat",e.thread.threadType===e.ThreadTypeApi.GROUP)("flShowMobile",!0)("otherMembers",e.otherMembers)}}function ve(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Tb(1,"fl-hr"),i.Yb(2,"app-messaging-chat-details-actions",15),i.nc("makingCall",function(t){return i.Pc(e),i.rc(2).makingCall.emit(t)})("showAddPeopleScreen",function(){return i.Pc(e),i.rc(2).showAddPeopleScreen.emit()}),i.Xb(),i.Yb(3,"app-messaging-chat-details-actions",16),i.nc("makingCall",function(t){return i.Pc(e),i.rc(2).makingCall.emit(t)})("showAddPeopleScreen",function(){return i.Pc(e),i.rc(2).showAddPeopleScreen.emit()}),i.Xb(),i.Vb()}if(2&e){const e=i.rc(2);i.Gb(2),i.zc("flHideMobile",!0)("callsEnabled",e.callsEnabled)("chatboxMode",e.chatboxMode)("showAddPeopleCta",e.canUserManageThreadMembers)("thread",e.thread),i.Gb(1),i.zc("flShowMobile",!0)("callsEnabled",e.callsEnabled)("chatboxMode",!0)("showAddPeopleCta",e.canUserManageThreadMembers)("thread",e.thread)}}function we(e,t){if(1&e&&(i.Wb(0),i.Tb(1,"fl-hr"),i.Tb(2,"app-messaging-chat-details-context",17),i.Vb()),2&e){const e=i.rc(2);i.Gb(2),i.zc("contextBoxState",e.contextBoxState)("thread",e.thread)}}function Ee(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Tb(1,"fl-hr"),i.Yb(2,"app-messaging-chat-details-group-members",18),i.nc("showAllMembers",function(){return i.Pc(e),i.rc(2).showAllMembers.emit()}),i.Xb(),i.Vb()}if(2&e){const e=i.rc(2);i.Gb(2),i.zc("loggedInUser",e.loggedInUser)("otherMembers",e.otherMembers)}}function ze(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Tb(1,"fl-hr"),i.Yb(2,"fl-bit",19),i.Yb(3,"fl-text",20),i.cc(4,21),i.Xb(),i.Yb(5,"fl-link",22),i.nc("click",function(){return i.Pc(e),i.rc(2).seeAttachmentsList()}),i.cc(6,23),i.Xb(),i.Xb(),i.Tb(7,"fl-hr",24),i.Yb(8,"app-messaging-chat-details-attachment-list",25),i.nc("seeAllAttachments",function(){return i.Pc(e),i.rc(2).seeAttachmentsList()}),i.Xb(),i.Vb()}if(2&e){const e=i.rc(2);i.Gb(3),i.zc("color",e.FontColor.MID)("size",e.TextSize.XXXSMALL)("textTransform",e.TextTransform.UPPERCASE),i.Gb(2),i.zc("size",e.TextSize.XXXSMALL)("textTransform",e.TextTransform.UPPERCASE),i.Gb(2),i.zc("flMarginBottom",e.Margin.SMALL),i.Gb(1),i.zc("attachments",e.attachments)}}const Le=function(){return["group","team","team_official"]};function ke(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Zc(1,Oe,6,6,"ng-container",7),i.Zc(2,Ae,3,8,"ng-container",7),i.Zc(3,ve,4,10,"ng-container",7),i.Zc(4,we,3,2,"ng-container",7),i.Zc(5,Ee,3,2,"ng-container",7),i.Zc(6,ze,9,7,"ng-container",7),i.Tb(7,"fl-hr"),i.Yb(8,"app-messaging-chat-details-settings",8),i.nc("leaveChat",function(){i.Pc(e);const t=i.rc();return t.removeMember.emit(t.loggedInUser)})("reportChat",function(){return i.Pc(e),i.rc().handleReportClick()})("toggleArchive",function(t){return i.Pc(e),i.rc().handleToggleArchive(t)})("toggleBlock",function(t){return i.Pc(e),i.rc().handleToggleBlock(t)})("toggleMute",function(t){return i.Pc(e),i.rc().handleToggleMute(t)}),i.sc(9,"flAsync"),i.sc(10,"flAsync"),i.sc(11,"flAsync"),i.Xb(),i.Vb()}if(2&e){const e=i.rc();i.Gb(1),i.zc("ngIf",e.chatboxMode),i.Gb(1),i.zc("ngIf",e.otherMembers&&(null==e.otherMembers?null:e.otherMembers.length)>0),i.Gb(1),i.zc("ngIf",e.canUserManageThreadMembers||(null==e.callsEnabled?null:e.callsEnabled.audio.enabled)),i.Gb(1),i.zc("ngIf",e.contextBoxState),i.Gb(1),i.zc("ngIf",!e.chatboxMode&&e.thread.threadType===e.ThreadTypeApi.GROUP),i.Gb(1),i.zc("ngIf",!e.chatboxMode&&e.attachments&&e.attachments.length>0),i.Gb(2),i.zc("archiveError",e.archiveError)("blockError",e.blockError)("archived",e.thread.folder===e.FolderApi.ARCHIVED)("blocked",e.thread.isBlocked)("muted",e.thread.isMuted)("isLoggedInUserThreadOwner",e.isLoggedInUserThreadOwner)("isGroupChat",e.thread.threadType===e.ThreadTypeApi.GROUP)("isArchiveToggleBusy",!!e.archiveResponse$&&void 0===i.tc(9,19,e.archiveResponse$))("isBlockToggleBusy",!!e.blockResponse$&&void 0===i.tc(10,21,e.blockResponse$))("isMuteToggleBusy",!!e.muteResponse$&&void 0===i.tc(11,23,e.muteResponse$))("isBlockSettingEnabled",1===e.thread.otherMembers.length&&!i.Dc(25,Le).includes(e.thread.threadType)&&"owner_autochat"!==e.thread.writePrivacy)("isReportSettingEnabled",e.isReportSettingEnabled)("muteError",e.muteError)}}function Pe(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-bit",26),i.Yb(1,"fl-icon",27),i.nc("click",function(){return i.Pc(e),i.rc().hideAttachmentsList()}),i.Xb(),i.Yb(2,"fl-text",28),i.cc(3,29),i.Xb(),i.Xb(),i.Yb(4,"app-messaging-chat-details-attachment-list",30),i.nc("seeAllAttachments",function(){return i.Pc(e),i.rc().seeAttachmentsList()})("loadMoreAttachments",function(){return i.Pc(e),i.rc().loadMoreAttachments.emit()}),i.Xb()}if(2&e){const e=i.rc();i.zc("flShowDesktop",!0),i.Gb(1),i.zc("name","ui-chevron-left")("clickable",!0)("flMarginRight",e.Margin.XXSMALL)("size",e.IconSize.SMALL),i.Gb(1),i.zc("size",e.TextSize.SMALL),i.Gb(2),i.zc("flShowDesktop",!0)("attachments",e.attachments)("attachmentsFetchStatus",e.attachmentsFetchStatus)("hasMoreAttachments",e.hasMoreAttachments)("showFullList",!0)}}function _e(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-chat-details-attachment-list",31),i.nc("seeAllAttachments",function(){return i.Pc(e),i.rc().seeAttachmentsList()})("loadMoreAttachments",function(){return i.Pc(e),i.rc().loadMoreAttachments.emit()}),i.Xb()}if(2&e){const e=i.rc();i.zc("attachments",e.attachments)("attachmentsFetchStatus",e.attachmentsFetchStatus)("hasMoreAttachments",e.hasMoreAttachments)("showFullList",!0)}}let Re=(()=>{class e{constructor(e,t,n){this.datastore=e,this.modalService=t,this.router=n,this.FolderApi=d.FolderApi,this.FontColor=c.a,this.FontWeight=l.c,this.IconColor=s.c,this.IconSize=s.e,this.LinkColor=a.a,this.LinkWeight=a.f,this.Margin=o.a,this.TextSize=l.f,this.TextTransform=l.g,this.ThreadTypeApi=d.ThreadTypeApi,this.chatboxMode=!0,this.isReportSettingEnabled=!1,this.loadMoreAttachments=new i.n,this.makingCall=new i.n,this.resetAttachmentsLimit=new i.n,this.removeMember=new i.n,this.showAddPeopleScreen=new i.n,this.showAllMembers=new i.n,this.showAttachmentsList=!1}handleRedirectToInbox(e){if(e.stopPropagation(),this.thread.isFake){const{threadType:e,members:t,context:n}=this.thread;return this.router.navigate(["/messages/new"],{queryParams:{thread_type:e,context_type:n.type,context_id:n.type!==d.ContextTypeApi.NONE?n.id:void 0,members:t}})}this.router.navigate(["/messages/thread",this.thread.id])}handleToggleArchive(e){if(!this.thread.isFake){const t=e?d.FolderApi.ARCHIVED:d.FolderApi.INBOX;this.archiveResponse$=this.datastore.collection("threads").update(this.thread.id,{folder:t}).then(e=>(this.archiveError="error"===e.status?e:void 0,e))}}handleToggleBlock(e){this.thread.isFake||(this.blockResponse$=this.datastore.collection("threads").update(this.thread.id,{isBlocked:e}).then(e=>(this.blockError="error"===e.status?e:void 0,e)))}handleToggleMute(e){this.thread.isFake||(this.muteResponse$=this.datastore.collection("threads").update(this.thread.id,{isMuted:e}).then(e=>(this.muteError="error"===e.status?e:void 0,e)))}seeAttachmentsList(){this.loadMoreAttachments.emit(),this.showAttachmentsList=!0,this.attachmentsDrawer.open(),this.scrollableContent.scrollToTop()}hideAttachmentsList(){this.resetAttachmentsLimit.emit(),this.showAttachmentsList=!1,this.attachmentsDrawer.close()}handleReportClick(){this.modalService.open("ViolationReportModal",{inputs:{violatorUserId:this.thread.owner,contextId:this.thread.context.type===d.ContextTypeApi.PROJECT?this.thread.context.id:this.thread.owner,contextType:this.thread.context.type===d.ContextTypeApi.PROJECT?h.ViolationReportContextTypeApi.PROJECT:h.ViolationReportContextTypeApi.PROFILE},size:r.a.MID,mobileFullscreen:!0})}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(g.a),i.Sb(u.b),i.Sb(b.e))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-details"]],viewQuery:function(e,t){if(1&e&&(i.id(ye,1),i.id(Ie,1)),2&e){let e;i.Lc(e=i.oc())&&(t.attachmentsDrawer=e.first),i.Lc(e=i.oc())&&(t.scrollableContent=e.first)}},inputs:{attachments:"attachments",attachmentsFetchStatus:"attachmentsFetchStatus",callsEnabled:"callsEnabled",chatboxMode:"chatboxMode",canUserManageThreadMembers:"canUserManageThreadMembers",contextBoxState:"contextBoxState",hasMoreAttachments:"hasMoreAttachments",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",isLoggedInUserThreadOwner:"isLoggedInUserThreadOwner",isReportSettingEnabled:"isReportSettingEnabled",loggedInUser:"loggedInUser",otherMembers:"otherMembers",supportAgent:"supportAgent",team:"team",thread:"thread",threadBidders:"threadBidders",threadCollaborators:"threadCollaborators",threadContacts:"threadContacts"},outputs:{loadMoreAttachments:"loadMoreAttachments",makingCall:"makingCall",resetAttachmentsLimit:"resetAttachmentsLimit",removeMember:"removeMember",showAddPeopleScreen:"showAddPeopleScreen",showAllMembers:"showAllMembers"},decls:9,vars:5,consts:function(){let e,t,n,i,s;return e="Attachments",t=" Open this chat in your inbox ",n=" Attachments ",i=" See All ",s=" Attachments ",[["flTrackingSection","MessagingChatDetails",1,"MessagingChatDetails"],["scrollableContent",""],[4,"ngIf","ngIfElse"],["fullAttachmentList",""],["mobileHeaderTitle",e,3,"edgeToEdge","fullWidth","flHideDesktop","closeDrawer"],["attachmentsDrawer",""],["drawerTemplate",""],[4,"ngIf"],[3,"archiveError","blockError","archived","blocked","muted","isLoggedInUserThreadOwner","isGroupChat","isArchiveToggleBusy","isBlockToggleBusy","isMuteToggleBusy","isBlockSettingEnabled","isReportSettingEnabled","muteError","leaveChat","reportChat","toggleArchive","toggleBlock","toggleMute"],[1,"OpenChatInInbox",3,"flMarginBottom"],[1,"OpenChatInInbox-icon",3,"name","color","flMarginRight"],["flTrackingLabel","OpenChatInInbox-link",3,"color","weight","click"],t,[1,"MessagingMembersSummary",3,"compactLayout","isGroupChat","flHideMobile","otherMembers","showAllMembers"],[1,"MessagingMembersSummary--mobileInbox",3,"compactLayout","isGroupChat","flShowMobile","otherMembers","showAllMembers"],[3,"flHideMobile","callsEnabled","chatboxMode","showAddPeopleCta","thread","makingCall","showAddPeopleScreen"],[3,"flShowMobile","callsEnabled","chatboxMode","showAddPeopleCta","thread","makingCall","showAddPeopleScreen"],[3,"contextBoxState","thread"],[3,"loggedInUser","otherMembers","showAllMembers"],[1,"MessagingAttachmentList-previewListHeader"],[3,"color","size","textTransform"],n,["flTrackingLabel","MessagingAttachmentsSeeAll",3,"size","textTransform","click"],i,[3,"flMarginBottom"],[3,"attachments","seeAllAttachments"],[1,"MessagingAttachmentList-fullListHeader",3,"flShowDesktop"],["flTrackingLabel","MessagingAttachmentListBackButton",3,"name","clickable","flMarginRight","size","click"],[3,"size"],s,[3,"flShowDesktop","attachments","attachmentsFetchStatus","hasMoreAttachments","showFullList","seeAllAttachments","loadMoreAttachments"],[1,"MessagingAttachmentList-drawer",3,"attachments","attachmentsFetchStatus","hasMoreAttachments","showFullList","seeAllAttachments","loadMoreAttachments"]]},template:function(e,t){if(1&e&&(i.Yb(0,"fl-scrollable-content",0,1),i.Zc(2,ke,12,26,"ng-container",2),i.Zc(3,Pe,5,11,"ng-template",null,3,i.ad),i.Yb(5,"fl-drawer",4,5),i.nc("closeDrawer",function(){return t.hideAttachmentsList()}),i.Zc(7,_e,1,4,"ng-template",null,6,i.ad),i.Xb(),i.Xb()),2&e){const e=i.Mc(4);i.Gb(2),i.zc("ngIf",!t.showAttachmentsList)("ngIfElse",e),i.Gb(3),i.zc("edgeToEdge",!0)("fullWidth",!0)("flHideDesktop",!0)}},directives:[f.a,p.a,m.q,M.a,C.a,S.a,R,I.a,o.b,s.d,a.b,O.a,Z,ee,oe,le,l.e,xe],pipes:[be.a],styles:["[_nghost-%COMP%]{display:block;height:100%;position:relative}.MessagingChatDetails[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0;height:calc(100vh - 52px);overflow-y:auto;padding:16px}@media (min-width:768px){.MessagingChatDetails[_ngcontent-%COMP%]{height:100vh}}@media (min-width:960px){.MessagingChatDetails[_ngcontent-%COMP%]{height:auto}}.MessagingAttachmentList-previewListHeader[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:space-between;padding:16px 8px}.MessagingAttachmentList-fullListHeader[_ngcontent-%COMP%]{align-items:center;display:flex}.MessagingAttachmentList-drawer[_ngcontent-%COMP%], .MessagingMembersSummary[_ngcontent-%COMP%]{padding:16px 8px}.MessagingMembersSummary--mobileInbox[_ngcontent-%COMP%]{padding:0 8px 16px}.OpenChatInInbox[_ngcontent-%COMP%]{display:flex;padding-left:8px}.OpenChatInInbox-icon[_ngcontent-%COMP%]{bottom:2px;position:relative}.OpenChatInInbox-link[_ngcontent-%COMP%]{align-items:center;color:#000;display:flex;padding:0 8px}"],changeDetection:0}),e})()},"2Gc0":function(e,t,n){"use strict";n.d(t,"d",function(){return b}),n.d(t,"c",function(){return f}),n.d(t,"b",function(){return p}),n.d(t,"a",function(){return m});var i=n("HsDr"),s=n("Krui"),a=n("Eu2U"),o=n("f6cb"),r=n("8Y7J"),c=n("SVse");function l(e,t){if(1&e&&r.Tb(0,"img",4),2&e){const e=r.rc(2);r.zc("src",e.src,r.Sc)("alt",e.alt),r.Hb("data-size",e.size)}}const d=function(e){return{IsLarge:e}};function h(e,t){if(1&e&&r.Tb(0,"fl-icon",5),2&e){const e=r.rc(2);r.zc("ngClass",r.Ec(4,d,e.size!==e.FileDisplaySize.XSMALL))("size",e.IconSize.MID)("color",e.IconColor.WHITE)("name",e.iconName)}}function g(e,t){if(1&e&&(r.Wb(0),r.Zc(1,l,1,3,"img",2),r.Zc(2,h,1,6,"fl-icon",3),r.Vb()),2&e){const e=r.rc();r.Gb(1),r.zc("ngIf",e.isImage),r.Gb(1),r.zc("ngIf",!e.isImage)}}function u(e,t){if(1&e&&r.Tb(0,"fl-icon",6),2&e){const e=r.rc();r.zc("color",e.iconColor)("name",e.iconName)("size",e.iconSize)("sizeTablet",e.iconSizeTablet)("sizeDesktop",e.iconSizeDesktop)}}var b=function(e){return e.ICON="icon",e.THUMBNAIL="thumbnail",e}({}),f=function(e){return e.XSMALL="xsmall",e.SMALL="small",e.MID="mid",e}({}),p=function(e){return e.GENERIC="generic",e.SPECIFIC="specific",e}({});let m=(()=>{class e{constructor(e){this.uiConfig=e,this.FileDisplaySize=f,this.FileDisplayType=b,this.IconColor=i.c,this.IconSize=i.e,this.PictureDisplay=s.b,this.iconColor=i.c.DARK,this.iconSize=i.e.MID,this.iconType=p.SPECIFIC,this.type=b.THUMBNAIL,this.size=f.SMALL}ngOnChanges(e){if("src"in e&&Object(o.h)(this.src)){const e=this.src.split(".");this.fileType=e.length>1?e[e.length-1].toLowerCase().split("?")[0]:"",this.isImage=this.isImageFile(),this.iconType===p.SPECIFIC?this.iconName=this.getFileIcon():this.iconType===p.GENERIC&&(this.iconName=this.getTypeIcon())}}isAudioFile(){return["aac","ogg","mp3","wma","wav"].includes(this.fileType)}isCodeFile(){return["html","js","ts","java","php","py","xml"].includes(this.fileType)}isImageFile(){return["jpg","jpeg","png","gif","bmp","svg"].includes(this.fileType)||!!this.src.match(/^data:image\/(?:jpg|jpeg|png|gif|bmp|svg)(;base64)?,[a-zA-Z0-9!$&',()*+;=\-._~:@/?%]*$/i)}isVideoFile(){return["avi","flv","mov","mpg","mp4"].includes(this.fileType)}getTypeIcon(){return this.isAudioFile()?"ui-file-audio":this.isCodeFile()?"ui-file-code":this.isImageFile()?"ui-file-img":this.isVideoFile()?"ui-file-video":"ui-file"}getFileIcon(){switch(this.fileType){case"avi":return"ui-file-avi";case"doc":case"docx":return"ui-file-doc";case"flv":return"ui-file-flv";case"gif":return"ui-file-gif";case"jpg":case"jpeg":return"ui-file-jpg";case"key":return"ui-file-key";case"mp4":return"ui-file-mp4";case"mov":return"ui-file-mov";case"mpg":return"ui-file-mpg";case"pdf":return"ui-file-pdf";case"png":return"ui-file-png";case"pps":case"ppt":case"pptx":return"ui-file-pps";case"rar":return"ui-file-rar";case"rtf":return"ui-file-rtf";case"svg":return"ui-file-svg";case"txt":return"ui-file-txt";case"xls":case"xlsx":return"ui-file-xls";case"zip":return"ui-file-zip";default:return"ui-file"}}}return e.\u0275fac=function(t){return new(t||e)(r.Sb(a.a))},e.\u0275cmp=r.Mb({type:e,selectors:[["fl-file-display"]],hostVars:2,hostBindings:function(e,t){2&e&&r.Hb("data-type",t.type)("data-size",t.size)},inputs:{alt:"alt",src:"src",iconColor:"iconColor",iconSize:"iconSize",iconSizeTablet:"iconSizeTablet",iconSizeDesktop:"iconSizeDesktop",iconType:"iconType",type:"type",size:"size"},features:[r.Eb],decls:2,vars:2,consts:[[4,"ngIf"],[3,"color","name","size","sizeTablet","sizeDesktop",4,"ngIf"],["class","FileDisplay Image",3,"src","alt",4,"ngIf"],["class","FileDisplay Icon",3,"ngClass","size","color","name",4,"ngIf"],[1,"FileDisplay","Image",3,"src","alt"],[1,"FileDisplay","Icon",3,"ngClass","size","color","name"],[3,"color","name","size","sizeTablet","sizeDesktop"]],template:function(e,t){1&e&&(r.Zc(0,g,3,2,"ng-container",0),r.Zc(1,u,1,5,"fl-icon",1)),2&e&&(r.zc("ngIf",t.type===t.FileDisplayType.THUMBNAIL),r.Gb(1),r.zc("ngIf",t.type===t.FileDisplayType.ICON))},directives:[c.q,i.d,c.o],styles:["[data-type=thumbnail][_nghost-%COMP%]{align-items:center;background:#4d525b;border-radius:0;display:flex;justify-content:center;overflow:hidden}[data-type=thumbnail][data-size=xsmall][_nghost-%COMP%]{height:32px;width:32px}[data-type=thumbnail][data-size=small][_nghost-%COMP%]{height:48px;width:48px}[data-type=thumbnail][data-size=mid][_nghost-%COMP%]{height:72px;width:72px}.FileDisplay[_ngcontent-%COMP%]{display:block}.FileDisplay.Image[_ngcontent-%COMP%]{height:100%;object-fit:cover;width:100%}.FileDisplay.Icon.IsLarge[_ngcontent-%COMP%]{transform:scale(1.33)}"],changeDetection:0}),e})()},"3bYl":function(e,t,n){"use strict";n.d(t,"b",function(){return E}),n.d(t,"a",function(){return z});var i=n("GS7A"),s=n("SVse"),a=n("8Y7J"),o=n("iInd"),r=n("m734"),c=n("uq5U"),l=n("I1jK"),d=n("sfSt"),h=n("HsDr"),g=n("2zwU"),u=n("o9eT"),b=n("NtPp"),f=n("pLZG"),p=n("lOjL"),m=n("EKBc"),M=n("p3pP"),C=n("7KAL"),S=n("SMHo"),T=n("w13q");const x=["drawerTemplate"];function y(e,t){if(1&e){const e=a.Zb();a.Yb(0,"fl-icon",7),a.nc("click",function(){return a.Pc(e),a.rc().handleEscape()}),a.Xb()}if(2&e){const e=a.rc();a.zc("flHideMobile",e.fullWidth)("name","ui-close")("size",e.IconSize.SMALL)}}function I(e,t){if(1&e&&(a.Yb(0,"fl-bit",8),a.Yb(1,"fl-view-header",9),a.Yb(2,"fl-heading",10),a.bd(3),a.Xb(),a.Xb(),a.Xb()),2&e){const e=a.rc();a.zc("flShowMobile",!0),a.Gb(1),a.zc("flSticky",!0)("flStickyStatic",!0)("flStickyBehaviour",e.StickyBehaviour.ALWAYS),a.Gb(1),a.zc("color",e.HeadingColor.INHERIT)("headingType",e.HeadingType.H1)("size",e.TextSize.MID)("truncate",!0),a.Gb(1),a.dd(" ",e.mobileHeaderTitle," ")}}function O(e,t){}function A(e,t){if(1&e&&(a.Yb(0,"fl-bit",11),a.Zc(1,O,0,0,"ng-template",12),a.Xb()),2&e){const e=a.rc();a.Hb("data-edge-to-edge",e.edgeToEdge),a.Gb(1),a.zc("ngTemplateOutlet",e.drawerTemplate)}}const v=function(e){return{distance:e}},w=function(e,t){return{value:e,params:t}};var E=function(e){return e.LEFT="left",e.RIGHT="right",e}({});let z=(()=>{class e{constructor(e,t,n,i,s,o,r){this.router=e,this.renderer=t,this.location=n,this.changeDetectorRef=i,this.swipeNavigation=s,this.pwa=o,this.document=r,this.HeadingColor=d.a,this.HeadingType=d.c,this.IconSize=h.e,this.StickyBehaviour=g.a,this.TextSize=u.f,this.ViewHeaderType=b.c,this.canRemoveOverflow=!1,this.state="hidden",this.hideStatePosition="10%",this.drawerPosition=E.RIGHT,this.closeOnBackdropClick=!0,this.edgeToEdge=!1,this.hideCloseButton=!1,this.fullWidth=!0,this.closeDrawer=new a.n,this.openDrawer=new a.n,this.isOpen=!1}set position(e){this.drawerPosition=e,this.setHidePosition()}handleEscape(){this.close()}ngOnInit(){this.routeChangeSubscription=this.router.events.pipe(Object(f.a)(e=>e instanceof o.c)).subscribe(()=>{this._close({fromRouteChange:!0})})}close(){this._close()}_close({fromRouteChange:e=!1}={}){this.isOpen&&(this.state="hidden",this.setHidePosition(),this.changeDetectorRef.markForCheck(),this.drawerPopCloseSubscription&&this.drawerPopCloseSubscription.unsubscribe(),e||this.location.back(),setTimeout(()=>{this.swipeNavigation.enableSwipeGestures(!0)}))}setHidePosition(){this.hideStatePosition=this.drawerPosition===E.RIGHT?"10%":"-10%"}handleBackdropClick(){this.closeOnBackdropClick&&this.close()}open(){this.isOpen||(this.swipeNavigation.enableSwipeGestures(!1),this.isOpen=!0,this.state="visible",this.openDrawer.emit(),this.togglePageScrollState(),this.drawerPopCloseSubscription=this.location._createBackButtonState({onPop:()=>this._close({fromRouteChange:!0})}),this.changeDetectorRef.detectChanges())}togglePageScrollState(){this.isOpen&&!this.document.body.style.overflow&&(this.canRemoveOverflow=!0),this.isOpen?this.disableBodyScroll():!this.isOpen&&this.canRemoveOverflow&&(this.enableBodyScroll(),this.canRemoveOverflow=!1)}disableBodyScroll(){this.renderer.setStyle(this.document.body,"overflow","hidden")}enableBodyScroll(){this.renderer.removeStyle(this.document.body,"overflow")}animationDone(e){"visible"===e.fromState&&"hidden"===e.toState&&(this.isOpen=!1,this.closeDrawer.emit(),this.togglePageScrollState())}handleSwipeRight(){this.pwa.isInstalled()&&this.drawerPosition===E.RIGHT&&this.close()}handleSwipeLeft(){this.pwa.isInstalled()&&this.drawerPosition===E.LEFT&&this.close()}ngOnDestroy(){this.enableBodyScroll(),this.routeChangeSubscription&&this.routeChangeSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(o.e),a.Sb(a.G),a.Sb(p.a),a.Sb(a.h),a.Sb(m.a),a.Sb(M.a),a.Sb(s.e))},e.\u0275cmp=a.Mb({type:e,selectors:[["fl-drawer"]],contentQueries:function(e,t,n){if(1&e&&a.Lb(n,x,1),2&e){let e;a.Lc(e=a.oc())&&(t.drawerTemplate=e.first)}},hostVars:2,hostBindings:function(e,t){1&e&&a.nc("keydown.escape",function(){return t.handleEscape()},!1,a.Nc),2&e&&a.Kb("IsActive",t.isOpen)},inputs:{closeOnBackdropClick:"closeOnBackdropClick",edgeToEdge:"edgeToEdge",hideCloseButton:"hideCloseButton",mobileHeaderTitle:"mobileHeaderTitle",position:"position",fullWidth:"fullWidth"},outputs:{closeDrawer:"closeDrawer",openDrawer:"openDrawer"},decls:7,vars:16,consts:[["cdkScrollable","",1,"DrawerContainer"],[1,"DrawerDialog"],[1,"DrawerContent",3,"swiperight","swipeleft"],["class","DrawerCloseButton",3,"flHideMobile","name","size","click",4,"ngIf"],[3,"flShowMobile",4,"ngIf"],["class","DrawerContent-inner",4,"ngIf"],[1,"DrawerBackdrop",3,"click"],[1,"DrawerCloseButton",3,"flHideMobile","name","size","click"],[3,"flShowMobile"],[1,"DrawerHeader",3,"flSticky","flStickyStatic","flStickyBehaviour"],[3,"color","headingType","size","truncate"],[1,"DrawerContent-inner"],[3,"ngTemplateOutlet"]],template:function(e,t){1&e&&(a.Yb(0,"div",0),a.Yb(1,"div",1),a.nc("@paneAnimation.done",function(e){return t.animationDone(e)}),a.Yb(2,"div",2),a.nc("swiperight",function(){return t.handleSwipeRight()})("swipeleft",function(){return t.handleSwipeLeft()}),a.Zc(3,y,1,3,"fl-icon",3),a.Zc(4,I,4,9,"fl-bit",4),a.Zc(5,A,2,2,"fl-bit",5),a.Xb(),a.Xb(),a.Yb(6,"div",6),a.nc("click",function(){return t.handleBackdropClick()}),a.Xb(),a.Xb()),2&e&&(a.Hb("data-position",t.drawerPosition),a.Gb(1),a.zc("@paneAnimation",a.Fc(13,w,t.state,a.Ec(11,v,t.hideStatePosition))),a.Hb("data-full-width",t.fullWidth),a.Gb(1),a.Hb("data-edge-to-edge",t.edgeToEdge)("data-full-width",t.fullWidth),a.Gb(1),a.zc("ngIf",!t.hideCloseButton),a.Gb(1),a.zc("ngIf",t.fullWidth),a.Gb(1),a.zc("ngIf",t.isOpen),a.Gb(1),a.zc("@backdropAnimation",t.state),a.Hb("data-backdrop",t.isOpen)("data-full-width",t.fullWidth))},directives:[C.a,s.q,h.d,S.a,T.a,b.b,g.b,d.b,s.v],styles:["[_nghost-%COMP%]{display:none}.IsActive[_nghost-%COMP%]{display:block}.DrawerBackdrop[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0;background:rgba(25,32,45,.7);display:none;position:fixed;z-index:1040}.DrawerBackdrop[data-color=dark][_ngcontent-%COMP%]{background:rgba(25,32,45,.6)}.DrawerBackdrop[data-backdrop=true][_ngcontent-%COMP%]{display:block}.DrawerBackdrop[data-full-width=true][_ngcontent-%COMP%]{background:#fff}.DrawerBackdrop[data-full-width=true][data-color=dark][_ngcontent-%COMP%]{background:#161e2c}@media (min-width:768px){.DrawerBackdrop[data-full-width=true][_ngcontent-%COMP%]{background:rgba(25,32,45,.7)}.DrawerBackdrop[data-full-width=true][data-color=dark][_ngcontent-%COMP%]{background:rgba(25,32,45,.6)}}.DrawerCloseButton[_ngcontent-%COMP%]{cursor:pointer;opacity:.5;position:absolute;right:8px;top:8px;transition:opacity .15s linear;z-index:1090}.DrawerCloseButton[_ngcontent-%COMP%]:hover{opacity:1}.DrawerContainer[_ngcontent-%COMP%]{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:auto;position:fixed;right:0;top:0;z-index:1090}.DrawerContainer[data-position=left][_ngcontent-%COMP%]{justify-content:flex-start}.DrawerContainer[data-position=right][_ngcontent-%COMP%]{justify-content:flex-end}.DrawerContent[_ngcontent-%COMP%]{touch-action:pan-y!important;background:#fff;min-height:100vh}@media (min-width:768px){.DrawerContent[_ngcontent-%COMP%]{-webkit-user-select:auto!important;-ms-user-select:auto!important;user-select:auto!important}}@media (min-width:768px){.DrawerContent[data-full-width=true][_ngcontent-%COMP%]{box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12)}}.DrawerContent[data-full-width=false][_ngcontent-%COMP%]{box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12)}.DrawerContent-inner[data-edge-to-edge=false][_ngcontent-%COMP%]{padding:16px}@media (min-width:768px){.DrawerContent-inner[data-edge-to-edge=false][_ngcontent-%COMP%]{padding:32px}}.DrawerHeader[_ngcontent-%COMP%]{min-width:100%}.DrawerDialog[_ngcontent-%COMP%]{height:100%;max-width:1000px;position:relative;z-index:1090}.DrawerDialog[data-full-width=false][_ngcontent-%COMP%]{width:90%}.DrawerDialog[data-full-width=true][_ngcontent-%COMP%]{width:100%}@media (min-width:960px){.DrawerDialog[_ngcontent-%COMP%]{min-width:800px}}"],data:{animation:[Object(i.l)("paneAnimation",[Object(i.k)("* => visible",[Object(i.m)(r.a,{params:{duration:"200",translateX:"{{ distance }}"}})]),Object(i.k)("* => hidden",[Object(i.m)(c.a,{params:{duration:"200",translateX:"{{ distance }}"}})])]),Object(i.l)("backdropAnimation",[Object(i.k)("visible => hidden",[Object(i.m)(l.a)])])]},changeDetection:0}),e})()},"3f1L":function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("itXk");function s(e){return i.a(e)}},"5f+h":function(e,t,n){"use strict";n.d(t,"b",function(){return x}),n.d(t,"a",function(){return y});var i=n("mrSG"),s=n("8Y7J"),a=n("s7LF"),o=n("HsDr"),r=n("9Aot"),c=n("Rnop"),l=n("IvPS"),d=n("IzEk"),h=n("b6KT"),g=n("L1P6"),u=n("SVse"),b=n("DSso"),f=n("V1in"),p=n("nSbf"),m=n("o9eT");function M(e,t){if(1&e){const e=s.Zb();s.Wb(0),s.Yb(1,"fl-icon",2),s.nc("click",function(){return s.Pc(e),s.rc().openFileSelect.emit()}),s.Xb(),s.Yb(2,"fl-textarea",3),s.nc("inputBlur",function(){return s.Pc(e),s.rc().textareaFocused=!1})("inputFocus",function(){return s.Pc(e),s.rc().textareaFocused=!0}),s.Xb(),s.Yb(3,"fl-emoji-picker",4),s.nc("emojiPicked",function(t){return s.Pc(e),s.rc().handleEmojiPicked(t)}),s.Xb(),s.Yb(4,"fl-icon",5),s.nc("click",function(){return s.Pc(e),s.rc().handleSendMessage()}),s.Xb(),s.Vb()}if(2&e){const e=s.rc();s.Gb(1),s.zc("flMarginRight",e.Margin.XXSMALL)("name","ui-attachment")("color",e.enableFileUpload?e.IconColor.DARK:e.IconColor.MID)("hoverColor",e.enableFileUpload?e.HoverColor.PRIMARY:e.HoverColor.CURRENT),s.Gb(1),s.zc("borderless",!0)("flAutoGrow",e.messageControl)("flAutoGrowMaxHeight",e.INPUT_MAX_HEIGHT)("flMarginRight",e.Margin.XXSMALL)("control",e.messageControl)("rows",1),s.Gb(1),s.zc("flMarginRight",e.Margin.XXSMALL)("pickerSize",e.IconSize.MID),s.Gb(1),s.zc("backdrop",e.enableSendButton?e.IconBackdrop.PRIMARY:void 0)("clickable",!0)("color",e.enableSendButton?e.IconColor.WHITE:e.IconColor.MID)("label","Send")("name","ui-send")}}function C(e,t){1&e&&(s.Wb(0),s.cc(1,8),s.Vb())}function S(e,t){1&e&&s.cc(0,9)}function T(e,t){if(1&e&&(s.Yb(0,"fl-text",6),s.Zc(1,C,2,0,"ng-container",0),s.Zc(2,S,1,0,"ng-template",null,7,s.ad),s.Xb()),2&e){const e=s.Mc(3),t=s.rc();s.zc("color",t.FontColor.MID),s.Gb(1),s.zc("ngIf",t.isBlockedByLoggedInUser)("ngIfElse",e)}}const x=5e3;let y=(()=>{class e{constructor(e){this.localStorage=e,this.FontColor=c.a,this.HoverColor=o.a,this.IconBackdrop=o.b,this.IconColor=o.c,this.IconSize=o.e,this.Margin=r.a,this.hasAttachments=!1,this.sendMessage=new s.n,this.addFile=new s.n,this.openFileSelect=new s.n,this.userTyping=new s.n,this.INPUT_MAX_HEIGHT=125,this.textareaFocused=!1,this.lastSentTyping=0,this.messageControl=new a.f,this.enableSendButton=!1}ngOnInit(){this.messageControlSubscription=this.messageControl.valueChanges.subscribe(e=>{this.enableSendButton=this.shouldEnableSendButton()})}ngOnDestroy(){this.messageControlSubscription&&this.messageControlSubscription.unsubscribe()}ngOnChanges(e){"threadIdentifier"in e&&(this.threadIdentifierKey=Object(h.d)(this.threadIdentifier),this.loadDraftMessage()),"hasAttachments"in e&&(this.enableSendButton=this.shouldEnableSendButton())}shouldEnableSendButton(){var e;return this.hasAttachments||""!==(null===(e=this.messageControl.value)||void 0===e?void 0:e.trim())}handleKeyUpEvent(e){this.textareaFocused&&(this.updateTypingStatus(),this.updateDraftMessage(this.messageControl.value))}handleKeyDownEvent(e){var t;!this.loggedInUser||!this.textareaFocused||"enter"!==(null===(t=e.key)||void 0===t?void 0:t.toLowerCase())&&13!==(e.which||e.keyCode||e.charCode)||e.shiftKey||(this.updateTypingStatus(),this.handleSendMessage(),e.preventDefault())}handlePasteEvent(e){if(!this.textareaFocused||!e.clipboardData)return;const{clipboardData:{items:t=[]}}=e;Array.from(t).some(e=>{if("file"!==e.kind)return void this.updateTypingStatus();const t=e.getAsFile();if(t){const n=e.type.split("/")[1],i=new File([t],`image.${n}`);this.addFile.emit(i)}})}handleSendMessage(){this.enableSendButton&&(this.sendMessage.emit({message:this.messageControl.value,sender:this.loggedInUser,threadIdentifier:this.threadIdentifier}),this.messageControl.setValue(""),this.updateDraftMessage(""))}handleEmojiPicked(e){this.textAreaComponent.insertAtCursor(e,{paddedWithSpaces:!0}),this.updateTypingStatus()}loadDraftMessage(){this.messageControl.value||this.localStorage.get("webappChatDraftMessages").pipe(Object(d.a)(1)).toPromise().then((e={})=>{if(this.threadIdentifierKey){const t=e[this.threadIdentifierKey];this.messageControl.setValue((null==t?void 0:t.text)||"")}})}updateDraftMessage(e){this.localStorage.get("webappChatDraftMessages").pipe(Object(d.a)(1)).toPromise().then((t={})=>{if(!this.threadIdentifierKey)return;const n=t,s=this.threadIdentifierKey,a=Object(i.d)(n,["symbol"==typeof s?s:s+""]);this.localStorage.set("webappChatDraftMessages",0===e.length?a:Object.assign(Object.assign({},a),{[this.threadIdentifierKey]:{text:e,lastUpdated:Date.now()}}))})}updateTypingStatus(){!this.threadIdentifier.isFake&&Date.now()>this.lastSentTyping+x&&(this.lastSentTyping=Date.now(),this.userTyping.emit(this.threadIdentifier.id))}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(g.a))},e.\u0275cmp=s.Mb({type:e,selectors:[["app-messaging-typing-box"]],viewQuery:function(e,t){if(1&e&&s.id(l.a,1),2&e){let e;s.Lc(e=s.oc())&&(t.textAreaComponent=e.first)}},hostBindings:function(e,t){1&e&&s.nc("keyup",function(e){return t.handleKeyUpEvent(e)},!1,s.Nc)("keydown",function(e){return t.handleKeyDownEvent(e)},!1,s.Nc)("paste",function(e){return t.handlePasteEvent(e)},!1,s.Nc)},inputs:{enableFileUpload:"enableFileUpload",hasAttachments:"hasAttachments",isBlockedByLoggedInUser:"isBlockedByLoggedInUser",isThreadBlocked:"isThreadBlocked",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",loggedInUser:"loggedInUser",threadIdentifier:"threadIdentifier"},outputs:{sendMessage:"sendMessage",addFile:"addFile",openFileSelect:"openFileSelect",userTyping:"userTyping"},features:[s.Eb],decls:3,vars:2,consts:function(){let e,t,n;return e="Type a message",t=" You blocked the calls and messages from this user. ",n=" You cannot chat with this user. ",[[4,"ngIf","ngIfElse"],["threadBlocked",""],["flTrackingLabel","MessagingTypingBoxFileIcon",3,"flMarginRight","name","color","hoverColor","click"],["flTrackingLabel","MessagingTypingBox","placeholder",e,1,"TypingBox-input",3,"borderless","flAutoGrow","flAutoGrowMaxHeight","flMarginRight","control","rows","inputBlur","inputFocus"],[3,"flMarginRight","pickerSize","emojiPicked"],["flTrackingLabel","ChatboxSendButton",3,"backdrop","clickable","color","label","name","click"],[3,"color"],["blockedByOther",""],t,n]},template:function(e,t){if(1&e&&(s.Zc(0,M,5,17,"ng-container",0),s.Zc(1,T,4,3,"ng-template",null,1,s.ad)),2&e){const e=s.Mc(2);s.zc("ngIf",t.isLoggedInUserSupportAgent||!t.isThreadBlocked)("ngIfElse",e)}},directives:[u.q,o.d,b.a,r.b,l.a,f.a,p.a,m.e],styles:["[_nghost-%COMP%]{align-items:center;display:flex;justify-content:center;min-height:56px;padding:0 8px}.TypingBox-input[_ngcontent-%COMP%]{line-height:0;width:100%}"],changeDetection:0}),e})()},"5i9J":function(e,t,n){"use strict";n.d(t,"a",function(){return f});var i=n("8Y7J"),s=n("fYbj"),a=n("HsDr"),o=n("9Aot"),r=n("HLWz"),c=n("w13q"),l=n("SVse"),d=n("p8b5"),h=n("lDT0");function g(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-contact-item",4),i.nc("removeUser",function(){i.Pc(e);const n=t.$implicit;return i.rc().removeMember.emit(n)}),i.Xb()}if(2&e){const e=t.$implicit,n=i.rc();i.zc("flMarginBottom",n.Margin.MID)("showCtas",!1)("showRemoveCta",n.showRemoveCta)("user",e)}}function u(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-link",5),i.nc("click",function(){return i.Pc(e),i.rc().addPeople.emit()}),i.ic(1,6),i.Yb(2,"fl-bit"),i.Tb(3,"fl-icon",7),i.Xb(),i.fc(),i.Xb()}if(2&e){const e=i.rc();i.Gb(3),i.zc("name","ui-plus-thin")("color",e.IconColor.PRIMARY)}}const b=function(e){return{"MessagingGroupMembers-content":e}};let f=(()=>{class e{constructor(){this.IconColor=a.c,this.Margin=o.a,this.trackById=s.m,this.addPeople=new i.n,this.removeMember=new i.n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-group-members"]],inputs:{chatboxMode:"chatboxMode",loggedInUser:"loggedInUser",otherMembers:"otherMembers",showAddPeopleCta:"showAddPeopleCta",showRemoveCta:"showRemoveCta"},outputs:{addPeople:"addPeople",removeMember:"removeMember"},decls:5,vars:10,consts:function(){let e;return e="" + "\ufffd#2\ufffd" + "" + "\ufffd#3\ufffd" + "" + "\ufffd/#3\ufffd" + " Add People " + "\ufffd/#2\ufffd" + "",[[3,"ngClass"],[3,"flMarginBottom","showCtas","isLoggedInUser","user"],[3,"flMarginBottom","showCtas","showRemoveCta","user","removeUser",4,"ngFor","ngForOf","ngForTrackBy"],["flTrackingLabel","AddPeopleCta",3,"click",4,"ngIf"],[3,"flMarginBottom","showCtas","showRemoveCta","user","removeUser"],["flTrackingLabel","AddPeopleCta",3,"click"],e,[3,"name","color"]]},template:function(e,t){1&e&&(i.Yb(0,"fl-scrollable-content"),i.Yb(1,"fl-bit",0),i.Tb(2,"app-messaging-contact-item",1),i.Zc(3,g,1,4,"app-messaging-contact-item",2),i.Zc(4,u,4,2,"fl-link",3),i.Xb(),i.Xb()),2&e&&(i.Gb(1),i.zc("ngClass",i.Ec(8,b,t.chatboxMode)),i.Gb(1),i.zc("flMarginBottom",t.Margin.MID)("showCtas",!1)("isLoggedInUser",!0)("user",t.loggedInUser),i.Gb(1),i.zc("ngForOf",t.otherMembers)("ngForTrackBy",t.trackById),i.Gb(1),i.zc("ngIf",t.showAddPeopleCta))},directives:[r.a,c.a,l.o,d.a,o.b,l.p,l.q,h.b,a.d],styles:["[_nghost-%COMP%]{display:block;height:calc(100% - 56px)}.MessagingGroupMembers-content[_ngcontent-%COMP%]{padding:16px 24px}"]}),e})()},"7A1k":function(e,t,n){"use strict";n.d(t,"a",function(){return N});var i=n("mrSG"),s=n("8Y7J"),a=n("iInd"),o=n("fVXH"),r=n("97vJ"),c=n("jnZY"),l=n("OpNG"),d=n("tlTr"),h=n("yeKy"),g=n("f6cb"),u=n("tsv4"),b=n("5yfJ"),f=n("lJxs"),p=n("/uUt"),m=n("zp1y"),M=n("pLZG"),C=n("eIep"),S=n("05l1"),T=n("x+ZX"),x=n("JX91"),y=n("vkgz"),I=n("IzEk"),O=n("b6KT"),A=n("/wLE"),v=n("eCtd"),w=n("w792"),E=n("u4EQ"),z=n("L1P6"),L=n("SVse"),k=n("WDoz"),P=n("yotz"),_=n("rurT"),R=n("KUXl"),j=n("al+g");const U=function(e,t){return{height:e,width:t}},B=function(e,t){return{top:e,left:t}};function $(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-messaging-chat-contents",4),s.nc("resizeEnd",function(t){s.Pc(e);const n=s.rc(2).$implicit;return s.rc().onResizeEnd(t,n)})("closeChat",function(t){return s.Pc(e),s.rc(3).closeChat(t)})("minimiseChat",function(t){return s.Pc(e),s.rc(3).minimiseChat(t,!0)})("focusChat",function(t){return s.Pc(e),s.rc(3).focusClick(t)})("toggleSize",function(t){return s.Pc(e),s.rc(3).toggleSize(t)})("unfocusChat",function(){return s.Pc(e),s.rc(3).blur()}),s.sc(1,"flAsync"),s.sc(2,"flAsync"),s.sc(3,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2).$implicit,t=s.rc();s.zc("ngStyle",s.Fc(18,U,e.minimised?t.NEW_CHATBOX_DIMENSIONS[t.ChatBoxSize.MINIMISED].height+"px":((null==e.dimensions?null:e.dimensions.height)||t.NEW_CHATBOX_DIMENSIONS[t.ChatBoxSize.REGULAR].height)+"px",e.minimised?t.NEW_CHATBOX_DIMENSIONS[t.ChatBoxSize.MINIMISED].width+"px":((null==e.dimensions?null:e.dimensions.width)||t.NEW_CHATBOX_DIMENSIONS[t.ChatBoxSize.REGULAR].width)+"px"))("allContacts",s.tc(1,12,t.contacts$))("chatboxMode",!0)("resizeEdges",s.Fc(21,B,!e.minimised,!e.minimised))("enableGhostResize",!e.minimised)("validateResize",t.validateResizeFunc)("resizeCursorPrecision",10)("isFocused",e.focus!==t.FocusState.Neither)("isMinimised",e.minimised)("team",s.tc(2,14,t.getTeamFromChat(t.teams$,e)))("thread",s.tc(3,16,e.thread$))("threadIdentifier",e.threadIdentifier)}}function G(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-chat-box",5),s.nc("resizeEnd",function(t){s.Pc(e);const n=s.rc(2).$implicit;return s.rc().onResizeEnd(t,n)})("closeChat",function(t){return s.Pc(e),s.rc(3).closeChat(t)})("minimiseChat",function(t){return s.Pc(e),s.rc(3).minimiseChat(t)})("blurClick",function(){return s.Pc(e),s.rc(3).blur()})("focusClick",function(t){return s.Pc(e),s.rc(3).focusClick(t)})("makingCall",function(t){return s.Pc(e),s.rc(3).makingCall.emit(t)}),s.Xb()}if(2&e){const e=s.rc(2).$implicit,t=s.rc();s.zc("resizeEdges",s.Fc(10,B,!e.minimised,!e.minimised))("enableGhostResize",!e.minimised)("validateResize",t.validateResizeFunc)("ngStyle",s.Fc(13,U,e.height+"px",e.width+"px"))("resizeCursorPrecision",10)("attributes",e)("allContacts$",t.contacts$)("inCall$",t.inCall$)("currentUserIdValue",t.currentUserIdValue)("team$",t.getTeamFromChat(t.teams$,e))}}function F(e,t){if(1&e&&(s.Wb(0),s.Zc(1,$,4,24,"app-messaging-chat-contents",2),s.Zc(2,G,1,16,"ng-template",null,3,s.ad),s.Vb()),2&e){const e=s.Mc(3),t=s.rc(2);s.Gb(1),s.zc("ngIf",t.isNewChatbox)("ngIfElse",e)}}function D(e,t){if(1&e&&(s.Wb(0),s.Zc(1,F,4,2,"ng-container",1),s.Vb()),2&e){const e=t.$implicit;s.Gb(1),s.zc("ngIf",e.visible)}}let N=(()=>{class e{constructor(e,t,n,i,a,o,r,c){this.auth=e,this.activatedRoute=t,this.datastore=n,this.webSocketService=i,this.sounds=a,this.changeDetectorRef=o,this.messagingChat=r,this.localStorage=c,this.ChatBoxSize=h.a,this.FocusState=d.a,this.NEW_CHATBOX_DIMENSIONS=h.e,this.toObservable=g.t,this.adminChatsOnly=!1,this.makingCall=new s.n,this.chats=[],this.errors={},this.getTeamFromChat=O.c,this.SUPPORT_CHATS_LIMIT=20,this.NEW_INBOX_WIDGET_WIDTH=356}onResize(){return Object(i.a)(this,void 0,void 0,function*(){yield this.limitChatHeight(),this.updateChatOverflow()})}beforeUnload(){return Object(i.a)(this,void 0,void 0,function*(){yield this.saveChats(this.chats)})}ngOnInit(){this.showNewChatboxSubscription$=this.activatedRoute.queryParams.pipe(Object(f.a)(e=>Object(a.m)(e).has("new_chatbox")),Object(p.a)()).subscribe(e=>this.isNewChatbox=e),this.currentUserId$=this.auth.getUserId(),this.messagingChat.registerLiveChat(e=>this.startChat(e)),this.messagingChat.cleanStoredDraftMessages(),this.currentUserIdSubscription=this.currentUserId$.subscribe(e=>{this.currentUserIdValue=e}),this.currentUserDoc=this.datastore.document("users",this.currentUserId$),this.loadChats().then(()=>this.limitChatHeight());const e=this.datastore.collection("notificationsPreferences").valueChanges().pipe(Object(f.a)(e=>{const t=e.filter(e=>"messages"===e.notificationType&&"chat_sound"===e.channel);return t.length>0&&t[0].enabled}));this.messageNotifySubscription=this.webSocketService.fromServerStream$.pipe(Object(m.a)(this.currentUserId$,e),Object(M.a)(([e,t,n])=>{if(n&&Object(o.a)(e)&&"messages"===e.body.parent_type&&"private"===e.body.type&&e.body.data.from_user.toString()!==t&&!this.isHiddenThread(e.body.data.thread_details.thread_type)){const t=e.body.data.thread_id,n=this.chats.find(e=>e.threadIdentifier.id===t);return void 0!==n&&(n.focus===d.a.Neither||n.focus===d.a.Header)}return!1})).subscribe(()=>this.sounds.handleNotification("message")),this.contacts$=this.currentUserDoc.valueChanges().pipe(Object(f.a)(O.f),Object(p.a)(),Object(C.a)(e=>e?b.a:this.datastore.collection("contacts").valueChanges()),Object(r.a)(),Object(S.a)(1),Object(T.a)()),this.teams$=this.datastore.collection("teams",e=>e.where("members","includes",this.currentUserId$.pipe(Object(f.a)(e=>Object(g.s)(e))))).valueChanges().pipe(Object(c.a)(),Object(x.a)({})),this.clickedOutsideSubscription=this.clickedOutside$.subscribe(e=>{e&&this.blur()}),this.validateResizeFunc=e=>void 0!==e.rectangle.width&&void 0!==e.rectangle.height&&this.messagingChat.isValidChatboxDimensions({width:e.rectangle.width,height:e.rectangle.height},this.isNewChatbox)}blur(e){this.chats=this.chats.map(t=>Object.assign(Object.assign({},t),{focus:e&&t===e?t.focus:d.a.Neither}))}onResizeEnd(e,t){return Object(i.a)(this,void 0,void 0,function*(){const{width:n,height:i}=e.rectangle;if(void 0===n||void 0===i)return;const s=this.messagingChat.constrainChatboxDimensions({width:n,height:i},this.isNewChatbox);if(this.chats){this.blur();const e=this.chats.findIndex(e=>Object(O.h)(e.threadIdentifier,t.threadIdentifier));e>=0&&(this.chats=this.getUpdatedChats(e,Object.assign(Object.assign({},this.chats[e]),this.isNewChatbox?{focus:d.a.HeaderAndTypingBox,dimensions:s,lastUpdate:Date.now()}:{height:s.height,width:s.width,focus:d.a.HeaderAndTypingBox,lastUpdate:Date.now()})),yield this.saveChats(this.chats),this.updateChatOverflow())}})}startChat({userIds:e,threadType:t,context:n={type:u.ContextTypeApi.NONE},threadId:s,focus:a}){return Object(i.a)(this,void 0,void 0,function*(){const i=Array.from(new Set([...e,Number(this.currentUserIdValue)]));if(i.length<2&&!s)return;const o=s||Math.floor(Math.random()*Number.MIN_SAFE_INTEGER),r={id:o,threadType:t,context:n,members:i,isFake:o<0},c=this.chats.find(e=>Object(O.h)(r,e.threadIdentifier));if(void 0===c){if(a&&this.blur(),t===u.ThreadTypeApi.ADMIN_PREFERRED_CHAT&&(n.type===u.ContextTypeApi.SUPPORT_CHAT||n.type===u.ContextTypeApi.SUPPORT_SESSION)){const e=this.chats.filter(e=>e.threadIdentifier.threadType===u.ThreadTypeApi.ADMIN_PREFERRED_CHAT&&(e.threadIdentifier.context.type===u.ContextTypeApi.SUPPORT_CHAT||e.threadIdentifier.context.type===u.ContextTypeApi.SUPPORT_SESSION));if(e&&e.length>=this.SUPPORT_CHATS_LIMIT){const t=e[e.length-1];yield this.closeChat(t.threadIdentifier)}}this.chats=[this.createChatAttributes(r,a),...this.chats],this.changeDetectorRef.markForCheck()}else{const e=this.chats.indexOf(c);e>=0&&(a&&this.blur(c),this.chats=this.getUpdatedChats(e,Object.assign(Object.assign({},c),{focus:a?d.a.HeaderAndTypingBox:c.focus,minimised:!a&&c.minimised,lastUpdate:Date.now()})))}this.updateChatOverflow(),yield this.saveChats(this.chats)})}createChatAttributes(e,t=!0,n=280,i=-1,s=!1,a=!1,o={width:h.e[h.a.REGULAR].width,height:h.e[h.a.REGULAR].height}){const r=e.members.length>0?e.members.filter(e=>e!==Number(this.currentUserIdValue)):[],c=Date.now(),l={context:e.context,contextType:e.context.type,folder:u.FolderApi.INBOX,id:e.id,inactiveMembers:[],isFake:e.isFake,isMuted:!1,isBlocked:!1,isRead:!0,members:e.members,messageUnreadCount:0,otherMembers:r,owner:Number(this.currentUserIdValue),threadType:e.threadType,timeCreated:c,timeRead:c,timeUpdated:c,userReadTimes:{},writePrivacy:u.PrivacyLevelApi.MEMBERS};let g;g=e.id>0?t=>t.where("id","==",e.id):t=>t.where("otherMembers","equalsIgnoreOrder",r).where("context","==",e.context).where("threadType","in",[e.threadType]);const b=this.datastore.collection("threads",g),p=b.valueChanges().pipe(Object(M.a)(e=>e&&0!==e.length),Object(y.a)(t=>{t.length>1&&console.warn(`More than 1 thread returned for user ${this.currentUserIdValue}`,e)}),Object(f.a)(e=>e[0]),Object(y.a)(e=>{this.updateThreadIdentifier(Object(O.a)(e))}),Object(x.a)(l),Object(S.a)(1),Object(T.a)());return{minimised:s,focus:t?d.a.HeaderAndTypingBox:d.a.Neither,width:n,height:i,lastUpdate:Date.now(),visible:!0,threadCollection:b,thread$:p,threadIdentifier:e,dimensions:o}}focusLastUpdatedChatbox(){const e=this.chats.reduce((e,t,n)=>t.visible&&!t.minimised&&(!this.chats[e]||t.lastUpdate>this.chats[e].lastUpdate)?n:e,-1);e>=0&&(this.chats=this.getUpdatedChats(e,Object.assign(Object.assign({},this.chats[e]),{focus:d.a.HeaderAndTypingBox})))}closeChat(e){return Object(i.a)(this,void 0,void 0,function*(){const t=this.chats.findIndex(t=>Object(O.h)(t.threadIdentifier,e));if(-1!==t){const n=this.chats[t].focus!==d.a.Neither;this.chats=this.chats.filter(t=>!Object(O.h)(t.threadIdentifier,e)),this.updateChatOverflow(),n&&this.focusLastUpdatedChatbox(),yield this.saveChats(this.chats)}})}minimiseChat(e,t=!1){return Object(i.a)(this,void 0,void 0,function*(){const n=this.chats.findIndex(t=>Object(O.h)(t.threadIdentifier,e));if(n>=0){const i=!this.chats[n].minimised;this.chats=this.getUpdatedChats(n,Object.assign(Object.assign({},this.chats[n]),{minimised:i})),yield this.saveChats(this.chats),t&&(i?this.blur():this.focusClick(e))}})}updateThreadIdentifier(e){const t=this.chats.findIndex(t=>Object(O.h)(t.threadIdentifier,e));if(t<0)return;const n=this.chats[t];e.id===n.threadIdentifier.id&&e.isFake===n.threadIdentifier.isFake&&Object(l.b)(e.members,n.threadIdentifier.members)||(this.chats=this.getUpdatedChats(t,Object.assign(Object.assign({},n),{threadIdentifier:Object.assign({},e)})))}ngOnDestroy(){this.currentUserIdSubscription&&this.currentUserIdSubscription.unsubscribe(),this.webSocketSubscription&&this.webSocketSubscription.unsubscribe(),this.messageNotifySubscription&&this.messageNotifySubscription.unsubscribe(),this.clickedOutsideSubscription&&this.clickedOutsideSubscription.unsubscribe(),this.messagingChat&&this.messagingChat.unregisterLiveChat(),this.showNewChatboxSubscription$&&this.showNewChatboxSubscription$.unsubscribe()}focusClick(e){this.chats=this.chats.map(t=>(t=>Object(O.h)(t.threadIdentifier,e))(t)?Object.assign(Object.assign({},t),{focus:d.a.HeaderAndTypingBox,lastUpdate:Date.now()}):Object.assign(Object.assign({},t),{focus:d.a.Neither}))}identifyChat(e,t){if("group"===t.threadIdentifier.threadType)return t.threadIdentifier.id.toString();const n=`[${[...t.threadIdentifier.members].sort().toString()}]`;return t.threadIdentifier.context.type===u.ContextTypeApi.NONE?`${t.threadIdentifier.threadType}:${n}`:`${t.threadIdentifier.threadType}:${t.threadIdentifier.context.type}:${t.threadIdentifier.context.id}:${n}`}updateChatOverflow(){const e=this.chats.filter(e=>!this.isHiddenThread(e.threadIdentifier.threadType)&&e.focus===d.a.Neither).sort((e,t)=>t.lastUpdate-e.lastUpdate),t=this.chats.findIndex(e=>!this.isHiddenThread(e.threadIdentifier.threadType)&&e.focus!==d.a.Neither),n=this.isNewChatbox,i=Object(a.m)(this.activatedRoute.snapshot.queryParams).has("newInboxWidget");-1!==t&&e.unshift(this.chats[t]);const s=this.messagingChat.fitChatsToScreen(e,{offset:i?this.NEW_INBOX_WIDGET_WIDTH:210,gap:8,useDimensions:n}).map(e=>e.threadIdentifier.id);this.chats=this.chats.map(e=>Object.assign(Object.assign({},e),{visible:s.includes(e.threadIdentifier.id)}))}getUpdatedChats(e,t){return e<0||e>this.chats.length-1?this.chats:(this.changeDetectorRef.markForCheck(),[...this.chats.slice(0,e),t,...this.chats.slice(e+1,this.chats.length)])}isHiddenThread(e){return this.adminChatsOnly&&"admin_preferred_chat"!==e&&"support_chat"!==e}saveChats(e){return Object(i.a)(this,void 0,void 0,function*(){const t=e.map(e=>({dimensions:e.dimensions,minimised:e.minimised,focus:e.focus,width:e.width,height:e.height,threadIdentifier:e.threadIdentifier}));yield this.localStorage.set("webappChats",t)})}loadChats(){return this.localStorage.get("webappChats").pipe(Object(I.a)(1)).toPromise().then(e=>{this.chats=e?e.filter(e=>!e.threadIdentifier.isFake).map(e=>this.createChatAttributes(e.threadIdentifier,!1,e.width,e.height,e.minimised,!!e.dimensions&&this.isExpanded(e.dimensions),e.dimensions)):[],this.updateChatOverflow(),this.changeDetectorRef.markForCheck()})}limitChatHeight(){return Object(i.a)(this,void 0,void 0,function*(){const{max:{height:e}}=this.messagingChat.getDimensionLimits(this.isNewChatbox);this.chats=this.chats.map(t=>{var n;return this.isNewChatbox&&t.dimensions&&(null===(n=t.dimensions)||void 0===n?void 0:n.height)>e?Object.assign(Object.assign({},t),{dimensions:Object.assign(Object.assign({},t.dimensions),{height:h.e[h.a.REGULAR].height})}):!this.isNewChatbox&&t.height>e?Object.assign(Object.assign({},t),{height:380}):t}),yield this.saveChats(this.chats)})}isExpanded(e){return e.height>=h.e[h.a.EXPANDED].height||e.width>=h.e[h.a.EXPANDED].width}toggleSize(e){if(this.chats){this.blur();const t=this.chats.findIndex(t=>Object(O.h)(t.threadIdentifier,e));if(t>=0){const{dimensions:e}=this.chats[t],n=!!e&&!this.isExpanded(e);this.chats=this.getUpdatedChats(t,Object.assign(Object.assign({},this.chats[t]),{focus:d.a.HeaderAndTypingBox,lastUpdate:Date.now(),dimensions:h.e[n?h.a.EXPANDED:h.a.REGULAR]})),this.saveChats(this.chats),this.updateChatOverflow()}}}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(A.a),s.Sb(a.a),s.Sb(v.a),s.Sb(w.a),s.Sb(E.a),s.Sb(s.h),s.Sb(h.d),s.Sb(z.a))},e.\u0275cmp=s.Mb({type:e,selectors:[["app-messaging-chat"]],hostBindings:function(e,t){1&e&&s.nc("resize",function(){return t.onResize()},!1,s.Oc)("beforeunload",function(){return t.beforeUnload()},!1,s.Oc)},inputs:{adminChatsOnly:"adminChatsOnly",inCall$:"inCall$",clickedOutside$:"clickedOutside$"},outputs:{makingCall:"makingCall"},decls:1,vars:2,consts:[[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],["class","MessagingChatBox","mwlResizable","",3,"ngStyle","allContacts","chatboxMode","resizeEdges","enableGhostResize","validateResize","resizeCursorPrecision","isFocused","isMinimised","team","thread","threadIdentifier","resizeEnd","closeChat","minimiseChat","focusChat","toggleSize","unfocusChat",4,"ngIf","ngIfElse"],["oldChatbox",""],["mwlResizable","",1,"MessagingChatBox",3,"ngStyle","allContacts","chatboxMode","resizeEdges","enableGhostResize","validateResize","resizeCursorPrecision","isFocused","isMinimised","team","thread","threadIdentifier","resizeEnd","closeChat","minimiseChat","focusChat","toggleSize","unfocusChat"],["mwlResizable","","flTrackingSection","chatbox",1,"InteractableChatbox",3,"resizeEdges","enableGhostResize","validateResize","ngStyle","resizeCursorPrecision","attributes","allContacts$","inCall$","currentUserIdValue","team$","resizeEnd","closeChat","minimiseChat","blurClick","focusClick","makingCall"]],template:function(e,t){1&e&&s.Zc(0,D,2,1,"ng-container",0),2&e&&s.zc("ngForOf",t.chats)("ngForTrackBy",t.identifyChat)},directives:[L.p,L.q,k.a,P.a,L.r,_.a,R.a],pipes:[j.a],styles:["[_nghost-%COMP%]{align-items:flex-end;bottom:0;display:flex;flex-direction:row;pointer-events:none}.InteractableChatbox[_ngcontent-%COMP%], .MessagingChatBox[_ngcontent-%COMP%]{pointer-events:auto}.MessagingChatBox[_ngcontent-%COMP%]{box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12);display:block;margin-right:8px}"],changeDetection:0}),e})()},"8FIo":function(e,t,n){"use strict";n.d(t,"a",function(){return x});var i=n("8Y7J"),s=n("B23V"),a=n("dO68"),o=n("sfSt"),r=n("9Aot"),c=n("o9eT"),l=n("w13q"),d=n("SVse"),h=n("dJr3");function g(e,t){if(1&e&&(i.Yb(0,"fl-heading",11),i.cc(1,12),i.Xb()),2&e){const e=i.rc(2);i.zc("headingType",e.HeadingType.H1)("size",e.TextSize.MID)("flMarginBottom",e.Margin.XSMALL)}}const u=function(e){return{"MessagingRemoveUser-description":e}};function b(e,t){if(1&e&&(i.Yb(0,"fl-text",13),i.cc(1,14),i.Xb()),2&e){const e=i.rc(2);i.zc("ngClass",i.Ec(2,u,e.chatboxMode))("flMarginBottom",e.Margin.XXLARGE)}}function f(e,t){if(1&e&&(i.Yb(0,"fl-text",15),i.cc(1,16),i.Xb()),2&e){const e=i.rc(2);i.zc("flMarginBottom",e.Margin.XXLARGE)("ngClass",i.Ec(2,u,e.chatboxMode))}}function p(e,t){if(1&e&&(i.Wb(0),i.Zc(1,g,2,3,"fl-heading",8),i.Zc(2,b,2,4,"fl-text",9),i.Zc(3,f,2,4,"ng-template",null,10,i.ad),i.Vb()),2&e){const e=i.Mc(4),t=i.rc();i.Gb(1),i.zc("ngIf",!t.chatboxMode),i.Gb(1),i.zc("ngIf",t.isLoggedInUserThreadOwner)("ngIfElse",e)}}function m(e,t){if(1&e&&(i.Yb(0,"fl-heading",11),i.cc(1,19),i.Xb()),2&e){const e=i.rc(2);i.zc("headingType",e.HeadingType.H1)("size",e.TextSize.MID)("flMarginBottom",e.Margin.XSMALL)}}function M(e,t){if(1&e&&(i.Zc(0,m,2,3,"fl-heading",8),i.Yb(1,"fl-text",13),i.ic(2,17),i.Tb(3,"fl-username",18),i.fc(),i.Xb()),2&e){const e=i.rc();i.zc("ngIf",!e.chatboxMode),i.Gb(1),i.zc("ngClass",i.Ec(5,u,e.chatboxMode))("flMarginBottom",e.Margin.XXLARGE),i.Gb(2),i.zc("displayName",e.user.displayName)("username",e.user.username)}}function C(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-button",20),i.nc("click",function(){i.Pc(e);const t=i.rc();return t.removeMember.emit(t.user)}),i.cc(1,21),i.Xb()}if(2&e){const e=i.rc();i.zc("color",e.ButtonColor.DANGER)("size",e.ButtonSize.SMALL)}}function S(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-button",22),i.nc("click",function(){i.Pc(e);const t=i.rc();return t.removeMember.emit(t.user)}),i.cc(1,23),i.Xb()}if(2&e){const e=i.rc();i.zc("color",e.ButtonColor.DANGER)("size",e.ButtonSize.SMALL)}}const T=function(e){return{MessagingRemoveUser:e}};let x=(()=>{class e{constructor(){this.ButtonColor=s.a,this.ButtonSize=a.a,this.HeadingType=o.c,this.Margin=r.a,this.TextSize=c.f,this.cancel=new i.n,this.removeMember=new i.n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-remove-user"]],inputs:{chatboxMode:"chatboxMode",isLoggedInUserThreadOwner:"isLoggedInUserThreadOwner",user:"user",loggedInUser:"loggedInUser"},outputs:{cancel:"cancel",removeMember:"removeMember"},decls:10,vars:10,consts:function(){let e,t,n,i,s,a,o,r;return e=" Cancel ",t=" Leave chat ",n=" Are you sure you want to leave this chat? This group will be closed, and all other participants will not be able to send messages anymore. ",i=" Are you sure you want to leave this chat? You will not be able to send messages or access the chat's history anymore. ",s=" Are you sure you want to remove " + "\ufffd#3\ufffd" + "" + "\ufffd/#3\ufffd" + " from your group? ",a=" Remove member ",o=" Leave ",r=" Remove ",[[3,"ngClass"],[4,"ngIf","ngIfElse"],["removeMemberCopy",""],[1,"MessagingRemoveUser-ctaContainer"],["flTrackingLabel","MessagingRemoveUserCancelButton",1,"MessagingRemoveUser-button",3,"color","flMarginRight","size","click"],e,["flTrackingLabel","MessagingLeaveChatButton","class","MessagingRemoveUser-button",3,"color","size","click",4,"ngIf","ngIfElse"],["removeMemberButton",""],[3,"headingType","size","flMarginBottom",4,"ngIf"],[3,"ngClass","flMarginBottom",4,"ngIf","ngIfElse"],["nonThreadOwnerLeaveCopy",""],[3,"headingType","size","flMarginBottom"],t,[3,"ngClass","flMarginBottom"],n,[3,"flMarginBottom","ngClass"],i,s,[1,"MessagingRemoveUser-username",3,"displayName","username"],a,["flTrackingLabel","MessagingLeaveChatButton",1,"MessagingRemoveUser-button",3,"color","size","click"],o,["flTrackingLabel","MessagingRemoveMemberButton",1,"MessagingRemoveUser-button",3,"color","size","click"],r]},template:function(e,t){if(1&e&&(i.Yb(0,"fl-bit",0),i.Zc(1,p,5,3,"ng-container",1),i.Zc(2,M,4,7,"ng-template",null,2,i.ad),i.Yb(4,"fl-bit",3),i.Yb(5,"fl-button",4),i.nc("click",function(){return t.cancel.emit()}),i.cc(6,5),i.Xb(),i.Zc(7,C,2,2,"fl-button",6),i.Zc(8,S,2,2,"ng-template",null,7,i.ad),i.Xb(),i.Xb()),2&e){const e=i.Mc(3),n=i.Mc(9);i.zc("ngClass",i.Ec(8,T,t.chatboxMode)),i.Gb(1),i.zc("ngIf",t.user.id===t.loggedInUser.id)("ngIfElse",e),i.Gb(4),i.zc("color",t.ButtonColor.TRANSPARENT_DARK)("flMarginRight",t.Margin.MID)("size",t.ButtonSize.SMALL),i.Gb(2),i.zc("ngIf",t.user.id===t.loggedInUser.id)("ngIfElse",n)}},directives:[l.a,d.o,d.q,s.b,r.b,o.b,c.e,h.b],styles:["[_nghost-%COMP%]{display:block;height:100%}.MessagingRemoveUser[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.MessagingRemoveUser-ctaContainer[_ngcontent-%COMP%]{display:flex}.MessagingRemoveUser-description[_ngcontent-%COMP%]{flex:1 1 0%}.MessagingRemoveUser-button[_ngcontent-%COMP%]{flex-grow:1;justify-content:center}.MessagingRemoveUser-username[_ngcontent-%COMP%]{display:inline-flex}"],changeDetection:0}),e})()},AJ15:function(e,t,n){"use strict";n.d(t,"a",function(){return Ae});var i=n("2Vo4"),s=n("XNiG"),a=n("8Y7J"),o=n("w13q"),r=n("SVse"),c=n("KUXl");let l=(()=>{class e{ngOnInit(){this.isHeadingBlue=this.isOldChatbox}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Mb({type:e,selectors:[["app-heading"]],hostVars:2,hostBindings:function(e,t){2&e&&a.Kb("IsHeadingBlue",t.isHeadingBlue)},inputs:{element:"element",isOldChatbox:"isOldChatbox"},decls:1,vars:1,template:function(e,t){1&e&&a.bd(0),2&e&&a.dd(" ",t.element.text," ")},styles:["[_nghost-%COMP%]{font-size:14px;line-height:1.43;word-break:break-word;word-wrap:break-word;font-weight:700}.IsHeadingBlue[_nghost-%COMP%]{color:#139ff0}"],changeDetection:0}),e})(),d=(()=>{class e{ngOnInit(){this.element.style&&(this.isBold=this.element.style.includes("bold"),this.isItalic=this.element.style.includes("italic"),this.isSmall=this.element.style.includes("small"))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Mb({type:e,selectors:[["app-body"]],hostVars:6,hostBindings:function(e,t){2&e&&a.Kb("IsBold",t.isBold)("IsItalic",t.isItalic)("IsSmall",t.isSmall)},inputs:{element:"element"},decls:2,vars:1,template:function(e,t){1&e&&(a.Yb(0,"fl-bit"),a.bd(1),a.Xb()),2&e&&(a.Gb(1),a.dd(" ",t.element.text," "))},directives:[o.a],styles:["[_nghost-%COMP%]{font-size:14px;line-height:1.43;word-break:break-word;word-wrap:break-word;white-space:pre-line}.IsBold[_nghost-%COMP%]{font-weight:700}.IsItalic[_nghost-%COMP%]{font-style:italic}.IsSmall[_nghost-%COMP%]{font-size:13px;line-height:1.2}"],changeDetection:0}),e})();var h=n("s7LF"),g=n("w5Bh"),u=n("DSso");function b(e,t){if(1&e&&(a.Yb(0,"fl-bit",2),a.bd(1),a.Xb()),2&e){const e=a.rc();a.Gb(1),a.cd(e.currErrText)}}let f=(()=>{class e{constructor(e){this.changeDetectorRef=e,this.control=new h.f,this.richMessageValuesChange=new a.n}handleClick(e){e.stopPropagation()}ngOnInit(){this.richMessageValues[this.element.name]=""}ngOnChanges(){this.disabled?this.control.disable():this.control.enable()}handleInput(){this.currErrText="",this.richMessageValues[this.element.name]=this.control.value,this.changeDetectorRef.markForCheck()}validate(){return this.currErrText="",this.changeDetectorRef.markForCheck(),!0}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(a.h))},e.\u0275cmp=a.Mb({type:e,selectors:[["app-text-input"]],hostBindings:function(e,t){1&e&&a.nc("click",function(e){return t.handleClick(e)})},inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},features:[a.Eb],decls:2,vars:3,consts:[["flTrackingLabel","rich-message-text-input",3,"placeholder","control","input"],["class","Error",4,"ngIf"],[1,"Error"]],template:function(e,t){1&e&&(a.Yb(0,"fl-input",0),a.nc("input",function(){return t.handleInput()}),a.Xb(),a.Zc(1,b,2,1,"fl-bit",1)),2&e&&(a.zc("placeholder",t.element.placeholder)("control",t.control),a.Gb(1),a.zc("ngIf",t.currErrText))},directives:[g.b,u.a,r.q,o.a],styles:[".Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730;margin-top:4px}"],changeDetection:0}),e})();var p=n("f6cb"),m=n("yb+G");function M(e,t){if(1&e&&a.Tb(0,"fl-radio",3),2&e){const e=a.rc().ngIf,t=a.rc();a.zc("control",e)("options",t.options)}}function C(e,t){if(1&e&&(a.Wb(0),a.Zc(1,M,1,2,"fl-radio",2),a.Vb()),2&e){const e=t.ngIf,n=a.rc();a.Gb(1),a.zc("ngIf",n.isFormControl(e))}}function S(e,t){if(1&e&&(a.Yb(0,"fl-bit",4),a.bd(1),a.Xb()),2&e){const e=a.rc();a.Gb(1),a.cd(e.currErrText)}}let T=(()=>{class e{constructor(){this.isFormControl=p.l,this.richMessageValuesChange=new a.n,this.formGroup=new h.h({radio:new h.f})}ngOnInit(){this.options=this.element.values.map(e=>e.text),this.formSubscription=this.formGroup.valueChanges.subscribe(e=>{const t=this.element.values.filter(t=>t.text===e.radio);1===t.length&&(this.richMessageValues[this.element.name]=t[0].value)})}ngOnDestroy(){this.formSubscription&&this.formSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Mb({type:e,selectors:[["app-radio-input"]],inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},decls:2,vars:2,consts:[[4,"ngIf"],["class","Error",4,"ngIf"],["flTrackingLabel","rich-message-radio-input",3,"control","options",4,"ngIf"],["flTrackingLabel","rich-message-radio-input",3,"control","options"],[1,"Error"]],template:function(e,t){1&e&&(a.Zc(0,C,2,1,"ng-container",0),a.Zc(1,S,2,1,"fl-bit",1)),2&e&&(a.zc("ngIf",t.formGroup.get("radio")),a.Gb(1),a.zc("ngIf",t.currErrText))},directives:[r.q,m.b,u.a,o.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730;margin-top:4px}"],changeDetection:0}),e})();var x=n("9Aot"),y=n("SYW+");function I(e,t){if(1&e&&a.Tb(0,"fl-checkbox",4),2&e){const e=a.rc().ngIf,t=a.rc().$implicit,n=a.rc();a.zc("control",e)("label",t.text)("flMarginBottom",n.Margin.SMALL)}}function O(e,t){if(1&e&&(a.Wb(0),a.Zc(1,I,1,3,"fl-checkbox",3),a.Vb()),2&e){const e=t.ngIf,n=a.rc(2);a.Gb(1),a.zc("ngIf",n.isFormControl(e))}}function A(e,t){if(1&e&&(a.Wb(0),a.Zc(1,O,2,1,"ng-container",2),a.Vb()),2&e){const e=t.$implicit,n=a.rc();a.Gb(1),a.zc("ngIf",n.formGroup.get(e.value))}}function v(e,t){if(1&e&&(a.Yb(0,"fl-bit",5),a.bd(1),a.Xb()),2&e){const e=a.rc();a.Gb(1),a.cd(e.currErrText)}}let w=(()=>{class e{constructor(){this.isFormControl=p.l,this.Margin=x.a,this.richMessageValues={},this.richMessageValuesChange=new a.n,this.formGroup=new h.h({})}ngOnInit(){this.element.values.forEach(e=>{this.richMessageValues[e.value]=!1,this.formGroup.addControl(e.value,new h.f(!1))}),this.formSubscription=this.formGroup.valueChanges.subscribe(e=>{Object.entries(e).forEach(e=>{const[t,n]=e;this.richMessageValues[t]=n})})}ngOnDestroy(){this.formSubscription&&this.formSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Mb({type:e,selectors:[["app-checkbox-input"]],inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},decls:2,vars:2,consts:[[4,"ngFor","ngForOf"],["class","Error",4,"ngIf"],[4,"ngIf"],["flTrackingLabel","rich-message-checkbox",3,"control","label","flMarginBottom",4,"ngIf"],["flTrackingLabel","rich-message-checkbox",3,"control","label","flMarginBottom"],[1,"Error"]],template:function(e,t){1&e&&(a.Zc(0,A,2,1,"ng-container",0),a.Zc(1,v,2,1,"fl-bit",1)),2&e&&(a.zc("ngForOf",t.element.values),a.Gb(1),a.zc("ngIf",t.currErrText))},directives:[r.p,r.q,y.a,u.a,x.b,o.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730}"],changeDetection:0}),e})();function E(e,t){if(1&e&&(a.Yb(0,"fl-bit",3),a.bd(1),a.Xb()),2&e){const e=a.rc();a.Gb(1),a.cd(e.currErrText)}}let z=(()=>{class e{constructor(e){this.changeDetectorRef=e,this.InputType=g.e,this.control=new h.f,this.richMessageValuesChange=new a.n}handleClick(e){e.stopPropagation()}ngOnInit(){this.richMessageValues[this.element.name]=NaN}ngOnChanges(){this.disabled?this.control.disable():this.control.enable()}handleInput(){const e=parseInt(this.control.value,10);this.currErrText="",this.richMessageValues[this.element.name]=e,this.changeDetectorRef.markForCheck()}validate(){return this.changeDetectorRef.markForCheck(),Number.isNaN(this.richMessageValues[this.element.name])?(this.currErrText="Please enter a value",!1):(this.currErrText="",this.changeDetectorRef.markForCheck(),!0)}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(a.h))},e.\u0275cmp=a.Mb({type:e,selectors:[["app-number-input"]],hostBindings:function(e,t){1&e&&a.nc("click",function(e){return t.handleClick(e)})},inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},features:[a.Eb],decls:3,vars:5,consts:[[1,"Container"],["flTrackingLabel","rich-message-number-input",1,"FieldInput",3,"beforeLabel","placeholder","control","type","input"],["class","Error",4,"ngIf"],[1,"Error"]],template:function(e,t){1&e&&(a.Yb(0,"fl-bit",0),a.Yb(1,"fl-input",1),a.nc("input",function(){return t.handleInput()}),a.Xb(),a.Xb(),a.Zc(2,E,2,1,"fl-bit",2)),2&e&&(a.Gb(1),a.zc("beforeLabel",t.element.label)("placeholder",t.element.placeholder)("control",t.control)("type",t.InputType.NUMBER),a.Gb(1),a.zc("ngIf",t.currErrText))},directives:[o.a,g.b,u.a,r.q],styles:[".Container[_ngcontent-%COMP%]{align-items:center;display:flex}.FieldInput[_ngcontent-%COMP%]{flex-grow:1}.Label[_ngcontent-%COMP%]{margin-right:8px}.Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730;margin-top:4px}"],changeDetection:0}),e})();var L=n("3VJ0");function k(e,t){if(1&e&&a.Tb(0,"fl-select",4),2&e){const e=a.rc().ngIf,t=a.rc();a.zc("disabled",t.disabled)("control",e)("options",t.options)("flMarginBottom",t.Margin.XSMALL)}}function P(e,t){if(1&e&&(a.Yb(0,"fl-bit",2),a.Zc(1,k,1,4,"fl-select",3),a.Xb()),2&e){const e=t.ngIf,n=a.rc();a.Gb(1),a.zc("ngIf",n.isFormControl(e))}}function _(e,t){if(1&e&&(a.Yb(0,"fl-bit",5),a.bd(1),a.Xb()),2&e){const e=a.rc();a.Gb(1),a.cd(e.currErrText)}}let R=(()=>{class e{constructor(){this.isFormControl=p.l,this.richMessageValuesChange=new a.n,this.Margin=x.a,this.formGroup=new h.h({select:new h.f})}handleClick(e){e.stopPropagation()}ngOnInit(){this.options=this.element.values.map(e=>e.text),this.element.default&&(this.richMessageValues[this.element.name]=this.element.default),this.formSubscription=this.formGroup.valueChanges.subscribe(e=>{const t=this.element.values.filter(t=>t.text===e.select);1===t.length&&(this.richMessageValues[this.element.name]=t[0].value)})}ngOnDestroy(){this.formSubscription&&this.formSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Mb({type:e,selectors:[["app-select-input"]],hostBindings:function(e,t){1&e&&a.nc("click",function(e){return t.handleClick(e)})},inputs:{element:"element",disabled:"disabled",richMessageValues:"richMessageValues"},outputs:{richMessageValuesChange:"richMessageValuesChange"},decls:2,vars:2,consts:[["class","Container",4,"ngIf"],["class","Error",4,"ngIf"],[1,"Container"],["flTrackingLabel","rich-message-select",3,"disabled","control","options","flMarginBottom",4,"ngIf"],["flTrackingLabel","rich-message-select",3,"disabled","control","options","flMarginBottom"],[1,"Error"]],template:function(e,t){1&e&&(a.Zc(0,P,2,1,"fl-bit",0),a.Zc(1,_,2,1,"fl-bit",1)),2&e&&(a.zc("ngIf",t.formGroup.get("select")),a.Gb(1),a.zc("ngIf",t.currErrText))},directives:[r.q,o.a,L.b,u.a,x.b],styles:[".Container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.Error[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;color:#eb3730;margin-top:4px}"],changeDetection:0}),e})();var j=n("ph87"),U=n("7v0r"),B=n("B23V"),$=n("quSY"),G=n("iInd"),F=n("LRne"),D=n("itXk"),N=n("lJxs"),X=n("eIep"),Y=n("CqXF"),H=n("JIr8"),V=n("IzEk"),Z=n("/wLE"),W=n("IheW"),q=n("90vB");let Q=(()=>{class e{constructor(e,t,n){this.auth=e,this.http=t,this.freelancerHttp=n}request(e,t,n){return this.auth.getAuthorizationHeader().pipe(Object(N.a)(t=>{const n=e.contentType||"application/json";return{headers:t.set("Content-Type",n),body:this.serialiseBody(n,e.payload)}}),Object(X.a)(({headers:i,body:s})=>this.http.request(t,e.url,{observe:"response",body:s,headers:i,params:{webapp:"1",compact:"true",new_errors:"true"}}).pipe(Object(X.a)(t=>this.savePayload(t.status,e.payload,n).pipe(Object(Y.a)({status:"success"}))),Object(H.a)(e=>F.a({status:"error",errorCode:e.error.error.code})))),Object(V.a)(1))}serialiseBody(e,t){return e.includes("urlencoded")?Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(`${t[e]}`)}`).join("&"):JSON.stringify(t)}savePayload(e,t,n){return D.a([this.auth.getAuthorizationHeader(),this.auth.getUserId()]).pipe(Object(X.a)(([i,s])=>this.http.post(`${this.freelancerHttp.getBaseServiceUrl()}/messages/0.1/messages/${n}/?action=save_rich_message_payload`,{[s]:{status_code:e,payload:t}},{headers:i,params:{webapp:"1",compact:"true",new_errors:"true"}})),Object(Y.a)(void 0))}}return e.\u0275fac=function(t){return new(t||e)(a.jc(Z.a),a.jc(W.a),a.jc(q.a))},e.\u0275prov=a.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var K=n("lDT0"),J=n("SMHo"),ee=n("565b"),te=n("4kPF"),ne=n("al+g");function ie(e,t){if(1&e&&(a.Yb(0,"fl-link",3),a.bd(1),a.Xb()),2&e){const e=a.rc(2);a.zc("link",e.transformedLink.url)("queryParams",e.transformedLink.queryParams)("fragment",e.transformedLink.fragment),a.Gb(1),a.dd(" ",e.element.label," ")}}function se(e,t){if(1&e&&(a.Yb(0,"fl-button",4),a.bd(1),a.Xb()),2&e){const e=a.rc(2);a.zc("color",e.color)("display","block")("link",e.transformedLink.url)("queryParams",e.transformedLink.queryParams)("fragment",e.transformedLink.fragment),a.Gb(1),a.dd(" ",e.element.label," ")}}function ae(e,t){if(1&e&&(a.Wb(0),a.Zc(1,ie,2,4,"fl-link",1),a.Zc(2,se,2,6,"ng-template",null,2,a.ad),a.Vb()),2&e){const e=a.Mc(3),t=a.rc();a.Gb(1),a.zc("ngIf","LinkHeading"===t.displayClass)("ngIfElse",e)}}function oe(e,t){if(1&e&&(a.Yb(0,"fl-banner-alert",12),a.Tb(1,"fl-interactive-text",13),a.Xb()),2&e){const e=a.rc(2);a.zc("type",e.BannerAlertType.ERROR)("closeable",!1)("flMarginBottom",e.Margin.XXSMALL),a.Gb(1),a.zc("link",!0)("content",e.currErrText)}}function re(e,t){if(1&e){const e=a.Zb();a.Wb(0),a.Yb(1,"fl-bit",5),a.Yb(2,"fl-button",6),a.nc("click",function(){return a.Pc(e),a.rc().handleClick()}),a.sc(3,"flAsync"),a.bd(4),a.Xb(),a.Xb(),a.Yb(5,"fl-bit",5),a.Yb(6,"fl-button",7),a.nc("click",function(){return a.Pc(e),a.rc().handleClick(!0)}),a.cc(7,8),a.sc(8,"flAsync"),a.Xb(),a.Yb(9,"fl-button",9),a.nc("click",function(){return a.Pc(e),a.rc().handleClick(!1)}),a.cc(10,10),a.sc(11,"flAsync"),a.Xb(),a.Xb(),a.Zc(12,oe,2,5,"fl-banner-alert",11),a.Vb()}if(2&e){const e=a.rc();a.Gb(1),a.zc("flHide",e.alreadyConfirming),a.Gb(1),a.zc("color",e.color)("display","block")("ngClass",e.displayClass)("disabled",a.tc(3,13,e.disabled$))("busy",e.busy),a.Gb(2),a.dd(" ",e.element.label," "),a.Gb(1),a.zc("flHide",!e.alreadyConfirming),a.Gb(1),a.zc("color",e.ButtonColor.SUCCESS)("disabled",a.tc(8,15,e.disabled$)),a.Gb(3),a.zc("color",e.ButtonColor.DEFAULT)("disabled",a.tc(11,17,e.disabled$)),a.Gb(3),a.zc("ngIf",e.currErrText)}}let ce=(()=>{class e{constructor(e,t,n){this.changeDetectorRef=e,this.router=t,this.richMessagesRequests=n,this.ButtonColor=B.a,this.BannerAlertType=U.c,this.Margin=x.a,this.displayType="default",this.link="",this.disabled=new a.n,this.richMessageValuesChange=new a.n,this.buttonPressFired=new a.n,this.submissionSuccess=new a.n,this.busy=!1,this.subscriptions=new $.a,this.color=B.a.DEFAULT,this.alreadyConfirming=!1,this.displayClass="",this.displayTypeMap={success:B.a.SUCCESS,info:B.a.DEFAULT,blue:B.a.SECONDARY,green:B.a.SUCCESS,default:B.a.DEFAULT,"post-project":B.a.PRIMARY}}ngOnInit(){switch(this.color=this.displayTypeMap[this.displayType]||B.a.DEFAULT,this.displayType){case"link-heading":this.color=B.a.DEFAULT,this.displayClass="LinkHeading"}this.transformedLink=Object(j.q)(this.link),this.subscriptions.add(this.validInputElements$.subscribe(e=>{if(!e)return this.disabled.emit(!1),void(this.busy=!1);this.alreadyConfirming=!1;const{action:t}=this.element,n=Object.assign(Object.assign({},this.element.request),{payload:Object.assign(Object.assign({},this.element.request.payload),this.richMessageValues)});if("REDIRECT"===t.toUpperCase()){const e=n.url.replace(/^(?:\/\/|[^/]+)*\//,"").split("?"),t=e[1].split("&").reduce((e,t)=>{const n=t.split("=");return Object.assign(Object.assign({},e),{[n[0]]:n[1]})},{});this.router.navigate([e[0]],{queryParams:t}).then(e=>{this.busy=!1,e?this.disabled.emit(!0):this.currErrText="Error: Failed to redirect."})}else this.subscriptions.add(this.richMessagesRequests.request(n,t,this.messageId).subscribe(e=>{this.busy=!1,"error"===e.status?(this.disabled.emit(!1),this.currErrText=e.errorCode&&this.element.errors&&this.element.errors[e.errorCode]?this.element.errors[e.errorCode]:"Unknown error."):(this.currErrText="",this.submissionSuccess.emit(!0)),this.changeDetectorRef.markForCheck()}))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}handleClick(e=!0){const t=()=>{this.busy=!0,this.disabled.emit(!0),this.buttonPressFired.emit(!0)};this.element.confirm?e&&this.alreadyConfirming?t():this.alreadyConfirming=e:t(),this.changeDetectorRef.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(a.h),a.Sb(G.e),a.Sb(Q))},e.\u0275cmp=a.Mb({type:e,selectors:[["app-button-input"]],inputs:{element:"element",displayType:"displayType",messageId:"messageId",link:"link",disabled$:"disabled$",validInputElements$:"validInputElements$",richMessageValues:"richMessageValues",currentUserId:"currentUserId"},outputs:{disabled:"disabled",richMessageValuesChange:"richMessageValuesChange",buttonPressFired:"buttonPressFired",submissionSuccess:"submissionSuccess"},decls:2,vars:2,consts:function(){let e,t;return e=" Confirm ",t=" Cancel ",[[4,"ngIf"],["flTrackingLabel","rich-message-button",3,"link","queryParams","fragment",4,"ngIf","ngIfElse"],["buttonLink",""],["flTrackingLabel","rich-message-button",3,"link","queryParams","fragment"],["flTrackingLabel","rich-message-button",3,"color","display","link","queryParams","fragment"],[3,"flHide"],["flTrackingLabel","rich-message-button",3,"color","display","ngClass","disabled","busy","click"],["flTrackingLabel","rich-message-button","data-uitest-target","richmessage-confirm",1,"ConfirmButton",3,"color","disabled","click"],e,["flTrackingLabel","rich-message-button",3,"color","disabled","click"],t,["class","Error",3,"type","closeable","flMarginBottom",4,"ngIf"],[1,"Error",3,"type","closeable","flMarginBottom"],[3,"link","content"]]},template:function(e,t){1&e&&(a.Zc(0,ae,4,2,"ng-container",0),a.Zc(1,re,13,19,"ng-container",0)),2&e&&(a.zc("ngIf","REDIRECT"===t.element.action),a.Gb(1),a.zc("ngIf","REDIRECT"!==t.element.action))},directives:[r.q,K.b,u.a,B.b,o.a,J.a,ee.a,r.o,U.a,x.b,te.a],pipes:[ne.a],styles:[".Error[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;margin-top:4px}.ConfirmButton[_ngcontent-%COMP%]{margin-right:8px}.LinkHeading[_ngcontent-%COMP%]{font-weight:700;text-align:left}"],changeDetection:0}),e})(),le=(()=>{class e{constructor(){this.BannerAlertType=U.c,this.Margin=x.a}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Mb({type:e,selectors:[["app-alert"]],inputs:{element:"element"},decls:2,vars:5,consts:[[3,"type","closeable","flMarginBottom"],[3,"link","content"]],template:function(e,t){1&e&&(a.Yb(0,"fl-banner-alert",0),a.Tb(1,"fl-interactive-text",1),a.Xb()),2&e&&(a.zc("type","success"===t.element.alert_type?t.BannerAlertType.SUCCESS:t.BannerAlertType.ERROR)("closeable",!1)("flMarginBottom",t.Margin.XXSMALL),a.Gb(1),a.zc("link",!0)("content",t.element.text))},directives:[U.a,x.b,te.a],encapsulation:2,changeDetection:0}),e})();const de=["inputel"];function he(e,t){if(1&e&&a.Tb(0,"app-heading",11),2&e){const e=a.rc(2).$implicit,t=a.rc(2);a.zc("isOldChatbox",t.isOldChatbox)("element",e)}}function ge(e,t){if(1&e&&a.Tb(0,"app-body",12),2&e){const e=a.rc(2).$implicit;a.zc("element",e)}}const ue=function(e){return{TextInput:e}};function be(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-text-input",13,14),a.nc("richMessageValuesChange",function(t){return a.Pc(e),a.rc(4).richMessageValues=t}),a.sc(2,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2).$implicit,t=a.rc(2);a.zc("ngClass",a.Ec(6,ue,!t.chatboxMode))("element",e)("disabled",a.tc(2,4,t.disabled$))("richMessageValues",t.richMessageValues)}}function fe(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-radio-input",15),a.nc("richMessageValuesChange",function(t){return a.Pc(e),a.rc(4).richMessageValues=t}),a.sc(1,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2).$implicit,t=a.rc(2);a.zc("element",e)("disabled",a.tc(1,3,t.disabled$))("richMessageValues",t.richMessageValues)}}function pe(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-checkbox-input",15,14),a.nc("richMessageValuesChange",function(t){return a.Pc(e),a.rc(4).richMessageValues=t}),a.sc(2,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2).$implicit,t=a.rc(2);a.zc("element",e)("disabled",a.tc(2,3,t.disabled$))("richMessageValues",t.richMessageValues)}}const me=function(e){return{Input:e}};function Me(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-number-input",13,14),a.nc("richMessageValuesChange",function(t){return a.Pc(e),a.rc(4).richMessageValues=t}),a.sc(2,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2).$implicit,t=a.rc(2);a.zc("ngClass",a.Ec(6,me,!t.chatboxMode))("element",e)("disabled",a.tc(2,4,t.disabled$))("richMessageValues",t.richMessageValues)}}function Ce(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-select-input",15),a.nc("richMessageValuesChange",function(t){return a.Pc(e),a.rc(4).richMessageValues=t}),a.sc(1,"flAsync"),a.Xb()}if(2&e){const e=a.rc(2).$implicit,t=a.rc(2);a.zc("element",e)("disabled",a.tc(1,3,t.disabled$))("richMessageValues",t.richMessageValues)}}function Se(e,t){if(1&e){const e=a.Zb();a.Yb(0,"app-button-input",16),a.nc("richMessageValuesChange",function(t){return a.Pc(e),a.rc(4).richMessageValues=t})("buttonPressFired",function(){return a.Pc(e),a.rc(4).handleButtonPress()})("submissionSuccess",function(){return a.Pc(e),a.rc(4).handleSubmissionSuccess()})("disabled",function(t){return a.Pc(e),a.rc(4).onDisabled(t)}),a.Xb()}if(2&e){const e=a.rc(2).$implicit,t=a.rc(2);a.zc("ngClass",a.Ec(9,me,!t.chatboxMode))("element",e)("link",e.request.url)("displayType",e.displayType)("messageId",t.messageId)("disabled$",t.disabled$)("validInputElements$",t.validInputElements$)("richMessageValues",t.richMessageValues)("currentUserId",t.currentUserId)}}function Te(e,t){if(1&e&&a.Tb(0,"app-alert",12),2&e){const e=a.rc(2).$implicit;a.zc("element",e)}}function xe(e,t){if(1&e&&(a.Wb(0),a.Zc(1,he,1,2,"app-heading",6),a.Zc(2,ge,1,1,"app-body",7),a.Zc(3,be,3,8,"app-text-input",8),a.Zc(4,fe,2,5,"app-radio-input",9),a.Zc(5,pe,3,5,"app-checkbox-input",9),a.Zc(6,Me,3,8,"app-number-input",8),a.Zc(7,Ce,2,5,"app-select-input",9),a.Zc(8,Se,1,11,"app-button-input",10),a.Zc(9,Te,1,1,"app-alert",7),a.Vb()),2&e){const e=a.rc().$implicit;a.Gb(1),a.zc("ngIf","heading"===e.type),a.Gb(1),a.zc("ngIf","body"===e.type),a.Gb(1),a.zc("ngIf","text-input"===e.type),a.Gb(1),a.zc("ngIf","radio"===e.type),a.Gb(1),a.zc("ngIf","checkbox"===e.type),a.Gb(1),a.zc("ngIf","number"===e.type),a.Gb(1),a.zc("ngIf","select"===e.type),a.Gb(1),a.zc("ngIf","button"===e.type),a.Gb(1),a.zc("ngIf","alert"===e.type)}}function ye(e,t){if(1&e&&(a.Wb(0,4),a.Zc(1,xe,10,9,"ng-container",5),a.Vb()),2&e){const e=t.$implicit,n=a.rc(2);a.Gb(1),a.zc("ngIf",n.shouldDisplay(e))}}function Ie(e,t){if(1&e&&(a.Yb(0,"fl-bit",2),a.Zc(1,ye,2,1,"ng-container",3),a.Xb()),2&e){const e=t.$implicit;a.Gb(1),a.zc("ngForOf",e)}}const Oe=function(e){return{OldChatbox:e}};let Ae=(()=>{class e{constructor(){this.isOldChatbox=!0,this.chatboxMode=!0,this.disabledSubject$=new i.a(!1),this.disabled$=this.disabledSubject$.asObservable(),this.validInputElementsSubject$=new s.a,this.validInputElements$=this.validInputElementsSubject$.asObservable(),this.richMessageValues={}}ngOnChanges(e){void 0!==e.richMessage&&(this.disabledSubject$.next(!!this.richMessage.disabled),this.submissionSuccessful=!(!this.richMessage.latestSubmissions||!this.richMessage.latestSubmissions[this.currentUserId]||200!==this.richMessage.latestSubmissions[this.currentUserId].status_code))}handleButtonPress(){const e=this.validatables.map(e=>e.validate());this.validInputElementsSubject$.next(e.every(e=>e))}handleSubmissionSuccess(){this.submissionSuccessful=!0}shouldDisplay(e){return!(e.hide_on_success&&this.submissionSuccessful||e.show_on_success&&!this.submissionSuccessful)}onDisabled(e){this.disabledSubject$.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=a.Mb({type:e,selectors:[["app-rich-message"]],viewQuery:function(e,t){if(1&e&&a.id(de,1),2&e){let e;a.Lc(e=a.oc())&&(t.validatables=e)}},inputs:{richMessage:"richMessage",messageId:"messageId",currentUserId:"currentUserId",isOldChatbox:"isOldChatbox",chatboxMode:"chatboxMode"},features:[a.Eb],decls:2,vars:4,consts:[[3,"ngClass"],["class","Group",4,"ngFor","ngForOf"],[1,"Group"],["flTrackingSection","rich-message",4,"ngFor","ngForOf"],["flTrackingSection","rich-message"],[4,"ngIf"],[3,"isOldChatbox","element",4,"ngIf"],[3,"element",4,"ngIf"],[3,"ngClass","element","disabled","richMessageValues","richMessageValuesChange",4,"ngIf"],[3,"element","disabled","richMessageValues","richMessageValuesChange",4,"ngIf"],[3,"ngClass","element","link","displayType","messageId","disabled$","validInputElements$","richMessageValues","currentUserId","richMessageValuesChange","buttonPressFired","submissionSuccess","disabled",4,"ngIf"],[3,"isOldChatbox","element"],[3,"element"],[3,"ngClass","element","disabled","richMessageValues","richMessageValuesChange"],["inputel",""],[3,"element","disabled","richMessageValues","richMessageValuesChange"],[3,"ngClass","element","link","displayType","messageId","disabled$","validInputElements$","richMessageValues","currentUserId","richMessageValuesChange","buttonPressFired","submissionSuccess","disabled"]],template:function(e,t){1&e&&(a.Yb(0,"fl-bit",0),a.Zc(1,Ie,2,1,"fl-bit",1),a.Xb()),2&e&&(a.zc("ngClass",a.Ec(2,Oe,t.isOldChatbox)),a.Gb(1),a.zc("ngForOf",t.richMessage.long))},directives:[o.a,r.o,r.p,c.a,r.q,l,d,f,T,w,z,R,ce,le],pipes:[ne.a],styles:[".OldChatbox[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12);display:flex;flex-direction:column;margin:16px;max-width:400px;padding:16px}.Group[_ngcontent-%COMP%]{display:block}.Group[_ngcontent-%COMP%]:not(:last-child){margin-bottom:8px}.Group[_ngcontent-%COMP%]:not(:first-child){margin-top:16px}@media (min-width:768px){.Input[_ngcontent-%COMP%], .TextInput[_ngcontent-%COMP%]{display:inline-block}.TextInput[_ngcontent-%COMP%]{min-width:50%}}"],changeDetection:0}),e})()},BFOf:function(e,t,n){"use strict";n.d(t,"c",function(){return A}),n.d(t,"b",function(){return v}),n.d(t,"a",function(){return w});var i=n("8Y7J"),s=n("s7LF"),a=n("HsDr"),o=n("Rnop"),r=n("o9eT"),c=n("xgIS"),l=n("JX91"),d=n("lJxs"),h=n("SVse"),g=n("w13q"),u=n("B23V");const b=["fileInput"],f=["content"];function p(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-bit",7),i.nc("dragleave",function(){return i.Pc(e),i.rc(2).onDragLeave()}),i.Tb(1,"fl-icon",8),i.Yb(2,"span",9),i.cc(3,10),i.Xb(),i.Xb()}if(2&e){const e=i.rc(2);i.Gb(1),i.zc("color",e.IconColor.LIGHT)("size",e.IconSize.MID)("name","ui-drag-drop")}}function m(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Zc(1,p,4,3,"fl-bit",4),i.Yb(2,"input",5,6),i.nc("change",function(){i.Pc(e);const t=i.Mc(3);return i.rc().onFileSelect(t.files)}),i.Xb(),i.Vb()}if(2&e){const e=i.rc();i.Gb(1),i.zc("ngIf",e.fileHover),i.Gb(1),i.zc("multiple",e.multiple)("disabled",e.control.disabled||null)}}function M(e,t){if(1&e&&(i.Yb(0,"fl-text",21),i.bd(1),i.Xb()),2&e){const e=i.rc(3);i.zc("color",e.FontColor.MID)("size",e.size===e.FileSelectSize.LARGE?e.TextSize.XXSMALL:e.TextSize.XXXSMALL),i.Gb(1),i.dd(" ",e.note," ")}}const C=function(e){return{FileHover:e}};function S(e,t){if(1&e&&(i.Yb(0,"fl-bit",14),i.Yb(1,"fl-bit",15),i.Tb(2,"fl-icon",16),i.Yb(3,"fl-bit",17),i.Yb(4,"fl-text",18),i.ic(5,19),i.Tb(6,"fl-text",20),i.fc(),i.Xb(),i.Zc(7,M,2,3,"fl-text",3),i.Xb(),i.Xb(),i.Xb()),2&e){const e=i.rc(2);i.zc("ngClass",i.Ec(13,C,e.fileHover)),i.Hb("data-size",e.size),i.Gb(2),i.zc("name","ui-upload")("color",e.IconColor.INHERIT)("size",e.size===e.FileSelectSize.LARGE?e.IconSize.XLARGE:e.IconSize.MID),i.Gb(2),i.zc("color",e.FontColor.DARK)("size",e.size===e.FileSelectSize.LARGE?e.TextSize.SMALL:e.TextSize.XSMALL)("weight",e.FontWeight.BOLD),i.Gb(2),i.zc("color",e.FontColor.INHERIT)("fontType",e.FontType.SPAN)("size",e.TextSize.INHERIT)("weight",e.FontWeight.BOLD),i.Gb(1),i.zc("ngIf",e.note)}}function T(e,t){if(1&e&&(i.Yb(0,"fl-button",22),i.Tb(1,"fl-icon",23),i.Xb()),2&e){const e=i.rc(2);i.zc("disabled",!e.active),i.Gb(1),i.zc("color",e.control.disabled?e.IconColor.MID:e.iconColor)("size",e.IconSize.SMALL)("name","ui-attachment")}}function x(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Zc(1,S,8,15,"fl-bit",11),i.Zc(2,T,2,4,"fl-button",12),i.Yb(3,"input",13,6),i.nc("change",function(){i.Pc(e);const t=i.Mc(4);return i.rc().onFileSelect(t.files)})("click",function(){return i.Pc(e),i.rc().handleClick()})("dragleave",function(){return i.Pc(e),i.rc().onDragLeave()})("mouseenter",function(){return i.Pc(e),i.rc().onMouseOver(!0)})("mouseleave",function(){return i.Pc(e),i.rc().onMouseOver(!1)}),i.Xb(),i.Vb()}if(2&e){const e=i.rc();i.Gb(1),i.zc("ngIf",e.fileSelectMode===e.FileSelectMode.DRAGDROP),i.Gb(1),i.zc("ngIf",e.fileSelectMode===e.FileSelectMode.ICON),i.Gb(1),i.zc("multiple",e.multiple)("disabled",e.control.disabled||null)}}function y(e,t){if(1&e&&(i.Yb(0,"fl-text",21),i.bd(1),i.Xb()),2&e){const e=i.rc();i.zc("color",e.FontColor.ERROR)("size",e.TextSize.XXSMALL),i.Gb(1),i.dd(" ",e.error," ")}}const I=function(e){return{Content:e}},O=["*"];var A=function(e){return e.COMPACT="compact",e.DEFAULT="default",e.LARGE="large",e}({}),v=function(e){return e.DRAGDROP="dragdrop",e.ICON="icon",e}({});let w=(()=>{class e{constructor(e){this.cd=e,this.FileSelectMode=v,this.FileSelectSize=A,this.HoverColor=a.a,this.IconColor=a.c,this.IconSize=a.e,this.FontColor=o.a,this.TextSize=r.f,this.FontType=r.b,this.FontWeight=r.c,this.fileHover=!1,this.contentProvided=!1,this.iconColor=a.c.DARK,this.fileSelectMode=v.DRAGDROP,this.control=new s.f,this.size=A.DEFAULT,this.multiple=!1,this.onFileDropped=new i.n}set active(e){console.warn("Manually setting active status on fl-file-select is deprecated.\n      Set the disabled status on your form control instead"),e?this.control.enable():this.control.disable()}ngOnInit(){this.asIcon=this.fileSelectMode===v.ICON,this.contentProvided=!!(this.content.nativeElement.children.length>0),this.errorSubscription=this.control.statusChanges.pipe(Object(l.a)(this.control.status)).subscribe(()=>{[this.error]=Object.values(this.control.errors||{}),this.cd.markForCheck()})}onDragOver(e){this.control.disabled||(this.fileHover=!0,e.preventDefault())}onDragLeave(){this.control.disabled||(this.fileHover=!1)}onDrop(e){this.control.disabled||(e.preventDefault(),e.stopPropagation(),e.dataTransfer&&this.onFileSelect(e.dataTransfer.files),this.fileHover=!1)}onMouseOver(e){this.iconColor=e?a.c.PRIMARY:a.c.DARK}onFileSelect(e){if(e){const t=Array.from(e);this.control.setValue(t),this.control.markAsDirty(),t.forEach(e=>{this.onFileDropped.emit(e)})}this.resetInputValue()}ngOnDestroy(){this.errorSubscription&&this.errorSubscription.unsubscribe()}triggerInput(){this.nativeElement.nativeElement.click()}handleClick(){this.resetInputValue()}resetInputValue(){this.nativeElement.nativeElement.value=""}readFileAsDataURL(e){const t=new FileReader;return t.readAsDataURL(e),c.a(t,"load").pipe(Object(d.a)(()=>t.result))}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(i.h))},e.\u0275cmp=i.Mb({type:e,selectors:[["fl-file-select"]],viewQuery:function(e,t){if(1&e&&(i.id(b,1),i.id(f,3,i.l)),2&e){let e;i.Lc(e=i.oc())&&(t.nativeElement=e.first),i.Lc(e=i.oc())&&(t.content=e.first)}},hostVars:2,hostBindings:function(e,t){1&e&&i.nc("dragover",function(e){return t.onDragOver(e)})("drop",function(e){return t.onDrop(e)}),2&e&&i.Kb("AsIcon",t.asIcon)},inputs:{fileSelectMode:"fileSelectMode",control:"control",size:"size",note:"note",active:"active",multiple:"multiple"},outputs:{onFileDropped:"onFileDropped"},ngContentSelectors:O,decls:6,vars:6,consts:function(){let e,t,n,i,s,a,o;return e="Drop to attach your file",t="Drop your file to send as attachment",n=" Drop to attach your file ",i="Click or drop to attach your file",s="Select file to send as attachment",a="" + "\ufffd#6\ufffd" + " Click " + "\ufffd/#6\ufffd" + " or drag here to upload ",o="Attach a file",[[4,"ngIf"],[3,"ngClass"],["content",""],[3,"color","size",4,"ngIf"],["class","FileHoverOverlay",3,"dragleave",4,"ngIf"],["title",e,"type","file",1,"HiddenInput",3,"multiple","disabled","change"],["fileInput",""],[1,"FileHoverOverlay",3,"dragleave"],["label",t,1,"FileHoverChild",3,"color","size","name"],[1,"FileHoverText","FileHoverChild"],n,["class","DefaultContent",3,"ngClass",4,"ngIf"],[3,"disabled",4,"ngIf"],["title",i,"type","file",1,"FileInput",3,"multiple","disabled","change","click","dragleave","mouseenter","mouseleave"],[1,"DefaultContent",3,"ngClass"],[1,"DefaultContent-inner"],["label",s,1,"DefaultContent-icon","FileHoverChild",3,"name","color","size"],[1,"DefaultContent-text"],[3,"color","size","weight"],a,[1,"DefaultContent-highlight",3,"color","fontType","size","weight"],[3,"color","size"],[3,"disabled"],["label",o,3,"color","size","name"]]},template:function(e,t){1&e&&(i.yc(),i.Zc(0,m,4,3,"ng-container",0),i.Yb(1,"fl-bit",1,2),i.xc(3),i.Xb(),i.Zc(4,x,5,4,"ng-container",0),i.Zc(5,y,2,3,"fl-text",3)),2&e&&(i.zc("ngIf",t.contentProvided&&t.fileSelectMode===t.FileSelectMode.DRAGDROP),i.Gb(1),i.zc("ngClass",i.Ec(4,I,t.contentProvided)),i.Gb(3),i.zc("ngIf",!t.contentProvided),i.Gb(1),i.zc("ngIf",t.control.invalid&&t.control.dirty))},directives:[h.q,g.a,h.o,a.d,r.e,u.b],styles:['[_nghost-%COMP%]{display:block;position:relative}.AsIcon[_nghost-%COMP%]{cursor:pointer;display:block;height:auto;width:auto}.Content[_ngcontent-%COMP%]{flex:1 0 100%;flex-direction:column;position:relative}.Content[_ngcontent-%COMP%], .FileHoverOverlay[_ngcontent-%COMP%]{display:flex;height:100%;width:100%}.FileHoverOverlay[_ngcontent-%COMP%]{background:rgba(25,32,45,.7);border-radius:0;color:#f7f7f7;flex-direction:column;justify-content:center;position:absolute;text-align:center;z-index:1010}.FileHoverText[_ngcontent-%COMP%]{margin-top:4px}.FileHoverChild[_ngcontent-%COMP%]{align-self:center;margin:0 auto}.DefaultContent[_ngcontent-%COMP%]{align-items:center;background:#f7f7f7;border:2px dashed #bec0c2;border-radius:0;display:flex;justify-content:center;min-height:76px;padding:8px;width:100%}.DefaultContent[_ngcontent-%COMP%]:after{content:"";font-size:0;min-height:inherit}.DefaultContent-inner[_ngcontent-%COMP%]{line-height:0;text-align:center}.DefaultContent-icon[_ngcontent-%COMP%]{margin:0}.DefaultContent-highlight[_ngcontent-%COMP%]{color:#007fed;display:inline}.DefaultContent[data-size=large][_ngcontent-%COMP%]{min-height:180px}.DefaultContent[data-size=large][_ngcontent-%COMP%]   .DefaultContent-icon[_ngcontent-%COMP%]{margin-bottom:8px}.DefaultContent[data-size=compact][_ngcontent-%COMP%]{justify-content:flex-start;min-height:44px;padding-left:16px}.DefaultContent[data-size=compact][_ngcontent-%COMP%]   .DefaultContent-inner[_ngcontent-%COMP%]{align-items:center;display:flex}.DefaultContent[data-size=compact][_ngcontent-%COMP%]   .DefaultContent-icon[_ngcontent-%COMP%]{margin-right:16px}.DefaultContent[data-size=compact][_ngcontent-%COMP%]   .DefaultContent-text[_ngcontent-%COMP%]{text-align:left}.DefaultContent.FileHover[_ngcontent-%COMP%]{background:#dbf4ff;border-color:#007fed}.FileInput[_ngcontent-%COMP%]{bottom:0;cursor:pointer;height:100%;left:0;opacity:0;right:0;top:0;width:100%}.FileInput[_ngcontent-%COMP%], .HiddenInput[_ngcontent-%COMP%]{overflow:hidden;position:absolute}.HiddenInput[_ngcontent-%COMP%]{height:1px;left:-10000px;top:auto;width:1px}'],changeDetection:0}),e})()},CJMb:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n("9u4R"),s=n("tqRt"),a=n("OpNG"),o=n("cUs2");function r(){return{defaultOrder:{field:"id",direction:a.a.ASC},fetch:(e,t,n)=>({endpoint:"support/0.1/agents/",params:{agents:t,users:Object(o.h)(n,"userId"),support_types:Object(o.h)(n,"type"),agent_states:Object(o.h)(n,"state")}}),push:void 0,set:void 0,update:(e,t,n)=>({endpoint:`support/0.1/agents/${n.id}/state`,method:"POST",payload:{state:t.state}}),remove:void 0}}function c(e){return{id:e.id,userId:e.user_id,owner:e.owner||void 0,type:e.support_type,createTime:1e3*e.create_time,state:e.state}}function l(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("agents"===t.payload.type){const{result:n,ref:i,order:s}=t.payload;return n.agents?Object(o.o)(e,Object(o.z)(n.agents,c),s,i):e}return e;case"API_UPDATE":if("agents"===t.payload.type){const{delta:n,ref:i,originalDocument:s}=t.payload;return Object(o.q)(e,Object(o.z)([Object(a.e)(s,n)],e=>e),i)}return e;case"API_UPDATE_SUCCESS":if("agents"===t.payload.type){const{result:n,ref:i}=t.payload;return Object(o.q)(e,Object(o.z)([n.agent],c),i)}return e;case"API_UPDATE_ERROR":if("agents"===t.payload.type){const{originalDocument:n,ref:i}=t.payload;return Object(o.q)(e,Object(o.z)([n],e=>e),i)}return e;case"WS_MESSAGE":{const{payload:n}=t;if("supportAgent"===n.type)switch(n.data.type){case"available":case"unavailable":case"away":return Object(o.b)(e,[n.data.agent],c,{path:{collection:"agents",authUid:n.toUserId}});default:return e}return e}default:return e}}var d=n("8Y7J");let h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Qb({type:e}),e.\u0275inj=d.Pb({imports:[[s.j.forFeature("agents",l),i.d.forFeature("agents",r)]]}),e})()},IvPS:function(e,t,n){"use strict";n.d(t,"a",function(){return m});var i=n("8Y7J"),s=n("QrFh"),a=n("9Aot"),o=n("Rnop"),r=n("o9eT"),c=n("JX91"),l=n("HsDr"),d=n("s7LF"),h=n("SVse"),g=n("w13q");const u=function(e){return{IsFocus:e}};function b(e,t){if(1&e&&(i.Yb(0,"fl-bit",3),i.Yb(1,"fl-text",4),i.cc(2,5),i.Xb(),i.Xb()),2&e){const e=i.rc();i.Gb(1),i.zc("ngClass",i.Ec(5,u,!0===e.textareaFocused))("color",e.maxCharacter-(null==e.control.value?null:e.control.value.length)>=0?e.FontColor.DARK:e.FontColor.ERROR)("size",e.TextSize.XSMALL)("fontType",e.FontType.PARAGRAPH),i.Gb(1),i.gc(e.maxCharacter-(null==e.control.value?null:e.control.value.length)),i.dc(2)}}function f(e,t){if(1&e&&(i.Yb(0,"fl-bit",6),i.Tb(1,"fl-icon",7),i.Yb(2,"fl-text",8),i.bd(3),i.Xb(),i.Xb()),2&e){const e=i.rc();i.Gb(1),i.zc("name","ui-warning-alt-v2")("color",e.IconColor.ERROR)("size",e.IconSize.XSMALL)("flMarginRight",e.Margin.XXSMALL),i.Gb(1),i.zc("color",e.FontColor.ERROR)("size",e.TextSize.XXSMALL),i.Gb(1),i.dd(" ",e.error," ")}}const p=function(e){return{IsInvalid:e}};let m=(()=>{class e{constructor(e){this.cd=e,this.FontColor=o.a,this.FontType=r.b,this.IconColor=l.c,this.IconSize=l.e,this.TextSize=r.f,this.Margin=a.a,this.textareaFocused=!1,this.borderless=!1,this.placeholder="",this.rows=2,this.inputBlur=new i.n,this.inputFocus=new i.n}set disabled(e){this.attrDisabled=!!e||void 0}ngOnInit(){this.errorSubscription=this.control.statusChanges.pipe(Object(c.a)(this.control.status)).subscribe(()=>{[this.error]=Object.values(this.control.errors||{}),this.cd.markForCheck()})}ngOnDestroy(){this.errorSubscription&&this.errorSubscription.unsubscribe()}handleBlur(){this.textareaFocused=!1,this.inputBlur.emit()}handleFocus(){this.textareaFocused=!this.textareaFocused,this.inputFocus.emit()}insertAtCursor(e,t={paddedWithSpaces:!1}){const n=this.control.value;if(n){const{selectionStart:i,selectionEnd:s}=this.controlValueAccessorDirective.getCursorSelectionPosition(),a=`${t.paddedWithSpaces&&0!==i&&!/\s/.test(n[i-1])?" ":""}${e}${t.paddedWithSpaces&&s!==n.length&&!/\s/.test(n[s])?" ":""}`;this.control.setValue(`${n.substring(0,i)}${a}${n.substring(s)}`),this.controlValueAccessorDirective.setCursorPosition(i+a.length)}else this.control.setValue(e),this.controlValueAccessorDirective.setCursorPosition(e.length)}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(i.h))},e.\u0275cmp=i.Mb({type:e,selectors:[["fl-textarea"]],viewQuery:function(e,t){if(1&e&&i.id(s.a,1),2&e){let e;i.Lc(e=i.oc())&&(t.controlValueAccessorDirective=e.first)}},inputs:{id:"id",control:"control",borderless:"borderless",placeholder:"placeholder",rows:"rows",maxCharacter:"maxCharacter",maxLength:"maxLength",disabled:"disabled"},outputs:{inputBlur:"inputBlur",inputFocus:"inputFocus"},decls:3,vars:13,consts:function(){let e;return e=" " + "\ufffd0\ufffd" + " ",[["flControlValueAccessor","",1,"TextArea",3,"formControl","ngClass","flMarginBottom","focus","blur"],["class","CountCharacterWrapper",4,"ngIf"],["class","ErrorContainer",4,"ngIf"],[1,"CountCharacterWrapper"],[1,"Counter",3,"ngClass","color","size","fontType"],e,[1,"ErrorContainer"],[1,"IconError",3,"name","color","size","flMarginRight"],[3,"color","size"]]},template:function(e,t){1&e&&(i.Yb(0,"textarea",0),i.nc("focus",function(){return t.handleFocus()})("blur",function(){return t.handleBlur()}),i.Xb(),i.Zc(1,b,3,7,"fl-bit",1),i.Zc(2,f,4,7,"fl-bit",2)),2&e&&(i.zc("formControl",t.control)("ngClass",i.Ec(11,p,t.control.invalid&&(t.control.touched||t.control.dirty)))("flMarginBottom",t.control.invalid&&(t.control.touched||t.control.dirty)?t.Margin.XXXSMALL:void 0),i.Hb("id",t.id)("data-borderless",t.borderless)("placeholder",t.placeholder)("maxlength",t.maxLength?t.maxLength:null)("rows",t.rows)("disabled",t.attrDisabled),i.Gb(1),i.zc("ngIf",void 0!==t.maxCharacter&&!(t.control.invalid&&(t.control.touched||t.control.dirty))),i.Gb(1),i.zc("ngIf",t.control.invalid&&(t.control.touched||t.control.dirty)))},directives:[d.c,s.a,d.k,d.o,d.g,h.o,a.b,h.q,g.a,r.e,l.d],styles:[".TextArea[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block}.TextArea[_ngcontent-%COMP%]{font-size:14px;line-height:1.43;align-items:center;background:#fff;border:1px solid #bec0c2;border-radius:0;color:#0e1724;max-height:inherit;padding:12px;resize:vertical;transition:all .2s ease-out;width:100%}.TextArea[_ngcontent-%COMP%]:-ms-input-placeholder{color:#75787d}.TextArea[_ngcontent-%COMP%]::placeholder{color:#75787d}.TextArea[_ngcontent-%COMP%]:focus, .TextArea[_ngcontent-%COMP%]:hover{border-color:#139ff0;color:#0e1724;outline:0}.TextArea[disabled][_ngcontent-%COMP%]{background:#f7f7f7;color:#0e1724;cursor:not-allowed}.TextArea.IsInvalid[_ngcontent-%COMP%]{border-color:#eb3730}.TextArea.IsInvalid[data-borderless=true][_ngcontent-%COMP%], .TextArea.IsInvalid[data-borderless=true][_ngcontent-%COMP%]:focus{border-bottom-color:#eb3730}.TextArea[data-borderless=true][_ngcontent-%COMP%]{background-color:transparent;border:1px solid transparent;padding-left:0;padding-right:0;transition:all .2s ease-out}.TextArea[data-borderless=true][_ngcontent-%COMP%]:focus{border-bottom-color:#139ff0}.TextArea[data-borderless=true][_ngcontent-%COMP%]:hover{box-shadow:none}.ErrorContainer[_ngcontent-%COMP%]{display:flex}.IconError[_ngcontent-%COMP%]{padding-top:4px}.CountCharacterWrapper[_ngcontent-%COMP%]{text-align:right}.Counter[_ngcontent-%COMP%]{opacity:0}.Counter.IsFocus[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0}),e})()},KHGu:function(e,t,n){"use strict";n.r(t),n.d(t,"MessagingRemoveUserModalModule",function(){return r});var i=n("SVse"),s=n("oA5+"),a=n("cokP"),o=n("8Y7J");let r=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.Qb({type:e}),e.\u0275inj=o.Pb({imports:[[s.a,i.c,a.a]]}),e})()},MmDv:function(e,t,n){"use strict";n.d(t,"a",function(){return p}),n.d(t,"b",function(){return m});var i=n("3f1L"),s=n("KPk5"),a=n("tsv4"),o=n("n0rP"),r=n("/uUt"),c=n("lJxs"),l=n("JX91"),d=n("b6KT");const h=(e,t)=>t===e.projectOwnerId,g=e=>"awarded"===e.awardStatus,u=e=>"pending"===e.awardStatus,b=(e,t,n)=>g(e)&&!h(e,t)&&!(e=>e.isInsourceProject)(n),f=e=>void 0===e.invalidTime&&void 0===e.timeTrackingStopped&&"automatic"===e.invoicePaymentMethod,p=["contest","hire","project","projectAdmin","userAdmin","recruiterSupportSession"];class m{constructor(e,t,n,i,s,a,o,r,c,l,d,h,g){this.auth=e,this.thread$=t,this.threadMembers$=n,this.project$=i,this.contest$=s,this.bids$=a,this.milestones$=o,this.milestoneRequests$=r,this.hourlyContracts$=c,this.agentSession$=l,this.team$=d,this.failedInvoices$=h,this.tracking=g}getState(){return Object(i.a)([this.auth.authState$,this.startWithUndefined(this.threadMembers$),this.thread$.pipe(Object(r.a)()),this.startWithUndefined(this.project$),this.startWithUndefined(this.contest$),this.startWithUndefined(this.bids$),this.startWithUndefined(this.milestones$),this.startWithUndefined(this.milestoneRequests$),this.startWithUndefined(this.hourlyContracts$),this.startWithUndefined(this.agentSession$),this.startWithUndefined(this.team$),this.startWithUndefined(this.failedInvoices$)]).pipe(Object(c.a)(e=>this.cleanState(e)),Object(c.a)(e=>this.getContextState(e,this.tracking)),Object(r.a)())}getContextState([e,t,n,i,o,r,c,l,p,m,M,C],S){if(!n||!e)return;const T=Number(e.userId),x=function(e,t,n){return n.filter(n=>n.bidderId===e||t.length<3&&t.includes(n.bidderId))[0]}(T,n.members,r||[]),y=t?t.find(t=>e&&t.id===T):void 0,I=t?t.find(t=>!(!e||t.id===T)):void 0,O=function(e,t,n){return n.filter(n=>n.bidderId===e||t.length<3&&t.includes(n.bidderId||-1))}(T,n.members,c||[]),A=function(e,t,n){return n.filter(n=>n.bidderId===e||t.length<3&&t.includes(n.bidderId||-1))}(T,n.members,l||[]);if(S&&S.trackCustomEvent("DebugMessagingRecruiter",void 0,{threadId:n.id,threadType:n.threadType,contextId:n.context.type!==a.ContextTypeApi.NONE?n.context.id:-1,contextType:n.contextType,isSupportUser:Object(d.f)(y).toString()}),I&&!(n.context.type===a.ContextTypeApi.TEAM||n.threadType===a.ThreadTypeApi.TEAM&&M&&T!==M.ownerUserId)){if((n.threadType===a.ThreadTypeApi.ADMIN_PREFERRED_CHAT||n.threadType===a.ThreadTypeApi.GROUP)&&n.context.type===a.ContextTypeApi.SUPPORT_SESSION&&t&&t.some(d.f))return Object(d.f)(y)?this.projectAdminLink(I,i,m):this.projectLink(I,i);if(o)return{name:"contest",linkText:o.title,linkUrl:`/${o.seoUrl}`,otherUserName:I.displayName,timeSubmitted:o.timeSubmitted,contextId:o.id};if(n.threadType&&n.threadType.toLowerCase()===a.ThreadTypeApi.GROUP)return this.projectLink(I,i);if(i&&"draft"===i.status)return this.projectLink(I,i);if(i&&i.projectCollaborations&&i.projectCollaborations.length&&(i.projectCollaborations.filter(e=>e.userId).map(e=>e.userId).includes(T)||i.projectCollaborations.filter(e=>e.userId).map(e=>e.userId).includes(I.id)))return this.projectLink(I,i);if("private_chat"!==n.threadType||i){if("primary"===n.threadType)return{name:"hireme",otherUserName:I.displayName,button:{data:{type:"LINK",buttonUrl:`/u/${I.username}`,buttonExtras:{queryParams:{hireme:!0}}},tag:"chatbox-hireme-button"}};if(void 0===x)return this.projectLink(I,i);if(((e,t)=>!g(e)&&!u(e)&&h(e,t))(x,T)&&i&&!i.hireme)return"hourly"===i.type?{name:"projectAwardHourly",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${i.seoUrl}`,buttonExtras:{queryParams:{awardBid:x.id}}},tag:"chatbox-award-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id}:{name:"projectAwardFixed",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"AWARD_FIXED",bidId:x.id,bidderId:x.bidderId,projectId:i.id},tag:"chatbox-award-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id};if(((e,t)=>!g(e)&&!(e=>"revoked"===e.awardStatus)(e)&&u(e)&&!h(e,t))(x,T)){if(i&&i.hireme&&i.isEscrowProject)return{name:"projectAcceptRedirect",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${i.seoUrl}`},tag:"chatbox-accept-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id};if(i&&"hourly"===i.type)return{name:"projectAcceptHourly",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"ACCEPT",projectId:i.id,bidId:x.id},tag:"chatbox-accept-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id};if(i)return{name:"projectAcceptFixed",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"ACCEPT",projectId:i.id,bidId:x.id},tag:"chatbox-accept-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id}}if((g(x)||u(x))&&h(x,T)&&y){if(i&&p&&p.length&&0===p.filter(f).length)return{name:"setupBilling",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${i.seoUrl}`},tag:"chatbox-billing-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id};if(i&&i.isEscrowProject&&!i.isInsourceProject)return{name:"milestoneCreateRedirect",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${i.seoUrl}`},tag:"chatbox-create-milestone-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id};if(i&&i.timeSubmitted>s.a&&C&&C.length>0)return{name:"payFailedInvoices",linkText:i.title,linkUrl:`projects/${i.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${i.seoUrl}/payments`},tag:"chatbox-redirect-payments-page"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id};if(i&&A.length>0&&!i.isInsourceProject)return{name:"milestoneCreateFromRequest",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"CREATE_MILESTONE",projectId:i.id,bidderId:x.bidderId,bidId:x.id,employerUsername:y.username,currencyDetails:i.currency},tag:"chatbox-create-milestone-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id};if(0===O.length&&i&&!i.isInsourceProject)return{name:"milestoneCreateInitial",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"CREATE_MILESTONE",projectId:i.id,bidderId:x.bidderId,bidId:x.id,employerUsername:y.username,currencyDetails:i.currency},tag:"chatbox-create-milestone-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id};if(i&&!i.isInsourceProject)return{name:"milestoneCreate",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"CREATE_MILESTONE",projectId:i.id,bidderId:x.bidderId,bidId:x.id,employerUsername:y.username,currencyDetails:i.currency},tag:"chatbox-create-milestone-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id}}return i&&!i.local&&p&&!h(x,T)&&void 0!==x.timeAccepted&&p.filter(f).length>0?{name:"trackTime",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${i.seoUrl}/tracking`,buttonExtras:{fragment:`timetracker-${x.id}-invoice-0`}},tag:"chatbox-track-time-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id}:i&&i.isEscrowProject&&b(x,T,i)?{name:"requestMilestoneRedirect",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"LINK",buttonUrl:`/projects/${i.seoUrl}`},tag:"chatbox-request-milestone-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id}:i&&b(x,T,i)?{name:"requestMilestone",linkText:i.title,linkUrl:`/projects/${i.seoUrl}`,button:{data:{type:"REQUEST_MILESTONE",bidId:x.id,projectId:i.id,employerUsername:I.displayName,currencyDetails:i.currency,bidderId:x.bidderId},tag:"chatbox-request-milestone-button"},otherUserName:I.displayName,timeSubmitted:i.timeSubmitted,contextId:i.id}:this.projectLink(I,i)}}}projectLink(e,t){if(t)return{name:"project",linkText:t.title,linkUrl:`/projects/${t.seoUrl}`,otherUserName:e.displayName,timeSubmitted:t.timeSubmitted,contextId:t.id}}projectAdminLink(e,t,n){return t?{name:"projectAdmin",linkUrl:"/admin/projects/properties.php",linkText:t.title,linkQueryParams:{id:t.id},otherUserName:e.displayName,timeSubmitted:t.timeSubmitted,contextId:t.id}:!t&&n&&n.sessionSourceType===o.SourceTypeApi.PROJECT?{name:"projectAdmin",linkUrl:"/admin/projects/properties.php",linkText:"Deleted project",linkQueryParams:{id:n.sessionSourceId},otherUserName:e.displayName,timeSubmitted:0}:!t&&n&&n.sessionSourceType===o.SourceTypeApi.USER?{name:"userAdmin",linkUrl:"/admin/users/properties.php",linkText:"View user",linkQueryParams:{id:n.sessionSourceId},otherUserName:e.displayName,timeSubmitted:0}:void 0}cleanState([e,t,n,i,s,r,c,l,d,h,g,u]){const b=i&&(n.context.type===a.ContextTypeApi.PROJECT&&n.context.id===i.id||h&&n.context.type===a.ContextTypeApi.SUPPORT_SESSION&&n.context.id===h.sessionId&&h.sessionSourceType===o.SourceTypeApi.PROJECT&&h.sessionSourceId===i.id),f="contest"===n.context.type&&s&&n.context.id===s.id,p=i&&"hourly"===i.type,m=h&&n.context.type===a.ContextTypeApi.SUPPORT_SESSION&&n.context.id===h.sessionId,M=u&&i&&u.every(e=>e.projectId===i.id);return[e,t,n,b?i:void 0,f?s:void 0,b?r:void 0,b?c:void 0,b?l:void 0,b&&p?d:void 0,m?h:void 0,g,M?u:void 0]}startWithUndefined(e){return e.pipe(Object(l.a)(void 0),Object(r.a)())}}},Np1b:function(e,t,n){"use strict";n.d(t,"b",function(){return V}),n.d(t,"a",function(){return Z});var i=n("8Y7J"),s=n("s7LF"),a=n("97vJ"),o=n("jnZY"),r=n("fVXH"),c=n("riYv"),l=n("etQe"),d=n("UlxN"),h=n("os2j"),g=n("fYbj"),u=n("4ykm"),b=n("f6cb"),f=n("tsv4"),p=n("2Vo4"),m=n("itXk"),M=n("LRne"),C=n("05l1"),S=n("x+ZX"),T=n("lJxs"),x=n("/uUt"),y=n("pLZG"),I=n("vkgz"),O=n("JX91"),A=n("zp1y"),v=n("5+tZ"),w=n("NJ9Y"),E=n("b6KT"),z=n("5f+h"),L=n("eCtd"),k=n("w792"),P=n("HEOu"),_=n("KrVf"),R=n("3A0Z"),j=n("YFxV"),U=n("DsW6");const B=["fileSelect"];function $(e,t){1&e&&(i.Yb(0,"fl-bit",9),i.Tb(1,"fl-spinner",10),i.Xb())}function G(e,t){1&e&&i.Tb(0,"app-messaging-message-list-empty")}function F(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-message-list",14,15),i.nc("loadMoreMessage",function(){return i.Pc(e),i.rc(3).loadMoreMessage()})("resendMessage",function(n){i.Pc(e);const s=t.ngIf;return i.rc(3).resendMessage(n,s.loggedInUser,s.threadIdentifier)})("viewAttachment",function(t){return i.Pc(e),i.rc(3).viewAttachment(t)}),i.sc(2,"flAsync"),i.sc(3,"flAsync"),i.sc(4,"flAsync"),i.sc(5,"flAsync"),i.sc(6,"flAsync"),i.sc(7,"flAsync"),i.sc(8,"flAsync"),i.sc(9,"flAsync"),i.sc(10,"flAsync"),i.Xb()}if(2&e){const e=i.rc(3);let t=null,n=null;i.zc("isGroupChat",(null==(t=i.tc(2,10,e.thread$))?null:t.threadType)===e.ThreadTypeApi.GROUP)("chatboxMode",e.chatboxMode)("loading",i.tc(3,12,e.messageListLoading$))("loggedInUser",i.tc(4,14,e.loggedInUser$))("messages",i.tc(5,16,e.sortedMessages$))("userReadTimes",null==(n=i.tc(6,18,e.thread$))?null:n.userReadTimes)("showLoadMore",i.tc(7,20,e.canLoadMoreMessages$))("thread",i.tc(8,22,e.thread$))("usersIsOnlineMap",i.tc(9,24,e.chatMembersIsOnlineMap$))("usersMap",i.tc(10,26,e.chatMembersMap$))}}const D=function(e,t){return{threadIdentifier:e,loggedInUser:t}};function N(e,t){if(1&e&&(i.Zc(0,F,11,28,"app-messaging-message-list",13),i.sc(1,"flAsync"),i.sc(2,"flAsync")),2&e){const e=i.rc(2);i.zc("ngIf",i.Fc(5,D,i.tc(1,1,e.threadIdentifier$),i.tc(2,3,e.loggedInUser$)))}}function X(e,t){if(1&e&&(i.Zc(0,G,1,0,"app-messaging-message-list-empty",11),i.sc(1,"flAsync"),i.Zc(2,N,3,8,"ng-template",null,12,i.ad)),2&e){const e=i.Mc(3),t=i.rc();let n=null;i.zc("ngIf",0===(null==(n=i.tc(1,2,t.sortedMessages$))?null:n.length))("ngIfElse",e)}}function Y(e,t){if(1&e){const e=i.Zb();i.Wb(0),i.Yb(1,"app-messaging-attachment-list",16),i.nc("removeAttachment",function(t){return i.Pc(e),i.rc().removeFile(t)})("successfulUpload",function(t){return i.Pc(e),i.rc().removeFile(t)})("retryUpload",function(t){return i.Pc(e),i.rc().retryUploadFile(t)}),i.sc(2,"flAsync"),i.Xb(),i.Tb(3,"fl-hr"),i.Vb()}if(2&e){const e=i.rc();i.Gb(1),i.zc("chatboxMode",e.chatboxMode)("fileAttachmentMap",i.tc(2,2,e.fileAttachmentMapping$))}}var H=function(e){return e[e.LOAD_THREAD=0]="LOAD_THREAD",e[e.LOAD_MORE_MESSAGES=1]="LOAD_MORE_MESSAGES",e}({}),V=function(e){return e[e.GENERIC_ERROR=0]="GENERIC_ERROR",e[e.ATTACHMENT_WITH_NO_MESSSAGE=1]="ATTACHMENT_WITH_NO_MESSSAGE",e[e.USER_NOT_ALLOWED=2]="USER_NOT_ALLOWED",e}({});let Z=(()=>{class e{constructor(e,t,n,s,a,o,r){this.datastore=e,this.featureFlagService=t,this.fileStorage=n,this.modalService=s,this.timeUtils=a,this.tracking=o,this.webSocketService=r,this.ThreadLoadingState=H,this.ThreadTypeApi=f.ThreadTypeApi,this.chatboxMode=!1,this.usersTyping=new i.n,this.previewModalOpen=new i.n,this.previewModalClose=new i.n,this.MESSAGE_LIST_INCREMENT=50,this.MESSAGE_LIST_LIMIT_MAX=5e3,this.messageLimit=this.MESSAGE_LIST_INCREMENT,this._messagesLimitSubject$=new p.a(this.MESSAGE_LIST_INCREMENT),this.messagesLimit$=this._messagesLimitSubject$.asObservable(),this._loadingStateSubject$=new p.a(H.LOAD_THREAD),this.loadingState$=this._loadingStateSubject$.asObservable(),this._fileAttachmentMappingSubject$=new p.a({}),this.fileAttachmentMapping$=this._fileAttachmentMappingSubject$.asObservable(),this._isFileAttachmentMappingEmptySubject$=new p.a(!0),this.isFileAttachmentMappingEmpty$=this._isFileAttachmentMappingEmptySubject$.asObservable(),this.messageSendQueue=[],this._messageSendQueueSubject$=new p.a([]),this.messageSendQueue$=this._messageSendQueueSubject$.asObservable().pipe(Object(C.a)(1),Object(S.a)()),this.messageErrorQueue=[],this._messageErrorQueueSubject$=new p.a([]),this.messageErrorQueue$=this._messageErrorQueueSubject$.asObservable().pipe(Object(C.a)(1),Object(S.a)()),this._usersTypingSubject$=new p.a({}),this.usersTypingMap$=this._usersTypingSubject$.asObservable(),this._threadErrorTypeSubject$=new p.a(void 0),this.threadErrorType$=this._threadErrorTypeSubject$.asObservable(),this._sendMessageErrorSubject$=new p.a(void 0),this.sendMessageError$=this._sendMessageErrorSubject$.asObservable()}ngOnInit(){this._allChatMembersSubject$=new p.a(this.allChatMembers),this.allChatMembers$=this._allChatMembersSubject$.asObservable(),this._loggedInUserSubject$=new p.a(this.loggedInUser),this.loggedInUser$=this._loggedInUserSubject$.asObservable(),this._membersActivityStatusSubject$=new p.a(this.membersActivityStatus),this.membersActivityStatus$=this._membersActivityStatusSubject$.asObservable(),this._threadSubject$=new p.a(this.thread),this.thread$=this._threadSubject$.asObservable(),this._threadIdentifierSubject$=new p.a(this.threadIdentifier),this.threadIdentifier$=this._threadIdentifierSubject$.asObservable();const e=this.thread$.pipe(Object(T.a)(e=>e.id),Object(x.a)());this.threadIdSubscription=e.subscribe(()=>{this.clearErrors()});const t=this.datastore.collection("messages",e=>this.thread$.pipe(Object(y.a)(e=>!e.isFake&&e.id>0),Object(T.a)(e=>e.id),Object(x.a)(),Object(I.a)(()=>{this._loadingStateSubject$.next(H.LOAD_THREAD),this.messageLimit=this.MESSAGE_LIST_INCREMENT,this._messagesLimitSubject$.next(this.messageLimit)}),Object(T.a)(t=>e.where("threadId","==",t).limit(this.messagesLimit$.pipe(Object(T.a)(e=>Math.min(e+1,this.MESSAGE_LIST_LIMIT_MAX))))))),n=t.valueChanges();this.messageListLoading$=t.status$.pipe(Object(T.a)(e=>!e.ready)),this.canLoadMoreMessages$=m.a([n,this.messagesLimit$]).pipe(Object(T.a)(([e,t])=>e.length>t&&e.length<this.MESSAGE_LIST_LIMIT_MAX)),this.sortedMessages$=m.a([n.pipe(Object(a.a)()),this.messageSendQueue$,this.messageErrorQueue$,this.thread$]).pipe(Object(T.a)(([e,t,n,i])=>{const s=n.filter(e=>e.threadId===i.id),a=new Set(e.map(e=>e.clientMessageId)),[o,r]=Object(b.q)(s,e=>a.has(e.clientMessageId));o.length>0&&(this.messageErrorQueue=[...r],this._messageErrorQueueSubject$.next(this.messageErrorQueue));const c={},l=[...e,...r].sort((e,t)=>e.timeCreated===t.timeCreated?e.id-t.id:e.timeCreated-t.timeCreated).reduceRight((e,t)=>{const n=JSON.parse(JSON.stringify(t));return n.richMessage&&(c[n.richMessage.category]&&(n.richMessage.disabled=!0),c[n.richMessage.category]=!0),[n,...e]},[]),d=new Set(l.map(e=>e.clientMessageId)),h=t.filter(e=>!d.has(e.clientMessageId));return[...l,...h]})),this.chatMembersMap$=this.allChatMembers$.pipe(Object(y.a)(b.h),Object(o.a)(),Object(O.a)({})),this.chatMembersIsOnlineMap$=this.membersActivityStatus$.pipe(Object(y.a)(b.h),Object(T.a)(e=>{const t={};return e.forEach(e=>t[e.id]=e.status===c.OnlineOfflineStatusApi.ONLINE),t}),Object(O.a)({})),this.filesSelectControl=new s.f([]),this.filesSelectControlSubscription$=this.filesSelectControl.valueChanges.subscribe(e=>{e.forEach(e=>{if(!Object.keys(this._fileAttachmentMappingSubject$.value).map(e=>e.slice(e.indexOf("_")+1)).some(t=>t===`${e.name}_${e.size}_${e.lastModified}`)){const t=this.getFileAttachmentKey(e),n=Object(g.i)(e.name)?this.fileSelect.readFileAsDataURL(e).pipe(Object(C.a)(1),Object(S.a)()):M.a("");this._fileAttachmentMappingSubject$.next(Object.assign(Object.assign({},this._fileAttachmentMappingSubject$.value),{[t]:{file:e,previewUrl$:n}})),this._isFileAttachmentMappingEmptySubject$.next(!1)}}),this.filesSelectControl.setValue([],{emitEvent:!1})});const i=this.featureFlagService.getFlag(d.b.FILEUPLOAD);this.filesSelectToggleSubscription$=m.a([this.messageListLoading$,this.loadingState$,i,this.thread$]).subscribe(([e,t,n,i])=>{!n||t!==H.LOAD_MORE_MESSAGES&&e||!this.isLoggedInUserSupportAgent&&("none"===i.writePrivacy||i.isBlocked)?this.filesSelectControl.disable():this.filesSelectControl.enable()}),this.typingSubscription=this.webSocketService.fromServerStream$.pipe(Object(y.a)(r.a),Object(A.a)(this.thread$),Object(y.a)(([e,t])=>"messages"===e.body.parent_type&&"typing"===e.body.type&&e.body.data.thread===t.id),Object(T.a)(([e,t])=>e),Object(A.a)(this.sortedMessages$.pipe(Object(T.a)(e=>e.filter(e=>e.sendStatus===l.a.SENT))),this.thread$.pipe(Object(T.a)(e=>e.userReadTimes)))).subscribe(([e,t,n])=>{const i=Object(b.s)(e.body.data.from_user),s=t.pop(),a=!!s&&n[i]>=s.timeCreated&&(s.fromUser!==i||1e3*e.body.timestamp>s.timeCreated);this._usersTypingSubject$.next(Object.assign(Object.assign({},this._usersTypingSubject$.value),{[i]:a})),this.timeUtils.setTimeout(()=>{this._usersTypingSubject$.next(Object.assign(Object.assign({},this._usersTypingSubject$.value),{[i]:!1}))},z.b)}),this.usersTyping$=m.a([this.usersTypingMap$,this.chatMembersMap$]).pipe(Object(T.a)(([e,t])=>Object.entries(e).filter(([e,t])=>!!t).map(([e,n])=>t[Object(b.s)(e)]))),this.hasUnsentAttachments$=this.fileAttachmentMapping$.pipe(Object(T.a)(e=>Object.entries(e).some(([e,t])=>!t.uploadTask)),Object(O.a)(!1))}ngOnChanges(e){var t,n,i,s,a;e.allChatMembers&&(null===(t=this._allChatMembersSubject$)||void 0===t||t.next(e.allChatMembers.currentValue)),e.loggedInUser&&(null===(n=this._loggedInUserSubject$)||void 0===n||n.next(e.loggedInUser.currentValue)),e.membersActivityStatus&&(null===(i=this._membersActivityStatusSubject$)||void 0===i||i.next(e.membersActivityStatus.currentValue)),e.thread&&(null===(s=this._threadSubject$)||void 0===s||s.next(e.thread.currentValue)),e.threadIdentifier&&(null===(a=this._threadIdentifierSubject$)||void 0===a||a.next(e.threadIdentifier.currentValue))}loadMoreMessage(){this._loadingStateSubject$.next(H.LOAD_MORE_MESSAGES),this.messageLimit=Math.min(this.messageLimit+this.MESSAGE_LIST_INCREMENT,this.MESSAGE_LIST_LIMIT_MAX),this._messagesLimitSubject$.next(this.messageLimit)}openFileSelect(){this.fileSelect&&this.fileSelect.triggerInput()}addFile(e){this.filesSelectControl.setValue([...this.filesSelectControl.value,e])}removeFile(e){var t;const n=this._fileAttachmentMappingSubject$.value;e in n&&(null===(t=n[e].uploadTask)||void 0===t||t.cancel(),delete n[e],this._fileAttachmentMappingSubject$.next(n)),this.isAttachmentListEmpty()&&(this._fileAttachmentMappingSubject$.next({}),this._isFileAttachmentMappingEmptySubject$.next(!0))}viewAttachment({messageId:e,name:t,type:n}){const i=this.modalService.open("FileViewerModal",{inputs:{messageId:e,filename:t,filetype:n},edgeToEdge:!0,size:u.a.XLARGE});i.afterOpen().toPromise().then(e=>setTimeout(()=>this.previewModalOpen.emit())),i.afterClosed().toPromise().then(()=>{this.previewModalClose.emit(),this.tracking.track("user_action",{section:"messaging_image_viewer",subsection:"header",label:"close_image_viewer"})})}resendMessage(e,t,n){t&&n&&(this.messageErrorQueue=this.messageErrorQueue.filter(t=>t.clientMessageId!==e.clientMessageId),this._messageErrorQueueSubject$.next(this.messageErrorQueue),this.enqueueMessage({message:e.message,sender:t,threadIdentifier:n}))}enqueueMessage(e){const{message:t,threadIdentifier:n,sender:i}=e,s=Date.now(),a=!t||0===t.trim().length;n.isFake||this.sendFiles(n.id),n.isFake&&a?this._threadErrorTypeSubject$.next(V.ATTACHMENT_WITH_NO_MESSSAGE):a||(this.messageSendQueue=[...this.messageSendQueue,{attachments:[],clientMessageId:s,fromUser:i.id,id:s,message:t,messageSource:f.SourceTypeApi.CHAT_BOX,threadId:n.id,timeCreated:Date.now(),sendStatus:l.a.SENDING}],this._messageSendQueueSubject$.next(this.messageSendQueue),1===this.messageSendQueue.length&&this.sendQueuedMessage())}sendQueuedMessage(){if(0===this.messageSendQueue.length)return;const e=this.messageSendQueue[0];this.sendMessage(e).then(t=>{"success"!==t.status?("FORBIDDEN"===t.errorCode?this._threadErrorTypeSubject$.next(V.USER_NOT_ALLOWED):(this._sendMessageErrorSubject$.next(t),this._threadErrorTypeSubject$.next(V.GENERIC_ERROR)),this.messageErrorQueue=[...this.messageErrorQueue,Object.assign(Object.assign({},e),{timeCreated:Date.now(),sendStatus:l.a.FAILED})],this._messageErrorQueueSubject$.next(this.messageErrorQueue)):this.clearErrors(),this.messageSendQueue=this.messageSendQueue.slice(1),this._messageSendQueueSubject$.next(this.messageSendQueue),this.sendQueuedMessage()})}sendMessage(e){return M.a(e).pipe(Object(A.a)(this.thread$),Object(v.b)(([e,t])=>{if(!t.isFake)return this.datastore.collection("messages").push(e);const n=Object(E.b)(t,e.message,e.fromUser);return this.datastore.collection("threads").push(n).then(e=>("success"===e.status&&this.sendFiles(e.id),e))})).toPromise()}sendFiles(e){Object.entries(this._fileAttachmentMappingSubject$.value).forEach(([t,n])=>{if(!this._fileAttachmentMappingSubject$.value[t].uploadTask){const i=this.fileStorage.upload(h.a.MESSAGING_ATTACHMENTS,n.file,{customMetadata:{threadId:e.toString(),clientMessageId:Date.now().toString()}});this._fileAttachmentMappingSubject$.next(Object.assign(Object.assign({},this._fileAttachmentMappingSubject$.value),{[t]:Object.assign({uploadTask:i,uploadTaskEvent$:i.changes(),uploadPercentage$:i.percentageChanges()},this._fileAttachmentMappingSubject$.value[t])}))}})}retryUploadFile(e){var t;if(e in this._fileAttachmentMappingSubject$.value){const n=this._fileAttachmentMappingSubject$.value[e];null===(t=n.uploadTaskEvent$)||void 0===t||t.pipe(Object(w.a)(),Object(T.a)(e=>e.metadata)).subscribe(t=>{var i;const s=null===(i=t.customMetadata)||void 0===i?void 0:i.threadId;if(s){const t=this.fileStorage.upload(h.a.MESSAGING_ATTACHMENTS,n.file,{customMetadata:{threadId:s,clientMessageId:Date.now().toString()}});this._fileAttachmentMappingSubject$.next(Object.assign(Object.assign({},this._fileAttachmentMappingSubject$.value),{[e]:Object.assign(Object.assign({},n),{uploadTask:t,uploadTaskEvent$:t.changes(),uploadPercentage$:t.percentageChanges()})}))}}).unsubscribe()}}getFileAttachmentKey(e){return`${Date.now()}_${e.name}_${e.size}_${e.lastModified}`}handleUserTyping(e){this.datastore.collection("threads").update(e,{typing:!0}),this.usersTyping.emit()}isAttachmentListEmpty(){return 0===Object.keys(this._fileAttachmentMappingSubject$.value).length}clearErrors(){this._threadErrorTypeSubject$.next(void 0)}ngOnDestroy(){var e;this.filesSelectControlSubscription$&&this.filesSelectControlSubscription$.unsubscribe(),this.filesSelectToggleSubscription$&&this.filesSelectToggleSubscription$.unsubscribe(),this.typingSubscription&&this.typingSubscription.unsubscribe(),null===(e=this.threadIdSubscription)||void 0===e||e.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(L.a),i.Sb(P.a),i.Sb(_.a),i.Sb(R.b),i.Sb(j.a),i.Sb(U.a),i.Sb(k.a))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-thread-view"]],viewQuery:function(e,t){if(1&e&&i.id(B,1),2&e){let e;i.Lc(e=i.oc())&&(t.fileSelect=e.first)}},inputs:{allChatMembers:"allChatMembers",chatboxMode:"chatboxMode",loggedInUser:"loggedInUser",membersActivityStatus:"membersActivityStatus",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",thread:"thread",threadIdentifier:"threadIdentifier"},outputs:{usersTyping:"usersTyping",previewModalOpen:"previewModalOpen",previewModalClose:"previewModalClose"},features:[i.Eb],decls:22,vars:37,consts:[["flTrackingLabel","ThreadViewFileSelect",1,"ThreadView-fileSelect",3,"control","multiple"],["fileSelect",""],["class","ThreadView-loading",4,"ngIf","ngIfElse"],["loadedState",""],[1,"ThreadView-typingBoxArea"],[3,"usersTyping"],[4,"ngIf"],[3,"errorType","errorObject","clearErrors"],[3,"enableFileUpload","hasAttachments","isThreadBlocked","isBlockedByLoggedInUser","isLoggedInUserSupportAgent","loggedInUser","threadIdentifier","userTyping","addFile","openFileSelect","sendMessage"],[1,"ThreadView-loading"],["flTrackingLabel","MessageListLoading"],[4,"ngIf","ngIfElse"],["nonEmptyMessageList",""],[3,"isGroupChat","chatboxMode","loading","loggedInUser","messages","userReadTimes","showLoadMore","thread","usersIsOnlineMap","usersMap","loadMoreMessage","resendMessage","viewAttachment",4,"ngIf"],[3,"isGroupChat","chatboxMode","loading","loggedInUser","messages","userReadTimes","showLoadMore","thread","usersIsOnlineMap","usersMap","loadMoreMessage","resendMessage","viewAttachment"],["messageList",""],[3,"chatboxMode","fileAttachmentMap","removeAttachment","successfulUpload","retryUpload"]],template:function(e,t){if(1&e&&(i.Yb(0,"fl-file-select",0,1),i.Zc(2,$,2,0,"fl-bit",2),i.sc(3,"flAsync"),i.sc(4,"flAsync"),i.Zc(5,X,4,4,"ng-template",null,3,i.ad),i.Yb(7,"fl-bit",4),i.Tb(8,"app-messaging-typing-indicator",5),i.sc(9,"flAsync"),i.Tb(10,"fl-hr"),i.Zc(11,Y,4,4,"ng-container",6),i.sc(12,"flAsync"),i.Yb(13,"app-messaging-thread-view-errors",7),i.nc("clearErrors",function(){return t.clearErrors()}),i.sc(14,"flAsync"),i.sc(15,"flAsync"),i.Xb(),i.Yb(16,"app-messaging-typing-box",8),i.nc("userTyping",function(e){return t.handleUserTyping(e)})("addFile",function(e){return t.addFile(e)})("openFileSelect",function(){return t.openFileSelect()})("sendMessage",function(e){return t.enqueueMessage(e)}),i.sc(17,"flAsync"),i.sc(18,"flAsync"),i.sc(19,"flAsync"),i.sc(20,"flAsync"),i.sc(21,"flAsync"),i.Xb(),i.Xb(),i.Xb()),2&e){const e=i.Mc(6);let n=null,s=null;i.zc("control",t.filesSelectControl)("multiple",!0),i.Gb(2),i.zc("ngIf",i.tc(3,15,t.messageListLoading$)&&i.tc(4,17,t.loadingState$)===t.ThreadLoadingState.LOAD_THREAD)("ngIfElse",e),i.Gb(6),i.zc("usersTyping",i.tc(9,19,t.usersTyping$)),i.Gb(3),i.zc("ngIf",!i.tc(12,21,t.isFileAttachmentMappingEmpty$)),i.Gb(2),i.zc("errorType",i.tc(14,23,t.threadErrorType$))("errorObject",i.tc(15,25,t.sendMessageError$)),i.Gb(3),i.zc("enableFileUpload",!t.filesSelectControl.disabled)("hasAttachments",i.tc(17,27,t.hasUnsentAttachments$))("isThreadBlocked","none"===(null==(n=i.tc(18,29,t.thread$))?null:n.writePrivacy))("isBlockedByLoggedInUser",null==(s=i.tc(19,31,t.thread$))?null:s.isBlocked)("isLoggedInUserSupportAgent",t.isLoggedInUserSupportAgent)("loggedInUser",i.tc(20,33,t.loggedInUser$))("threadIdentifier",i.tc(21,35,t.threadIdentifier$))}},styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column}.ThreadView-fileSelect[_ngcontent-%COMP%]{height:100%}.ThreadView-loading[_ngcontent-%COMP%]{align-items:center;display:flex;height:100%;justify-content:center;width:100%}.ThreadView-typingBoxArea[_ngcontent-%COMP%]{flex:0 0 auto}"],changeDetection:0}),e})()},O3cg:function(e,t,n){"use strict";n.d(t,"a",function(){return p});var i=n("9u4R"),s=n("tqRt"),a=n("OpNG"),o=n("cUs2"),r=n("inQW");function c(){return{defaultOrder:{field:"id",direction:a.a.ASC},fetch:(e,t,n,i)=>({endpoint:"projects/0.1/milestone_requests",params:{bids:Object(o.h)(n,"bidId"),projects:Object(o.h)(n,"projectId"),statuses:Object(o.h)(n,"status"),bidders:Object(o.h)(n,"bidderId"),milestone_requests:t}}),push:(e,t)=>{var n;return{endpoint:"projects/0.1/milestone_requests",payload:{project_id:t.projectId,bid_id:t.bidId,description:t.description,amount:t.amount,is_initial_payment:null!==(n=t.isInitialPayment)&&void 0!==n&&n}}},set:void 0,update:(e,t,n)=>{let i,s,a="PUT",o=!1,r=!1;if(n.projectId&&n.bidId&&t.description&&t.amount){if(i)throw new Error("Cannot update two requests at once");s="payment/onRequestMilestone.php",i={projectId:n.projectId,bidId:n.bidId,id:n.id,description:t.description,amount:t.amount},a="POST",o=!0,r=!0}if(t.action){if(i)throw new Error("Cannot update two requests at once");s=`projects/0.1/milestone_requests/${n.id}`,i={action:t.action},a="PUT"}if(void 0===i||void 0===s||void 0===o||void 0===r)throw new Error("Could not update due to missing field(s)");return{asFormData:r,payload:i,endpoint:s,method:a,isGaf:o}},remove:(e,t,n)=>({payload:{action:r.a.DELETE},endpoint:`projects/0.1/milestone_requests/${t}`,method:"PUT"})}}var l=n("f6cb"),d=n("ueDg"),h=n("e+HA");function g(e){if(!e.project_id)throw Error("Milestone request doesn't have a project ID.");if(!e.bidder_id||!e.bid_id||!e.amount)throw Error("Milestone request is missing a required field.");return{id:e.id||Math.random(),bidderId:e.bidder_id,bidId:e.bid_id,timeRequested:e.time_requested?1e3*e.time_requested:void 0,amount:e.amount,projectOwnerId:e.project_owner_id,projectId:e.project_id,description:e.description,currency:e.currency?Object(h.a)(e.currency):void 0,status:e.status,requesterId:e.requester_id,isInitialPayment:e.is_initial_payment}}function u(e){return{id:Object(l.s)(e.data.requestId),bidderId:Object(l.s)(e.data.sellerId),bidId:Object(l.s)(e.data.bidId),timeRequested:1e3*e.timestamp,amount:Object(l.s)(e.data.amount),projectOwnerId:Object(l.s)(e.data.accountId),projectId:Object(l.s)(e.data.id),description:e.data.description,currency:{code:e.data.currencyCode,id:Object(l.s)(e.data.currencyId),sign:e.data.currencySign},status:d.MilestoneRequestStatusApi.PENDING}}function b(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("milestoneRequests"===t.payload.type){const{result:n,ref:i,order:s}=t.payload;return Object(o.o)(e,Object(o.z)(n.milestone_requests,g),s,i)}return e;case"API_UPDATE_SUCCESS":if("milestoneRequests"===t.payload.type){const{delta:n,originalDocument:i,ref:s}=t.payload;return Object(o.A)(e,[i.id],e=>n.action===r.a.REJECT?Object(a.e)(e,Object.assign(Object.assign({},n),{status:d.MilestoneRequestStatusApi.REJECTED})):Object(a.e)(e,n),s)}return e;case"API_PUSH_SUCCESS":if("milestoneRequests"===t.payload.type){const{ref:n,result:i}=t.payload;return Object(o.q)(e,Object(o.z)([i],g),n)}return e;case"API_DELETE_SUCCESS":if("milestoneRequests"===t.payload.type){const{originalDocument:n,ref:i}=t.payload;return Object(o.u)(i,e,n.id)}return e;case"WS_MESSAGE":if("notifications"===t.payload.parent_type){const n={path:{collection:"milestoneRequests",authUid:t.payload.toUserId}};switch(t.payload.type){case"requestMilestone":return Object(o.b)(e,[t.payload],u,n);case"createMilestone":{const i=Object(l.s)(t.payload.data.created_milestone_request_id);return i?Object(o.A)(e,[i],e=>Object.assign(Object.assign({},e),{status:d.MilestoneRequestStatusApi.CREATED}),n):e}default:return e}}return e;default:return e}}var f=n("8Y7J");let p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f.Qb({type:e}),e.\u0275inj=f.Pb({imports:[[s.j.forFeature("milestoneRequests",b),i.d.forFeature("milestoneRequests",c)]]}),e})()},QrFh:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n("s7LF"),s=n("f6cb"),a=n("8Y7J"),o=n("YFxV");let r=(()=>{class e extends i.c{constructor(e,t,n,i){super(n,e,i),this.elementRef=e,this.timeUtils=t}writeValue(e){super.writeValue(e),this.timeUtils.setTimeout(()=>{if(!Object(s.h)(this.offset))return;const{nativeElement:e}=this.elementRef;e.focus(),e.setSelectionRange(this.offset,this.offset)})}setCursorPosition(e){this.offset=e}getCursorSelectionPosition(){const{nativeElement:e}=this.elementRef;return{selectionStart:e.selectionStart,selectionEnd:e.selectionEnd}}}return e.\u0275fac=function(t){return new(t||e)(a.Sb(a.l),a.Sb(o.a),a.Sb(a.G,4),a.Sb(i.a,8))},e.\u0275dir=a.Nb({type:e,selectors:[["","flControlValueAccessor",""]],features:[a.Fb([{provide:i.m,useExisting:e,multi:!0}]),a.Db]}),e})()},Uw4d:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var i=n("SVse"),s=n("s7LF"),a=n("oA5+"),o=n("18b0"),r=n("cokP"),c=n("8Y7J");let l=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.Qb({type:e}),e.\u0275inj=c.Pb({imports:[[i.c,r.a,a.a,o.a,s.j]]}),e})()},UztC:function(e,t,n){"use strict";n.d(t,"a",function(){return y});var i=n("UlxN"),s=n("B23V"),a=n("dO68"),o=n("MmDv"),r=n("8Y7J"),c=n("HEOu"),l=n("SVse"),d=n("w13q"),h=n("o9eT"),g=n("g6qU"),u=n("al+g");function b(e,t){1&e&&(r.Wb(0),r.cc(1,4),r.Vb())}function f(e,t){1&e&&(r.Wb(0),r.cc(1,5),r.Vb())}function p(e,t){1&e&&(r.Wb(0),r.cc(1,6),r.Vb())}function m(e,t){1&e&&(r.Wb(0),r.cc(1,7),r.Vb())}function M(e,t){1&e&&(r.Wb(0),r.cc(1,8),r.Vb())}function C(e,t){1&e&&(r.Wb(0),r.cc(1,9),r.Vb())}function S(e,t){1&e&&(r.Wb(0),r.cc(1,10),r.Vb())}function T(e,t){1&e&&(r.Wb(0),r.cc(1,11),r.Vb())}function x(e,t){if(1&e&&(r.Yb(0,"fl-bit",1),r.Yb(1,"fl-text"),r.Zc(2,b,2,0,"ng-container",2),r.Zc(3,f,2,0,"ng-container",2),r.Zc(4,p,2,0,"ng-container",2),r.Zc(5,m,2,0,"ng-container",2),r.Zc(6,M,2,0,"ng-container",2),r.Zc(7,C,2,0,"ng-container",2),r.Zc(8,S,2,0,"ng-container",2),r.Zc(9,T,2,0,"ng-container",2),r.Xb(),r.Tb(10,"app-messaging-context-button",3),r.Xb()),2&e){const e=r.rc();r.Gb(2),r.zc("ngIf","projectAwardHourly"===(null==e.contextBoxState?null:e.contextBoxState.name)||"projectAwardFixed"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","setupBilling"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","milestoneCreate"===(null==e.contextBoxState?null:e.contextBoxState.name)||"milestoneCreateFromRequest"===(null==e.contextBoxState?null:e.contextBoxState.name)||"milestoneCreateInitial"===(null==e.contextBoxState?null:e.contextBoxState.name)||"milestoneCreateRedirect"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","payFailedInvoices"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","hireme"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","projectAcceptHourly"===(null==e.contextBoxState?null:e.contextBoxState.name)||"projectAcceptFixed"===(null==e.contextBoxState?null:e.contextBoxState.name)||"projectAcceptRedirect"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","trackTime"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("ngIf","requestMilestone"===(null==e.contextBoxState?null:e.contextBoxState.name)||"requestMilestoneRedirect"===(null==e.contextBoxState?null:e.contextBoxState.name)),r.Gb(1),r.zc("contextBoxState",e.contextBoxState)}}let y=(()=>{class e{constructor(e){this.featureFlagService=e,this.ButtonColor=s.a,this.ButtonSize=a.a,this.NON_CTA_CONTEXT_BOX_STATE_NAME=o.a}ngOnInit(){this.billingEnabled$=this.featureFlagService.getFlag(i.b.BILLING)}}return e.\u0275fac=function(t){return new(t||e)(r.Sb(c.a))},e.\u0275cmp=r.Mb({type:e,selectors:[["app-messaging-context-box"]],inputs:{contextBoxState:"contextBoxState"},decls:2,vars:3,consts:function(){let e,t,n,i,s,a,o,r;return e=" Start working with this freelancer! ",t=" Set your billing for this project. ",n=" Set project deliverables. ",i=" This project has an outstanding bill. ",s=" I'm available. Let's work together! ",a=" This project has been awarded to you! ",o=" Make sure to track your progress. ",r=" Define your deliverables. ",[["class","ContextBox",4,"ngIf"],[1,"ContextBox"],[4,"ngIf"],[3,"contextBoxState"],e,t,n,i,s,a,o,r]},template:function(e,t){1&e&&(r.Zc(0,x,11,9,"fl-bit",0),r.sc(1,"flAsync")),2&e&&r.zc("ngIf",!!t.contextBoxState&&!t.NON_CTA_CONTEXT_BOX_STATE_NAME.includes(t.contextBoxState.name)&&("setupBilling"!==(null==t.contextBoxState?null:t.contextBoxState.name)||r.tc(1,1,t.billingEnabled$)))},directives:[l.q,d.a,h.e,g.a],pipes:[u.a],styles:[".ContextBox[_ngcontent-%COMP%]{align-items:center;background:#fff;border-bottom:1px solid #dedede;box-shadow:0 10px 10px -9px rgba(0,0,0,.12);display:flex;flex:0 0 48px;height:48px;justify-content:space-between;padding:0 8px;width:100%}"],changeDetection:0}),e})()},V1in:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n("8Y7J");let s=(()=>{class e{constructor(e){this.element=e,this.flAutoGrowMaxHeight=72,this.flAutoGrowMinHeight=48}ngOnInit(){this.valueChangeSubscription=this.flAutoGrow.valueChanges.subscribe(e=>this.adjust())}ngOnDestroy(){this.valueChangeSubscription&&this.valueChangeSubscription.unsubscribe()}adjust(){let e;if(this.element.nativeElement instanceof HTMLTextAreaElement)e=this.element.nativeElement;else{if("FL-TEXTAREA"!==this.element.nativeElement.tagName)throw new Error("Not supported element!");e=this.element.nativeElement.children.item(0)}e.style.overflow="hidden",e.style.height="auto",e.style.overflowY="auto",e.style.height=`${Math.max(this.flAutoGrowMinHeight,Math.min(e.scrollHeight,this.flAutoGrowMaxHeight))}px`,e.scrollHeight<this.flAutoGrowMaxHeight&&(e.style.overflow="hidden")}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(i.l))},e.\u0275dir=i.Nb({type:e,selectors:[["","flAutoGrow",""]],inputs:{flAutoGrow:"flAutoGrow",flAutoGrowMaxHeight:"flAutoGrowMaxHeight",flAutoGrowMinHeight:"flAutoGrowMinHeight"},exportAs:["autogrow"]}),e})()},VFv1:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("9u4R"),s=n("tqRt"),a=n("OpNG"),o=n("cUs2"),r=n("DXEH");function c(){return{defaultOrder:{field:"id",direction:a.a.DESC},fetch:(e,t,n,i)=>({endpoint:"projects/0.1/hourly_contracts",params:{project_ids:Object(o.h)(n,"projectId"),bidder_ids:Object(o.h)(n,"bidderId"),active:Object(o.h)(n,"active")[0]?"true":void 0}}),push:void 0,set:void 0,update:(e,t,n)=>{const i=`projects/0.1/hourly_contracts/${n.bidId}`;let s;if("timeTrackingStopped"in t?s=void 0===t.timeTrackingStopped?{action:r.HourlyContractActionApi.STOP_TIME_TRACKING}:{action:r.HourlyContractActionApi.ENABLE_TIME_TRACKING}:"currentWorkLimit"in t&&n.currentWorkLimit!==t.currentWorkLimit&&(s={action:r.HourlyContractActionApi.UPDATE,work_limit:t.currentWorkLimit}),void 0===s)throw new Error("Could not update due to missing payload");return{endpoint:i,payload:s,method:"PUT",asFormData:!0}},remove:void 0}}function l(e){if(!(e.id&&e.project_id&&e.bid_id&&e.billing_cycle&&e.invoice_payment_method))throw new ReferenceError("Missing a required hourly contract field.");if(e.billing_cycle!==r.HourlyContractBillingCycleApi.WEEKLY&&e.billing_cycle!==r.HourlyContractBillingCycleApi.MONTHLY)throw new ReferenceError("Billing Cycle must be monthly or weekly");return{id:e.id,projectId:e.project_id,bidId:e.bid_id,defaultHourlyRate:e.default_hourly_rate,defaultWorkLimit:e.default_work_limit,billingCycle:e.billing_cycle,invoicePaymentMethod:e.invoice_payment_method,currentHourlyRate:e.current_hourly_rate,currentWorkLimit:e.current_work_limit,timezone:e.timezone,bidderId:e.bidder_id,projectOwnerId:e.project_owner_id,invalidTime:e.invalid_time?1e3*e.invalid_time:void 0,timeTrackingStopped:e.time_tracking_stopped?1e3*e.time_tracking_stopped:void 0,invoiceId:e.invoice_id,active:!e.invalid_time}}function d(e){if(!(e.id&&e.project_id&&e.bid_id&&e.billing_cycle&&e.invoice_payment_method))throw new ReferenceError("Missing a required hourly contract field.");if(e.billing_cycle!==r.HourlyContractBillingCycleApi.WEEKLY&&e.billing_cycle!==r.HourlyContractBillingCycleApi.MONTHLY)throw new ReferenceError("Billing Cycle must be monthly or weekly");return{id:e.id,projectId:e.project_id,bidId:e.bid_id,defaultHourlyRate:e.default_hourly_rate||void 0,defaultWorkLimit:e.default_work_limit||void 0,billingCycle:e.billing_cycle,invoicePaymentMethod:e.invoice_payment_method,currentHourlyRate:e.current_hourly_rate||void 0,currentWorkLimit:e.current_work_limit||void 0,timezone:e.timezone?{id:e.timezone.id||void 0,country:e.timezone.country||void 0,timezone:e.timezone.timezone||void 0,offset:e.timezone.offset||void 0}:void 0,bidderId:e.bidder_id||void 0,projectOwnerId:e.project_owner_id||void 0,invalidTime:e.invalid_time?1e3*e.invalid_time:void 0,timeTrackingStopped:e.time_tracking_stopped?1e3*e.time_tracking_stopped:void 0,invoiceId:e.invoice_id||void 0,active:!e.invalid_time}}function h(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("hourlyContracts"===t.payload.type){const{result:n,ref:i,order:s}=t.payload;return Object(o.o)(e,Object(o.z)(n.hourly_contracts,l),s,i)}return e;case"API_UPDATE_SUCCESS":{const{result:n}=t.payload;if(("bids"===t.payload.type||"projectViewBids"===t.payload.type)&&n&&"hourly_contract"in n&&n.hourly_contract){const i={path:{collection:"hourlyContracts",authUid:t.payload.ref.path.authUid}};return Object(o.q)(e,Object(o.z)([n.hourly_contract],l),i)}if("hourlyContracts"===t.payload.type){const{result:n,ref:i}=t.payload;return Object(o.q)(e,Object(o.z)([n],l),i)}return e}case"WS_MESSAGE":{const n={path:{collection:"hourlyContracts",authUid:t.payload.toUserId}};if("notifications"===t.payload.parent_type)switch(t.payload.type){case"hourlyContractUpdate":return Object(o.q)(e,Object(o.z)([t.payload.data.hourlyContract],d),n);default:return e}return e}default:return e}}var g=n("8Y7J");let u=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.Qb({type:e}),e.\u0275inj=g.Pb({imports:[[s.j.forFeature("hourlyContracts",h),i.d.forFeature("hourlyContracts",c)]]}),e})()},WDoz:function(e,t,n){"use strict";n.d(t,"a",function(){return ee});var i=n("8Y7J"),s=n("3f1L"),a=n("97vJ"),o=n("riYv"),r=n("UlxN"),c=n("f6cb"),l=n("tsv4"),d=n("DXEH"),h=n("ueDg"),g=n("n0rP"),u=n("2Vo4"),b=n("itXk"),f=n("VRyK"),p=n("LRne"),m=n("lJxs"),M=n("pLZG"),C=n("JX91"),S=n("/uUt"),T=n("05l1"),x=n("x+ZX"),y=n("zp1y"),I=n("puO/"),O=n("MmDv"),A=function(e){return e[e.ADD=0]="ADD",e[e.REMOVE=1]="REMOVE",e}({}),v=n("/wLE"),w=n("eCtd"),E=n("HEOu"),z=n("L1P6"),L=n("LE8X"),k=n("tbiQ"),P=n("SVse"),_=n("4ykm"),R=n("yvyY"),j=n("3A0Z"),U=n("w13q"),B=n("KUXl"),$=n("1YM7"),G=n("SMHo"),F=n("UztC"),D=n("Np1b"),N=n("3bYl"),X=n("NtPp"),Y=n("23iI");const H=["chatOptionsDrawer"];function V(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-view-header",11),i.Yb(1,"app-messaging-header",12),i.nc("makingCall",function(t){return i.Pc(e),i.rc().makingCall.emit(t)})("showChatDetails",function(){return i.Pc(e),i.rc().toggleSidebar()}),i.Xb(),i.Xb()}if(2&e){const e=i.rc();i.zc("sideNotch",!1)("showMenu",!1),i.Gb(1),i.zc("callsEnabled",e.callsEnabled)("chatboxMode",!1)("contextBoxState",e.contextBoxState)("loggedInUser",e.loggedInUser)("membersActivityStatus",e.membersActivityStatus)("mobileMode",!0)("otherMembers",e.activeOtherMembers)("supportAgent",e.supportAgent)("thread",e.thread)}}function Z(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-chat-details",13),i.nc("makingCall",function(t){return i.Pc(e),i.rc().makingCall.emit(t)})("loadMoreAttachments",function(){return i.Pc(e),i.rc().loadMoreAttachments.emit()})("resetAttachmentsLimit",function(){return i.Pc(e),i.rc().resetAttachmentsLimit.emit()})("removeMember",function(t){return i.Pc(e),i.rc().openRemoveUserModal(t)})("showAddPeopleScreen",function(){return i.Pc(e),i.rc().openAddPeopleModal()})("showAllMembers",function(){return i.Pc(e),i.rc().openAllMembersModal()}),i.Xb()}if(2&e){const e=i.rc();i.zc("flShowDesktop",!0)("attachments",e.attachments)("attachmentsFetchStatus",e.attachmentsFetchStatus)("callsEnabled",e.callsEnabled)("canUserManageThreadMembers",e.canUserManageThreadMembers)("chatboxMode",!1)("contextBoxState",e.contextBoxState)("hasMoreAttachments",e.hasMoreAttachments)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("isLoggedInUserThreadOwner",e.isLoggedInUserThreadOwner)("isReportSettingEnabled",e.isReportSettingEnabled)("loggedInUser",e.loggedInUser)("otherMembers",e.activeOtherMembers)("supportAgent",e.supportAgent)("team",e.team)("thread",e.thread)("threadBidders",e.threadBidders)("threadCollaborators",e.threadCollaborators)("threadContacts",e.threadContacts)}}function W(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-chat-details",14),i.nc("makingCall",function(t){return i.Pc(e),i.rc().makingCall.emit(t)})("loadMoreAttachments",function(){return i.Pc(e),i.rc().loadMoreAttachments.emit()})("resetAttachmentsLimit",function(){return i.Pc(e),i.rc().resetAttachmentsLimit.emit()})("removeMember",function(t){return i.Pc(e),i.rc().openRemoveUserModal(t)})("showAddPeopleScreen",function(){return i.Pc(e),i.rc().openAddPeopleModal()})("showAllMembers",function(){return i.Pc(e),i.rc().openAllMembersModal()}),i.Xb()}if(2&e){const e=i.rc();i.zc("attachments",e.attachments)("attachmentsFetchStatus",e.attachmentsFetchStatus)("callsEnabled",e.callsEnabled)("canUserManageThreadMembers",e.canUserManageThreadMembers)("chatboxMode",!1)("contextBoxState",e.contextBoxState)("hasMoreAttachments",e.hasMoreAttachments)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("isLoggedInUserThreadOwner",e.isLoggedInUserThreadOwner)("isReportSettingEnabled",e.isReportSettingEnabled)("loggedInUser",e.loggedInUser)("otherMembers",e.activeOtherMembers)("supportAgent",e.supportAgent)("team",e.team)("thread",e.thread)("threadBidders",e.threadBidders)("threadCollaborators",e.threadCollaborators)("threadContacts",e.threadContacts)}}let q=(()=>{class e{constructor(e){this.modalService=e,this.ViewHeaderType=R.b,this.isReportSettingEnabled=!1,this.makingCall=new i.n,this.addChatMembers=new i.n,this.markAsRead=new i.n,this.loadMoreAttachments=new i.n,this.resetAttachmentsLimit=new i.n,this.removeChatMembers=new i.n,this.showSidebar=!1}toggleSidebar(){this.showSidebar=!this.showSidebar,this.showSidebar?this.chatOptionsDrawer.open():this.chatOptionsDrawer.close()}openAddPeopleModal(){this.modalService.open("MessagingAddPeopleModal",{edgeToEdge:!0,inputs:{isLoggedInUserSupportAgent:this.isLoggedInUserSupportAgent,threadBidders:this.threadBidders,threadCollaborators:this.threadCollaborators,threadContacts:this.threadContacts},mobileFullscreen:!0,size:_.a.SMALL}).afterClosed().toPromise().then(e=>{e&&this.addChatMembers.emit(e)})}openAllMembersModal(){this.modalService.open("MessagingGroupMembersModal",{edgeToEdge:!0,inputs:{isLoggedInUserThreadOwner:this.isLoggedInUserThreadOwner,loggedInUser:this.loggedInUser,otherMembers:this.activeOtherMembers,showAddPeopleCta:this.canUserManageThreadMembers},mobileFullscreen:!0,size:_.a.SMALL}).afterClosed().toPromise().then(e=>{e&&"showAddPeople"in e&&this.openAddPeopleModal(),e&&"removeMember"in e&&"user"in e&&this.openRemoveUserModal(e.user)})}openRemoveUserModal(e){this.modalService.open("MessagingRemoveUserModal",{inputs:{user:e,loggedInUser:this.loggedInUser,isLoggedInUserThreadOwner:this.isLoggedInUserThreadOwner},size:_.a.XSMALL}).afterClosed().toPromise().then(e=>{e&&("removeUserId"in e&&this.removeChatMembers.emit([e.removeUserId]),"userIsOtherMember"in e&&e.userIsOtherMember&&this.openAllMembersModal())})}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(j.b))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-full-inbox"]],viewQuery:function(e,t){if(1&e&&i.id(H,1),2&e){let e;i.Lc(e=i.oc())&&(t.chatOptionsDrawer=e.first)}},inputs:{activeOtherMembers:"activeOtherMembers",allChatMembers:"allChatMembers",attachments:"attachments",attachmentsFetchStatus:"attachmentsFetchStatus",callsEnabled:"callsEnabled",canUserManageThreadMembers:"canUserManageThreadMembers",contextBoxState:"contextBoxState",hasMoreAttachments:"hasMoreAttachments",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",isLoggedInUserThreadOwner:"isLoggedInUserThreadOwner",isReportSettingEnabled:"isReportSettingEnabled",loggedInUser:"loggedInUser",membersActivityStatus:"membersActivityStatus",project:"project",supportAgent:"supportAgent",team:"team",thread:"thread",threadBidders:"threadBidders",threadCollaborators:"threadCollaborators",threadContacts:"threadContacts",threadIdentifier:"threadIdentifier"},outputs:{makingCall:"makingCall",addChatMembers:"addChatMembers",markAsRead:"markAsRead",loadMoreAttachments:"loadMoreAttachments",resetAttachmentsLimit:"resetAttachmentsLimit",removeChatMembers:"removeChatMembers"},decls:12,vars:24,consts:function(){let e;return e="Chat Details",[["flTrackingSection","FullInbox",1,"FullInbox"],[3,"sideNotch","showMenu",4,"flViewHeaderTemplate","flViewHeaderTemplateFullReplacement"],[1,"FullInbox-header",3,"flHideMobile","callsEnabled","chatboxMode","contextBoxState","loggedInUser","membersActivityStatus","mobileMode","otherMembers","project","supportAgent","thread","makingCall","showChatDetails"],[1,"FullInbox-content"],[1,"FullInbox-threadView"],[3,"contextBoxState"],[3,"allChatMembers","chatboxMode","loggedInUser","membersActivityStatus","thread","threadIdentifier","click","usersTyping"],["class","FullInbox-sidebar FullInbox-sidebar--desktop",3,"flShowDesktop","attachments","attachmentsFetchStatus","callsEnabled","canUserManageThreadMembers","chatboxMode","contextBoxState","hasMoreAttachments","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isReportSettingEnabled","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","makingCall","loadMoreAttachments","resetAttachmentsLimit","removeMember","showAddPeopleScreen","showAllMembers",4,"ngIf"],["mobileHeaderTitle",e,3,"edgeToEdge","fullWidth","flHideDesktop"],["chatOptionsDrawer",""],["drawerTemplate",""],[3,"sideNotch","showMenu"],[3,"callsEnabled","chatboxMode","contextBoxState","loggedInUser","membersActivityStatus","mobileMode","otherMembers","supportAgent","thread","makingCall","showChatDetails"],[1,"FullInbox-sidebar","FullInbox-sidebar--desktop",3,"flShowDesktop","attachments","attachmentsFetchStatus","callsEnabled","canUserManageThreadMembers","chatboxMode","contextBoxState","hasMoreAttachments","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isReportSettingEnabled","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","makingCall","loadMoreAttachments","resetAttachmentsLimit","removeMember","showAddPeopleScreen","showAllMembers"],[1,"FullInbox-sidebar",3,"attachments","attachmentsFetchStatus","callsEnabled","canUserManageThreadMembers","chatboxMode","contextBoxState","hasMoreAttachments","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isReportSettingEnabled","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","makingCall","loadMoreAttachments","resetAttachmentsLimit","removeMember","showAddPeopleScreen","showAllMembers"]]},template:function(e,t){1&e&&(i.Yb(0,"fl-bit",0),i.Zc(1,V,2,11,"fl-view-header",1),i.Yb(2,"app-messaging-header",2),i.nc("makingCall",function(e){return t.makingCall.emit(e)})("showChatDetails",function(){return t.toggleSidebar()}),i.Xb(),i.Yb(3,"fl-bit",3),i.Yb(4,"fl-bit",4),i.Tb(5,"app-messaging-context-box",5),i.Yb(6,"app-messaging-thread-view",6),i.nc("click",function(){return t.markAsRead.emit()})("usersTyping",function(){return t.markAsRead.emit()}),i.Xb(),i.Xb(),i.Zc(7,Z,1,19,"app-messaging-chat-details",7),i.Yb(8,"fl-drawer",8,9),i.Zc(10,W,1,18,"ng-template",null,10,i.ad),i.Xb(),i.Xb(),i.Xb()),2&e&&(i.Gb(1),i.zc("flViewHeaderTemplate",t.ViewHeaderType.MOBILE_ONLY)("flViewHeaderTemplateFullReplacement",!0),i.Gb(1),i.zc("flHideMobile",!0)("callsEnabled",t.callsEnabled)("chatboxMode",!1)("contextBoxState",t.contextBoxState)("loggedInUser",t.loggedInUser)("membersActivityStatus",t.membersActivityStatus)("mobileMode",!1)("otherMembers",t.activeOtherMembers)("project",t.project)("supportAgent",t.supportAgent)("thread",t.thread),i.Gb(3),i.zc("contextBoxState",t.contextBoxState),i.Gb(1),i.zc("allChatMembers",t.allChatMembers)("chatboxMode",!1)("loggedInUser",t.loggedInUser)("membersActivityStatus",t.membersActivityStatus)("thread",t.thread)("threadIdentifier",t.threadIdentifier),i.Gb(1),i.zc("ngIf",t.showSidebar),i.Gb(1),i.zc("edgeToEdge",!0)("fullWidth",!0)("flHideDesktop",!0))},directives:[U.a,B.a,R.a,$.a,G.a,F.a,D.a,P.q,N.a,X.b,Y.a],styles:["[_nghost-%COMP%]{display:block;height:100%}.FullInbox[_ngcontent-%COMP%]{background:#fff;flex-flow:column;padding-bottom:env(safe-area-inset-bottom);width:100%}.FullInbox[_ngcontent-%COMP%], .FullInbox-content[_ngcontent-%COMP%], .FullInbox-threadView[_ngcontent-%COMP%]{display:flex;height:100%}.FullInbox-threadView[_ngcontent-%COMP%]{flex:1 0 auto;flex-flow:column}.FullInbox-header[_ngcontent-%COMP%]{border-bottom:1px solid #dedede}.FullInbox-sidebar[_ngcontent-%COMP%]{border-left:1px solid #dedede;display:block}.FullInbox-sidebar--desktop[_ngcontent-%COMP%]{width:375px}"],changeDetection:0}),e})();var Q=n("al+g");function K(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-chat-box",2),i.nc("addChatMembers",function(t){i.Pc(e);const n=i.rc();return n.modifyChatMembers(t,n.ModifyChatMembersActionType.ADD)})("focusChat",function(t){return i.Pc(e),i.rc().focusChatBox(t)})("closeChat",function(){i.Pc(e);const t=i.rc();return t.closeChat.emit(t.threadIdentifier)})("closeOnboarding",function(){return i.Pc(e),i.rc().closeOnboarding()})("minimiseChat",function(){i.Pc(e);const t=i.rc();return t.minimiseChat.emit(t.threadIdentifier)})("unfocusChat",function(){return i.Pc(e),i.rc().unfocusChat.emit()})("makingCall",function(t){return i.Pc(e),i.rc().setInCall(t)})("markAsRead",function(){return i.Pc(e),i.rc().markAsRead()})("removeChatMembers",function(t){i.Pc(e);const n=i.rc();return n.modifyChatMembers(t,n.ModifyChatMembersActionType.REMOVE)})("toggleSize",function(){i.Pc(e);const t=i.rc();return t.toggleSize.emit(t.threadIdentifier)}),i.sc(1,"flAsync"),i.sc(2,"flAsync"),i.sc(3,"flAsync"),i.sc(4,"flAsync"),i.sc(5,"flAsync"),i.sc(6,"flAsync"),i.sc(7,"flAsync"),i.sc(8,"flAsync"),i.sc(9,"flAsync"),i.sc(10,"flAsync"),i.sc(11,"flAsync"),i.sc(12,"flAsync"),i.sc(13,"flAsync"),i.sc(14,"flAsync"),i.sc(15,"flAsync"),i.sc(16,"flAsync"),i.sc(17,"flAsync"),i.sc(18,"flAsync"),i.Xb()}if(2&e){const e=i.rc();i.zc("allChatMembers",i.tc(1,23,e.allChatMembers$))("activeOtherMembers",i.tc(2,25,e.activeOtherMembers$))("callsEnabled",i.tc(3,27,e.callsEnabled$))("canUserManageThreadMembers",i.tc(4,29,e.canUserManageThreadMembers$))("contextBoxState",i.tc(5,31,e.contextBoxState$))("isFocused",e.isFocused)("isHourlyProject",i.tc(6,33,e.isHourlyProject$))("isLoggedInUserSupportAgent",i.tc(7,35,e.isLoggedInUserSupportAgent$))("isLoggedInUserThreadOwner",i.tc(8,37,e.isLoggedInUserThreadOwner$))("isReportSettingEnabled",i.tc(9,39,e.isReportSettingEnabled$))("isMinimised",e.isMinimised)("loggedInUser",i.tc(10,41,e.loggedInUser$))("membersActivityStatus",i.tc(11,43,e.membersActivityStatus$))("privateChatOtherUser",i.tc(12,45,e.otherUser$))("project",i.tc(13,47,e.project$))("showOnboarding",i.tc(14,49,e.showOnboarding$))("supportAgent",i.tc(15,51,e.supportAgent$))("team",e.team)("thread",e.thread)("threadBidders",i.tc(16,53,e.threadBidders$))("threadContacts",i.tc(17,55,e.threadContacts$))("threadCollaborators",i.tc(18,57,e.threadCollaborators$))("threadIdentifier",e.threadIdentifier)}}function J(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-full-inbox",3),i.nc("addChatMembers",function(t){i.Pc(e);const n=i.rc();return n.modifyChatMembers(t,n.ModifyChatMembersActionType.ADD)})("focusChat",function(){return i.Pc(e),i.rc().markAsRead()})("markAsRead",function(){return i.Pc(e),i.rc().markAsRead()})("makingCall",function(t){return i.Pc(e),i.rc().setInCall(t)})("loadMoreAttachments",function(){return i.Pc(e),i.rc().loadMoreAttachments()})("resetAttachmentsLimit",function(){return i.Pc(e),i.rc().resetAttachmentLimit()})("removeChatMembers",function(t){i.Pc(e);const n=i.rc();return n.modifyChatMembers(t,n.ModifyChatMembersActionType.REMOVE)}),i.sc(1,"flAsync"),i.sc(2,"flAsync"),i.sc(3,"flAsync"),i.sc(4,"flAsync"),i.sc(5,"flAsync"),i.sc(6,"flAsync"),i.sc(7,"flAsync"),i.sc(8,"flAsync"),i.sc(9,"flAsync"),i.sc(10,"flAsync"),i.sc(11,"flAsync"),i.sc(12,"flAsync"),i.sc(13,"flAsync"),i.sc(14,"flAsync"),i.sc(15,"flAsync"),i.sc(16,"flAsync"),i.sc(17,"flAsync"),i.sc(18,"flAsync"),i.Xb()}if(2&e){const e=i.rc();i.zc("activeOtherMembers",i.tc(1,21,e.activeOtherMembers$))("allChatMembers",i.tc(2,23,e.allChatMembers$))("attachments",i.tc(3,25,e.attachments$))("attachmentsFetchStatus",i.tc(4,27,e.attachmentsFetchStatus$))("callsEnabled",i.tc(5,29,e.callsEnabled$))("canUserManageThreadMembers",i.tc(6,31,e.canUserManageThreadMembers$))("contextBoxState",i.tc(7,33,e.contextBoxState$))("hasMoreAttachments",i.tc(8,35,e.hasMoreAttachments$))("isLoggedInUserSupportAgent",i.tc(9,37,e.isLoggedInUserSupportAgent$))("isLoggedInUserThreadOwner",i.tc(10,39,e.isLoggedInUserThreadOwner$))("isReportSettingEnabled",i.tc(11,41,e.isReportSettingEnabled$))("loggedInUser",i.tc(12,43,e.loggedInUser$))("membersActivityStatus",i.tc(13,45,e.membersActivityStatus$))("project",i.tc(14,47,e.project$))("supportAgent",i.tc(15,49,e.supportAgent$))("team",e.team)("thread",e.thread)("threadBidders",i.tc(16,51,e.threadBidders$))("threadContacts",i.tc(17,53,e.threadContacts$))("threadCollaborators",i.tc(18,55,e.threadCollaborators$))("threadIdentifier",e.threadIdentifier)}}let ee=(()=>{class e{constructor(e,t,n,s,a,o){this.auth=e,this.datastore=t,this.featureFlagService=n,this.localStorage=s,this.userAgent=a,this.videochat=o,this.ModifyChatMembersActionType=A,this.isFocused=!1,this.isMinimised=!1,this.closeChat=new i.n,this.focusChat=new i.n,this.unfocusChat=new i.n,this.minimiseChat=new i.n,this.toggleSize=new i.n,this.ATTACHMENTS_LIMIT_INCREMENT=50,this.ATTACHMENTS_INITIAL_LIMIT=4,this._attachmentsLimitSubject$=new u.a(this.ATTACHMENTS_INITIAL_LIMIT),this.attachmentsLimit$=this._attachmentsLimitSubject$.asObservable(),this.XXX_SKILL_ID=88,this.projectOnboardingClosedSubject$=new u.a(!1),this.projectOnboardingClosed$=this.projectOnboardingClosedSubject$.asObservable()}ngOnInit(){this.preAwardAudioCallFeatureEnabled$=this.featureFlagService.getFlag(r.b.PRE_AWARD_AUDIO_CALL),this._allContactsSubject$=new u.a(this.allContacts),this.allContacts$=this._allContactsSubject$.asObservable(),this._threadSubject$=new u.a(this.thread),this.thread$=this._threadSubject$.asObservable(),this._threadIdentifierSubject$=new u.a(this.threadIdentifier),this.threadIdentifier$=this._threadIdentifierSubject$.asObservable(),this._teamSubject$=new u.a(this.team),this.team$=this._teamSubject$.asObservable();const e=this.auth.getUserId().pipe(Object(m.a)(e=>Object(c.s)(e)));this.allChatMembers$=this.datastore.collection("users",this.thread$.pipe(Object(m.a)(e=>[...e.inactiveMembers,...e.members]))).valueChanges(),this.loggedInUser$=b.a([this.allChatMembers$,e]).pipe(Object(m.a)(([e,t])=>e.find(e=>e.id===t)),Object(M.a)(c.h)),this.isLoggedInUserThreadOwner$=b.a([this.thread$,this.loggedInUser$]).pipe(Object(m.a)(([e,t])=>!e.isFake&&e.owner===t.id)),this.activeOtherMembers$=b.a([this.thread$,this.allChatMembers$]).pipe(Object(m.a)(([e,t])=>t.filter(t=>e.otherMembers.includes(t.id)))),this.membersActivityStatus$=this.datastore.collection("onlineOffline",this.thread$.pipe(Object(m.a)(e=>e.members))).valueChanges();const t=this.datastore.collection("agentSessions",e=>e.where("sessionId","==",this.thread$.pipe(Object(m.a)(e=>e.context.type===l.ContextTypeApi.SUPPORT_SESSION?e.context.id:void 0),Object(M.a)(c.h)))).valueChanges().pipe(Object(m.a)(e=>e[0]),Object(M.a)(c.h)),n=this.datastore.collection("agents",e=>e.where("userId","in",this.thread$.pipe(Object(m.a)(e=>e.members))).where("state","in",[g.AgentStateApi.AVAILABLE,g.AgentStateApi.AWAY,g.AgentStateApi.UNAVAILABLE])).valueChanges();this.isLoggedInUserSupportAgent$=b.a([e,n]).pipe(Object(m.a)(([e,t])=>t.map(e=>e.userId).includes(e))),this.supportAgent$=b.a([t.pipe(Object(C.a)(void 0)),this.isLoggedInUserSupportAgent$,this.activeOtherMembers$,this.loggedInUser$,n]).pipe(Object(m.a)(([e,t,n,i,s])=>{if(0!==s.length)return s.find(t?t=>e?t.userId===i.id&&t.type===e.type:t.userId===i.id:e=>n.map(e=>e.id).includes(e.userId))}));const i=f.a(this.thread$.pipe(Object(m.a)(e=>e.context.type===l.ContextTypeApi.PROJECT?e.context.id:void 0),Object(M.a)(c.h)),t.pipe(Object(M.a)(e=>e.sessionSourceType===g.SourceTypeApi.PROJECT),Object(m.a)(e=>e.sessionSourceId))),p=this.datastore.document("threadProjects",i);this.project$=p.valueChanges();const y=this.activeOtherMembers$.pipe(Object(m.a)(e=>e[0]),Object(M.a)(c.h),Object(m.a)(e=>e.id));this.otherUser$=this.datastore.document("projectViewUsers",y).valueChanges();const I=b.a([y,this.membersActivityStatus$]).pipe(Object(m.a)(([e,t])=>{const n=t.find(t=>t.id===e);return(null==n?void 0:n.status)===o.OnlineOfflineStatusApi.ONLINE}),Object(C.a)(!1),Object(S.a)()),A=b.a([this.project$,y,e]).pipe(Object(m.a)(([e,t,n])=>e.ownerId===n?t:n),Object(S.a)()),v=this.datastore.collection("bids",e=>e.where("projectId","==",i).where("awardStatus","==",h.BidAwardStatusApi.AWARDED).where("bidderId","==",A)),w=this.datastore.document("contests",this.thread$.pipe(Object(m.a)(e=>e.context.type===l.ContextTypeApi.CONTEST?e.context.id:void 0),Object(M.a)(c.h)));this.isFocused&&this.markAsRead();const E=v.valueChanges().pipe(Object(m.a)(e=>e.length>0),Object(C.a)(!1)),z=b.a([e,this.project$.pipe(Object(m.a)(e=>e.ownerId))]).pipe(Object(m.a)(([e,t])=>e===t),Object(C.a)(!1)),L=b.a([E,z,this.otherUser$,this.preAwardAudioCallFeatureEnabled$]).pipe(Object(m.a)(([e,t,n,i])=>!e&&t&&(n.preferredFreelancer&&n.status.freelancerVerifiedUser||i)),Object(C.a)(!1)),k=this.project$.pipe(Object(m.a)(e=>!e.skills.map(e=>e.id).includes(this.XXX_SKILL_ID)),Object(C.a)(!1)),P=this.videochat.getInCall(),_=this.datastore.document("membershipBenefits","free_pre_awarded_voip").valueChanges().pipe(Object(m.a)(e=>0!==e.value)),R=b.a([this.thread$,this.project$,t.pipe(Object(C.a)(void 0))]).pipe(Object(m.a)(([e,t,n])=>!!t&&(e.context.type===l.ContextTypeApi.PROJECT&&e.context.id===t.id||!!n&&e.context.type===l.ContextTypeApi.SUPPORT_SESSION&&e.context.id===n.sessionId&&n.sessionSourceType===g.SourceTypeApi.PROJECT&&n.sessionSourceId===t.id)),Object(C.a)(!1));this.callsEnabled$=Object(s.a)([P,this.isLoggedInUserSupportAgent$,I,this.thread$,this.threadIdentifier$,L,E,k,R,_,z]).pipe(Object(m.a)(([e,t,n,i,s,a,o,r,c,l,d])=>{const h=null==s?void 0:s.isFake,g=1===i.otherMembers.length;if(t&&g)return{audio:{enabled:!0,recorded:!1},video:{enabled:!0,recorded:!1}};const u=c&&g&&n&&this.isCallSupportedBrowser()&&!e&&"none"!==i.writePrivacy&&r&&!h,b=u&&l&&d,f=("admin_preferred_chat"===i.threadType||!t)&&u;return{audio:{enabled:(o||a)&&f||b,recorded:a&&f},video:{enabled:!t&&"admin_preferred_chat"!==i.threadType&&o&&u||b,recorded:!1}}}),Object(C.a)({audio:{enabled:!1,recorded:!1},video:{enabled:!1,recorded:!1}}),Object(T.a)(1),Object(x.a)());const j=this.datastore.collection("bids",e=>e.where("projectId","==",this.project$.pipe(Object(m.a)(e=>e.id))));this.showOnboarding$=Object(s.a)([this.projectOnboardingClosed$,j.valueChanges(),e,this.thread$,this.localStorage.get("projectOverlayThreadComplete"),this.loggedInUser$.pipe(Object(m.a)(e=>!!e.isDeloitteDcUser)),this.project$.pipe(Object(m.a)(e=>e.isInsourceProject))]).pipe(Object(m.a)(([e,t,n,i,s,a,o])=>!(e||"project"!==i.context.type||"private_chat"!==i.threadType||s&&s[i.id]||void 0===t.find(e=>e.bidderId===Object(c.s)(n))||a||o)));const U=this.datastore.collection("hourlyContracts",e=>e.where("projectId","==",this.project$.pipe(Object(M.a)(c.h),Object(M.a)(e=>e.type===h.ProjectTypeApi.HOURLY),Object(m.a)(e=>e.id))).where("bidderId","==",A)).valueChanges();this.isHourlyProject$=b.a([U,this.project$]).pipe(Object(m.a)(([e,t])=>t.type===h.ProjectTypeApi.HOURLY&&e.some(e=>e.projectId===t.id)));const B=this.datastore.collection("bids",e=>e.where("projectId","==",i).where("bidderId","==",A)),$=this.datastore.collection("milestones",t=>b.a([p.valueChanges(),e]).pipe(Object(m.a)(([e,n])=>e.ownerId===n?t.where("projectId","==",i):t.where("projectId","==",i).where("bidderId","==",n)))),G=this.datastore.collection("milestoneRequests",t=>b.a([p.valueChanges(),e]).pipe(Object(m.a)(([e,n])=>e.ownerId===n?t.where("projectId","==",i):t.where("projectId","==",i).where("bidderId","==",n)))),F=this.datastore.collection("invoices",e=>e.where("projectId","==",i).where("freelancerId","==",A).where("milestoneLinkedStatus","==",d.ProjectInvoiceMilestoneLinkedStatusesApi.UNLINKED).limit(1)),D=b.a([j.valueChanges(),this.thread$]).pipe(Object(m.a)(([e,t])=>e.map(e=>e.bidderId).filter(e=>!t.members.includes(e)).filter(e=>void 0!==e)),Object(M.a)(e=>e.length>0));this.threadBidders$=this.datastore.collection("users",D).valueChanges().pipe(Object(T.a)(1),Object(x.a)(),Object(a.a)()),this.threadContacts$=b.a([this.allContacts$,this.thread$]).pipe(Object(m.a)(([e,t])=>e.filter(e=>!t.members.includes(e.id))));const N=this.datastore.collection("projectCollaborations",e=>e.where("context","==",this.project$.pipe(Object(m.a)(e=>({id:e.id,type:l.ContextTypeApi.PROJECT}))))).valueChanges(),X=b.a([this.project$,this.thread$]).pipe(Object(m.a)(([e,t])=>(e.projectCollaborations||[]).map(e=>e.userId).filter(c.h).filter(e=>!t.members.includes(e))),Object(M.a)(e=>e.length>0));this.threadCollaborators$=this.datastore.collection("users",X).valueChanges().pipe(Object(T.a)(1),Object(x.a)(),Object(a.a)());const Y=this.datastore.collection("messageAttachments",e=>e.where("threadId","==",this.thread$.pipe(Object(m.a)(e=>e.id))).limit(this.attachmentsLimit$.pipe(Object(m.a)(e=>e+1))));this.attachmentsFetchStatus$=Y.status$;const H=Y.valueChanges();this.hasMoreAttachments$=b.a([H,this.attachmentsLimit$]).pipe(Object(m.a)(([e,t])=>t<e.length)),this.attachments$=b.a([H,this.hasMoreAttachments$]).pipe(Object(m.a)(([e,t])=>t?e.slice(0,-1):e)),this.isReportSettingEnabled$=b.a([this.loggedInUser$,this.thread$,this.project$.pipe(Object(C.a)(void 0)),w.valueChanges().pipe(Object(C.a)(void 0)),N.pipe(Object(C.a)(void 0))]).pipe(Object(m.a)(([e,t,n,i,s])=>t.threadType===l.ThreadTypeApi.PRIVATE_CHAT&&(t.context.type===l.ContextTypeApi.PROJECT&&t.context.id===(null==n?void 0:n.id)&&(null==n?void 0:n.ownerId)!==e.id&&!(null==s?void 0:s.some(t=>{var i;return t.userId===e.id&&(null===(i=t.context)||void 0===i?void 0:i.id)===(null==n?void 0:n.id)&&t.status===h.ProjectCollaborationStatusApi.ACTIVE}))||t.context.type===l.ContextTypeApi.CONTEST&&t.context.id===(null==i?void 0:i.id)&&(null==i?void 0:i.ownerId)!==e.id))),this.stateManager=new O.b(this.auth,this.thread$,this.allChatMembers$,p.valueChanges(),w.valueChanges(),B.valueChanges(),$.valueChanges(),G.valueChanges(),U,t,this.team$,F.valueChanges()),this.contextBoxState$=this.stateManager.getState(),this.canUserManageThreadMembers$=Object(s.a)([this.thread$,this.team$,this.threadBidders$,this.threadCollaborators$,this.threadContacts$,this.isLoggedInUserSupportAgent$,this.isLoggedInUserThreadOwner$]).pipe(Object(m.a)(([e,t,n,i,s,a,o])=>{const r=[...n||[],...i||[],...s||[]].length>0;return this.thread.context.type!==l.ContextTypeApi.NONE&&(!!(e.context.type===l.ContextTypeApi.TEAM&&e.threadType!==l.ThreadTypeApi.TEAM_OFFICIAL||e.threadType===l.ThreadTypeApi.TEAM&&t)||this.thread.threadType!==l.ThreadTypeApi.TEAM_OFFICIAL&&(o&&r||a))}))}ngOnChanges(e){var t,n,i,s,a,o,r,c;e.allContacts&&(null===(t=this._allContactsSubject$)||void 0===t||t.next(e.allContacts.currentValue)),e.thread&&(null===(n=this._threadSubject$)||void 0===n||n.next(e.thread.currentValue)),e.threadIdentifier&&(null===(i=this._threadIdentifierSubject$)||void 0===i||i.next(e.threadIdentifier.currentValue)),e.team&&(null===(s=this._teamSubject$)||void 0===s||s.next(e.team.currentValue)),(null===(o=null===(a=e.thread)||void 0===a?void 0:a.currentValue)||void 0===o?void 0:o.id)!==(null===(c=null===(r=e.thread)||void 0===r?void 0:r.previousValue)||void 0===c?void 0:c.id)&&this.resetAttachmentLimit()}focusChatBox(e){this.markAsRead(),this.focusChat.emit(e)}markAsRead(){this.threadIdentifier$.pipe(Object(m.a)(e=>e.isFake),Object(y.a)(this.thread$),Object(m.a)(([e,t])=>!(e||t.isRead&&0===t.messageUnreadCount)&&this.datastore.collection("threads").update(t.id,{isRead:!0,messageUnreadCount:0}))).toPromise()}isCallSupportedBrowser(){const e=this.userAgent.getUserAgent(),{name:t}=e.getBrowser();return"Chrome"===t||"Firefox"===t}escCloseChat(e){"Escape"===e.key&&this.isFocused&&(e.stopImmediatePropagation(),this.closeChat.emit(this.threadIdentifier))}closeOnboarding(){this.projectOnboardingClosedSubject$.next(!0)}setInCall(e){this.videochat.setInCall(e)}modifyChatMembers(e,t){p.a({userIds:e,actionType:t}).pipe(Object(y.a)(this.thread$,this.loggedInUser$,this.threadIdentifier$),Object(m.a)(([e,t,n,i])=>{if(t.isFake)return;const s=e.actionType===A.ADD?[...t.members,...e.userIds]:t.members.filter(t=>!e.userIds.includes(t)),a=s.filter(e=>e!==n.id),o=e.actionType===A.ADD?t.inactiveMembers.filter(t=>!e.userIds.includes(t)):[...t.inactiveMembers,...e.userIds];return this.datastore.collection("threads").update(t.id,{inactiveMembers:o,members:s,otherMembers:a}).then(t=>{"success"===t.status&&(e.actionType===A.REMOVE&&e.userIds.includes(n.id)&&this.closeChat.emit(i),this.chatboxMode&&this.messagingChatBoxComponent.showThreadView())})})).toPromise()}loadMoreAttachments(){this._attachmentsLimitSubject$.next(this._attachmentsLimitSubject$.value<this.ATTACHMENTS_LIMIT_INCREMENT?this.ATTACHMENTS_LIMIT_INCREMENT:this._attachmentsLimitSubject$.value+this.ATTACHMENTS_LIMIT_INCREMENT)}resetAttachmentLimit(){this._attachmentsLimitSubject$.next(this.ATTACHMENTS_INITIAL_LIMIT)}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(v.a),i.Sb(w.a),i.Sb(E.a),i.Sb(z.a),i.Sb(L.a),i.Sb(k.b))},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-contents"]],viewQuery:function(e,t){if(1&e&&i.id(I.b,1),2&e){let e;i.Lc(e=i.oc())&&(t.messagingChatBoxComponent=e.first)}},hostBindings:function(e,t){1&e&&i.nc("keydown",function(e){return t.escCloseChat(e)},!1,i.Nc)},inputs:{allContacts:"allContacts",chatboxMode:"chatboxMode",isFocused:"isFocused",isMinimised:"isMinimised",team:"team",thread:"thread",threadIdentifier:"threadIdentifier"},outputs:{closeChat:"closeChat",focusChat:"focusChat",unfocusChat:"unfocusChat",minimiseChat:"minimiseChat",toggleSize:"toggleSize"},features:[i.Eb],decls:3,vars:2,consts:[[3,"allChatMembers","activeOtherMembers","callsEnabled","canUserManageThreadMembers","contextBoxState","isFocused","isHourlyProject","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isReportSettingEnabled","isMinimised","loggedInUser","membersActivityStatus","privateChatOtherUser","project","showOnboarding","supportAgent","team","thread","threadBidders","threadContacts","threadCollaborators","threadIdentifier","addChatMembers","focusChat","closeChat","closeOnboarding","minimiseChat","unfocusChat","makingCall","markAsRead","removeChatMembers","toggleSize",4,"ngIf","ngIfElse"],["fullInbox",""],[3,"allChatMembers","activeOtherMembers","callsEnabled","canUserManageThreadMembers","contextBoxState","isFocused","isHourlyProject","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isReportSettingEnabled","isMinimised","loggedInUser","membersActivityStatus","privateChatOtherUser","project","showOnboarding","supportAgent","team","thread","threadBidders","threadContacts","threadCollaborators","threadIdentifier","addChatMembers","focusChat","closeChat","closeOnboarding","minimiseChat","unfocusChat","makingCall","markAsRead","removeChatMembers","toggleSize"],[3,"activeOtherMembers","allChatMembers","attachments","attachmentsFetchStatus","callsEnabled","canUserManageThreadMembers","contextBoxState","hasMoreAttachments","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isReportSettingEnabled","loggedInUser","membersActivityStatus","project","supportAgent","team","thread","threadBidders","threadContacts","threadCollaborators","threadIdentifier","addChatMembers","focusChat","markAsRead","makingCall","loadMoreAttachments","resetAttachmentsLimit","removeChatMembers"]],template:function(e,t){if(1&e&&(i.Zc(0,K,19,59,"app-messaging-chat-box",0),i.Zc(1,J,19,57,"ng-template",null,1,i.ad)),2&e){const e=i.Mc(2);i.zc("ngIf",t.chatboxMode)("ngIfElse",e)}},directives:[P.q,I.b,q],pipes:[Q.a],styles:["[_nghost-%COMP%]{display:block;height:100%}"],changeDetection:0}),e})()},WcJj:function(e,t,n){"use strict";n.d(t,"a",function(){return ua});var i=n("SVse"),s=n("s7LF"),a=n("oA5+"),o=n("jZoe"),r=n("9u4R"),c=n("tqRt"),l=n("OpNG");function d(){return{defaultOrder:{field:"maxWeight",direction:l.a.DESC},fetch:(e,t,n,i)=>({endpoint:"contacts/0.1/contacts",params:{}}),push:void 0,set:void 0,update:void 0,remove:void 0}}var h=n("cUs2"),g=n("f6cb"),u=n("Z9nB");function b(e){const t=e.relationships?Object.values(e.relationships).filter(g.h).map(e=>e.weight).filter(g.h):[];return Object.assign(Object.assign({},Object(u.a)(e.user)),{maxWeight:Math.max(0,...t)})}function f(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("contacts"===t.payload.type){const{result:n,ref:i,order:s}=t.payload;return Object(h.o)(e,Object(h.z)(n.contacts,b,i.path.authUid),s,i)}return e;default:return e}}var p=n("8Y7J");let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({imports:[[c.j.forFeature("contacts",f),r.d.forFeature("contacts",d)]]}),e})();var M=n("VFv1"),C=n("7bNT");function S(){return{defaultOrder:{field:"timeCreated",direction:l.a.DESC},fetch:(e,t,n,i)=>({endpoint:"messages/0.1/messages",params:{threads:Object(h.h)(n,"threadId"),thread_details:"true"}}),push:(e,t)=>({endpoint:`messages/0.1/threads/${t.threadId}/messages/`,asFormData:!0,payload:{message:t.message,client_message_id:String(t.clientMessageId?t.clientMessageId:Date.now()),source:t.messageSource}}),set:void 0,update:void 0,remove:void 0}}var T=n("mrSG"),x=n("FRAM"),y=n("pLZG"),I=n("lJxs"),O=n("zp1y"),A=n("/wLE"),v=n("yeKy");let w=(()=>{class e{constructor(e,t,n,i){this.actions$=e,this.auth=t,this.store$=n,this.messagingChat=i,this.fetchData$=this.actions$.pipe(Object(y.a)(x.c),Object(I.a)(e=>e.payload),Object(y.a)(E),Object(O.a)(this.store$,this.auth.authState$),Object(y.a)(([e])=>!!e),Object(I.a)(([e,t,n])=>{if(n&&e.data.notify_user&&e.data.from_user!==Object(g.s)(n.userId)&&this.messagingChat.canStartChat())return void this.messagingChat.startChat({userIds:e.data.thread_details.members,threadType:e.data.thread_details.thread_type,origin:"websocket",context:e.data.thread_details.context,threadId:e.data.thread_id,focus:!1,doNotRedirect:!0});const i={collection:"threads",authUid:e.toUserId,ids:[String(e.data.thread_id)]};return Object(h.s)(t.threads,i,e.data.thread_id)?void 0:{type:"REQUEST_DATA",payload:{type:"threads",ref:{path:i},clientRequestIds:[]}}}),Object(y.a)(g.h))}}return e.\u0275fac=function(t){return new(t||e)(p.jc(C.a),p.jc(A.a),p.jc(c.h),p.jc(v.d))},e.\u0275prov=p.Ob({token:e,factory:e.\u0275fac}),Object(T.b)([Object(C.b)()],e.prototype,"fetchData$",void 0),e})();function E(e){return"private"===e.type&&"messages"===e.parent_type}var z=n("etQe"),L=n("OI7T");function k(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("messages"===t.payload.type){const{result:n,ref:i,order:s}=t.payload;return Object(h.o)(e,Object(h.z)(n.messages,L.a),s,i)}return e;case"API_PUSH_SUCCESS":if("messages"===t.payload.type){const{result:n,ref:i}=t.payload;return Object(h.q)(e,Object(h.z)([n],L.a),i)}return e;case"WS_MESSAGE":{const{payload:n}=t;if("messages"===n.parent_type&&"private"===n.type){const t={path:{collection:"messages",authUid:n.toUserId}};return Object(h.q)(e,Object(h.z)([n],L.b),t)}if("messages"===n.parent_type&&"attach"===n.type){const t={collection:"messages",authUid:n.toUserId},i=n.data.message_id,s={path:t};return Object(h.q)(e,Object(h.z)([n.data.thread_id],s=>{const a=Object(h.s)(e,t,i);return a?Object.assign(Object.assign({},a),{attachments:[...a.attachments||[],...n.data.filenames]}):{id:n.data.message_id,attachments:n.data.filenames,fromUser:n.data.from_user,message:"",messageSource:"chat_box",threadId:n.data.thread_id,timeCreated:n.timestamp,sendStatus:z.a.SENT}}),s)}return e}default:return e}}let P=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({imports:[[c.j.forFeature("messages",k),C.c.forFeature([w]),r.d.forFeature("messages",S)]]}),e})();var _=n("O3cg"),R=n("QcR0"),j=n("fejZ"),U=n("eI96"),B=n("EgRV"),$=n("I0A4"),G=n("ynQg"),F=n("jnT3"),D=n("7LCa");function N(){return{defaultOrder:{field:"id",direction:l.a.DESC},fetch:(e,t,n,i)=>({endpoint:"messages/0.1/threads/search",params:{query:n&&n.searchQueryParams&&n.searchQueryParams.searchTerm}}),push:void 0,set:void 0,update:void 0,remove:void 0}}var X=n("AO4K");function Y(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("searchThreads"===t.payload.type){const{result:n,ref:i,order:s}=t.payload;return Object(h.o)(e,Object(h.z)(n.threads,X.b,i.path.authUid),s,i)}return e;default:return e}}let H=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({imports:[[c.j.forFeature("searchThreads",Y),r.d.forFeature("searchThreads",N)]]}),e})();var V=n("gKBM"),Z=n("pjJp"),W=n("c/oE"),q=n("v7L1"),Q=n("VkX4"),K=n("CJMb"),J=n("cNBb"),ee=n("EXHp"),te=n("18b0"),ne=n("cokP"),ie=n("OS7q"),se=n("yotz"),ae=n("iAS6"),oe=n("gJiX"),re=n("eiII"),ce=n("sfSt"),le=n("HsDr"),de=n("o9eT"),he=n("yvyY"),ge=n("NtPp"),ue=n("UlxN"),be=n("dO68"),fe=n("B23V"),pe=n("lDT0"),me=n("9Aot"),Me=n("4ykm"),Ce=n("Rnop"),Se=n("cs8y"),Te=n("ueDg"),xe=n("b6KT"),ye=n("iInd"),Ie=n("3A0Z"),Oe=n("eCtd"),Ae=n("HEOu"),ve=n("DSso"),we=n("ni7p"),Ee=n("w13q"),ze=n("SMHo"),Le=n("Bxc1"),ke=n("pZRy"),Pe=n("565b"),_e=n("al+g");function Re(e,t){1&e&&(p.Yb(0,"fl-text",6),p.cc(1,7),p.Xb())}function je(e,t){if(1&e&&(p.Yb(0,"fl-link",8),p.bd(1),p.Xb()),2&e){const e=p.rc(3);p.Ac("link",null==e.state?null:e.state.linkUrl),p.zc("queryParams",null==e.state?null:e.state.linkQueryParams),p.Gb(1),p.dd(" ",null==e.state?null:e.state.linkText," ")}}function Ue(e,t){}function Be(e,t){if(1&e&&(p.Wb(0),p.Zc(1,Re,2,0,"fl-text",3),p.Zc(2,je,2,3,"fl-link",4),p.Zc(3,Ue,0,0,"ng-template",5),p.Vb()),2&e){p.rc();const e=p.Mc(4),t=p.rc();p.Gb(1),p.zc("ngIf","hireme"===t.state.name),p.Gb(1),p.zc("ngIf","hireme"!==t.state.name),p.Gb(1),p.zc("ngTemplateOutlet",e)}}function $e(e,t){if(1&e&&(p.Yb(0,"fl-text",19),p.bd(1),p.Tb(2,"fl-online-indicator",20),p.Xb()),2&e){const e=p.rc(4);p.zc("flMarginBottom",e.Margin.XXSMALL)("weight",e.FontWeight.BOLD),p.Gb(1),p.dd(" ",e.state.otherUserName," "),p.Gb(1),p.zc("isOnline",e.isOnline)("flMarginRight",e.Margin.SMALL)}}function Ge(e,t){if(1&e&&(p.Yb(0,"fl-text",19),p.bd(1),p.Xb()),2&e){const e=p.rc(4);p.zc("flMarginBottom",e.Margin.XXSMALL)("weight",e.FontWeight.BOLD),p.Gb(1),p.dd(" ",e.otherMembersList," ")}}function Fe(e,t){1&e&&(p.Yb(0,"fl-text"),p.cc(1,21),p.Xb())}function De(e,t){if(1&e&&(p.Yb(0,"fl-link",22),p.bd(1),p.Xb()),2&e){const e=p.rc(4);p.zc("link",e.state.linkUrl)("queryParams",e.state.linkQueryParams)("color",e.chatBoxMode?e.LinkColor.INHERIT:e.LinkColor.DARK)("hoverColor",e.LinkHoverColor.INHERIT),p.Gb(1),p.dd(" ",e.state.linkText," ")}}function Ne(e,t){if(1&e&&(p.Yb(0,"fl-text",23),p.ic(1,24),p.Tb(2,"fl-relative-time",25),p.fc(),p.Xb()),2&e){const e=p.rc(4);p.zc("fontType",e.FontType.PARAGRAPH)("color",e.FontColor.MID)("size",e.TextSize.XXSMALL)("flHideMobile",!0),p.Gb(2),p.zc("date",e.state.timeSubmitted)("size",e.TextSize.XXSMALL)}}function Xe(e,t){if(1&e&&(p.Yb(0,"fl-grid",13),p.Yb(1,"fl-col",14),p.Zc(2,$e,3,5,"fl-text",15),p.Zc(3,Ge,2,3,"fl-text",15),p.Xb(),p.Yb(4,"fl-col"),p.Yb(5,"fl-bit",16),p.Zc(6,Fe,2,0,"fl-text",0),p.Zc(7,De,2,5,"fl-link",17),p.Xb(),p.Zc(8,Ne,3,6,"fl-text",18),p.Xb(),p.Xb()),2&e){const e=p.rc(3);p.zc("vAlign",e.VerticalAlignment.VERTICAL_STRETCH),p.Gb(1),p.zc("flHideDesktop",!0),p.Gb(1),p.zc("ngIf",!e.isGroupChatThread),p.Gb(1),p.zc("ngIf",e.isGroupChatThread),p.Gb(2),p.zc("flMarginBottom",e.Margin.XXSMALL),p.Gb(1),p.zc("ngIf","hireme"===e.state.name),p.Gb(1),p.zc("ngIf","hireme"!==e.state.name),p.Gb(1),p.zc("ngIf","hireme"!==e.state.name)}}function Ye(e,t){1&e&&(p.Wb(0),p.cc(1,27),p.Vb())}function He(e,t){if(1&e&&(p.Wb(0),p.cc(1,28),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function Ve(e,t){if(1&e&&(p.Wb(0),p.cc(1,29),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function Ze(e,t){if(1&e&&(p.Wb(0),p.cc(1,30),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function We(e,t){1&e&&(p.ic(0,31,1),p.Ub(1),p.fc())}function qe(e,t){if(1&e&&(p.Wb(0),p.ic(1,31),p.Zc(2,We,2,0,"ng-container",0),p.fc(),p.Vb()),2&e){const e=p.rc(4);p.Gb(2),p.zc("ngIf",!(null!=e.state.otherUserName&&e.state.otherUserName.endsWith("."))),p.gc(e.state.otherUserName),p.dc(1)}}function Qe(e,t){if(1&e&&(p.Wb(0),p.cc(1,32),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function Ke(e,t){if(1&e&&(p.Wb(0),p.cc(1,33),p.Vb()),2&e){const e=p.rc(4);p.Gb(1),p.gc(e.state.otherUserName),p.dc(1)}}function Je(e,t){if(1&e&&(p.Yb(0,"fl-bit"),p.Yb(1,"fl-text",26),p.Zc(2,Ye,2,0,"ng-container",0),p.Zc(3,He,2,1,"ng-container",0),p.Zc(4,Ve,2,1,"ng-container",0),p.Zc(5,Ze,2,1,"ng-container",0),p.sc(6,"flAsync"),p.Zc(7,qe,3,2,"ng-container",0),p.Zc(8,Qe,2,1,"ng-container",0),p.Zc(9,Ke,2,1,"ng-container",0),p.Xb(),p.Xb()),2&e){const e=p.rc(3);p.Gb(1),p.zc("flMarginBottom",e.Margin.XXSMALL),p.Gb(1),p.zc("ngIf","hireme"===e.state.name),p.Gb(1),p.zc("ngIf","projectAwardHourly"===e.state.name||"projectAwardFixed"===e.state.name),p.Gb(1),p.zc("ngIf","projectAcceptHourly"===e.state.name||"projectAcceptFixed"===e.state.name||"projectAcceptRedirect"===e.state.name),p.Gb(1),p.zc("ngIf","setupBilling"===e.state.name&&p.tc(6,8,e.billingEnabled$)),p.Gb(2),p.zc("ngIf","milestoneCreateRedirect"===e.state.name||"milestoneCreateFromRequest"===e.state.name||"milestoneCreateInitial"===e.state.name||"milestoneCreate"===e.state.name),p.Gb(1),p.zc("ngIf","trackTime"===e.state.name),p.Gb(1),p.zc("ngIf","requestMilestone"===e.state.name||"requestMilestoneRedirect"===e.state.name)}}function et(e,t){}function tt(e,t){if(1&e&&(p.Yb(0,"fl-grid",9),p.Yb(1,"fl-col",10),p.Zc(2,Xe,9,8,"fl-grid",11),p.Zc(3,Je,10,10,"fl-bit",0),p.Xb(),p.Yb(4,"fl-col",10),p.Yb(5,"fl-bit",12),p.Zc(6,et,0,0,"ng-template",5),p.Xb(),p.Xb(),p.Xb()),2&e){p.rc();const e=p.Mc(4),t=p.rc();p.zc("hAlign",t.HorizontalAlignment.HORIZONTAL_CENTER)("vAlign",t.VerticalAlignment.VERTICAL_CENTER),p.Gb(1),p.zc("col",12)("colTablet",t.extended?12:9)("colDesktopSmall",t.extended?12:9),p.Gb(1),p.zc("ngIf",!t.extended),p.Gb(1),p.zc("ngIf",t.extended),p.Gb(1),p.zc("col",12)("colTablet",t.extended?12:3)("colDesktopSmall",t.extended?12:3),p.Gb(2),p.zc("ngTemplateOutlet",e)}}function nt(e,t){1&e&&(p.Wb(0),p.cc(1,36),p.Vb())}function it(e,t){1&e&&(p.Wb(0),p.cc(1,37),p.Vb())}function st(e,t){1&e&&(p.Wb(0),p.cc(1,38),p.Vb())}function at(e,t){1&e&&(p.Wb(0),p.cc(1,39),p.Vb())}function ot(e,t){1&e&&(p.Wb(0),p.cc(1,40),p.Vb())}function rt(e,t){1&e&&(p.Wb(0),p.cc(1,41),p.Vb())}function ct(e,t){1&e&&(p.Wb(0),p.cc(1,42),p.Vb())}function lt(e,t){1&e&&(p.Wb(0),p.cc(1,43),p.Vb())}function dt(e,t){1&e&&(p.Wb(0),p.cc(1,44),p.Vb())}function ht(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",35),p.nc("click",function(){return p.Pc(e),p.rc(4).handleButtonClick()}),p.Zc(1,nt,2,0,"ng-container",0),p.Zc(2,it,2,0,"ng-container",0),p.Zc(3,st,2,0,"ng-container",0),p.Zc(4,at,2,0,"ng-container",0),p.Zc(5,ot,2,0,"ng-container",0),p.Zc(6,rt,2,0,"ng-container",0),p.Zc(7,ct,2,0,"ng-container",0),p.Zc(8,lt,2,0,"ng-container",0),p.Zc(9,dt,2,0,"ng-container",0),p.Xb()}if(2&e){const e=p.rc(4);p.Bc("flTrackingLabel","contextBoxButton-",null==e.state?null:e.state.name,""),p.zc("busy",e.buttonBusy)("color",e.buttonColor)("size",e.ButtonSize.MINI)("sizeTablet",e.chatBoxMode?e.ButtonSize.MINI:e.ButtonSize.SMALL),p.Hb("data-uitest-target",null==e.state||null==e.state.button?null:e.state.button.tag),p.Gb(1),p.zc("ngIf","hireme"===e.state.name),p.Gb(1),p.zc("ngIf","projectAwardHourly"===e.state.name||"projectAwardFixed"===e.state.name),p.Gb(1),p.zc("ngIf","projectAcceptHourly"===e.state.name||"projectAcceptFixed"===e.state.name||"projectAcceptRedirect"===e.state.name),p.Gb(1),p.zc("ngIf","setupBilling"===e.state.name),p.Gb(1),p.zc("ngIf","payFailedInvoices"===e.state.name),p.Gb(1),p.zc("ngIf","milestoneCreateRedirect"===e.state.name||"milestoneCreateFromRequest"===e.state.name||"milestoneCreateInitial"===e.state.name||"milestoneCreate"===e.state.name),p.Gb(1),p.zc("ngIf","trackTime"===e.state.name),p.Gb(1),p.zc("ngIf","requestMilestone"===e.state.name||"requestMilestoneRedirect"===e.state.name),p.Gb(1),p.zc("ngIf","projectAdmin"===e.state.name||"userAdmin"===e.state.name)}}function gt(e,t){if(1&e&&(p.Wb(0),p.Zc(1,ht,10,15,"fl-button",34),p.Vb()),2&e){const e=p.rc(3);p.Gb(1),p.zc("ngIf",e.state.button)}}function ut(e,t){if(1&e&&(p.Zc(0,gt,2,1,"ng-container",0),p.sc(1,"flAsync")),2&e){const e=p.rc(2);p.zc("ngIf",p.tc(1,1,e.billingEnabled$)||"setupBilling"!==(null==e.state?null:e.state.name))}}function bt(e,t){if(1&e&&(p.Wb(0),p.Zc(1,Be,4,3,"ng-container",0),p.Zc(2,tt,7,11,"fl-grid",1),p.Zc(3,ut,2,3,"ng-template",null,2,p.ad),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngIf",e.chatBoxMode),p.Gb(1),p.zc("ngIf",!e.chatBoxMode)}}function ft(e,t){if(1&e&&p.Tb(0,"fl-online-indicator",20),2&e){const e=p.rc(2);p.zc("isOnline",e.isOnline)("flMarginRight",e.Margin.SMALL)}}function pt(e,t){if(1&e&&(p.Yb(0,"fl-text",47),p.cc(1,48),p.Xb()),2&e){const e=p.rc(2);p.zc("color",e.FontColor.MID)("fontType",e.FontType.PARAGRAPH)("size",e.TextSize.XXSMALL)}}function mt(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-text",19),p.bd(2),p.Zc(3,ft,1,2,"fl-online-indicator",45),p.Xb(),p.Zc(4,pt,2,3,"fl-text",46),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("flMarginBottom",e.Margin.XXXSMALL)("weight",e.FontWeight.BOLD),p.Gb(1),p.dd(" ",e.otherMembersList," "),p.Gb(1),p.zc("ngIf",!e.isGroupChatThread),p.Gb(1),p.zc("ngIf",!e.isGroupChatThread&&e.isOtherMemberSupportUser)}}let Mt=(()=>{class e{constructor(e,t,n,i,s){this.router=e,this.modalService=t,this.datastore=n,this.changeDetectorRef=i,this.featureFlagService=s,this.ButtonSize=be.a,this.FontType=de.b,this.FontColor=Ce.a,this.TextSize=de.f,this.FontWeight=de.c,this.HorizontalAlignment=re.b,this.LinkColor=pe.a,this.LinkHoverColor=pe.c,this.Margin=me.a,this.VerticalAlignment=re.c,this.otherMembers=[],this.extended=!1,this.buttonColor=fe.a.SECONDARY,this.buttonBusy=!1,this.greenBtnStates=["projectAwardHourly","projectAwardFixed","projectAcceptFixed","projectAcceptHourly","projectAcceptRedirect"]}ngOnInit(){this.billingEnabled$=this.featureFlagService.getFlag(ue.b.BILLING)}handleButtonClick(){if(this.state&&this.state.name)switch(this.state.name){case"hireme":case"milestoneCreateRedirect":case"projectAwardHourly":case"projectAcceptRedirect":case"setupBilling":case"trackTime":case"requestMilestoneRedirect":case"payFailedInvoices":this.state.button&&"LINK"===this.state.button.data.type&&this.goToUrl(this.state.button.data.buttonUrl,this.state.button.data.buttonExtras);break;case"projectAwardFixed":this.awardFixed();break;case"milestoneCreate":case"milestoneCreateInitial":case"milestoneCreateFromRequest":this.createMilestone();break;case"requestMilestone":this.requestMilestone();break;case"projectAcceptHourly":case"projectAcceptFixed":this.accept();break;default:console.warn("Unknown context box state button clicked")}}ngOnChanges(e){if(this.state&&this.state.name&&(this.buttonColor=this.greenBtnStates.includes(this.state.name)?fe.a.SUCCESS:fe.a.SECONDARY),"otherMembers"in e){const e=this.otherMembers.slice(0,3).map(e=>e.displayName).join(", ");this.otherMembersList=this.otherMembers.length>3?`${e}, +${this.otherMembers.length-3}`:e,this.isOtherMemberSupportUser=!!this.otherMembers.find(e=>Object(xe.f)(e))}}goToUrl(e,t){t?this.router.navigate([e],t):this.router.navigate([e])}awardFixed(){if(this.state&&this.state.button&&"AWARD_FIXED"===this.state.button.data.type){const{bidId:e,projectId:t}=this.state.button.data;this.buttonBusy=!0;const n=this.modalService.open("AwardModal",{inputs:{bidId:e,projectId:t},size:Me.a.LARGE,edgeToEdge:!0,mobileFullscreen:!0});n.afterOpen().toPromise().then(e=>{this.buttonBusy=!1,this.changeDetectorRef.markForCheck()}),n.afterClosed().toPromise().then(e=>{e&&this.goToUrl(`/projects/${t}.html`,{fragment:"/management"})})}}createMilestone(){if(this.state&&this.state.button&&"CREATE_MILESTONE"===this.state.button.data.type&&"hireme"!==this.state.name){this.buttonBusy=!0;const{bidderId:e,bidId:t,projectId:n,currencyDetails:i}=this.state.button.data;this.modalService.open("MilestoneCreateModal",{inputs:{bidId:t,projectId:n,currencyDetails:i,username:this.state.otherUserName,bidderId:e},size:Me.a.SMALL}).afterOpen().toPromise().then(()=>{this.changeDetectorRef.markForCheck(),this.buttonBusy=!1})}}requestMilestone(){this.state&&this.state.button&&"hireme"!==this.state.name&&"REQUEST_MILESTONE"===this.state.button.data.type&&(this.buttonBusy=!0,this.router.navigate(["/projects",this.state.button.data.projectId,"payments"],{queryParams:{request_milestone:1}}),this.buttonBusy=!1)}accept(){if(this.state&&this.state.button&&"ACCEPT"===this.state.button.data.type){this.buttonBusy=!0;const{projectId:e}=this.state.button.data;this.datastore.collection("bids",t=>t.where("projectId","==",e)).update(this.state.button.data.bidId,{awardStatus:Te.BidAwardStatusApi.AWARDED}).then(t=>{this.buttonBusy=!1,this.changeDetectorRef.markForCheck(),"error"!==t.status||t.errorCode!==Se.ErrorCodeApi.ESCROWCOM_ACCOUNT_UNLINKED&&t.errorCode!==Se.ErrorCodeApi.PROFILE_INCOMPLETE&&t.errorCode!==Se.ErrorCodeApi.NDA_NOT_SIGNED||this.goToUrl(`/projects/${e}`)})}}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(ye.e),p.Sb(Ie.b),p.Sb(Oe.a),p.Sb(p.h),p.Sb(Ae.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-context-box"]],inputs:{state:"state",isOnline:"isOnline",isGroupChatThread:"isGroupChatThread",otherMembers:"otherMembers",extended:"extended",chatBoxMode:"chatBoxMode"},features:[p.Eb],decls:2,vars:2,consts:function(){let e,t,n,i,s,a,o,r,c,l,d,h,g,u,b,f,p,m,M,C;return e=" I'm available! Let's work together. ",t=" I'm available! Let's work together. ",n=" Posted " + "\ufffd#2\ufffd" + "" + "\ufffd/#2\ufffd" + "",i=" I'm available! Let's work together. ",s=" To start working with this freelancer, award " + "\ufffd0\ufffd" + " the project. They will be notified that you have chosen them for your project. ",a=" " + "\ufffd0\ufffd" + " has chosen you for their project. Accept the project to begin working. ",o=" Set up billing to allow " + "\ufffd0\ufffd" + " to track hours they work, and invoice you automatically each Monday. ",r=" Create a Milestone Payment for " + "\ufffd0\ufffd" + "" + "\ufffd*2:1\ufffd\ufffd#1:1\ufffd" + "." + "\ufffd/#1:1\ufffd\ufffd/*2:1\ufffd" + " This is a secure deposit for work they are about to do which you can release when you're happy. ",c=" Track the hours you are working, and we will automatically invoice " + "\ufffd0\ufffd" + " each Monday. ",l=" Create a request for " + "\ufffd0\ufffd" + " to make a Milestone Payment. They will be notified that you have requested a milestone payment. ",d=" Hire Me! ",h=" Award ",g=" Accept ",u=" Setup Billing ",b=" Pay Outstanding Bill ",f=" Create Milestone ",p=" Track Time ",m=" Request Milestone ",M=" View Admin ",C=" Freelancer Staff ",[[4,"ngIf"],[3,"hAlign","vAlign",4,"ngIf"],["contextButton",""],["class","ContextBox-title",4,"ngIf"],["class","ContextBox-title","flTrackingLabel","ContextBox-link",3,"queryParams","link",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"ContextBox-title"],e,["flTrackingLabel","ContextBox-link",1,"ContextBox-title",3,"queryParams","link"],[3,"hAlign","vAlign"],[3,"col","colTablet","colDesktopSmall"],[3,"vAlign",4,"ngIf"],[1,"ContextBox-buttonWrapper"],[3,"vAlign"],[3,"flHideDesktop"],[3,"flMarginBottom","weight",4,"ngIf"],[1,"ContextBox-header",3,"flMarginBottom"],["class","ContextBox-projectLink","flTrackingLabel","Inbox.ProjectLink",3,"link","queryParams","color","hoverColor",4,"ngIf"],[3,"fontType","color","size","flHideMobile",4,"ngIf"],[3,"flMarginBottom","weight"],[3,"isOnline","flMarginRight"],t,["flTrackingLabel","Inbox.ProjectLink",1,"ContextBox-projectLink",3,"link","queryParams","color","hoverColor"],[3,"fontType","color","size","flHideMobile"],n,[3,"date","size"],[3,"flMarginBottom"],i,s,a,o,r,c,l,["class","ContextBox-button",3,"flTrackingLabel","busy","color","size","sizeTablet","click",4,"ngIf"],[1,"ContextBox-button",3,"flTrackingLabel","busy","color","size","sizeTablet","click"],d,h,g,u,b,f,p,m,M,[3,"isOnline","flMarginRight",4,"ngIf"],[3,"color","fontType","size",4,"ngIf"],[3,"color","fontType","size"],C]},template:function(e,t){1&e&&(p.Zc(0,bt,5,2,"ng-container",0),p.Zc(1,mt,5,5,"ng-container",0)),2&e&&(p.zc("ngIf",t.state),p.Gb(1),p.zc("ngIf",!t.state&&!t.chatBoxMode))},directives:[i.q,i.v,de.e,pe.b,ve.a,re.a,we.a,Ee.a,ze.a,me.b,Le.a,ke.b,fe.b,Pe.a],pipes:[_e.a],styles:[".ContextBox-title[_ngcontent-%COMP%]{font-size:14px;line-height:1.43;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:0 1 auto;padding-right:4px}.ContextBox-buttonWrapper[_ngcontent-%COMP%]{align-items:flex-start;display:flex;flex-direction:column}@media (min-width:768px){.ContextBox-buttonWrapper[_ngcontent-%COMP%]{align-items:flex-end}}.ContextBox-button[_ngcontent-%COMP%]{flex:0 0 auto;white-space:nowrap}.ContextBox-header[_ngcontent-%COMP%]{max-width:400px;overflow:hidden;white-space:nowrap}@media (min-width:960px){.ContextBox-header[_ngcontent-%COMP%]{max-width:600px}}.ContextBox-projectLink[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block;width:100%}"],changeDetection:0}),e})();function Ct(e,t){if(1&e&&(p.Wb(0),p.Tb(1,"app-context-box",3),p.Vb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("state",e.contextBoxState)("isOnline",e.isOnline)("isGroupChatThread",e.isGroupChatThread)("chatBoxMode",!1)("otherMembers",e.otherMembers)}}function St(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-heading",4),p.cc(2,5),p.Xb(),p.Vb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("headingType",e.HeadingType.H4)("size",e.TextSize.LARGE)}}function Tt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-view-header",1),p.nc("menuClick",function(){return p.Pc(e),p.rc().openChatOptionsDrawer()}),p.Zc(1,Ct,2,5,"ng-container",2),p.Zc(2,St,3,2,"ng-container",2),p.Xb()}if(2&e){const e=p.rc();p.zc("sideNotch",!1)("showMenu",!e.emptyState),p.Gb(1),p.zc("ngIf",!e.emptyState),p.Gb(1),p.zc("ngIf",e.emptyState)}}let xt=(()=>{class e{constructor(){this.ViewHeaderType=he.b,this.VerticalAlignment=re.c,this.TextSize=de.f,this.HeadingType=ce.c,this.IconColor=le.c,this.IconSize=le.e,this.chatOptionsDrawerToggle=new p.n}openChatOptionsDrawer(){this.chatOptionsDrawerToggle.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-messaging-inbox-header"]],inputs:{emptyState:"emptyState",contextBoxState:"contextBoxState",isOnline:"isOnline",isGroupChatThread:"isGroupChatThread",otherMembers:"otherMembers"},outputs:{chatOptionsDrawerToggle:"chatOptionsDrawerToggle"},decls:1,vars:2,consts:function(){let e;return e=" Messages ",[[3,"sideNotch","showMenu","menuClick",4,"flViewHeaderTemplate","flViewHeaderTemplateFullReplacement"],[3,"sideNotch","showMenu","menuClick"],[4,"ngIf"],[1,"ContextBox",3,"state","isOnline","isGroupChatThread","chatBoxMode","otherMembers"],[3,"headingType","size"],e]},template:function(e,t){1&e&&p.Zc(0,Tt,3,4,"fl-view-header",0),2&e&&p.zc("flViewHeaderTemplate",t.ViewHeaderType.SHOW_ALL)("flViewHeaderTemplateFullReplacement",!0)},directives:[he.a,ge.b,i.q,Mt,ce.b],styles:["[_nghost-%COMP%]{border-right:1px solid #dedede;display:block}.ContextBox[_ngcontent-%COMP%]{display:block;padding-bottom:12px;padding-top:12px}@media (min-width:960px){.ContextBox[_ngcontent-%COMP%]{padding-bottom:8px;padding-top:8px}}"],changeDetection:0}),e})();var yt=n("HLWz");function It(e,t){if(1&e&&(p.Yb(0,"fl-bit",4),p.Tb(1,"fl-bit",5),p.Xb()),2&e){const e=p.rc();p.Gb(1),p.Wc("width",e.progressBarWidth)}}function Ot(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",6),p.nc("click",function(){return p.Pc(e),p.rc().removeAttachment()}),p.Tb(1,"fl-icon",7),p.Xb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("color",e.IconColor.MID)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}let At=(()=>{class e{constructor(){this.FontType=de.b,this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.removeFailedUpload=new p.n,this.progressBarWidth="0%"}ngOnChanges(e){"progress"in e&&(this.progressBarWidth=this.getProgressBarWidth(e.progress.currentValue))}removeAttachment(){this.removeFailedUpload.emit(this.id)}getProgressBarWidth(e){return e&&void 0!==e.loaded&&void 0!==e.total?`${Math.round(100*e.loaded/e.total)}%`:"0%"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-attachment-upload"]],hostVars:2,hostBindings:function(e,t){2&e&&p.Kb("UploadFailed",t.failed)},inputs:{id:"id",progress:"progress",filename:"filename",failed:"failed"},outputs:{removeFailedUpload:"removeFailedUpload"},features:[p.Eb],decls:5,vars:7,consts:function(){let e;return e="Failed, please re-attach",[["name","ui-file",3,"color","size","hoverColor"],[1,"TextLabel",3,"fontType"],["class","ProgressBarContainer",4,"ngIf"],["flTrackingLabel","removeAttachment",3,"click",4,"ngIf"],[1,"ProgressBarContainer"],[1,"ProgressBar"],["flTrackingLabel","removeAttachment",3,"click"],["name","ui-close","label",e,3,"color","size","hoverColor"]]},template:function(e,t){1&e&&(p.Tb(0,"fl-icon",0),p.Yb(1,"fl-text",1),p.bd(2),p.Xb(),p.Zc(3,It,2,2,"fl-bit",2),p.Zc(4,Ot,2,3,"fl-button",3)),2&e&&(p.zc("color",t.IconColor.MID)("size",t.IconSize.SMALL)("hoverColor",t.HoverColor.PRIMARY),p.Gb(1),p.zc("fontType",t.FontType.SPAN),p.Gb(1),p.dd(" ",t.filename," "),p.Gb(1),p.zc("ngIf",!t.failed),p.Gb(1),p.zc("ngIf",t.failed))},directives:[le.d,de.e,i.q,Ee.a,fe.b,ve.a],styles:["[_nghost-%COMP%]{font-size:13px;line-height:1.2;background-color:#ddf5d3;display:flex;padding:8px;position:relative;width:100%}.UploadFailed[_nghost-%COMP%]{background-color:#ffcdc7}.TextLabel[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1 1 100%;padding-left:4px;width:100px}.ProgressBarContainer[_ngcontent-%COMP%]{background-color:#dedede;bottom:0;height:4px;left:0;position:absolute;width:100%}.ProgressBar[_ngcontent-%COMP%]{background-color:#2a934d;height:100%}.ClearUploadBtn[_ngcontent-%COMP%]{margin-left:auto}"],changeDetection:0}),e})();var vt=n("zQqY");function wt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-bit",3),p.Tb(1,"fl-icon",4),p.Yb(2,"fl-bit",5),p.bd(3),p.Xb(),p.Yb(4,"fl-bit",6),p.Yb(5,"fl-text",7),p.bd(6),p.sc(7,"fileSize"),p.Xb(),p.Yb(8,"fl-button",8),p.nc("click",function(){p.Pc(e);const n=t.$implicit;return p.rc(2).handleRemoveAttachment(n)}),p.Tb(9,"fl-icon",9),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=t.$implicit,n=p.rc(2);p.Gb(1),p.zc("color",n.IconColor.MID)("size",n.IconSize.SMALL)("hoverColor",n.HoverColor.PRIMARY),p.Gb(2),p.dd(" ",e.name," "),p.Gb(2),p.zc("fontType",n.FontType.SPAN),p.Gb(1),p.dd(" ",p.tc(7,9,e.size)," "),p.Gb(3),p.zc("color",n.IconColor.MID)("size",n.IconSize.SMALL)("hoverColor",n.HoverColor.PRIMARY)}}function Et(e,t){if(1&e&&(p.Wb(0),p.Zc(1,wt,10,11,"fl-bit",2),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngForOf",e.attachments)("ngForTrackBy",e.identifyAttachment)}}function zt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-attachment-upload",11),p.nc("removeFailedUpload",function(t){return p.Pc(e),p.rc(2).removeFailedUpload(t)}),p.sc(1,"flAsync"),p.Xb()}if(2&e){const e=t.$implicit;p.zc("id",e.id)("progress",p.tc(1,4,e.progress$))("filename",e.filename)("failed",e.failed)}}function Lt(e,t){if(1&e&&(p.Wb(0),p.Zc(1,zt,2,6,"app-attachment-upload",10),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngForOf",e.uploads)}}let kt=(()=>{class e{constructor(){this.FontType=de.b,this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.removeAttachment=new p.n,this.removeUpload=new p.n}removeFailedUpload(e){this.removeUpload.emit(e)}handleRemoveAttachment(e){this.removeAttachment.emit(e)}identifyAttachment(e,t){return t.name}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-attachment-list"]],inputs:{thread:"thread",attachments:"attachments",uploads:"uploads"},outputs:{removeAttachment:"removeAttachment",removeUpload:"removeUpload"},decls:3,vars:2,consts:function(){let e;return e="Remove File",[[1,"AttachmentList"],[4,"ngIf"],["class","AttachmentItem",4,"ngFor","ngForOf","ngForTrackBy"],[1,"AttachmentItem"],["name","ui-file",3,"color","size","hoverColor"],[1,"AttachmentItem-filename"],[1,"AttachmentItem-details"],[1,"AttachmentItem-filesize",3,"fontType"],["flTrackingLabel","removeAttachment",1,"AttachmentItem-close",3,"click"],["name","ui-close","label",e,3,"color","size","hoverColor"],[3,"id","progress","filename","failed","removeFailedUpload",4,"ngFor","ngForOf"],[3,"id","progress","filename","failed","removeFailedUpload"]]},template:function(e,t){1&e&&(p.Yb(0,"fl-scrollable-content",0),p.Zc(1,Et,2,2,"ng-container",1),p.Zc(2,Lt,2,1,"ng-container",1),p.Xb()),2&e&&(p.Gb(1),p.zc("ngIf",t.attachments),p.Gb(1),p.zc("ngIf",t.uploads))},directives:[yt.a,i.q,i.p,Ee.a,le.d,de.e,fe.b,ve.a,At],pipes:[vt.a,_e.a],styles:["[_nghost-%COMP%]{background-color:#dbf4ff;display:flex;flex-direction:column;position:relative}.AttachmentList[_ngcontent-%COMP%]{max-height:100px}.AttachmentItem[_ngcontent-%COMP%]{font-size:14px;line-height:1.43;align-items:center;border-top:1px solid #dedede;color:#75787d;display:flex;padding:4px 8px;width:100%}.AttachmentItem-filename[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1 1 100%;padding-left:4px;width:100px}.AttachmentItem-details[_ngcontent-%COMP%]{align-self:flex-end;display:flex;flex:1 0 auto;justify-content:flex-end;margin-left:auto}.AttachmentItem-filesize[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;padding-right:8px}"],changeDetection:0}),e})();var Pt=n("rurT");const _t=["*"];let Rt=(()=>{class e{constructor(){this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.close=new p.n}closeErrorAlert(){this.close.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-error-alert"]],outputs:{close:"close"},ngContentSelectors:_t,decls:6,vars:3,consts:function(){let e;return e="Hide",[[1,"CloseButton"],["flTrackingLabel","closeErrorAlert",3,"click"],["name","ui-close","label",e,3,"color","size","hoverColor"],[1,"ErrorString"]]},template:function(e,t){1&e&&(p.yc(),p.Yb(0,"fl-bit"),p.Yb(1,"fl-bit",0),p.Yb(2,"fl-button",1),p.nc("click",function(){return t.closeErrorAlert()}),p.Tb(3,"fl-icon",2),p.Xb(),p.Xb(),p.Yb(4,"fl-bit",3),p.xc(5),p.Xb(),p.Xb()),2&e&&(p.Gb(3),p.zc("color",t.IconColor.MID)("size",t.IconSize.SMALL)("hoverColor",t.HoverColor.PRIMARY))},directives:[Ee.a,fe.b,ve.a,le.d],styles:["[_nghost-%COMP%]{align-items:flex-end;background:#ffcdc7;color:#891b21;display:block;flex-direction:column;padding:8px}.ErrorString[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;font-weight:700;padding:4px;width:100%}.CloseButton[_ngcontent-%COMP%]{float:right;padding-left:4px}"]}),e})();var jt=n("tlTr"),Ut=n("YKAE"),Bt=n("tbiQ"),$t=n("tsv4"),Gt=n("n0rP"),Ft=n("riYv"),Dt=n("Z8zW");function Nt(e,t){if(1&e&&(p.Tb(0,"fl-online-indicator",14),p.sc(1,"isOnline"),p.sc(2,"flAsync")),2&e){const e=p.rc();p.zc("username",e.otherUser.username)("isOnline",!!p.uc(1,2,e.otherUser,p.tc(2,5,e.onlineOfflineStatuses$)))}}function Xt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-link",15),p.nc("click",function(t){return p.Pc(e),p.rc().handleBlockedClick(t)}),p.bd(1),p.Xb()}if(2&e){const e=p.rc();p.zc("color",e.LinkColor.LIGHT)("weight",e.LinkWeight.BOLD)("link",e.titleLink)("queryParams",e.titleParams)("hoverColor",e.LinkHoverColor.LIGHT),p.Hb("data-uitest-target",e.project?"chatbox-header-project-name":"chatbox-header-username"),p.Gb(1),p.dd(" ",e.title," ")}}function Yt(e,t){if(1&e&&(p.Yb(0,"fl-bit",16),p.bd(1),p.Xb()),2&e){const e=p.rc();p.Hb("data-uitest-target",e.project?"chatbox-header-project-name":"chatbox-header-username"),p.Gb(1),p.dd(" ",e.title," ")}}function Ht(e,t){if(1&e&&(p.Yb(0,"fl-bit",16),p.bd(1),p.Xb()),2&e){const e=p.rc();p.Hb("data-uitest-target",e.project?"chatbox-header-project-name":"chatbox-header-username"),p.Gb(1),p.dd(" ",e.title," ")}}function Vt(e,t){if(1&e&&(p.Yb(0,"fl-bit",17),p.bd(1),p.Xb()),2&e){const e=p.rc();p.Gb(1),p.dd(" ",e.secondaryTitle," ")}}function Zt(e,t){if(1&e&&p.Tb(0,"fl-relative-time",18),2&e){const e=p.rc();p.zc("color",e.FontColor.LIGHT)("size",e.TextSize.XXXSMALL)("date",e.lastSeenDate)("includeSeconds",!1)("strict",!0)}}function Wt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-tooltip",19),p.Yb(1,"fl-button",20),p.nc("click",function(t){p.Pc(e);const n=p.rc();return n.handleAudioCallClick(t,null==n.callsEnabled?null:n.callsEnabled.audio.recorded)}),p.Tb(2,"fl-icon",21),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.zc("position",e.TooltipPosition.TOP_CENTER)("message",!(null!=e.callsEnabled&&e.callsEnabled.audio.enabled)&&(null==e.callsEnabled?null:e.callsEnabled.reason)||"Start an audio call"),p.Gb(1),p.Hb("data-uitest-target","chatbox-audiochat-button"),p.Gb(1),p.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)("name","ui-phone")}}function qt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-tooltip",19),p.Yb(1,"fl-button",22),p.nc("click",function(t){return p.Pc(e),p.rc().handleVideoCallClick(t)}),p.Tb(2,"fl-icon",21),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.zc("position",e.TooltipPosition.TOP_CENTER)("message",!(null!=e.callsEnabled&&e.callsEnabled.video.enabled)&&(null==e.callsEnabled?null:e.callsEnabled.reason)||"Start a video call"),p.Gb(1),p.Hb("data-uitest-target","chatbox-videochat-button"),p.Gb(1),p.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)("name","ui-video-camera-v2")}}function Qt(e,t){if(1&e&&p.Tb(0,"fl-icon",26),2&e){const e=p.rc(2);p.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function Kt(e,t){if(1&e&&p.Tb(0,"fl-icon",27),2&e){const e=p.rc(2);p.zc("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function Jt(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",23),p.nc("click",function(t){return p.Pc(e),p.rc().handleGroupchatButtonClick(t)}),p.Zc(1,Qt,1,3,"fl-icon",24),p.Zc(2,Kt,1,3,"fl-icon",25),p.Xb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("ngIf",e.canManageChatMembers()),p.Gb(1),p.zc("ngIf",!e.canManageChatMembers())}}let en=(()=>{class e{constructor(e){this.videochat=e,this.FontColor=Ce.a,this.HoverColor=le.a,this.IconColor=le.c,this.IconSize=le.e,this.LinkColor=pe.a,this.LinkHoverColor=pe.c,this.LinkWeight=pe.f,this.TextSize=de.f,this.TooltipPosition=Ut.b,this.focusState=jt.a.Neither,this.isUserSupportAgent=!1,this.closeChat=new p.n,this.handleSettingsHeaderClick=new p.n,this.handleGroupchatHeaderClick=new p.n,this.makingCall=new p.n,this.isFocused=!1,this.isUnread=!1,this.isSupportChat=!1,this.isThreadSupportSession=!1,this.isArrowProject=!1,this.threadHasContext=!1,this.showLastSeen=!1}static getSupportQueueTitle(e){switch(e.type){case Gt.SupportTypeApi.TECHNICAL:return"Technical";case Gt.SupportTypeApi.RECRUITER:return"Recruiter Chat";case Gt.SupportTypeApi.GENERAL:return"General Chat";case Gt.SupportTypeApi.LOCAL:return"Local Jobs";case Gt.SupportTypeApi.PAYMENT_SATISFACTION:return"Payment Satisfaction";case Gt.SupportTypeApi.PROJECT_MANAGEMENT:return"Project Management";case Gt.SupportTypeApi.SUCCESS_MANAGER:return"Success Manager";case Gt.SupportTypeApi.MEMBERSHIP_CURATION:return"Membership Curation";case Gt.SupportTypeApi.ARROW_CONCIERGE:return"Arrow Concierge";default:return e.type.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}}ngOnChanges(){[this.otherUser]=this.otherMembers,this.supportAgent=this.getSupportAgent(this.currentUser,this.isUserSupportAgent,this.otherMembers,this.supportAgentMembers,this.agentSession),this.supportAgentUser=this.supportAgent?this.getSupportAgentUser(this.supportAgent,[this.currentUser,...this.otherMembers]):void 0,this.otherMembers&&this.otherMembers.length>0&&(this.isSupportChat=void 0!==this.supportAgent||"admin_preferred_chat"===this.thread.threadType,this.isGroupChat=this.thread.threadType===$t.ThreadTypeApi.GROUP,this.isTeamChat=this.thread.threadType===$t.ThreadTypeApi.TEAM||this.thread.threadType===$t.ThreadTypeApi.TEAM_OFFICIAL||this.thread.context.type===$t.ContextTypeApi.TEAM),this.isThreadSupportSession=this.thread.context&&this.thread.context.type===$t.ContextTypeApi.SUPPORT_SESSION,this.isUnread=this.thread.messageUnreadCount>0,this.setTitles(),this.isFocused=this.focusState===jt.a.Header||this.focusState===jt.a.HeaderAndTypingBox,this.isArrowProject=this.project&&this.project.isArrowProject||!1}getSupportAgent(e,t,n,i,s){if(i)return t?i.find(t=>s?t.userId===e.id&&t.type===s.type:t.userId===e.id):!t&&n?i.find(e=>n.map(e=>e.id).includes(e.userId)):void 0}getSupportAgentUser(e,t){return t.find(t=>t.id===e.userId)}setTitles(){var t,n,i;if(this.showLastSeen=!1,this.thread.threadType===$t.ThreadTypeApi.GROUP||this.thread.threadType===$t.ThreadTypeApi.TEAM){const e=this.otherMembers.map(e=>e.displayName).join(", ");this.project&&this.thread.context.type===$t.ContextTypeApi.PROJECT?(this.title=this.project.title,this.titleLink=`/projects/${this.project.seoUrl}`,this.secondaryTitle=e):this.contest&&this.thread.context.type===$t.ContextTypeApi.CONTEST?(this.title=this.contest.title,this.titleLink=this.contest.seoUrl,this.secondaryTitle=e):(this.title=e,this.titleLink=void 0,this.secondaryTitle=void 0)}else if(this.isSupportChat&&this.isUserSupportAgent&&this.supportAgent&&this.otherUser)this.title=this.otherUser.displayName,this.titleLink=this.otherUser.profileUrl,this.secondaryTitle=this.otherUser.username===this.otherUser.displayName?e.getSupportQueueTitle(this.supportAgent):`(${this.otherUser.username})`;else if(this.isSupportChat&&this.supportAgent&&this.supportAgentUser)this.title=this.supportAgentUser.displayName,this.titleLink=this.otherUser?this.otherUser.profileUrl:void 0,this.secondaryTitle="Freelancer Staff";else if(this.team&&this.thread.threadType===$t.ThreadTypeApi.TEAM_OFFICIAL)this.title=this.team.name,this.titleLink=`/teams/${this.team.id}`,this.secondaryTitle="Official Group Chat";else if(this.otherUser){this.title=this.otherUser.displayName,this.titleLink=this.otherUser.profileUrl;const e=(null===(t=this.project)||void 0===t?void 0:t.skills.length)&&this.otherUser&&(null===(n=this.project)||void 0===n?void 0:n.ownerId)!==this.otherUser.id?{reviewSkills:null===(i=this.project)||void 0===i?void 0:i.skills.map(e=>e.id).join(",")}:{};this.titleParams=this.project?Object.assign({ref_project_id:this.project.id},e):void 0,this.secondaryTitle=void 0,this.otherUser.onlineOfflineStatus&&void 0!==this.otherUser.onlineOfflineStatus.lastUpdatedTimestamp&&this.otherUser.onlineOfflineStatus.status===Ft.OnlineOfflineStatusApi.OFFLINE&&(this.lastSeenDate=new Date(this.otherUser.onlineOfflineStatus.lastUpdatedTimestamp),this.showLastSeen=!0)}else this.title="Private Chat",this.titleLink=void 0,this.secondaryTitle=void 0}canManageChatMembers(){return!!(this.thread.context.type===$t.ContextTypeApi.TEAM&&this.thread.threadType!==$t.ThreadTypeApi.TEAM_OFFICIAL||this.thread.threadType===$t.ThreadTypeApi.TEAM&&this.team)||this.thread.threadType!==$t.ThreadTypeApi.TEAM_OFFICIAL&&(this.isThreadOwner&&!this.isSupportChat||this.isUserSupportAgent)}handleBlockedClick(e){e.stopPropagation()}handleClose(e){e.stopPropagation(),this.closeChat.emit()}handleSettingsButtonClick(e){e.stopPropagation(),this.handleSettingsHeaderClick.emit()}handleGroupchatButtonClick(e){e.stopPropagation(),this.handleGroupchatHeaderClick.emit()}handleAudioCallClick(e,t){e.stopPropagation(),this.startCall(Bt.a.AUDIO,t),this.makingCall.emit(!0)}handleVideoCallClick(e){e.stopPropagation(),this.startCall(Bt.a.VIDEO),this.makingCall.emit(!0)}startCall(e,t=!1){this.videochat.openCallWindow({action:e,threadId:this.thread.id,accepting:!1,recorded:t})}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Bt.b))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-header"]],hostVars:16,hostBindings:function(e,t){2&e&&p.Kb("IsMinimised",t.isMinimised)("IsUserRecruiter",t.isUserSupportAgent)("IsFocused",t.isFocused)("IsUnread",t.isUnread)("IsRecruiter",t.isSupportChat)("IsThreadSupportSession",t.isThreadSupportSession)("has-secondaryTitle",t.secondaryTitle)("IsArrowProject",t.isArrowProject)},inputs:{thread:"thread",currentUserId:"currentUserId",otherMembers:"otherMembers",currentUser:"currentUser",project:"project",contest:"contest",agentSession:"agentSession",isThreadOwner:"isThreadOwner",candidatesExist:"candidatesExist",callsEnabled:"callsEnabled",onlineOfflineStatuses$:"onlineOfflineStatuses$",team:"team",focusState:"focusState",supportAgentMembers:"supportAgentMembers",isMinimised:"isMinimised",isUserSupportAgent:"isUserSupportAgent"},outputs:{closeChat:"closeChat",handleSettingsHeaderClick:"handleSettingsHeaderClick",handleGroupchatHeaderClick:"handleGroupchatHeaderClick",makingCall:"makingCall"},features:[p.Eb],decls:18,vars:22,consts:function(){let e,t,n,i;return e="Chatbox settings",t="Close chat",n="Invite more users to this chat",i="View the participants of this thread",[[1,"ChatHeader-details"],["class","ChatHeader-details-onlineStatus",3,"username","isOnline",4,"ngIf"],[1,"ChatHeader-details-text"],["class","ChatHeader-details-title","flTrackingLabel","headerLink",3,"color","weight","link","queryParams","hoverColor","click",4,"ngIf"],["class","ChatHeader-details-title",4,"ngIf"],["class","ChatHeader-details-secondaryTitle","data-uitest-target","chatbox-header-username",4,"ngIf"],["class","ChatHeader-details-secondaryTitle",3,"color","size","date","includeSeconds","strict",4,"ngIf"],[1,"ChatHeader-controls"],["class","ChatHeader-controls-btn",3,"position","message",4,"ngIf"],["flTrackingLabel","groupChat","class","ChatHeader-controls-btn",3,"click",4,"ngIf"],["flTrackingLabel","chatSettings","data-uitest-target","chatbox-settings",1,"ChatHeader-controls-btn",3,"click"],["label",e,3,"color","size","hoverColor","name"],["flTrackingLabel","closeChat","data-uitest-target","chatbox-close",1,"ChatHeader-controls-btn",3,"click"],["label",t,3,"color","size","hoverColor","name"],[1,"ChatHeader-details-onlineStatus",3,"username","isOnline"],["flTrackingLabel","headerLink",1,"ChatHeader-details-title",3,"color","weight","link","queryParams","hoverColor","click"],[1,"ChatHeader-details-title"],["data-uitest-target","chatbox-header-username",1,"ChatHeader-details-secondaryTitle"],[1,"ChatHeader-details-secondaryTitle",3,"color","size","date","includeSeconds","strict"],[1,"ChatHeader-controls-btn",3,"position","message"],["flTrackingLabel","audioCall",3,"click"],[3,"color","size","hoverColor","name"],["flTrackingLabel","videoCall",3,"click"],["flTrackingLabel","groupChat",1,"ChatHeader-controls-btn",3,"click"],["name","ui-invite-v2","label",n,3,"color","size","hoverColor",4,"ngIf"],["name","ui-invite-v2","label",i,3,"color","size","hoverColor",4,"ngIf"],["name","ui-invite-v2","label",n,3,"color","size","hoverColor"],["name","ui-invite-v2","label",i,3,"color","size","hoverColor"]]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Zc(1,Nt,3,7,"fl-online-indicator",1),p.Yb(2,"fl-bit",2),p.Zc(3,Xt,2,7,"fl-link",3),p.Zc(4,Yt,2,2,"fl-bit",4),p.Zc(5,Ht,2,2,"fl-bit",4),p.Zc(6,Vt,2,1,"fl-bit",5),p.Zc(7,Zt,1,5,"fl-relative-time",6),p.sc(8,"isOnline"),p.sc(9,"flAsync"),p.Xb(),p.Xb(),p.Yb(10,"fl-bit",7),p.Zc(11,Wt,3,7,"fl-tooltip",8),p.Zc(12,qt,3,7,"fl-tooltip",8),p.Zc(13,Jt,3,2,"fl-button",9),p.Yb(14,"fl-button",10),p.nc("click",function(e){return t.handleSettingsButtonClick(e)}),p.Tb(15,"fl-icon",11),p.Xb(),p.Yb(16,"fl-button",12),p.nc("click",function(e){return t.handleClose(e)}),p.Tb(17,"fl-icon",13),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.zc("ngIf",!t.isGroupChat&&!t.isTeamChat&&t.otherUser),p.Gb(2),p.zc("ngIf",!t.isMinimised&&void 0!==t.titleLink),p.Gb(1),p.zc("ngIf",!t.isMinimised&&void 0===t.titleLink),p.Gb(1),p.zc("ngIf",t.isMinimised),p.Gb(1),p.zc("ngIf",void 0!==t.secondaryTitle),p.Gb(1),p.zc("ngIf",t.showLastSeen&&t.otherUser&&(null==t.otherUser.onlineOfflineStatus?null:t.otherUser.onlineOfflineStatus.lastUpdatedTimestamp)&&!p.uc(8,17,t.otherUser,p.tc(9,20,t.onlineOfflineStatuses$))),p.Gb(4),p.zc("ngIf",!t.isMinimised&&(null==t.callsEnabled?null:t.callsEnabled.audio.enabled)),p.Gb(1),p.zc("ngIf",!t.isMinimised&&(null==t.callsEnabled?null:t.callsEnabled.audio.enabled)&&(null==t.callsEnabled?null:t.callsEnabled.video.enabled)),p.Gb(1),p.zc("ngIf",!t.isMinimised&&(t.isUserSupportAgent||t.isGroupChat||t.isTeamChat||t.isThreadOwner&&!t.isSupportChat)),p.Gb(2),p.zc("color",t.IconColor.LIGHT)("size",t.IconSize.SMALL)("hoverColor",t.HoverColor.PRIMARY)("name","ui-cog-v2"),p.Gb(2),p.zc("color",t.IconColor.LIGHT)("size",t.IconSize.SMALL)("hoverColor",t.HoverColor.PRIMARY)("name","ui-close"))},directives:[Ee.a,i.q,fe.b,ve.a,le.d,Le.a,pe.b,ke.b,Ut.a],pipes:[Dt.a,_e.a],styles:["@keyframes pulseUnfocus{10%{background-color:#dedede;opacity:1}50%{background-color:#1073cb;opacity:.5}to{background-color:#dedede;opacity:1}}@keyframes pulseFocus{0%{opacity:1}50%{opacity:.5}to{opacity:1}}[_nghost-%COMP%]{font-size:14px;line-height:1.43;align-items:center;background-color:#dedede;border-radius:0 0 0 0;color:#f7f7f7;cursor:pointer;display:flex;flex:0 0 auto;height:34px;padding:0 12px;width:100%}.IsFocused[_nghost-%COMP%]{background-color:#1073cb}.IsFocused.IsRecruiter[_nghost-%COMP%]{background-color:#7d30c9}.IsFocused.IsRecruiter.IsThreadSupportSession.IsUserRecruiter[_nghost-%COMP%]{background-color:#000}.IsFocused.IsRecruiter.IsThreadSupportSession.IsUserRecruiter.IsArrowProject[_nghost-%COMP%]{background-color:#eb3730}.IsRecruiter[_nghost-%COMP%]{background-color:rgba(125,48,201,.5)}.IsRecruiter.IsThreadSupportSession.IsUserRecruiter[_nghost-%COMP%]{background-color:rgba(0,0,0,.5)}.IsRecruiter.IsThreadSupportSession.IsUserRecruiter.IsArrowProject[_nghost-%COMP%]{background-color:rgba(235,55,48,.5)}.IsUnread[_nghost-%COMP%]{animation:pulseFocus 1.5s ease-in-out infinite;opacity:1}.IsUnread[_nghost-%COMP%]:not(.IsFocused):not(.IsRecruiter){animation:pulseUnfocus 1.5s ease-in-out infinite}.ChatHeader-details[_ngcontent-%COMP%]{align-items:center;display:flex;max-width:calc(100% - 72px);overflow:auto}.ChatHeader-details-text[_ngcontent-%COMP%]{align-items:flex-start;display:flex;flex-direction:column;overflow:hidden;width:100%}.ChatHeader-details-onlineStatus[_ngcontent-%COMP%]{margin-right:8px}.ChatHeader-details-title[_ngcontent-%COMP%]{color:#fff;font-weight:700;line-height:1.1}.ChatHeader-details-secondaryTitle[_ngcontent-%COMP%], .ChatHeader-details-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%}.ChatHeader-details-secondaryTitle[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;line-height:1.1}.ChatHeader-controls[_ngcontent-%COMP%]{align-items:center;display:flex;margin-left:auto}.ChatHeader-controls-btn[_ngcontent-%COMP%]{padding:4px 0 4px 4px}"],changeDetection:0}),e})();var tn=n("os2j"),nn=n("fYbj"),sn=n("Krui"),an=function(e){return e[e.CHAT_MESSAGE=220]="CHAT_MESSAGE",e[e.ATTACHMENT_SIDEBAR=48]="ATTACHMENT_SIDEBAR",e}({}),on=function(e){return e[e.CHAT_MESSAGE=330]="CHAT_MESSAGE",e[e.ATTACHMENT_SIDEBAR=48]="ATTACHMENT_SIDEBAR",e}({});function rn(e,t,n){const i=`/api/messages/0.1/messages/${e}/${encodeURIComponent(t)}/thumbnail?height=${n.height}&width=${n.width}`;return n.method?`${i}&resizing_method=${n.method}`:i}var cn=n("DsW6"),ln=n("T2yU"),dn=n("KrVf"),hn=n("LE8X"),gn=n("KUXl");function un(e,t){if(1&e){const e=p.Zb();p.Wb(0,2),p.Yb(1,"fl-button",3),p.nc("click",function(){return p.Pc(e),p.rc().openPreviewModal()}),p.Tb(2,"fl-picture",4),p.sc(3,"flAsync"),p.Xb(),p.Yb(4,"fl-link",5),p.nc("click",function(){return p.Pc(e),p.rc().openPreviewModal()}),p.bd(5),p.Xb(),p.Vb()}if(2&e){const e=p.rc();p.zc("flTrackingSection",e.trackingSection),p.Gb(1),p.zc("flMarginBottom",e.Margin.XXXSMALL),p.Gb(1),p.zc("src",e.useThumbnailService&&!e.isGifFile?e.imageThumbnailPath:p.tc(3,10,e.attachmentPathPromise))("externalSrc",!0)("boundedWidth",!0)("alt",e.attachment)("objectFit",e.PictureObjectFit.COVER),p.Gb(2),p.zc("color",e.fromMe?e.LinkColor.LIGHT:e.LinkColor.DEFAULT)("hoverColor",e.fromMe?e.LinkHoverColor.LIGHT:e.LinkHoverColor.DEFAULT),p.Gb(1),p.dd(" ",e.attachment," ")}}function bn(e,t){if(1&e){const e=p.Zb();p.Wb(0),p.Yb(1,"fl-button",6),p.nc("click",function(){return p.Pc(e),p.rc().openPreviewModal()}),p.Yb(2,"fl-bit",7),p.Tb(3,"fl-icon",8),p.Xb(),p.Yb(4,"fl-link",9),p.nc("click",function(){return p.Pc(e),p.rc().openPreviewModal()}),p.bd(5),p.Xb(),p.Xb(),p.Vb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("display","block"),p.Gb(2),p.zc("color",e.IconColor.MID)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)("name","ui-file"),p.Gb(1),p.zc("color",e.fromMe?e.LinkColor.LIGHT:e.LinkColor.DEFAULT)("hoverColor",e.fromMe?e.LinkHoverColor.LIGHT:e.LinkHoverColor.DEFAULT),p.Gb(1),p.dd(" ",e.attachment," ")}}let fn=(()=>{class e{constructor(e,t,n,i,s){this.modalService=e,this.tracking=t,this.fileDownload=n,this.fileStorage=i,this.userAgent=s,this.Margin=me.a,this.IconColor=le.c,this.IconSize=le.e,this.ImageAttachmentThumbnailHeight=an,this.ImageAttachmentThumbnailWidth=on,this.HoverColor=le.a,this.LinkColor=pe.a,this.LinkHoverColor=pe.c,this.PictureObjectFit=sn.c,this.ModalSize=Me.a,this.chatBoxMode=!0,this.useThumbnailService=!1,this.previewModalOpen=new p.n,this.previewModalClose=new p.n,this.isImage=!1}ngOnInit(){this.isImage=Object(nn.i)(this.attachment),this.trackingSection=this.chatBoxMode?"chatbox":"inbox",this.attachmentPathPromise=this.fileStorage.getDownloadURL(tn.a.MESSAGING_ATTACHMENTS,this.attachment,{messageId:this.messageId.toString()}).then(e=>"success"===e.status?e.downloadURL:void 0),this.imageThumbnailPath=rn(this.messageId,this.attachment,{height:an.CHAT_MESSAGE,width:on.CHAT_MESSAGE,method:"fit"}),this.isGifFile="gif"===Object(nn.e)(this.attachment)}openPreviewModal(){return Object(T.a)(this,void 0,void 0,function*(){if(["IE","Edge"].includes(this.userAgent.getUserAgent().getBrowser().name||"")){const e=yield this.attachmentPathPromise;if(!e)return;return this.fileDownload.download(e,this.attachment)}const e=this.modalService.open("FileViewerModal",{inputs:{messageId:this.messageId,filename:this.attachment,filetype:Object(nn.f)(this.attachment)},edgeToEdge:!0,size:Me.a.XLARGE});e.afterOpen().toPromise().then(e=>this.previewModalOpen.emit()),e.afterClosed().toPromise().then(e=>{this.previewModalClose.emit(),this.tracking.track("user_action",{section:"messaging_image_viewer",subsection:"header",label:"close_image_viewer"})})})}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ie.b),p.Sb(cn.a),p.Sb(ln.a),p.Sb(dn.a),p.Sb(hn.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-message-attachment"]],inputs:{attachment:"attachment",messageId:"messageId",fromMe:"fromMe",chatBoxMode:"chatBoxMode",useThumbnailService:"useThumbnailService"},outputs:{previewModalOpen:"previewModalOpen",previewModalClose:"previewModalClose"},decls:2,vars:2,consts:function(){let e;return e="Download the attachment",[["flTrackingSubSection","message_content",3,"flTrackingSection",4,"ngIf"],[4,"ngIf"],["flTrackingSubSection","message_content",3,"flTrackingSection"],["flTrackingLabel","open_image_viewer",1,"AttachmentContainer",3,"flMarginBottom","click"],["data-uitest-target","chatbox-image-thumbnail",1,"AttachmentImage",3,"src","externalSrc","boundedWidth","alt","objectFit"],["flTrackingLabel","open_image_viewer","data-uitest-target","chatbox-imagefile-link",1,"AttachmentFile-name",3,"color","hoverColor","click"],["flTrackingLabel","open_image_viewer",3,"display","click"],[1,"AttachmentFile"],["label",e,1,"AttachmentFile-icon",3,"color","size","hoverColor","name"],["flTrackingLabel","open_image_viewer","data-uitest-target","chatbox-file-link",1,"AttachmentFile-name",3,"color","hoverColor","click"]]},template:function(e,t){1&e&&(p.Zc(0,un,6,12,"ng-container",0),p.Zc(1,bn,6,8,"ng-container",1)),2&e&&(p.zc("ngIf",t.isImage),p.Gb(1),p.zc("ngIf",!t.isImage))},directives:[i.q,gn.a,fe.b,ve.a,me.b,sn.a,pe.b,Ee.a,le.d],pipes:[_e.a],styles:[".AttachmentContainer[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.AttachmentContainer[_ngcontent-%COMP%]{display:flex}}.AttachmentFile[_ngcontent-%COMP%]{align-items:center;display:flex}.AttachmentFile-name[_ngcontent-%COMP%]{word-break:break-all}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.AttachmentFile-name[_ngcontent-%COMP%]{flex-basis:100%}}.AttachmentFile-name--fromMe[_ngcontent-%COMP%]{color:#f7f7f7;flex:0 1 auto}.AttachmentFile-icon[_ngcontent-%COMP%]{margin-right:4px}.AttachmentImage[_ngcontent-%COMP%]{display:block;height:220px;width:100%}"]}),e})();var pn=n("71eJ"),mn=n("4kPF"),Mn=n("AJ15"),Cn=n("zOIv"),Sn=n("jASZ"),Tn=n("jtHE");function xn(e,t){if(1&e&&(p.Yb(0,"fl-bit",6),p.Tb(1,"fl-spinner",7),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("size",e.SpinnerSize.SMALL)("color",e.fromMe?e.SpinnerColor.LIGHT:e.SpinnerColor.PRIMARY)}}function yn(e,t){if(1&e&&p.Tb(0,"fl-icon",10),2&e){const e=p.rc(3);p.zc("color",e.IconColor.LIGHT)("name","ui-computer")}}function In(e,t){if(1&e&&p.Tb(0,"fl-icon",10),2&e){const e=p.rc(3);p.zc("color",e.IconColor.LIGHT)("name","ui-trophy")}}const On=function(e){return{"ImageContainer--inactive":e}};function An(e,t){if(1&e&&(p.Yb(0,"fl-bit",8),p.Zc(1,yn,1,2,"fl-icon",9),p.Zc(2,In,1,2,"fl-icon",9),p.Xb()),2&e){const e=p.rc().ngIf,t=p.rc();p.zc("ngClass",p.Ec(4,On,e.error))("flMarginRight",t.Margin.XXSMALL),p.Gb(1),p.zc("ngIf","share_project"===t.type&&e.ready),p.Gb(1),p.zc("ngIf","share_contest"===t.type&&e.ready)}}function vn(e,t){if(1&e&&(p.Yb(0,"fl-link",18),p.sc(1,"flAsync"),p.Yb(2,"fl-text",19),p.bd(3),p.sc(4,"flAsync"),p.Xb(),p.Xb()),2&e){const e=p.rc(3);let t=null;p.zc("link",p.tc(1,10,e.jobLink$))("color",e.fromMe?e.LinkColor.LIGHT:e.LinkColor.INHERIT)("hoverColor",e.fromMe?e.LinkHoverColor.LIGHT:e.LinkHoverColor.INHERIT)("weight",e.LinkWeight.BOLD)("flMarginBottom",e.Margin.XXSMALL)("newTab",!0),p.Gb(2),p.zc("maxLines",2)("color",e.FontColor.INHERIT)("size",e.TextSize.INHERIT),p.Gb(1),p.dd(" ",null==(t=p.tc(4,12,e.job$))?null:t.title," ")}}function wn(e,t){if(1&e&&(p.Yb(0,"fl-text",20),p.cc(1,21),p.Xb()),2&e){const e=p.rc(3);p.zc("color",e.FontColor.DARK)("weight",e.FontWeight.BOLD)("maxLines",2)("flMarginBottom",e.Margin.XXSMALL)}}function En(e,t){if(1&e&&p.Tb(0,"fl-icon",22),2&e){const e=p.rc(3);p.zc("color",e.fromMe?e.IconColor.LIGHT:e.IconColor.MID)("name","ui-clock-alt-v2")("size",e.IconSize.SMALL)("flMarginRight",e.Margin.XXSMALL)}}function zn(e,t){if(1&e&&(p.Yb(0,"fl-text",23),p.bd(1),p.sc(2,"date"),p.sc(3,"flAsync"),p.Xb()),2&e){const e=p.rc(3);let t=null;p.zc("color",e.fromMe?e.FontColor.LIGHT:e.FontColor.MID)("maxLines",2),p.Gb(1),p.dd(" ",p.uc(2,3,null==(t=p.tc(3,6,e.job$))?null:t.timeSubmitted,"LLL dd, yyyy")," ")}}function Ln(e,t){if(1&e&&(p.Yb(0,"fl-text",24),p.cc(1,25),p.Xb()),2&e){const e=p.rc(3);p.zc("color",e.FontColor.MID)}}function kn(e,t){if(1&e&&(p.Yb(0,"fl-bit",11),p.Zc(1,vn,5,14,"fl-link",12),p.Zc(2,wn,2,4,"fl-text",13),p.Yb(3,"fl-bit",14),p.Zc(4,En,1,4,"fl-icon",15),p.Zc(5,zn,4,8,"fl-text",16),p.Zc(6,Ln,2,1,"fl-text",17),p.Xb(),p.Xb()),2&e){const e=p.rc().ngIf;p.Gb(1),p.zc("ngIf",e.ready),p.Gb(1),p.zc("ngIf",e.error),p.Gb(2),p.zc("ngIf",e.ready),p.Gb(1),p.zc("ngIf",e.ready),p.Gb(1),p.zc("ngIf",e.error)}}const Pn=function(e){return{"CardContainer--fromOther":e}},_n=function(e,t,n,i){return{"MainContainer--fromMe":e,"MainContainer--fromOther":t,"MainContainer--inactive":n,"MainContainer--loaded":i}};function Rn(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-card",1),p.Yb(2,"fl-bit",2),p.Zc(3,xn,2,2,"fl-bit",3),p.Zc(4,An,3,6,"fl-bit",4),p.Zc(5,kn,7,5,"fl-bit",5),p.Xb(),p.Xb(),p.Vb()),2&e){const e=t.ngIf,n=p.rc();p.Gb(1),p.zc("borderRadius",n.CardBorderRadius.LARGE)("ngClass",p.Ec(9,Pn,!n.fromMe))("size",n.CardSize.SMALL)("maxContent",!1)("edgeToEdge",!0),p.Gb(1),p.zc("ngClass",p.Hc(11,_n,n.fromMe,!n.fromMe,e.error,e.ready||e.error)),p.Gb(1),p.zc("ngIf",!e.ready&&!e.error),p.Gb(1),p.zc("ngIf",e.ready||e.error),p.Gb(1),p.zc("ngIf",e.ready||e.error)}}let jn=(()=>{class e{constructor(e){this.datastore=e,this.CardBorderRadius=Cn.a,this.CardSize=Cn.g,this.FontColor=Ce.a,this.FontWeight=de.c,this.IconSize=le.e,this.IconColor=le.c,this.LinkColor=pe.a,this.LinkHoverColor=pe.c,this.LinkWeight=pe.f,this.TextSize=de.f,this.Margin=me.a,this.SpinnerColor=Sn.b,this.SpinnerSize=Sn.d,this.jobId$=new Tn.a(1)}ngOnInit(){if("share_project"===this.type){const e=this.datastore.document("threadProjects",this.jobId$),t=e.valueChanges();this.job$=t,this.status$=e.status$}else{const e=this.datastore.document("contests",this.jobId$),t=e.valueChanges();this.job$=t,this.status$=e.status$}this.jobLink$=this.job$.pipe(Object(I.a)(e=>"share_project"===this.type?`/projects/${e.seoUrl}`:`/${e.seoUrl}`))}ngOnChanges(e){"jobId"in e&&this.jobId$.next(e.jobId.currentValue)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Oe.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-share-job"]],hostVars:2,hostBindings:function(e,t){2&e&&p.Kb("FromMe",t.fromMe)},inputs:{jobId:"jobId",type:"type",fromMe:"fromMe"},features:[p.Eb],decls:2,vars:3,consts:function(){let e,t;return e=" Unavailable job ",t=" This job is no longer available to view. ",[[4,"ngIf"],[1,"CardContainer",3,"borderRadius","ngClass","size","maxContent","edgeToEdge"],[1,"MainContainer",3,"ngClass"],["class","LoadingContainer",4,"ngIf"],["class","ImageContainer",3,"ngClass","flMarginRight",4,"ngIf"],["class","DescriptionContainer",4,"ngIf"],[1,"LoadingContainer"],["flTrackingLabel","ShareJobRichMessageInitialisationSpinner",3,"size","color"],[1,"ImageContainer",3,"ngClass","flMarginRight"],[3,"color","name",4,"ngIf"],[3,"color","name"],[1,"DescriptionContainer"],["class","ShareJobTitle","flTrackingLabel","ShareJobRichMessage",3,"link","color","hoverColor","weight","flMarginBottom","newTab",4,"ngIf"],[3,"color","weight","maxLines","flMarginBottom",4,"ngIf"],[1,"BottomContainer"],[3,"color","name","size","flMarginRight",4,"ngIf"],[3,"color","maxLines",4,"ngIf"],[3,"color",4,"ngIf"],["flTrackingLabel","ShareJobRichMessage",1,"ShareJobTitle",3,"link","color","hoverColor","weight","flMarginBottom","newTab"],[3,"maxLines","color","size"],[3,"color","weight","maxLines","flMarginBottom"],e,[3,"color","name","size","flMarginRight"],[3,"color","maxLines"],[3,"color"],t]},template:function(e,t){1&e&&(p.Zc(0,Rn,6,16,"ng-container",0),p.sc(1,"flAsync")),2&e&&p.zc("ngIf",p.tc(1,1,t.status$))},directives:[i.q,Cn.b,i.o,Ee.a,Sn.c,Pe.a,ve.a,me.b,le.d,pe.b,de.e],pipes:[_e.a,i.f],styles:["[_nghost-%COMP%]{display:flex;min-width:215px;padding:8px 0}.FromMe[_nghost-%COMP%]{justify-content:flex-end}.MainContainer[_ngcontent-%COMP%]{border-radius:0;display:flex;padding:8px}.MainContainer--loaded[_ngcontent-%COMP%]{padding-right:16px}.MainContainer--fromMe[_ngcontent-%COMP%]{background-color:#007fed}.MainContainer--fromOther[_ngcontent-%COMP%], .MainContainer--inactive[_ngcontent-%COMP%]{background-color:#f0f0f0}.ImageContainer[_ngcontent-%COMP%]{align-items:center;background-color:#2259b5;border-radius:0;display:flex;height:50px;justify-content:center;min-width:50px;width:50px}.ImageContainer--inactive[_ngcontent-%COMP%]{background-color:#bec0c2}.BottomContainer[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:flex-start}.CardContainer[_ngcontent-%COMP%]{display:flex;max-width:80%}.CardContainer--fromOther[_ngcontent-%COMP%]{margin-left:36px}.LoadingContainer[_ngcontent-%COMP%]{align-items:center;display:flex;height:54px;justify-content:center;width:56px}.DescriptionContainer[_ngcontent-%COMP%]{width:100%}.ShareJobTitle[_ngcontent-%COMP%]{display:inline-block}"],changeDetection:0}),e})();function Un(e,t){if(1&e&&(p.Yb(0,"fl-picture",6),p.ec(1,7),p.Xb()),2&e){const e=p.rc(2);p.gc(e.user.displayName),p.dc(1),p.zc("src",e.user.avatar)("externalSrc",!0)("boundedWidth",!0)}}function Bn(e,t){if(1&e&&(p.Yb(0,"fl-bit",8),p.bd(1),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.dd(" ",e.user.displayName[0].toUpperCase()," ")}}function $n(e,t){if(1&e&&(p.Yb(0,"fl-bit",2),p.sc(1,"date"),p.ec(2,3),p.Zc(3,Un,2,4,"fl-picture",4),p.Zc(4,Bn,2,1,"fl-bit",5),p.Xb()),2&e){const e=p.rc();p.gc(e.user.displayName)(p.uc(1,4,e.time,"h:mma d MMMM y")),p.dc(2),p.Gb(3),p.zc("ngIf",e.user.avatar),p.Gb(1),p.zc("ngIf",!e.user.avatar)}}function Gn(e,t){1&e&&p.Tb(0,"fl-icon",9)}let Fn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-read-marker"]],inputs:{user:"user",time:"time",isTyping:"isTyping"},decls:2,vars:2,consts:function(){let e,t;return e="Seen by " + "\ufffd0\ufffd" + " at " + "\ufffd1\ufffd" + "",t="Seen by " + "\ufffd0\ufffd" + "",[["class","ReadMarkerContainer",3,"title",4,"ngIf"],["name","typing-icon",4,"ngIf"],[1,"ReadMarkerContainer",6,"title"],["title",e],["class","ReadMarker",3,"src","externalSrc","boundedWidth","alt",4,"ngIf"],["class","ReadMarkerText",4,"ngIf"],[1,"ReadMarker",3,"src","externalSrc","boundedWidth",6,"alt"],["alt",t],[1,"ReadMarkerText"],["name","typing-icon"]]},template:function(e,t){1&e&&(p.Zc(0,$n,5,7,"fl-bit",0),p.Zc(1,Gn,1,0,"fl-icon",1)),2&e&&(p.zc("ngIf",t.user),p.Gb(1),p.zc("ngIf",t.isTyping))},directives:[i.q,Ee.a,sn.a,le.d],pipes:[i.f],styles:["[_nghost-%COMP%]{display:flex}.ReadMarker[_ngcontent-%COMP%], .ReadMarkerText[_ngcontent-%COMP%]{height:16px;width:16px}.ReadMarkerText[_ngcontent-%COMP%]{align-items:center;color:#139ff0;display:flex;justify-content:center;overflow:hidden}.ReadMarkerContainer[_ngcontent-%COMP%]{margin:0;padding-left:4px}"],changeDetection:0}),e})();function Dn(e,t){if(1&e&&(p.Yb(0,"fl-bit",7),p.bd(1),p.sc(2,"uppercase"),p.sc(3,"date"),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.cd(p.tc(2,1,p.uc(3,3,e.message.timeCreated,"dd MMM yyyy \xb7 h:mm a")||""))}}function Nn(e,t){if(1&e&&(p.Yb(0,"fl-bit",8),p.bd(1),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.dd(" ",null==e.author?null:e.author.displayName," ")}}const Xn=function(e){return[e]};function Yn(e,t){if(1&e&&p.Tb(0,"fl-user-avatar",17),2&e){const e=p.rc(3);p.zc("users",p.Ec(4,Xn,e.author))("size",e.AvatarSize.SMALL)("flMarginRight",e.Margin.XXXSMALL),p.Hb("title",null==e.author?null:e.author.displayName)}}function Hn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",20),p.nc("click",function(t){return p.Pc(e),p.rc(4).handleResend(t)}),p.Tb(1,"fl-icon",21),p.Xb()}if(2&e){const e=p.rc(4);p.zc("flMarginRight",e.Margin.XXXSMALL),p.Gb(1),p.zc("color",e.IconColor.DARK)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function Vn(e,t){if(1&e&&(p.Yb(0,"fl-bit",18),p.Zc(1,Hn,2,4,"fl-button",19),p.Xb()),2&e){const e=p.rc(3);p.Gb(1),p.zc("ngIf",e.failed)}}function Zn(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-message-attachment",22),p.nc("click",function(e){return e.stopPropagation()})("previewModalClose",function(){return p.Pc(e),p.rc(3).previewModalClose.emit()})("previewModalOpen",function(){return p.Pc(e),p.rc(3).previewModalOpen.emit()}),p.Xb()}if(2&e){const e=t.$implicit,n=p.rc(3);p.zc("attachment",e)("messageId",n.message.id)("fromMe",n.fromMe)("chatBoxMode",n.chatBoxMode)("useThumbnailService",n.useThumbnailService)}}const Wn=function(e){return{"Message--hasName":e}},qn=function(e){return{"AvatarContainer--other":e}},Qn=function(e,t,n,i,s,a,o,r){return{"MessageBody--failed":e,"MessageBody--unsent":t,"MessageBody--mine":n,"MessageBody--other":i,"MessageBody--first":s,"MessageBody--mid":a,"MessageBody--last":o,"MessageBody--solo":r}};function Kn(e,t){if(1&e&&(p.Yb(0,"fl-bit",9),p.Yb(1,"fl-bit",10),p.Zc(2,Yn,1,6,"fl-user-avatar",11),p.Xb(),p.Zc(3,Vn,2,1,"fl-bit",12),p.Yb(4,"fl-bit",13),p.Yb(5,"fl-tooltip",14),p.sc(6,"date"),p.Tb(7,"fl-interactive-text",15),p.Zc(8,Zn,1,5,"app-message-attachment",16),p.Xb(),p.Xb(),p.Xb()),2&e){const e=p.rc(2);p.zc("ngClass",p.Ec(16,Wn,e.isFirst&&!e.fromMe&&(null==e.otherMembers?null:e.otherMembers.length)>1)),p.Gb(1),p.zc("ngClass",p.Ec(18,qn,!e.fromMe)),p.Gb(1),p.zc("ngIf",void 0!==e.author&&e.hasUserImg),p.Gb(1),p.zc("ngIf",e.fromMe),p.Gb(1),p.zc("ngClass",p.Jc(20,Qn,e.fromMe&&e.failed,e.fromMe&&e.sending,e.fromMe,!e.fromMe,e.isFirst,!e.isFirst&&!e.isLast,e.isLast,e.isFirst&&e.isLast)),p.Gb(1),p.zc("message",p.uc(6,13,e.message.timeCreated,"dd MMM yyyy \xb7 h:mm a")),p.Gb(2),p.zc("content",e.message.message)("emoji",!0)("link",!0)("fontColor",e.fromMe?e.FontColor.LIGHT:e.FontColor.DARK)("highlightColor",e.HighlightColor.BLUE)("linkColor",e.fromMe?e.LinkColor.LIGHT:e.LinkColor.DEFAULT),p.Gb(1),p.zc("ngForOf",e.message.attachments)}}function Jn(e,t){1&e&&(p.Yb(0,"fl-bit",23),p.cc(1,24),p.Xb())}function ei(e,t){if(1&e&&p.Tb(0,"app-rich-message",25),2&e){const e=p.rc(2);p.zc("richMessage",e.message.richMessage)("messageId",e.message.id)("currentUserId",e.currentUserId)}}function ti(e,t){if(1&e&&p.Tb(0,"app-share-job",27),2&e){const e=p.rc().$implicit,t=p.rc(2);p.zc("jobId","share_project"===e.type?e.metadata.project_id:e.metadata.contest_id)("type",e.type)("fromMe",t.richMessageFromMe)}}function ni(e,t){if(1&e&&(p.Wb(0),p.Zc(1,ti,1,3,"app-share-job",26),p.Vb()),2&e){const e=t.$implicit;p.Gb(1),p.zc("ngIf","share_project"===e.type||"share_contest"===e.type)}}function ii(e,t){if(1&e&&(p.Tb(0,"app-read-marker",30),p.sc(1,"flAsync")),2&e){const e=t.$implicit,n=p.rc(3);p.zc("user",e.user)("time",e.time)("isTyping",p.tc(1,3,n.usersTyping[e.user.id]))}}function si(e,t){if(1&e&&(p.Yb(0,"fl-bit",28),p.Zc(1,ii,2,5,"app-read-marker",29),p.Xb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("ngForOf",e.readMarkers)("ngForTrackBy",e.identifyReadMarker)}}function ai(e,t){if(1&e&&(p.Wb(0),p.Zc(1,Dn,4,6,"fl-bit",1),p.Zc(2,Nn,2,1,"fl-bit",2),p.Zc(3,Kn,9,29,"fl-bit",3),p.Zc(4,Jn,2,0,"fl-bit",4),p.Zc(5,ei,1,3,"app-rich-message",5),p.Zc(6,ni,2,1,"ng-container",0),p.Zc(7,si,2,2,"fl-bit",6),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngIf",e.isTimestamp),p.Gb(1),p.zc("ngIf",e.isFirst&&!e.fromMe&&(null==e.otherMembers?null:e.otherMembers.length)>1),p.Gb(1),p.zc("ngIf",!e.message.richMessage),p.Gb(1),p.zc("ngIf",e.isLastFailed),p.Gb(1),p.zc("ngIf",e.message.richMessage&&!e.getSupportedRichMessageType(e.message.richMessage)),p.Gb(1),p.zc("ngIf",e.message.richMessage&&e.getSupportedRichMessageType(e.message.richMessage)),p.Gb(1),p.zc("ngIf",e.readMarkers.length>0)}}let oi=(()=>{class e{constructor(){this.AvatarSize=pn.a,this.FontColor=Ce.a,this.HighlightColor=Ce.b,this.HoverColor=le.a,this.IconColor=le.c,this.IconSize=le.e,this.LinkColor=pe.a,this.Margin=me.a,this.TooltipPosition=Ut.b,this.chatBoxMode=!0,this.useThumbnailService=!1,this.previewModalClose=new p.n,this.previewModalOpen=new p.n,this.resendMessage=new p.n,this.isRichMessage=!1,this.readMarkers=[],this.supportedRichMessageType=["share_project","share_contest"],this.author=void 0,this.options=["Resend","Resend All","Remove"]}ngOnInit(){this.message.richMessage&&(this.isRichMessage=void 0!==this.message.richMessage),this.updateMessageAttributes()}ngOnChanges(){this.updateMessageAttributes()}getAuthor(){return this.threadMembers?this.threadMembers.find(e=>e.id===this.message.fromUser):void 0}differentAuthor(e){return this.message.fromUser!==e.fromUser}shouldShowTimestamp(e,t){return e.timeCreated-t.timeCreated>144e5}updateMessageAttributes(){this.fromMe=this.message.fromUser===Number(this.currentUserId),this.richMessageFromMe=Object(g.h)(this.message.richMessage)&&Object(g.h)(this.message.richMessage.fromUser)&&this.message.richMessage.fromUser===Object(g.s)(this.currentUserId),this.isTimestamp=!this.before||this.shouldShowTimestamp(this.message,this.before),this.isFirst=!this.before||this.differentAuthor(this.before)||this.isTimestamp,this.isLast=!this.after||this.differentAuthor(this.after)||this.shouldShowTimestamp(this.after,this.message),this.hasUserImg=!this.fromMe&&this.isLast,this.sent=void 0!==this.message.messageId,this.sent=this.message.sendStatus===z.a.SENT,this.sending=this.message.sendStatus===z.a.SENDING,this.failed=this.fromMe&&this.message.sendStatus===z.a.FAILED,this.isLastFailed=this.failed&&(!this.after||this.after.sendStatus!==z.a.FAILED),this.shouldRender=!(this.message.richMessage&&0===this.message.richMessage.long.length&&0===this.message.richMessage.short.length),this.otherMembers&&this.userReadTimes&&(this.readMarkers=this.otherMembers.filter(e=>{const t=this.userReadTimes[e.id];return t>=this.message.timeCreated&&(!this.after||t<this.after.timeCreated)}).map(e=>({time:this.userReadTimes[e.id],user:e}))),this.author=this.getAuthor()}handleResend(e){e.stopPropagation(),this.resendMessage.emit(this.message)}identifyReadMarker(e,t){return`${t.user.id}${t.time}`}getSupportedRichMessageType(e){if(e.types)return e.types.find(e=>this.supportedRichMessageType.includes(e.type))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-message-item"]],hostVars:2,hostBindings:function(e,t){2&e&&p.Kb("IsRichMessage",t.isRichMessage)},inputs:{otherMembers:"otherMembers",threadMembers:"threadMembers",userReadTimes:"userReadTimes",message:"message",after:"after",before:"before",currentUserId:"currentUserId",chatBoxMode:"chatBoxMode",usersTyping:"usersTyping",useThumbnailService:"useThumbnailService"},outputs:{previewModalClose:"previewModalClose",previewModalOpen:"previewModalOpen",resendMessage:"resendMessage"},features:[p.Eb],decls:1,vars:1,consts:function(){let e,t;return e="Retry",t=" Message not delivered. ",[[4,"ngIf"],["class","Timestamp",4,"ngIf"],["class","Username",4,"ngIf"],["class","Message","data-uitest-target","chat-messages",3,"ngClass",4,"ngIf"],["class","FailedMessage",4,"ngIf"],[3,"richMessage","messageId","currentUserId",4,"ngIf"],["class","ReadMarkersContainer",4,"ngIf"],[1,"Timestamp"],[1,"Username"],["data-uitest-target","chat-messages",1,"Message",3,"ngClass"],[1,"AvatarContainer",3,"ngClass"],[3,"users","size","flMarginRight",4,"ngIf"],["class","ResendButtonContainer",4,"ngIf"],[1,"MessageBody",3,"ngClass"],[1,"MessageContainer",3,"message"],["data-uitest-target","chatbox-thread-message",1,"MessageText",3,"content","emoji","link","fontColor","highlightColor","linkColor"],["class","MessageAttachmentContainer",3,"attachment","messageId","fromMe","chatBoxMode","useThumbnailService","click","previewModalClose","previewModalOpen",4,"ngFor","ngForOf"],[3,"users","size","flMarginRight"],[1,"ResendButtonContainer"],["class","ResendButton","flTrackingLabel","resendButton",3,"flMarginRight","click",4,"ngIf"],["flTrackingLabel","resendButton",1,"ResendButton",3,"flMarginRight","click"],["name","ui-refresh","label",e,3,"color","size","hoverColor"],[1,"MessageAttachmentContainer",3,"attachment","messageId","fromMe","chatBoxMode","useThumbnailService","click","previewModalClose","previewModalOpen"],[1,"FailedMessage"],t,[3,"richMessage","messageId","currentUserId"],[3,"jobId","type","fromMe",4,"ngIf"],[3,"jobId","type","fromMe"],[1,"ReadMarkersContainer"],[3,"user","time","isTyping",4,"ngFor","ngForOf","ngForTrackBy"],[3,"user","time","isTyping"]]},template:function(e,t){1&e&&p.Zc(0,ai,8,7,"ng-container",0),2&e&&p.zc("ngIf",t.shouldRender)},directives:[i.q,Ee.a,i.o,Ut.a,mn.a,i.p,pn.b,me.b,fe.b,ve.a,le.d,fn,Mn.a,jn,Fn],pipes:[i.B,i.f,_e.a],styles:["[_nghost-%COMP%]{background:#fff;display:flex;flex:0 0 auto;flex-direction:column}.IsRichMessage[_nghost-%COMP%]{background:none}[_nghost-%COMP%]:last-child{margin-bottom:8px}.ReadMarkersContainer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-top:16px;width:100%}.Timestamp[_ngcontent-%COMP%]{font-size:11px;line-height:1.45;color:#4d525b;margin-bottom:4px;margin-top:20px;text-align:center}.AvatarContainer[_ngcontent-%COMP%]{height:32px;width:32px}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.AvatarContainer--other[_ngcontent-%COMP%]{flex:0 0 32px}}.Message[_ngcontent-%COMP%]{align-items:flex-end;display:flex;justify-content:flex-start;margin-top:4px}.Message[_ngcontent-%COMP%]:hover   .ResendButton[_ngcontent-%COMP%]{display:inline-block}.Message--hasName[_ngcontent-%COMP%]{margin-top:0}.MessageBody[_ngcontent-%COMP%]{font-size:13px;line-height:1.2;word-break:break-word;word-wrap:break-word;max-width:75%;padding:8px}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageBody[_ngcontent-%COMP%]{-ms-word-break:break-all}}@supports (-ms-accelerator:true){.MessageBody[_ngcontent-%COMP%]{word-break:break-all}}@supports (-ms-ime-align:auto){.MessageBody[_ngcontent-%COMP%]{word-break:break-all}}.MessageBody--mine[_ngcontent-%COMP%]{background-color:#007fed}.MessageBody--failed[_ngcontent-%COMP%], .MessageBody--unsent[_ngcontent-%COMP%]{background-color:#dedede}.MessageBody--other[_ngcontent-%COMP%]{background-color:#f0f0f0;margin-left:4px}.MessageBody--first.MessageBody--mine[_ngcontent-%COMP%]{border-radius:8px 8px 0}.MessageBody--first.MessageBody--other[_ngcontent-%COMP%]{border-radius:8px 8px 8px 0}.MessageBody--mid.MessageBody--mine[_ngcontent-%COMP%]{border-radius:8px 0 0 8px}.MessageBody--mid.MessageBody--other[_ngcontent-%COMP%]{border-radius:0 8px 8px 0}.MessageBody--last.MessageBody--mine[_ngcontent-%COMP%]{border-radius:8px 0 8px 8px}.MessageBody--last.MessageBody--other[_ngcontent-%COMP%]{border-radius:0 8px 8px 8px}.MessageBody--solo.MessageBody[_ngcontent-%COMP%]{border-radius:8px}.MessageContainer[_ngcontent-%COMP%]{align-items:flex-start;display:flex;flex-direction:column;flex-wrap:wrap}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageContainer[_ngcontent-%COMP%]{display:block}}.MessageText[_ngcontent-%COMP%]{min-width:1px;-webkit-user-select:auto;-ms-user-select:auto;user-select:auto}.FailedMessage[_ngcontent-%COMP%]{font-size:11px;line-height:1.45;color:#ff624d;text-align:right}.ResendButtonContainer[_ngcontent-%COMP%]{align-self:center;display:flex;margin-left:auto;position:relative}.ResendButtonContainer[_ngcontent-%COMP%]   .ResendButton[_ngcontent-%COMP%]{display:none}.ResendButtonContainer[_ngcontent-%COMP%]   .Menu[_ngcontent-%COMP%]{bottom:16px;position:absolute;width:auto}.Username[_ngcontent-%COMP%]{font-size:11px;line-height:1.45;color:#4d525b;margin-left:40px;margin-top:4px}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageAttachmentContainer[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}}"],changeDetection:0}),e})();var ri=n("M5XV"),ci=n("v01h");const li=["scrollableContent"];function di(e,t){1&e&&p.Tb(0,"fl-spinner",11),2&e&&p.zc("overlay",!0)}function hi(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-link",12),p.nc("click",function(){return p.Pc(e),p.rc().handleLoadMessages()}),p.cc(1,13),p.Xb()}}function gi(e,t){if(1&e&&p.Tb(0,"fl-spinner",14),2&e){const e=p.rc();p.zc("size",e.SpinnerSize.SMALL)}}const ui=function(e,t){return{"MessageList-content-wrapper":e,"MessageList-content-chatbox-wrapper":t}};function bi(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-message-item",16),p.nc("previewModalClose",function(){return p.Pc(e),p.rc(2).previewModalClose.emit()})("previewModalOpen",function(){return p.Pc(e),p.rc(2).previewModalOpen.emit()})("resendMessage",function(t){return p.Pc(e),p.rc(2).handleMessageResend(t)}),p.Xb()}if(2&e){const e=p.rc(),t=e.index,n=e.$implicit,i=p.rc();p.zc("ngClass",p.Fc(11,ui,!i.chatBoxMode,i.chatBoxMode))("after",i.messages[t+1])("before",i.messages[t-1])("currentUserId",i.currentUserId)("usersTyping",i.usersTyping)("message",n)("otherMembers",i.otherMembers)("threadMembers",i.members)("userReadTimes",i.thread.userReadTimes)("chatBoxMode",i.chatBoxMode)("useThumbnailService",i.useThumbnailService)}}function fi(e,t){if(1&e&&(p.Wb(0),p.Zc(1,bi,1,14,"app-message-item",15),p.Vb()),2&e){const e=t.$implicit;p.Gb(1),p.zc("ngIf",e.message&&e.message.length>0||e.attachments&&e.attachments.length>0||e.richMessage)}}function pi(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-floating-action",17),p.nc("click",function(){return p.Pc(e),p.rc().handleShowNewMessages()}),p.Xb()}2&e&&p.zc("icon","ui-arrow-down")}const mi=function(e,t){return{"MessageList-content-wrapper":e,"MessageList-placeholder":t}};function Mi(e,t){if(1&e&&(p.Yb(0,"fl-bit",18),p.Yb(1,"fl-text",19),p.cc(2,20),p.Xb(),p.Xb()),2&e){const e=p.rc();p.zc("ngClass",p.Fc(4,mi,!e.chatBoxMode,e.chatBoxMode)),p.Gb(1),p.zc("textAlign",e.TextAlign.CENTER)("flMarginBottom",e.Margin.SMALL)("color",e.FontColor.MID)}}let Ci=(()=>{class e{constructor(e){this.clipboard=e,this.FontColor=Ce.a,this.Margin=me.a,this.SpinnerSize=Sn.d,this.TextAlign=de.d,this.chatBoxMode=!0,this.showLoadingMoreSpinner=!1,this.useThumbnailService=!1,this.previewModalClose=new p.n,this.previewModalOpen=new p.n,this.resendMessage=new p.n,this.loadMoreMessages=new p.n,this.showLoadingSpinner=!0,this.showNewMessageFloatingAction=!1}ngAfterViewInit(){this.scrollToBottom()}ngOnChanges(e){if(e.messages&&(!e.messages.previousValue||this.isAtBottom()||this.isMessageSent(e.messages.currentValue,e.messages.previousValue))&&setTimeout(()=>this.scrollToBottom(),0),e.messages&&this.isMessageReceived(e.messages.currentValue,e.messages.previousValue)&&!this.isAtBottom()&&(this.showNewMessageFloatingAction=!0),e.thread||e.messages){const e=this.messages&&this.messages.length>0?this.messages[0].threadId:void 0;this.showLoadingSpinner=!this.thread||!this.thread.isFake&&!this.messages||!this.thread.isFake&&!!e&&this.thread.id!==e}}ignoreSelection(e){const t=this.clipboard.getSelectedText();t&&t.rangeCount&&!t.getRangeAt(0).collapsed&&e.stopPropagation()}handleMessageResend(e){this.resendMessage.emit(e)}handleShowNewMessages(){this.scrollToBottom()}isMessageReceived(e,t){const n=e?e[e.length-1]:void 0,i=t?t[t.length-1]:void 0;return!!n&&n.fromUser!==Object(g.s)(this.currentUserId)&&!Object(xe.e)(n,i)}isMessageSent(e,t){const n=e[e.length-1],i=t[t.length-1];return n&&n.fromUser?!Object(xe.e)(n,i)&&n.fromUser===Object(g.s)(this.currentUserId):!Object(xe.e)(n,i)}scrollToBottom(){this.scrollableContent.scrollToBottom(),this.showNewMessageFloatingAction=!1}isAtBottom(){return!this.messageComponents||0===this.messageComponents.length||this.scrollableContent.isAtBottom(this.messageComponents.last.nativeElement.clientHeight)}handleScrollAtBottom(){this.showNewMessageFloatingAction=!1}identifyMessage(e,t){return t.id||t.clientMessageId}handleLoadMessages(){this.loadMoreMessages.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(ri.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-message-list"]],viewQuery:function(e,t){if(1&e&&(p.id(li,1),p.id(oi,1,p.l)),2&e){let e;p.Lc(e=p.oc())&&(t.scrollableContent=e.first),p.Lc(e=p.oc())&&(t.messageComponents=e)}},hostBindings:function(e,t){1&e&&p.nc("click",function(e){return t.ignoreSelection(e)})},inputs:{currentUserId:"currentUserId",members:"members",messages:"messages",otherMembers:"otherMembers",thread:"thread",chatBoxMode:"chatBoxMode",canLoadMore:"canLoadMore",showLoadingMoreSpinner:"showLoadingMoreSpinner",usersTyping:"usersTyping",useThumbnailService:"useThumbnailService"},outputs:{previewModalClose:"previewModalClose",previewModalOpen:"previewModalOpen",resendMessage:"resendMessage",loadMoreMessages:"loadMoreMessages"},features:[p.Eb],decls:11,vars:7,consts:function(){let e,t,n;return e="Show new messages",t=" Load more... ",n=" This is the start of your conversation ",[[1,"MessageList-content"],[1,"MessageList-scrollable"],["scrollableContent",""],["flTrackingLabel","ChatboxInitialisationSpinner",3,"overlay",4,"ngIf"],[1,"MessageList-loadMore"],["flTrackingLabel","LoadMoreMessages",3,"click",4,"ngIf"],["flTrackingLabel","ChatboxLoadMessagesSpinner",3,"size",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],["flTrackingLabel","show_new_messages","text",e,3,"icon","click",4,"ngIf"],["class","MessageList-emptyStateText",3,"ngClass",4,"ngIf"],["name","ui-refresh",1,"MessageList-preloadIcon"],["flTrackingLabel","ChatboxInitialisationSpinner",3,"overlay"],["flTrackingLabel","LoadMoreMessages",3,"click"],t,["flTrackingLabel","ChatboxLoadMessagesSpinner",3,"size"],[3,"ngClass","after","before","currentUserId","usersTyping","message","otherMembers","threadMembers","userReadTimes","chatBoxMode","useThumbnailService","previewModalClose","previewModalOpen","resendMessage",4,"ngIf"],[3,"ngClass","after","before","currentUserId","usersTyping","message","otherMembers","threadMembers","userReadTimes","chatBoxMode","useThumbnailService","previewModalClose","previewModalOpen","resendMessage"],["flTrackingLabel","show_new_messages","text",e,3,"icon","click"],[1,"MessageList-emptyStateText",3,"ngClass"],[3,"textAlign","flMarginBottom","color"],n]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Yb(1,"fl-scrollable-content",1,2),p.Zc(3,di,1,1,"fl-spinner",3),p.Yb(4,"fl-bit",4),p.Zc(5,hi,2,0,"fl-link",5),p.Zc(6,gi,1,1,"fl-spinner",6),p.Xb(),p.Zc(7,fi,2,1,"ng-container",7),p.Zc(8,pi,1,1,"fl-floating-action",8),p.Xb(),p.Xb(),p.Zc(9,Mi,3,7,"fl-bit",9),p.Tb(10,"fl-icon",10)),2&e&&(p.Gb(3),p.zc("ngIf",t.showLoadingSpinner),p.Gb(2),p.zc("ngIf",!t.showLoadingMoreSpinner&&t.canLoadMore),p.Gb(1),p.zc("ngIf",t.showLoadingMoreSpinner),p.Gb(1),p.zc("ngForOf",t.messages)("ngForTrackBy",t.identifyMessage),p.Gb(1),p.zc("ngIf",t.showNewMessageFloatingAction),p.Gb(1),p.zc("ngIf",t.thread.isFake))},directives:[Ee.a,yt.a,i.q,i.p,le.d,Sn.c,Pe.a,ve.a,pe.b,oi,i.o,ci.a,de.e,me.b],styles:["[_nghost-%COMP%]{background:#fff;display:flex;flex:1 0;flex-direction:column;justify-content:space-between;position:relative}.MessageList-scrollable[_ngcontent-%COMP%]{padding-right:8px}@media (min-width:768px){.MessageList-scrollable[_ngcontent-%COMP%]{padding-right:0}}.MessageList-content[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0;flex:1 0 100%;padding-left:8px}.MessageList-content-wrapper[_ngcontent-%COMP%]{margin:0 auto 4px;width:95%}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageList-content-wrapper[_ngcontent-%COMP%]{display:block}}@media (-ms-high-contrast:active),(-ms-high-contrast:none){.MessageList-content-chatbox-wrapper[_ngcontent-%COMP%]{display:block}}.MessageList-placeholder[_ngcontent-%COMP%]{align-items:flex-end;display:flex;flex:1 0 100%;justify-content:center}.MessageList-preloadIcon[_ngcontent-%COMP%]{display:none}.MessageList-loadMore[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;padding-top:16px}.MessageList-emptyStateText[_ngcontent-%COMP%]{left:50%;position:absolute;transform:translateX(-50%);bottom:0;width:100%}"],changeDetection:0}),e})();n("7A1k");var Si=n("KtYJ"),Ti=n("2Vo4"),xi=n("C825");function yi(e,t){1&e&&(p.Wb(0),p.cc(1,7),p.Vb())}function Ii(e,t){if(1&e&&(p.Yb(0,"fl-text"),p.bd(1),p.Xb()),2&e){const e=p.rc().$implicit;p.Gb(1),p.dd(" ",e.username," ")}}function Oi(e,t){if(1&e&&p.Tb(0,"fl-relative-time",11),2&e){const e=p.rc(2).$implicit,t=p.rc();p.zc("size",t.TextSize.XXXSMALL)("date",e.onlineOfflineStatus.lastUpdatedTimestamp)("includeSeconds",!1)("strict",!0)}}function Ai(e,t){if(1&e&&(p.Yb(0,"fl-bit"),p.Yb(1,"fl-text",8),p.cc(2,9),p.Xb(),p.Zc(3,Oi,1,4,"fl-relative-time",10),p.Xb()),2&e){const e=p.rc().$implicit,t=p.rc();p.Gb(1),p.zc("fontType",t.FontType.SPAN)("size",t.TextSize.XXXSMALL)("color",t.FontColor.MID),p.Gb(2),p.zc("ngIf",e.onlineOfflineStatus)}}function vi(e,t){if(1&e&&p.Tb(0,"fl-icon",15),2&e){const e=p.rc(3);p.zc("color",e.IconColor.MID)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function wi(e,t){if(1&e&&p.Tb(0,"fl-icon",16),2&e){const e=p.rc(3);p.zc("color",e.IconColor.MID)("size",e.IconSize.SMALL)("hoverColor",e.HoverColor.PRIMARY)}}function Ei(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",12),p.nc("click",function(){p.Pc(e);const t=p.rc().$implicit;return p.rc().handleRemove(t)}),p.Zc(1,vi,1,3,"fl-icon",13),p.Zc(2,wi,1,3,"fl-icon",14),p.Xb()}if(2&e){const e=p.rc().$implicit,t=p.rc();p.Gb(1),p.zc("ngIf",e.id===t.currentUser.id),p.Gb(1),p.zc("ngIf",e.id!==t.currentUser.id)}}const zi=function(e){return[e]};function Li(e,t){if(1&e&&(p.Yb(0,"fl-bit",2),p.Tb(1,"fl-user-avatar",3),p.sc(2,"isOnline"),p.sc(3,"flAsync"),p.Yb(4,"fl-bit"),p.Yb(5,"fl-link",4),p.bd(6),p.Zc(7,yi,2,0,"ng-container",5),p.Xb(),p.Zc(8,Ii,2,1,"fl-text",5),p.Zc(9,Ai,4,4,"fl-bit",5),p.sc(10,"isOnline"),p.sc(11,"flAsync"),p.Xb(),p.Zc(12,Ei,3,2,"fl-button",6),p.Xb()),2&e){const e=t.$implicit,n=t.last,i=p.rc();p.zc("flMarginBottom",n?i.Margin.NONE:i.Margin.SMALL),p.Gb(1),p.zc("users",p.Ec(20,zi,e))("isOnline",p.uc(2,10,e,p.tc(3,13,i.onlineOfflineStatuses$)))("flMarginRight",i.Margin.XXXSMALL),p.Gb(4),p.zc("link",e.profileUrl),p.Gb(1),p.dd(" ",e.displayName," "),p.Gb(1),p.zc("ngIf",e.id===i.currentUser.id),p.Gb(1),p.zc("ngIf",i.isRecruiter&&e.username!==e.displayName),p.Gb(1),p.zc("ngIf",e.id!==i.currentUser.id&&!p.uc(10,15,e,p.tc(11,18,i.onlineOfflineStatuses$))&&(null==e||null==e.onlineOfflineStatus?null:e.onlineOfflineStatus.lastUpdatedTimestamp)),p.Gb(3),p.zc("ngIf",i.showRemoveButton(e))}}function ki(e,t){if(1&e&&(p.Yb(0,"fl-text",17),p.cc(1,18),p.Xb()),2&e){const e=p.rc();p.zc("color",e.FontColor.MID)("size",e.TextSize.XXSMALL)}}let Pi=(()=>{class e{constructor(){this.Margin=me.a,this.ButtonColor=fe.a,this.FontColor=Ce.a,this.TextSize=de.f,this.FontType=de.b,this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.userRemoval=new p.n}showRemoveButton(e){return this.thread.threadType===$t.ThreadTypeApi.TEAM?!!this.team&&e.id!==this.team.ownerUserId&&this.team.members.includes(e.id):this.thread.threadType!==$t.ThreadTypeApi.TEAM_OFFICIAL&&(e.id===this.currentUser.id||this.isThreadOwner||this.isRecruiter)&&this.thread.threadType!==$t.ThreadTypeApi.PRIVATE_CHAT}showGroupChatHelperText(){return 2===this.participants.length&&this.thread.context.type!==$t.ContextTypeApi.NONE&&(this.isThreadOwner&&this.candidatesExist||this.isRecruiter)}handleRemove(e){this.userRemoval.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-participants-view-content"]],inputs:{participants:"participants",onlineOfflineStatuses$:"onlineOfflineStatuses$",isThreadOwner:"isThreadOwner",candidatesExist:"candidatesExist",isRecruiter:"isRecruiter",currentUser:"currentUser",thread:"thread",team:"team"},outputs:{userRemoval:"userRemoval"},decls:2,vars:2,consts:function(){let e,t,n,i,s;return e=" (you) ",t=" Last seen ",n="Leave this chat",i="Remove the user from this chat",s=" You are currently talking to one user, add more people to start a new group chat. ",[["class","ParticipantItem",3,"flMarginBottom",4,"ngFor","ngForOf"],["class","AsideText",3,"color","size",4,"ngIf"],[1,"ParticipantItem",3,"flMarginBottom"],[3,"users","isOnline","flMarginRight"],["flTrackingSection","ParticipantsView","flTrackingLabel","UsernameLink",3,"link"],[4,"ngIf"],["class","RemoveButton","flTrackingLabel","GroupChatRemoveParticipant",3,"click",4,"ngIf"],e,[3,"fontType","size","color"],t,[3,"size","date","includeSeconds","strict",4,"ngIf"],[3,"size","date","includeSeconds","strict"],["flTrackingLabel","GroupChatRemoveParticipant",1,"RemoveButton",3,"click"],["name","ui-close","label",n,3,"color","size","hoverColor",4,"ngIf"],["name","ui-close","label",i,3,"color","size","hoverColor",4,"ngIf"],["name","ui-close","label",n,3,"color","size","hoverColor"],["name","ui-close","label",i,3,"color","size","hoverColor"],[1,"AsideText",3,"color","size"],s]},template:function(e,t){1&e&&(p.Zc(0,Li,13,22,"fl-bit",0),p.Zc(1,ki,2,2,"fl-text",1)),2&e&&(p.zc("ngForOf",t.participants),p.Gb(1),p.zc("ngIf",t.showGroupChatHelperText()))},directives:[i.p,i.q,Ee.a,me.b,pn.b,pe.b,gn.a,ve.a,de.e,ke.b,fe.b,le.d],pipes:[Dt.a,_e.a],styles:[".ParticipantItem[_ngcontent-%COMP%]{align-items:center;display:flex}.ParticipantItem[_ngcontent-%COMP%]:hover   .RemoveButton[_ngcontent-%COMP%]{opacity:1}.RemoveButton[_ngcontent-%COMP%]{flex:0 0 auto;margin-left:auto;opacity:0;transition:opacity .1s ease-in}.AsideText[_ngcontent-%COMP%]{padding:12px}"],changeDetection:0}),e})();var _i=n("/zj7");function Ri(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",5),p.nc("click",function(){return p.Pc(e),p.rc().inboxRedirect()}),p.Tb(1,"fl-icon",6),p.Yb(2,"fl-text",7),p.cc(3,8),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("color",e.IconColor.PRIMARY)("size",e.IconSize.SMALL)("flMarginRight",e.Margin.XSMALL)("name","ui-inbox"),p.Gb(1),p.zc("size",e.TextSize.XSMALL)("fontType",e.FontType.SPAN)}}function ji(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",10),p.nc("click",function(){return p.Pc(e),p.rc(2).handleArchiveClick()}),p.Yb(1,"fl-bit",11),p.Yb(2,"fl-text",12),p.cc(3,13),p.Xb(),p.Yb(4,"fl-text",14),p.cc(5,15),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.rc().ngIf,t=p.rc();p.zc("control",e),p.Gb(2),p.zc("size",t.TextSize.XSMALL),p.Gb(2),p.zc("color",t.FontColor.MID)("size",t.TextSize.XXSMALL)}}function Ui(e,t){if(1&e&&(p.Wb(0),p.Zc(1,ji,6,4,"fl-list-item",9),p.Vb()),2&e){const e=t.ngIf,n=p.rc();p.Gb(1),p.zc("ngIf",n.isFormControl(e))}}function Bi(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",17),p.nc("click",function(){return p.Pc(e),p.rc(2).handleMuteClick()}),p.Yb(1,"fl-bit",11),p.Yb(2,"fl-text",12),p.cc(3,18),p.Xb(),p.Yb(4,"fl-text",14),p.cc(5,19),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.rc().ngIf,t=p.rc();p.zc("control",e),p.Gb(2),p.zc("size",t.TextSize.XSMALL),p.Gb(2),p.zc("color",t.FontColor.MID)("size",t.TextSize.XXSMALL)}}function $i(e,t){if(1&e&&(p.Wb(0),p.Zc(1,Bi,6,4,"fl-list-item",16),p.Vb()),2&e){const e=t.ngIf,n=p.rc();p.Gb(1),p.zc("ngIf",n.isFormControl(e))}}function Gi(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",21),p.nc("click",function(){return p.Pc(e),p.rc(2).handleBlockClick()}),p.Yb(1,"fl-bit",11),p.Yb(2,"fl-text",12),p.cc(3,22),p.Xb(),p.Yb(4,"fl-text",14),p.cc(5,23),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.rc().ngIf,t=p.rc();p.zc("control",e),p.Gb(2),p.zc("size",t.TextSize.XSMALL),p.Gb(2),p.zc("color",t.FontColor.MID)("size",t.TextSize.XXSMALL)}}const Fi=function(){return["group","team","team_official"]};function Di(e,t){if(1&e&&(p.Wb(0),p.Zc(1,Gi,6,4,"fl-list-item",20),p.Vb()),2&e){const e=t.ngIf,n=p.rc();p.Gb(1),p.zc("ngIf",1===n.thread.otherMembers.length&&!p.Dc(1,Fi).includes(n.thread.threadType)&&"owner_autochat"!==n.thread.writePrivacy&&n.isFormControl(e))}}function Ni(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list",24),p.Yb(1,"fl-list-item",25),p.nc("click",function(){return p.Pc(e),p.rc().handleReportClick()}),p.Yb(2,"fl-bit",26),p.Tb(3,"fl-icon",27),p.Yb(4,"fl-bit"),p.Yb(5,"fl-text"),p.cc(6,28),p.Xb(),p.Yb(7,"fl-text",14),p.cc(8,29),p.Xb(),p.Xb(),p.Xb(),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.zc("clickable",!0)("padding",e.ListItemPadding.XXSMALL),p.Gb(3),p.zc("flMarginRight",e.Margin.XSMALL)("name","ui-warning-alt-v2")("size",e.IconSize.SMALL),p.Gb(4),p.zc("color",e.FontColor.MID)("size",e.TextSize.XXSMALL)}}let Xi=(()=>{class e{constructor(e,t){this.modalService=e,this.router=t,this.ContextTypeApi=$t.ContextTypeApi,this.Margin=me.a,this.IconColor=le.c,this.IconSize=le.e,this.isFormControl=g.l,this.FontColor=Ce.a,this.TextSize=de.f,this.FontType=de.b,this.ListItemType=Si.f,this.ListItemPadding=Si.e,this.showReportCta=!1,this.chatBoxMode=!0,this.archiveChatToggle=new p.n,this.muteChatToggle=new p.n,this.blockChatToggle=new p.n,this.formGroup=new s.h({archive:new s.f,mute:new s.f,block:new s.f})}ngOnInit(){this.formGroup.controls.archive.setValue(this.thread.folder===$t.FolderApi.ARCHIVED),this.formGroup.controls.mute.setValue(this.thread.isMuted),this.formGroup.controls.block.setValue(this.thread.isBlocked)}ngOnChanges(e){if(e.thread&&e.thread.previousValue){const t=this.thread.folder===$t.FolderApi.ARCHIVED;e.thread.previousValue.folder!==this.thread.folder&&(this.formGroup.controls.archive.setValue(t),this.formGroup.controls.archive.enable()),e.thread.previousValue.isMuted!==this.thread.isMuted&&(this.formGroup.controls.mute.setValue(this.thread.isMuted),this.formGroup.controls.mute.enable()),e.thread.previousValue.isBlocked!==this.thread.isBlocked&&(this.formGroup.controls.block.setValue(this.thread.isBlocked),this.formGroup.controls.block.enable())}}handleArchiveClick(){this.formGroup.controls.archive.enabled&&(this.formGroup.controls.archive.disable(),this.archiveChatToggle.emit(!0))}handleMuteClick(){this.formGroup.controls.mute.enabled&&(this.formGroup.controls.mute.disable(),this.muteChatToggle.emit(!0))}handleBlockClick(){this.formGroup.controls.block.enabled&&(this.formGroup.controls.block.disable(),this.blockChatToggle.emit(!0))}handleReportClick(){[$t.ContextTypeApi.PROJECT,$t.ContextTypeApi.CONTEST].includes(this.thread.context.type)&&this.modalService.open("ViolationReportModal",{inputs:{violatorUserId:this.thread.owner,contextId:this.thread.context.type===$t.ContextTypeApi.PROJECT?this.thread.context.id:this.thread.owner,contextType:this.thread.context.type===$t.ContextTypeApi.PROJECT?Ft.ViolationReportContextTypeApi.PROJECT:Ft.ViolationReportContextTypeApi.PROFILE},size:Me.a.MID,mobileFullscreen:!0})}inboxRedirect(){if(this.thread.isFake){const{threadType:e,members:t,context:n}=this.thread;this.router.navigate(["/messages/new"],{queryParams:{newMessageOptions:{thread_type:e,context_type:n.type,context_id:n.type!==$t.ContextTypeApi.NONE?n.id:void 0,members:t}}})}this.router.navigate(["/messages/thread",this.thread.id])}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ie.b),p.Sb(ye.e))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-settings-overlay-content"]],inputs:{showReportCta:"showReportCta",thread:"thread",chatBoxMode:"chatBoxMode"},outputs:{archiveChatToggle:"archiveChatToggle",muteChatToggle:"muteChatToggle",blockChatToggle:"blockChatToggle"},features:[p.Eb],decls:7,vars:12,consts:function(){let e,t,n,i,s,a,o,r,c;return e="Open this chat in your inbox ",t=" Archive ",n=" Hide this chat from your active chats. You will still receive notifications. ",i=" Mute ",s=" You will receive no notifications for future messages. ",a=" Block ",o=" No members of this chat will be able to send any messages in it. ",r="Report",c=" There is something wrong with this conversation. ",[[3,"bottomBorder","clickable","padding","type"],["flTrackingLabel","settingsInbox",3,"click",4,"ngIf"],[3,"bottomBorder","type","padding"],[4,"ngIf"],[3,"clickable","padding",4,"ngIf"],["flTrackingLabel","settingsInbox",3,"click"],[3,"color","size","flMarginRight","name"],[3,"size","fontType"],e,["flTrackingLabel","settingsArchive",3,"control","click",4,"ngIf"],["flTrackingLabel","settingsArchive",3,"control","click"],[1,"SettingListItem"],[3,"size"],t,[3,"color","size"],n,["flTrackingLabel","settingsMute",3,"control","click",4,"ngIf"],["flTrackingLabel","settingsMute",3,"control","click"],i,s,["flTrackingLabel","settingsBlock",3,"control","click",4,"ngIf"],["flTrackingLabel","settingsBlock",3,"control","click"],a,o,[3,"clickable","padding"],["flTrackingLabel","ChatboxReportCta",3,"click"],[1,"ChatboxReportCta"],[3,"flMarginRight","name","size"],r,c]},template:function(e,t){1&e&&(p.Yb(0,"fl-list",0),p.Zc(1,Ri,4,6,"fl-list-item",1),p.Xb(),p.Yb(2,"fl-list",2),p.Zc(3,Ui,2,1,"ng-container",3),p.Zc(4,$i,2,1,"ng-container",3),p.Zc(5,Di,2,2,"ng-container",3),p.Xb(),p.Zc(6,Ni,9,7,"fl-list",4)),2&e&&(p.zc("bottomBorder",!0)("clickable",!0)("padding",t.ListItemPadding.XXSMALL)("type",t.ListItemType.DEFAULT),p.Gb(1),p.zc("ngIf",t.chatBoxMode),p.Gb(1),p.zc("bottomBorder",t.showReportCta)("type",t.ListItemType.CHECKBOX)("padding",t.ListItemPadding.XXSMALL),p.Gb(1),p.zc("ngIf",t.formGroup.get("archive")),p.Gb(1),p.zc("ngIf",t.formGroup.get("mute")),p.Gb(1),p.zc("ngIf",t.formGroup.get("block")),p.Gb(1),p.zc("ngIf",t.showReportCta))},directives:[_i.a,i.q,Si.b,ve.a,le.d,me.b,de.e,Ee.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.ChatboxReportCta[_ngcontent-%COMP%]{align-items:center;display:flex}"],changeDetection:0}),e})();var Yi=n("2Gc0");function Hi(e,t){1&e&&p.Ub(0)}function Vi(e,t){if(1&e&&p.Tb(0,"fl-picture",9),2&e){const e=p.rc();p.zc("src",e.imageThumbnailPath)("boundedWidth",!0)("alt",e.filename)("externalSrc",!0)("flMarginRight",e.Margin.XXSMALL)}}function Zi(e,t){if(1&e&&(p.Tb(0,"fl-file-display",10),p.sc(1,"flAsync")),2&e){const e=p.rc();p.zc("src",p.tc(1,4,e.pathPromise))("alt",e.filename)("size",e.FileDisplaySize.SMALL)("flMarginRight",e.Margin.XXSMALL)}}let Wi=(()=>{class e{constructor(e){this.fileStorage=e,this.Margin=me.a,this.FileDisplaySize=Yi.c,this.FontColor=Ce.a,this.TextSize=de.f,this.ImageAttachmentThumbnailHeight=an,this.ImageAttachmentThumbnailWidth=on,this.useThumbnailService=!1}set attachment(e){this.filename=e.filename,this.pathPromise=this.fileStorage.getDownloadURL(tn.a.MESSAGING_ATTACHMENTS,e.filename,{messageId:e.messageId.toString()}).then(e=>"success"===e.status?e.downloadURL:void 0),this.date=new Date(e.timeCreated),this.isImageFile=Object(nn.i)(this.filename),this.imageThumbnailPath=rn(e.messageId,e.filename,{height:an.ATTACHMENT_SIDEBAR,width:on.ATTACHMENT_SIDEBAR}),this.isGifFile="gif"===Object(nn.e)(e.filename)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(dn.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-sidebar-attachment-item"]],inputs:{attachment:"attachment",useThumbnailService:"useThumbnailService"},decls:13,vars:8,consts:function(){let e;return e=" Uploaded " + "\ufffd0\ufffd" + " ",[[1,"SidebarAttachment"],[4,"ngTemplateOutlet"],[1,"SidebarAttachment-details"],[3,"size"],[1,"SidebarAttachment-fileName"],[3,"size","color"],e,["imageThumbnail",""],["fileDisplay",""],[1,"SidebarAttachment-icon",3,"src","boundedWidth","alt","externalSrc","flMarginRight"],[1,"SidebarAttachment-icon",3,"src","alt","size","flMarginRight"]]},template:function(e,t){if(1&e&&(p.Yb(0,"fl-bit",0),p.Zc(1,Hi,1,0,"ng-container",1),p.Yb(2,"fl-bit",2),p.Yb(3,"fl-text",3),p.Yb(4,"fl-bit",4),p.bd(5),p.Xb(),p.Xb(),p.Yb(6,"fl-text",5),p.cc(7,6),p.sc(8,"date"),p.Xb(),p.Xb(),p.Xb(),p.Zc(9,Vi,1,5,"ng-template",null,7,p.ad),p.Zc(11,Zi,2,6,"ng-template",null,8,p.ad)),2&e){const e=p.Mc(10),n=p.Mc(12);p.Gb(1),p.zc("ngTemplateOutlet",t.isImageFile&&!t.isGifFile&&t.useThumbnailService?e:n),p.Gb(2),p.zc("size",t.TextSize.XSMALL),p.Gb(2),p.cd(t.filename),p.Gb(1),p.zc("size",t.TextSize.XXSMALL)("color",t.FontColor.MID),p.Gb(2),p.gc(p.tc(8,6,t.date)),p.dc(7)}},directives:[Ee.a,i.v,de.e,sn.a,me.b,Yi.a],pipes:[i.f,_e.a],styles:[".SidebarAttachment[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row}.SidebarAttachment-icon[_ngcontent-%COMP%]{flex-shrink:0}.SidebarAttachment-details[_ngcontent-%COMP%]{flex:1 1 100%;min-width:0}.SidebarAttachment-fileName[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}"],changeDetection:0}),e})();function qi(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-list-item",2),p.nc("click",function(){p.Pc(e);const n=t.$implicit;return p.rc().openPreviewModal(n)}),p.Tb(1,"app-sidebar-attachment-item",3),p.Xb()}if(2&e){const e=t.$implicit,n=p.rc();p.Ac("flTrackingReferenceId",e.threadId),p.Gb(1),p.zc("attachment",e)("useThumbnailService",n.useThumbnailService)}}let Qi=(()=>{class e{constructor(e,t,n,i,s){this.modalService=e,this.tracking=t,this.fileDownload=n,this.fileStorage=i,this.userAgent=s,this.TextSize=de.f,this.FontWeight=de.c,this.ListItemPadding=Si.e,this.ListItemType=Si.f,this.ModalSize=Me.a,this.useThumbnailService=!1}identifyAttachment(e,t){return t.id}openPreviewModal(e){return Object(T.a)(this,void 0,void 0,function*(){if(["IE","Edge"].includes(this.userAgent.getUserAgent().getBrowser().name||"")){const t=yield this.fileStorage.getDownloadURL(tn.a.MESSAGING_ATTACHMENTS,e.filename,{messageId:e.messageId.toString()});if("error"===t.status)return;return this.fileDownload.download(t.downloadURL,e.filename)}this.modalService.open("FileViewerModal",{inputs:{messageId:e.messageId,filename:e.filename,filetype:Object(nn.f)(e.filename)},edgeToEdge:!0,size:Me.a.XLARGE}).afterClosed().toPromise().then(()=>{this.tracking.track("user_action",{section:"messaging_image_viewer",subsection:"header",label:"close_image_viewer"})})})}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ie.b),p.Sb(cn.a),p.Sb(ln.a),p.Sb(dn.a),p.Sb(hn.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-sidebar-attachments"]],inputs:{attachments:"attachments",useThumbnailService:"useThumbnailService"},decls:2,vars:5,consts:[[3,"clickable","padding","type"],["flTrackingLabel","open_image_viewer","flTrackingReferenceType","thread_id",3,"flTrackingReferenceId","click",4,"ngFor","ngForOf","ngForTrackBy"],["flTrackingLabel","open_image_viewer","flTrackingReferenceType","thread_id",3,"flTrackingReferenceId","click"],[3,"attachment","useThumbnailService"]],template:function(e,t){1&e&&(p.Yb(0,"fl-list",0),p.Zc(1,qi,2,3,"fl-list-item",1),p.Xb()),2&e&&(p.zc("clickable",!0)("padding",t.ListItemPadding.XXSMALL)("type",t.ListItemType.NON_BORDERED),p.Gb(1),p.zc("ngForOf",t.attachments)("ngForTrackBy",t.identifyAttachment))},directives:[_i.a,i.p,Si.b,ve.a,Wi],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.SidebarImages[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap}"],changeDetection:0}),e})();function Ki(e,t){if(1&e&&(p.Yb(0,"fl-bit",13),p.Yb(1,"fl-text",3),p.cc(2,14),p.Xb(),p.Yb(3,"fl-bit",5),p.Tb(4,"app-context-box",15),p.Xb(),p.Xb()),2&e){const e=p.rc();p.zc("flHideTablet",!0)("flHideMobile",!0),p.Gb(1),p.zc("weight",e.FontWeight.BOLD)("size",e.TextSize.SMALL)("flMarginBottom",e.Margin.XXSMALL),p.Gb(2),p.zc("flMarginBottom",e.Margin.XXSMALL),p.Gb(1),p.zc("extended",!0)("chatBoxMode",!1)("state",e.contextBoxState)}}function Ji(e,t){1&e&&(p.Wb(0),p.cc(1,23),p.Vb())}function es(e,t){1&e&&(p.Wb(0),p.cc(1,24),p.Vb())}function ts(e,t){if(1&e&&(p.Yb(0,"fl-bit",13),p.Yb(1,"fl-text",9),p.Zc(2,Ji,2,0,"ng-container",16),p.Zc(3,es,2,0,"ng-container",16),p.Xb(),p.Yb(4,"fl-list",17),p.Yb(5,"fl-list-item"),p.Yb(6,"fl-link",18),p.Tb(7,"fl-icon",19),p.bd(8),p.Xb(),p.Xb(),p.Yb(9,"fl-list-item"),p.Tb(10,"fl-icon",19),p.Yb(11,"fl-text",20),p.cc(12,21),p.Xb(),p.Tb(13,"fl-relative-time",22),p.Xb(),p.Xb(),p.Xb()),2&e){const e=p.rc();p.zc("flHideTablet",!0)("flHideMobile",!0),p.Gb(1),p.zc("weight",e.FontWeight.BOLD)("size",e.TextSize.SMALL),p.Gb(1),p.zc("ngIf","project"===e.thread.context.type),p.Gb(1),p.zc("ngIf","contest"===e.thread.context.type),p.Gb(1),p.zc("type",e.ListItemType.NON_BORDERED)("padding",e.ListItemPadding.XXSMALL),p.Gb(2),p.zc("link",e.contextBoxState.linkUrl)("queryParams",e.contextBoxState.linkQueryParams),p.Gb(1),p.zc("flMarginRight",e.Margin.XXXSMALL)("name","ui-link")("size",e.IconSize.SMALL),p.Gb(1),p.dd(" ",e.contextBoxState.linkText," "),p.Gb(2),p.zc("flMarginRight",e.Margin.XXXSMALL)("name","ui-hourglass")("size",e.IconSize.SMALL),p.Gb(1),p.zc("fontType",e.FontType.SPAN)("size",e.TextSize.XSMALL),p.Gb(2),p.zc("date",e.contextBoxState.timeSubmitted)("size",e.TextSize.XSMALL)("color",e.FontColor.DARK)}}function ns(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-link",25),p.nc("click",function(){return p.Pc(e),p.rc().onAddPeopleClick()}),p.cc(1,26),p.Xb()}if(2&e){const e=p.rc();p.zc("flMarginBottom",e.Margin.XXSMALL)}}function is(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-link",32),p.nc("click",function(){return p.Pc(e),p.rc(2).handleLoadAttachments()}),p.cc(1,33),p.Xb()}if(2&e){const e=p.rc(2);p.zc("flMarginBottom",e.Margin.XSMALL)}}function ss(e,t){if(1&e&&(p.Yb(0,"fl-bit",27),p.Yb(1,"fl-text",28),p.cc(2,29),p.Xb(),p.Tb(3,"app-sidebar-attachments",30),p.sc(4,"flAsync"),p.Zc(5,is,2,1,"fl-link",31),p.sc(6,"flAsync"),p.Xb()),2&e){const e=p.rc();p.Gb(1),p.zc("size",e.TextSize.SMALL)("weight",e.FontWeight.BOLD),p.Gb(2),p.zc("attachments",p.tc(4,5,e.attachmentsCollection.valueChanges()))("useThumbnailService",e.useThumbnailService),p.Gb(2),p.zc("ngIf",p.tc(6,7,e.canLoadMore$))}}let as=(()=>{class e{constructor(e,t){this.datastore=e,this.abtestService=t,this.Margin=me.a,this.FontColor=Ce.a,this.TextSize=de.f,this.FontType=de.b,this.FontWeight=de.c,this.IconSize=le.e,this.ListItemPadding=Si.e,this.ListItemType=Si.f,this.showReportCta=!1,this.chatOptionsMode=!1,this.archiveChatToggle=new p.n,this.blockChatToggle=new p.n,this.muteChatToggle=new p.n,this.userAdd=new p.n,this.userRemove=new p.n,this.currentLimit=50,this.attachmentsLimitSubject$=new Ti.a(this.currentLimit)}ngOnInit(){this.resetSubscription=this.threadId$.subscribe(()=>{this.currentLimit=50,this.attachmentsLimitSubject$.next(this.currentLimit)}),this.attachmentsCollection=this.datastore.collection("messageAttachments",e=>e.where("threadId","==",this.threadId$).limit(this.attachmentsLimitSubject$)),this.canLoadMore$=this.attachmentsCollection.valueChanges().pipe(Object(I.a)(e=>e.length>=this.currentLimit)),this.hasAttachments$=this.attachmentsCollection.valueChanges().pipe(Object(I.a)(e=>!!e.length))}ngOnDestroy(){this.resetSubscription&&this.resetSubscription.unsubscribe()}ngOnChanges(e){e.currentUser&&e.currentUser.currentValue&&(this.useThumbnailService=this.abtestService.isWhitelistUser()||this.abtestService.shouldEnrol("T90189-image-thumbnail-service",e.currentUser.currentValue.id,.01))}handleLoadAttachments(){this.currentLimit+=50,this.attachmentsLimitSubject$.next(this.currentLimit)}identifyAttachment(e,t){return t.id}onArchiveChatToggle(){this.archiveChatToggle.emit()}onBlockChatToggle(){this.blockChatToggle.emit()}onMuteChatToggle(){this.muteChatToggle.emit()}onAddPeopleClick(){this.userAdd.emit()}handleUserRemoved(e){this.userRemove.emit(e)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Oe.a),p.Sb(xi.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-messaging-sidebar"]],inputs:{candidatesExist:"candidatesExist",contextBoxState:"contextBoxState",currentUser:"currentUser",isRecruiter:"isRecruiter",isThreadOwner:"isThreadOwner",onlineOfflineStatuses$:"onlineOfflineStatuses$",showAddPeopleOption:"showAddPeopleOption",showReportCta:"showReportCta",threadId$:"threadId$",thread:"thread",members:"members",team:"team",chatOptionsMode:"chatOptionsMode"},outputs:{archiveChatToggle:"archiveChatToggle",blockChatToggle:"blockChatToggle",muteChatToggle:"muteChatToggle",userAdd:"userAdd",userRemove:"userRemove"},features:[p.Eb],decls:16,vars:24,consts:function(){let e,t,n,i,s,a,o,r,c;return e=" People in Chat ",t=" Settings ",n=" Actions ",i=" Posted ",s=" Project Details ",a=" Contest Details ",o=" Add people ",r=" Thread attachments ",c=" Load more... ",[[1,"MessagingSidebar-scrollbar",3,"hideHorizontalScroll"],["class","MessagingSidebar-subsection",3,"flHideTablet","flHideMobile",4,"ngIf"],[1,"MessagingSidebar-subsection"],[3,"weight","size","flMarginBottom"],e,[3,"flMarginBottom"],[1,"MessagingSidebar-threadMembersScrollSection"],[3,"participants","onlineOfflineStatuses$","currentUser","isRecruiter","isThreadOwner","candidatesExist","thread","team","userRemoval"],["class","MessagingSidebar-actionLink","flTrackingLabel","AddUsersToChat",3,"flMarginBottom","click",4,"ngIf"],[3,"weight","size"],t,[3,"showReportCta","thread","chatBoxMode","archiveChatToggle","muteChatToggle","blockChatToggle"],["class","MessagingSidebar-subsection MessagingSidebar-attachmentsPanel",4,"ngIf"],[1,"MessagingSidebar-subsection",3,"flHideTablet","flHideMobile"],n,[1,"MessagingSidebar-contextBox",3,"extended","chatBoxMode","state"],[4,"ngIf"],[3,"type","padding"],["flTrackingLabel","Inbox.ProjectLink",1,"MessagingSidebar-detailLink",3,"link","queryParams"],[3,"flMarginRight","name","size"],[3,"fontType","size"],i,[3,"date","size","color"],s,a,["flTrackingLabel","AddUsersToChat",1,"MessagingSidebar-actionLink",3,"flMarginBottom","click"],o,[1,"MessagingSidebar-subsection","MessagingSidebar-attachmentsPanel"],[3,"size","weight"],r,[3,"attachments","useThumbnailService"],["class","MessagingSidebar-attachmentsLoad","flTrackingLabel","LoadMoreAttachments",3,"flMarginBottom","click",4,"ngIf"],["flTrackingLabel","LoadMoreAttachments",1,"MessagingSidebar-attachmentsLoad",3,"flMarginBottom","click"],c]},template:function(e,t){1&e&&(p.Yb(0,"fl-scrollable-content",0),p.Zc(1,Ki,5,9,"fl-bit",1),p.Zc(2,ts,14,22,"fl-bit",1),p.Yb(3,"fl-bit",2),p.Yb(4,"fl-text",3),p.cc(5,4),p.Xb(),p.Yb(6,"fl-bit",5),p.Yb(7,"fl-scrollable-content",6),p.Yb(8,"app-participants-view-content",7),p.nc("userRemoval",function(e){return t.handleUserRemoved(e)}),p.Xb(),p.Xb(),p.Xb(),p.Zc(9,ns,2,1,"fl-link",8),p.Xb(),p.Yb(10,"fl-bit",2),p.Yb(11,"fl-text",9),p.cc(12,10),p.Xb(),p.Yb(13,"app-settings-overlay-content",11),p.nc("archiveChatToggle",function(){return t.onArchiveChatToggle()})("muteChatToggle",function(){return t.onMuteChatToggle()})("blockChatToggle",function(){return t.onBlockChatToggle()}),p.Xb(),p.Xb(),p.Zc(14,ss,7,9,"fl-bit",12),p.sc(15,"flAsync"),p.Xb()),2&e&&(p.zc("hideHorizontalScroll",!0),p.Gb(1),p.zc("ngIf",(null==t.contextBoxState?null:t.contextBoxState.button)&&!t.chatOptionsMode),p.Gb(1),p.zc("ngIf",t.contextBoxState&&"hireme"!==t.contextBoxState.name&&!t.chatOptionsMode),p.Gb(2),p.zc("weight",t.FontWeight.BOLD)("size",t.TextSize.SMALL)("flMarginBottom",t.Margin.XXSMALL),p.Gb(2),p.zc("flMarginBottom",t.Margin.XXSMALL),p.Gb(2),p.zc("participants",t.members)("onlineOfflineStatuses$",t.onlineOfflineStatuses$)("currentUser",t.currentUser)("isRecruiter",t.isRecruiter)("isThreadOwner",t.isThreadOwner)("candidatesExist",t.candidatesExist)("thread",t.thread)("team",t.team),p.Gb(1),p.zc("ngIf",t.showAddPeopleOption),p.Gb(2),p.zc("weight",t.FontWeight.BOLD)("size",t.TextSize.SMALL),p.Gb(2),p.zc("showReportCta",t.showReportCta)("thread",t.thread)("chatBoxMode",!1),p.Gb(1),p.zc("ngIf",!t.thread.isFake&&p.tc(15,22,t.hasAttachments$)))},directives:[yt.a,i.q,Ee.a,de.e,me.b,Pi,Xi,ze.a,Mt,_i.a,Si.b,pe.b,ve.a,le.d,ke.b,Qi],pipes:[_e.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}.MessagingSidebar-attachmentsLoad[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.MessagingSidebar-contextBox[_ngcontent-%COMP%]{display:flex;flex:0 0 auto;flex-direction:column}.MessagingSidebar-contextDetailItem[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row}.MessagingSidebar-subsection[_ngcontent-%COMP%]{border-bottom:1px solid #dedede;padding-top:8px}@media (min-width:768px){.MessagingSidebar-subsection[_ngcontent-%COMP%]{padding-left:8px;padding-right:8px}}.MessagingSidebar-threadMembersScrollSection[_ngcontent-%COMP%]{max-height:300px;padding-right:12px}.MessagingSidebar-attachmentsPanel[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:hidden}.MessagingSidebar-actionLink[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center}.MessagingSidebar-scrollbar[_ngcontent-%COMP%]{bottom:0;left:0;position:absolute;right:0;top:0}.MessagingSidebar-detailLink[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:block}"],changeDetection:0}),e})();var os=n("IzEk");let rs=(()=>{class e{constructor(){this.FontType=de.b,this.TextSize=de.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-overlay-template-discuss"]],inputs:{otherUser:"otherUser"},decls:6,vars:3,consts:function(){let e,t;return e=" Don't forget to discuss goals and deadlines ",t=" Make sure you and " + "\ufffd0\ufffd" + " agree on exactly what the tasks to be completed are, and when each of them is due.",[[1,"OnboardingOverlayTitle"],[3,"size"],e,[1,"OnboardingOverlayBody"],[3,"fontType"],t]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Yb(1,"fl-text",1),p.cc(2,2),p.Xb(),p.Xb(),p.Yb(3,"fl-bit",3),p.Yb(4,"fl-text",4),p.cc(5,5),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.zc("size",t.TextSize.SMALL),p.Gb(3),p.zc("fontType",t.FontType.SPAN),p.Gb(1),p.gc(t.otherUser.displayName),p.dc(5))},directives:[Ee.a,de.e],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();var cs=n("/e27");function ls(e,t){if(1&e&&(p.Yb(0,"fl-text",5),p.cc(1,6),p.sc(2,"truncateFilename"),p.Xb()),2&e){const e=p.rc();p.zc("size",e.TextSize.SMALL),p.Gb(2),p.gc(e.otherUser.displayName)(p.uc(2,3,e.project.title,100)),p.dc(1)}}function ds(e,t){if(1&e&&(p.Yb(0,"fl-text",5),p.cc(1,7),p.Xb()),2&e){const e=p.rc();p.zc("size",e.TextSize.SMALL),p.Gb(1),p.gc(e.otherUser.displayName)(e.project.title),p.dc(1)}}let hs=(()=>{class e{constructor(){this.FontType=de.b,this.TextSize=de.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-overlay-template-intro"]],inputs:{thread:"thread",otherUser:"otherUser",project:"project"},decls:6,vars:4,consts:function(){let e,t,n;return e=" Click 'Next' to see a few tips on how to make sure you and " + "\ufffd0\ufffd" + " have a great experience working together. ",t=" " + "\ufffd0\ufffd" + " would like to chat to you about " + "\ufffd1\ufffd" + " ",n=" You are about to start chatting to " + "\ufffd0\ufffd" + " about " + "\ufffd1\ufffd" + " ",[[1,"OnboardingOverlayTitle"],[3,"size",4,"ngIf"],[1,"OnboardingOverlayBody"],[3,"fontType"],e,[3,"size"],t,n]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Zc(1,ls,3,6,"fl-text",1),p.Zc(2,ds,2,3,"fl-text",1),p.Xb(),p.Yb(3,"fl-bit",2),p.Yb(4,"fl-text",3),p.cc(5,4),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.zc("ngIf",t.thread&&t.thread.id),p.Gb(1),p.zc("ngIf",!t.thread||!t.thread.id),p.Gb(2),p.zc("fontType",t.FontType.SPAN),p.Gb(1),p.gc(t.otherUser.displayName),p.dc(5))},directives:[Ee.a,i.q,de.e],pipes:[cs.a],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();function gs(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-bit",3),p.Yb(2,"fl-text",4),p.cc(3,5),p.Xb(),p.Xb(),p.Yb(4,"fl-bit",6),p.Yb(5,"fl-text"),p.cc(6,7),p.Xb(),p.Xb(),p.Vb()),2&e){const e=p.rc(2);p.Gb(2),p.zc("size",e.TextSize.SMALL),p.Gb(4),p.gc(e.otherUser.displayName),p.dc(6)}}function us(e,t){if(1&e&&(p.Yb(0,"fl-text"),p.ic(1,9),p.Tb(2,"fl-link",10),p.fc(),p.Xb()),2&e){const e=p.rc(3);p.Gb(2),p.zc("link",e.MOBILE_APP_DOWNLOAD_LINK),p.gc(e.otherUser.displayName),p.dc(1)}}function bs(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-bit",3),p.Yb(2,"fl-text",4),p.cc(3,8),p.Xb(),p.Xb(),p.Yb(4,"fl-bit",6),p.Zc(5,us,3,2,"fl-text",2),p.Xb(),p.Vb()),2&e){const e=p.rc(2);p.Gb(2),p.zc("size",e.TextSize.SMALL),p.Gb(3),p.zc("ngIf",e.project.local)}}function fs(e,t){if(1&e&&(p.Wb(0),p.Zc(1,gs,7,2,"ng-container",2),p.Zc(2,bs,6,2,"ng-container",2),p.Vb()),2&e){const e=p.rc();p.Gb(1),p.zc("ngIf",!e.project.local),p.Gb(1),p.zc("ngIf",e.project.local)}}function ps(e,t){if(1&e&&(p.Yb(0,"fl-bit",3),p.Yb(1,"fl-text",4),p.cc(2,11),p.Xb(),p.Xb(),p.Yb(3,"fl-bit",6),p.Yb(4,"fl-text"),p.cc(5,12),p.Xb(),p.Xb()),2&e){const e=p.rc();p.Gb(1),p.zc("size",e.TextSize.SMALL),p.Gb(4),p.gc(e.otherUser.displayName),p.dc(5)}}let ms=(()=>{class e{constructor(){this.FontType=de.b,this.TextSize=de.f,this.MOBILE_APP_DOWNLOAD_LINK="https://bnc.lt/Ed5l/VcovUszaWr"}ngOnChanges(e){var t;("hourlyContracts"in e||"project"in e)&&(this.isHourlyProject=this.project.type===Te.ProjectTypeApi.HOURLY&&(null===(t=this.hourlyContracts)||void 0===t?void 0:t.some(e=>e.projectId===this.project.id)))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-overlay-template-milestone"]],inputs:{otherUser:"otherUser",project:"project",hourlyContracts:"hourlyContracts"},features:[p.Eb],decls:3,vars:2,consts:function(){let e,t,n,i,s,a;return e=" Track time to get paid ",t=" If " + "\ufffd0\ufffd" + " has enabled time tracking, simply track time with the Desktop App or from the Time Tracking tab to get paid. ",n=" Track location to get paid ",i=" For " + "\ufffd0\ufffd" + " to see your location, you need to use our " + "\ufffd#2\ufffd" + " mobile app " + "\ufffd/#2\ufffd" + " while on the job. ",s=" Only ask for payment to be released after you have completed work ",a=" Ask " + "\ufffd0\ufffd" + " to create milestone payments for work you agree to complete, and only ask for it to be released once you complete the task. ",[[4,"ngIf","ngIfElse"],["default",""],[4,"ngIf"],[1,"OnboardingOverlayTitle"],[3,"size"],e,[1,"OnboardingOverlayBody"],t,n,i,["flTrackingLabel","DownloadMobileAppLink",3,"link"],s,a]},template:function(e,t){if(1&e&&(p.Zc(0,fs,3,2,"ng-container",0),p.Zc(1,ps,6,2,"ng-template",null,1,p.ad)),2&e){const e=p.Mc(2);p.zc("ngIf",t.isHourlyProject)("ngIfElse",e)}},directives:[i.q,Ee.a,de.e,pe.b,ve.a],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();var Ms=n("4BSF");let Cs=(()=>{class e{constructor(e){this.siteName=e,this.FontType=de.b,this.TextSize=de.f}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ms.e))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-overlay-template-offsite"]],decls:6,vars:5,consts:function(){let e,t;return e=" Always communicate and make payments through " + "\ufffd0\ufffd" + " ",t=" Stay protected from scams and ensure you get paid by only communicating using the " + "[\ufffd0\ufffd|\ufffd1\ufffd]" + " chat system. Never make payments outside " + "[\ufffd0\ufffd|\ufffd1\ufffd]" + ". ",t=p.hc(t),[[1,"OnboardingOverlayTitle"],[3,"size"],e,[1,"OnboardingOverlayBody"],[3,"fontType"],t]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Yb(1,"fl-text",1),p.cc(2,2),p.Xb(),p.Xb(),p.Yb(3,"fl-bit",3),p.Yb(4,"fl-text",4),p.cc(5,5),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.zc("size",t.TextSize.SMALL),p.Gb(1),p.gc(t.siteName),p.dc(2),p.Gb(2),p.zc("fontType",t.FontType.SPAN),p.Gb(1),p.gc(t.siteName)(t.siteName),p.dc(5))},directives:[Ee.a,de.e],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();var Ss=n("L1P6"),Ts=n("J301");function xs(e,t){if(1&e&&p.Tb(0,"app-overlay-template-intro",11),2&e){const e=p.rc(3);p.zc("otherUser",e.otherMembers[0])("project",e.project)("thread",e.thread)}}function ys(e,t){1&e&&p.Tb(0,"app-overlay-template-offsite")}function Is(e,t){if(1&e&&p.Tb(0,"app-overlay-template-discuss",12),2&e){const e=p.rc(3);p.zc("otherUser",e.otherMembers[0])}}function Os(e,t){if(1&e&&p.Tb(0,"app-overlay-template-milestone",13),2&e){const e=p.rc(3);p.zc("hourlyContracts",e.hourlyContracts)("project",e.project)("otherUser",e.otherMembers[0])}}function As(e,t){if(1&e&&(p.Wb(0),p.Yb(1,"fl-bit",6),p.Zc(2,xs,1,3,"app-overlay-template-intro",7),p.Zc(3,ys,1,0,"app-overlay-template-offsite",8),p.Zc(4,Is,1,1,"app-overlay-template-discuss",9),p.Zc(5,Os,1,3,"app-overlay-template-milestone",10),p.Xb(),p.Vb()),2&e){const e=p.rc(2);p.Gb(1),p.zc("ngSwitch",e.currentStep),p.Gb(1),p.zc("ngSwitchCase",0),p.Gb(1),p.zc("ngSwitchCase",1),p.Gb(1),p.zc("ngSwitchCase",2),p.Gb(1),p.zc("ngSwitchCase",3)}}function vs(e,t){1&e&&p.Tb(0,"fl-spinner",14)}function ws(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",22),p.nc("click",function(){return p.Pc(e),p.rc(3).handleBackClicked()}),p.Tb(1,"fl-icon",23),p.Yb(2,"fl-text",24),p.cc(3,25),p.Xb(),p.Xb()}if(2&e){const e=p.rc(3);p.zc("size",e.ButtonSize.SMALL),p.Gb(1),p.zc("name","ui-chevron-left")("size",e.IconSize.XSMALL),p.Gb(1),p.zc("fontType",e.FontType.SPAN)}}function Es(e,t){if(1&e&&p.Tb(0,"fl-progress-bar",26),2&e){const e=p.rc(3);p.zc("progressPercentage",100*e.currentStep/(e.steps.length-1))}}function zs(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",27),p.nc("click",function(){return p.Pc(e),p.rc(3).handleNextClicked()}),p.Yb(1,"fl-text",24),p.cc(2,28),p.Xb(),p.Tb(3,"fl-icon",23),p.Xb()}if(2&e){const e=p.rc(3);p.zc("size",e.ButtonSize.MINI),p.Gb(1),p.zc("fontType",e.FontType.SPAN),p.Gb(2),p.zc("name","ui-chevron-right")("size",e.IconSize.XSMALL)}}function Ls(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",29),p.nc("click",function(){return p.Pc(e),p.rc(3).handleEndClicked()}),p.cc(1,30),p.Xb()}if(2&e){const e=p.rc(3);p.zc("color",e.ButtonColor.DEFAULT)("size",e.ButtonSize.MINI)}}function ks(e,t){if(1&e&&(p.Yb(0,"fl-bit",15),p.Yb(1,"fl-bit",16),p.Zc(2,ws,4,4,"fl-button",17),p.Xb(),p.Zc(3,Es,1,1,"fl-progress-bar",18),p.Yb(4,"fl-bit",19),p.Zc(5,zs,4,4,"fl-button",20),p.Zc(6,Ls,2,2,"fl-button",21),p.Xb(),p.Xb()),2&e){const e=p.rc(2);p.zc("flMarginBottom",e.Margin.LARGE),p.Gb(2),p.zc("ngIf",!e.isAtStart()),p.Gb(1),p.zc("ngIf",void 0!==e.currentStep),p.Gb(2),p.zc("ngIf",!e.isAtEnd()),p.Gb(1),p.zc("ngIf",e.isAtEnd())}}function Ps(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-bit",31),p.Yb(1,"fl-button",32),p.nc("click",function(){return p.Pc(e),p.rc(2).handleEndClicked()}),p.cc(2,33),p.Xb(),p.Xb()}if(2&e){const e=p.rc(2);p.zc("flMarginBottom",e.Margin.LARGE),p.Gb(1),p.zc("color",e.ButtonColor.SECONDARY)("size",e.ButtonSize.SMALL)}}function _s(e,t){if(1&e&&(p.Yb(0,"fl-bit",1),p.Zc(1,As,6,5,"ng-container",2),p.Zc(2,vs,1,0,"ng-template",null,3,p.ad),p.Zc(4,ks,7,5,"fl-bit",4),p.sc(5,"flAsync"),p.Zc(6,Ps,3,3,"fl-bit",5),p.sc(7,"flAsync"),p.Xb()),2&e){const e=p.Mc(3),t=p.rc();p.Gb(1),p.zc("ngIf",(null==t.otherMembers?null:t.otherMembers.length)>0)("ngIfElse",e),p.Gb(3),p.zc("ngIf",p.tc(5,4,t.showFullFlow$)),p.Gb(2),p.zc("ngIf",!1===p.tc(7,6,t.showFullFlow$))}}let Rs=(()=>{class e{constructor(e,t){this.localStorage=e,this.changeDetectorRef=t,this.Margin=me.a,this.ButtonColor=fe.a,this.ButtonSize=be.a,this.IconSize=le.e,this.FontType=de.b,this.closeOverlay=new p.n,this.steps=[hs,Cs,rs,ms]}ngOnInit(){this.showFullFlow$=this.localStorage.get("projectOverlayFullFlowComplete").pipe(Object(I.a)(e=>!0!==e)),this.showFullFlow$.pipe(Object(os.a)(1)).toPromise().then(e=>{this.currentStep=e?0:Math.floor(Math.random()*(this.steps.length-1)+1),this.changeDetectorRef.markForCheck()})}handleBackClicked(){void 0===this.currentStep||this.isAtStart()||(this.currentStep--,this.changeDetectorRef.markForCheck())}handleNextClicked(){void 0===this.currentStep||this.isAtEnd()||(this.currentStep++,this.changeDetectorRef.markForCheck())}handleEndClicked(){return Object(T.a)(this,void 0,void 0,function*(){const e=yield this.localStorage.get("projectOverlayThreadComplete").pipe(Object(os.a)(1)).toPromise(),t=Object.assign(Object.assign({},e),{[this.thread.id]:!0});yield this.localStorage.set("projectOverlayThreadComplete",t),yield this.localStorage.set("projectOverlayFullFlowComplete",!0),this.closeOverlay.emit()})}isAtStart(){return void 0!==this.currentStep&&0===this.currentStep}isAtEnd(){return void 0!==this.currentStep&&this.currentStep>=this.steps.length-1}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(Ss.a),p.Sb(p.h))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-onboarding-overlay"]],inputs:{otherMembers:"otherMembers",project:"project",thread:"thread",hourlyContracts:"hourlyContracts"},outputs:{closeOverlay:"closeOverlay"},decls:1,vars:1,consts:function(){let e,t,n,i,s;return e="Onboarding progress",t=" Back ",n=" Next ",i=" Chat ",s=" Start Chatting ",[["class","OnboardingOverlay",4,"ngIf"],[1,"OnboardingOverlay"],[4,"ngIf","ngIfElse"],["spinner",""],["class","Footer","flTrackingSection","FullFlow",3,"flMarginBottom",4,"ngIf"],["class","Footer Footer--nonFullFlow","flTrackingSection","OneStepOnly",3,"flMarginBottom",4,"ngIf"],[3,"ngSwitch"],[3,"otherUser","project","thread",4,"ngSwitchCase"],[4,"ngSwitchCase"],[3,"otherUser",4,"ngSwitchCase"],[3,"hourlyContracts","project","otherUser",4,"ngSwitchCase"],[3,"otherUser","project","thread"],[3,"otherUser"],[3,"hourlyContracts","project","otherUser"],["flTrackingLabel","ChatboxUserLoadingSpinner"],["flTrackingSection","FullFlow",1,"Footer",3,"flMarginBottom"],[1,"LeftButton"],["flTrackingLabel","previousStep",3,"size","click",4,"ngIf"],["class","Progress","label",e,3,"progressPercentage",4,"ngIf"],[1,"RightButton"],["flTrackingLabel","nextStep",3,"size","click",4,"ngIf"],["flTrackingLabel","nextStep",3,"color","size","click",4,"ngIf"],["flTrackingLabel","previousStep",3,"size","click"],[3,"name","size"],[3,"fontType"],t,["label",e,1,"Progress",3,"progressPercentage"],["flTrackingLabel","nextStep",3,"size","click"],n,["flTrackingLabel","nextStep",3,"color","size","click"],i,["flTrackingSection","OneStepOnly",1,"Footer","Footer--nonFullFlow",3,"flMarginBottom"],["flTrackingLabel","dismissOneStep",3,"color","size","click"],s]},template:function(e,t){1&e&&p.Zc(0,_s,8,8,"fl-bit",0),2&e&&p.zc("ngIf",t.steps&&void 0!==t.currentStep&&t.currentStep<t.steps.length)},directives:[i.q,Ee.a,i.s,i.t,hs,Cs,rs,ms,Sn.c,Pe.a,ve.a,gn.a,me.b,fe.b,le.d,de.e,Ts.a],pipes:[_e.a],styles:[".OnboardingOverlay[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;padding:16px;position:absolute;width:100%;word-wrap:break-word}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]{align-items:center;display:flex;margin-top:auto}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .LeftButton[_ngcontent-%COMP%]{min-width:64px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .RightButton[_ngcontent-%COMP%]{min-width:64px;padding-left:4px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer[_ngcontent-%COMP%]   .Progress[_ngcontent-%COMP%]{margin-left:auto;margin-right:auto;width:72px}.OnboardingOverlay[_ngcontent-%COMP%]   .Footer--nonFullFlow[_ngcontent-%COMP%]{justify-content:center}.OnboardingOverlayTitle[_ngcontent-%COMP%]{padding-top:12px;text-align:center}.OnboardingOverlayBody[_ngcontent-%COMP%]{padding-top:24px;text-align:center}"],changeDetection:0}),e})();var js=n("LU0i"),Us=n("h5VB"),Bs=n("+qCR"),$s=n("vwlU");function Gs(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-overlay-controls-item"),p.Yb(1,"fl-button",5),p.nc("click",function(){return p.Pc(e),p.rc().handleShowManagementView()}),p.cc(2,6),p.Xb(),p.Xb()}if(2&e){const e=p.rc();p.Gb(1),p.zc("color",e.ButtonColor.SECONDARY)}}let Fs=(()=>{class e{constructor(){this.ButtonColor=fe.a,this.IconColor=le.c,this.IconSize=le.e,this.HoverColor=le.a,this.showManagementView=new p.n,this.closeView=new p.n,this.userRemoval=new p.n}handleCloseView(){this.closeView.emit()}handleShowManagementView(){this.showManagementView.emit()}handleRemove(e){this.userRemoval.emit(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-participants-view"]],inputs:{participants:"participants",onlineOfflineStatuses$:"onlineOfflineStatuses$",isThreadOwner:"isThreadOwner",candidatesExist:"candidatesExist",isRecruiter:"isRecruiter",currentUser:"currentUser",thread:"thread",team:"team",showAddPeopleOption:"showAddPeopleOption"},outputs:{showManagementView:"showManagementView",closeView:"closeView",userRemoval:"userRemoval"},decls:9,vars:10,consts:function(){let e,t,n;return e=" People in Chat ",t=" Back ",n=" Add People ",[e,[3,"participants","onlineOfflineStatuses$","currentUser","isRecruiter","isThreadOwner","candidatesExist","thread","team","userRemoval"],["display","block","flTrackingLabel","CloseParticipantsView",3,"color","click"],t,[4,"ngIf"],["display","block","flTrackingLabel","AddPeopleToGroupChat",3,"color","click"],n]},template:function(e,t){1&e&&(p.Yb(0,"app-overlay-header"),p.cc(1,0),p.Xb(),p.Yb(2,"app-overlay-content"),p.Yb(3,"app-participants-view-content",1),p.nc("userRemoval",function(e){return t.handleRemove(e)}),p.Xb(),p.Xb(),p.Yb(4,"app-overlay-controls"),p.Yb(5,"app-overlay-controls-item"),p.Yb(6,"fl-button",2),p.nc("click",function(){return t.handleCloseView()}),p.cc(7,3),p.Xb(),p.Xb(),p.Zc(8,Gs,3,1,"app-overlay-controls-item",4),p.Xb()),2&e&&(p.Gb(3),p.zc("participants",t.participants)("onlineOfflineStatuses$",t.onlineOfflineStatuses$)("currentUser",t.currentUser)("isRecruiter",t.isRecruiter)("isThreadOwner",t.isThreadOwner)("candidatesExist",t.candidatesExist)("thread",t.thread)("team",t.team),p.Gb(3),p.zc("color",t.ButtonColor.DEFAULT),p.Gb(2),p.zc("ngIf",t.showAddPeopleOption))},directives:[js.a,Us.a,Pi,Bs.a,$s.a,fe.b,ve.a,i.q],styles:["[_nghost-%COMP%]{display:flex;flex:1 1 100%;flex-direction:column}"],changeDetection:0}),e})(),Ds=(()=>{class e{constructor(){this.ButtonColor=fe.a,this.confirm=new p.n,this.cancel=new p.n}handleBackButton(){this.cancel.emit()}handleConfirmButton(){this.confirm.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-confirm-user-removal-view"]],inputs:{user:"user"},outputs:{confirm:"confirm",cancel:"cancel"},decls:9,vars:3,consts:function(){let e,t,n;return e=" Are you sure you want to remove " + "\ufffd0\ufffd" + " from this chat? ",t=" Back ",n=" Remove ",[e,["display","block","flTrackingLabel","UserRemovalBackButton",3,"color","click"],t,["display","block","flTrackingLabel","UserRemovalConfirmButton",3,"color","click"],n]},template:function(e,t){1&e&&(p.Yb(0,"app-overlay-content"),p.cc(1,0),p.Xb(),p.Yb(2,"app-overlay-controls"),p.Yb(3,"app-overlay-controls-item"),p.Yb(4,"fl-button",1),p.nc("click",function(){return t.handleBackButton()}),p.cc(5,2),p.Xb(),p.Xb(),p.Yb(6,"app-overlay-controls-item"),p.Yb(7,"fl-button",3),p.nc("click",function(){return t.handleConfirmButton()}),p.cc(8,4),p.Xb(),p.Xb(),p.Xb()),2&e&&(p.Gb(1),p.gc(t.user.displayName),p.dc(1),p.Gb(3),p.zc("color",t.ButtonColor.DEFAULT),p.Gb(3),p.zc("color",t.ButtonColor.DANGER))},directives:[Us.a,Bs.a,$s.a,fe.b,ve.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"],changeDetection:0}),e})(),Ns=(()=>{class e{constructor(){this.ButtonColor=fe.a,this.confirm=new p.n,this.cancel=new p.n}handleBackButton(){this.cancel.emit()}handleConfirmButton(){this.confirm.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-confirm-user-leave-view"]],outputs:{confirm:"confirm",cancel:"cancel"},decls:9,vars:2,consts:function(){let e,t,n;return e=" Are you sure you want to leave this chat? ",t=" Back ",n=" Leave ",[e,["display","block","flTrackingLabel","UserLeaveBackButton",3,"color","click"],t,["display","block","flTrackingLabel","UserLeaveConfirmButton",3,"color","click"],n]},template:function(e,t){1&e&&(p.Yb(0,"app-overlay-content"),p.cc(1,0),p.Xb(),p.Yb(2,"app-overlay-controls"),p.Yb(3,"app-overlay-controls-item"),p.Yb(4,"fl-button",1),p.nc("click",function(){return t.handleBackButton()}),p.cc(5,2),p.Xb(),p.Xb(),p.Yb(6,"app-overlay-controls-item"),p.Yb(7,"fl-button",3),p.nc("click",function(){return t.handleConfirmButton()}),p.cc(8,4),p.Xb(),p.Xb(),p.Xb()),2&e&&(p.Gb(4),p.zc("color",t.ButtonColor.DEFAULT),p.Gb(3),p.zc("color",t.ButtonColor.DANGER))},directives:[Us.a,Bs.a,$s.a,fe.b,ve.a],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}"],changeDetection:0}),e})();var Xs=n("Eg4/");function Ys(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-participants-view",5),p.nc("showManagementView",function(){return p.Pc(e),p.rc().setViewState("management")})("closeView",function(){return p.Pc(e),p.rc().handleCloseGroupchatOverlay()})("userRemoval",function(t){return p.Pc(e),p.rc().handleUserRemovalTrigger(t)}),p.Xb()}if(2&e){const e=p.rc();p.zc("participants",e.participants)("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("currentUser",e.currentUser)("isThreadOwner",e.isThreadOwner)("isRecruiter",e.isRecruiter)("candidatesExist",e.candidatesExist)("thread",e.thread)("team",e.team)("showAddPeopleOption",e.showAddPeopleOption)}}function Hs(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-confirm-user-removal-view",6),p.nc("confirm",function(){return p.Pc(e),p.rc().handleUserRemovalConfirm()})("cancel",function(){return p.Pc(e),p.rc().handleUserRemovalCancel()}),p.Xb()}if(2&e){const e=p.rc();p.zc("user",e.userToRemove)}}function Vs(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-confirm-user-leave-view",7),p.nc("confirm",function(){return p.Pc(e),p.rc().handleUserRemovalConfirm()})("cancel",function(){return p.Pc(e),p.rc().handleUserRemovalCancel()}),p.Xb()}}function Zs(e,t){if(1&e){const e=p.Zb();p.Yb(0,"app-management-view",8),p.nc("addUsers",function(t){return p.Pc(e),p.rc().handleManagementAddUsers(t)})("closeView",function(){return p.Pc(e),p.rc().setViewState("participant")}),p.Xb()}if(2&e){const e=p.rc();p.zc("candidateBidders",e.candidateBidders)("candidateContacts",e.candidateContacts)("candidateCollaborators",e.candidateCollaborators)("isRecruiter",e.isRecruiter)("thread",e.thread)("team",e.team)}}let Ws=(()=>{class e{constructor(){this.hideGroupchatOverlay=new p.n,this.modifyMembers=new p.n,this.currentViewState="participant"}setViewState(e){this.currentViewState=e}handleCloseGroupchatOverlay(){this.hideGroupchatOverlay.emit()}handleManagementAddUsers(e){this.modifyMembers.emit({action:"add",userIds:e}),this.hideGroupchatOverlay.emit()}handleUserRemovalTrigger(e){this.userToRemove=e,this.currentViewState=e.id===this.currentUser.id?"userLeave":"userRemoval"}handleUserRemovalConfirm(){this.userToRemove&&this.modifyMembers.emit({action:"remove",userIds:[this.userToRemove.id]}),this.userToRemove=void 0,this.currentViewState="participant"}handleUserRemovalCancel(){this.userToRemove=void 0,this.currentViewState="participant"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-groupchat-overlay"]],inputs:{participants:"participants",currentUser:"currentUser",isThreadOwner:"isThreadOwner",isRecruiter:"isRecruiter",candidatesExist:"candidatesExist",candidateBidders:"candidateBidders",candidateContacts:"candidateContacts",candidateCollaborators:"candidateCollaborators",onlineOfflineStatuses$:"onlineOfflineStatuses$",thread:"thread",team:"team",showAddPeopleOption:"showAddPeopleOption"},outputs:{hideGroupchatOverlay:"hideGroupchatOverlay",modifyMembers:"modifyMembers"},decls:5,vars:5,consts:[[3,"ngSwitch"],[3,"participants","onlineOfflineStatuses$","currentUser","isThreadOwner","isRecruiter","candidatesExist","thread","team","showAddPeopleOption","showManagementView","closeView","userRemoval",4,"ngSwitchCase"],[3,"user","confirm","cancel",4,"ngSwitchCase"],[3,"confirm","cancel",4,"ngSwitchCase"],[3,"candidateBidders","candidateContacts","candidateCollaborators","isRecruiter","thread","team","addUsers","closeView",4,"ngSwitchCase"],[3,"participants","onlineOfflineStatuses$","currentUser","isThreadOwner","isRecruiter","candidatesExist","thread","team","showAddPeopleOption","showManagementView","closeView","userRemoval"],[3,"user","confirm","cancel"],[3,"confirm","cancel"],[3,"candidateBidders","candidateContacts","candidateCollaborators","isRecruiter","thread","team","addUsers","closeView"]],template:function(e,t){1&e&&(p.Wb(0,0),p.Zc(1,Ys,1,9,"app-participants-view",1),p.Zc(2,Hs,1,1,"app-confirm-user-removal-view",2),p.Zc(3,Vs,1,0,"app-confirm-user-leave-view",3),p.Zc(4,Zs,1,6,"app-management-view",4),p.Vb()),2&e&&(p.zc("ngSwitch",t.currentViewState),p.Gb(1),p.zc("ngSwitchCase","participant"),p.Gb(1),p.zc("ngSwitchCase","userRemoval"),p.Gb(1),p.zc("ngSwitchCase","userLeave"),p.Gb(1),p.zc("ngSwitchCase","management"))},directives:[i.s,i.t,Fs,Ds,Ns,Xs.a],styles:["[_nghost-%COMP%]{background-color:#fff;display:flex;flex:1 1 100%;flex-direction:column;height:100%;padding:8px;width:100%}"],changeDetection:0}),e})();function qs(e,t){if(1&e){const e=p.Zb();p.Wb(0),p.Yb(1,"app-overlay-controls"),p.Yb(2,"app-overlay-controls-item"),p.Yb(3,"fl-button",3),p.nc("click",function(){return p.Pc(e),p.rc().handleCloseView()}),p.cc(4,4),p.Xb(),p.Xb(),p.Xb(),p.Vb()}if(2&e){const e=p.rc();p.Gb(3),p.zc("color",e.ButtonColor.DEFAULT)}}n("LaQp"),n("7Qkd"),n("DIEf");let Qs=(()=>{class e{constructor(){this.ButtonColor=fe.a,this.ButtonSize=be.a,this.showReportCta=!1,this.showControls=!0,this.hideSettingsOverlay=new p.n,this.archiveChatToggle=new p.n,this.muteChatToggle=new p.n,this.blockChatToggle=new p.n}handleCloseView(){this.hideSettingsOverlay.emit()}handleArchiveToggle(){this.archiveChatToggle.emit(!0)}handleMuteToggle(){this.muteChatToggle.emit(!0)}handleBlockToggle(){this.blockChatToggle.emit(!0)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=p.Mb({type:e,selectors:[["app-settings-overlay"]],inputs:{showReportCta:"showReportCta",thread:"thread",showControls:"showControls"},outputs:{hideSettingsOverlay:"hideSettingsOverlay",archiveChatToggle:"archiveChatToggle",muteChatToggle:"muteChatToggle",blockChatToggle:"blockChatToggle"},decls:5,vars:3,consts:function(){let e,t;return e=" Settings ",t=" Back ",[e,[3,"showReportCta","thread","archiveChatToggle","muteChatToggle","blockChatToggle"],[4,"ngIf"],["display","block","flTrackingLabel","CloseSettings",3,"color","click"],t]},template:function(e,t){1&e&&(p.Yb(0,"app-overlay-header"),p.cc(1,0),p.Xb(),p.Yb(2,"app-overlay-content"),p.Yb(3,"app-settings-overlay-content",1),p.nc("archiveChatToggle",function(){return t.handleArchiveToggle()})("muteChatToggle",function(){return t.handleMuteToggle()})("blockChatToggle",function(){return t.handleBlockToggle()}),p.Xb(),p.Xb(),p.Zc(4,qs,5,1,"ng-container",2)),2&e&&(p.Gb(3),p.zc("showReportCta",t.showReportCta)("thread",t.thread),p.Gb(1),p.zc("ngIf",t.showControls))},directives:[js.a,Us.a,Xi,i.q,Bs.a,$s.a,fe.b,ve.a],styles:["[_nghost-%COMP%]{background-color:#fff;display:flex;flex:1 1 100%;flex-direction:column;height:100%;padding:8px;width:100%}.SettingButtons[_ngcontent-%COMP%], .SettingTitle[_ngcontent-%COMP%]{display:flex;flex-direction:column}.SettingTitle[_ngcontent-%COMP%]{justify-content:space-between}"],changeDetection:0}),e})();var Ks=n("Uw4d"),Js=n("cWjy");let ea=(()=>{class e{constructor(e,t){this.element=e,this.focusService=t,this.MAX_HEIGHT=72,this.MIN_HEIGHT=32}onInput(e){this.adjust()}adjust(){const{nativeElement:e}=this.element;e.style.overflow="hidden",e.style.height="auto",e.style.overflowY="auto",e.style.height=`${Math.max(this.MIN_HEIGHT,Math.min(e.scrollHeight,this.MAX_HEIGHT))}px`,e.scrollHeight<this.MAX_HEIGHT&&(e.style.overflow="hidden")}focus(){this.focusService.focusElement(this.element)}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(p.l),p.Sb(Js.a))},e.\u0275dir=p.Nb({type:e,selectors:[["","appAutoGrow",""]],hostBindings:function(e,t){1&e&&p.nc("input",function(e){return t.onInput(e.target)})},exportAs:["autogrow"]}),e})();var ta=n("BFOf"),na=n("YFxV"),ia=n("nSbf"),sa=n("tbJ/");const aa=["textarea"];function oa(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-file-select",6),p.nc("onFileDropped",function(t){return p.Pc(e),p.rc().onFileSelected(t)}),p.Xb()}if(2&e){const e=p.rc();p.zc("flMarginRight",e.isChatBoxMode?e.Margin.NONE:e.Margin.XXSMALL)("multiple",!0)("fileSelectMode",e.FileSelectMode.ICON)("active",!e.thread.isBlocked)}}function ra(e,t){if(1&e){const e=p.Zb();p.Yb(0,"fl-button",7),p.nc("mousedown",function(t){return p.Pc(e),p.rc().keepTextareaFocused(t)})("click",function(){return p.Pc(e),p.rc().handleSendMessage()}),p.cc(1,8),p.Xb()}if(2&e){const e=p.rc();p.zc("size",e.ButtonSize.SMALL)("color",e.ButtonColor.SECONDARY)("disabled",!e.textValue&&!e.hasAttachments)}}const ca=function(e){return{"TypingBox-inboxChatContainer":e}};let la=(()=>{class e{constructor(e,t,n){this.changeDetectorRef=e,this.localStorage=t,this.timeUtils=n,this.ButtonColor=fe.a,this.ButtonSize=be.a,this.FileSelectMode=ta.b,this.Feature=ue.b,this.Margin=me.a,this.isChatBoxMode=!1,this.sendMessage=new p.n,this.typingEvent=new p.n,this.focusTypingBox=new p.n,this.addAttachment=new p.n,this.textValue=""}ngOnInit(){this.loadDraftMessage(this.threadIdentifierKey),this.timeUtils.setTimeout(()=>this.element.adjust(),0)}ngOnChanges(e){e.threadIdentifierKey&&this.loadDraftMessage(this.threadIdentifierKey)}keepTextareaFocused(e){e.preventDefault()}handleSendMessage(){this.sendMessage.emit(this.textValue),this.textValue="",this.typingEvent.emit(this.textValue),this.timeUtils.setTimeout(()=>this.element.adjust(),0)}handleKeyDownEvent(e){if((e.key&&"enter"===e.key.toLowerCase()||13===(e.which||e.keyCode||e.charCode))&&!e.shiftKey)return this.handleSendMessage(),!1}handleKeyUpEvent(e){this.typingEvent.emit(this.textValue)}focus(){this.element.focus()}handlePasteEvent(e){if(this.thread.isFake||!e.clipboardData)return;const{clipboardData:{items:t=[]}}=e;Array.from(t).some(e=>{if("file"===e.kind){const t=e.getAsFile();if(t){const n=e.type.split("/")[1],i=new File([t],`image.${n}`);this.addAttachment.emit(i)}return!0}return!1})}handleEmojiPicked(e){const t=this.element.element.nativeElement;if(this.textValue){if(t instanceof HTMLTextAreaElement){const n=t.selectionStart,i=t.selectionEnd,s=`${0===n||/\s/.test(this.textValue[n-1])?"":" "}${e}${i===this.textValue.length||/\s/.test(this.textValue[i])?"":" "}`;this.textValue=`${this.textValue.substring(0,n)}${s}${this.textValue.substring(i)}`,this.timeUtils.setTimeout(()=>{const e=n+s.length;t.setSelectionRange(e,e),this.element.adjust()})}}else this.textValue=e;this.typingEvent.emit(this.textValue)}onFileSelected(e){this.addAttachment.emit(e),this.focusTypingBox.emit(this.thread.id)}loadDraftMessage(e){this.localStorage.get("webappChatDraftMessages").pipe(Object(os.a)(1)).toPromise().then((t={})=>{if(e){const n=t[e];this.textValue=n?n.text:""}this.changeDetectorRef.markForCheck()})}}return e.\u0275fac=function(t){return new(t||e)(p.Sb(p.h),p.Sb(Ss.a),p.Sb(na.a))},e.\u0275cmp=p.Mb({type:e,selectors:[["app-typing-box"]],viewQuery:function(e,t){if(1&e&&p.id(aa,1),2&e){let e;p.Lc(e=p.oc())&&(t.element=e.first)}},inputs:{isChatBoxMode:"isChatBoxMode",hasAttachments:"hasAttachments",thread:"thread",threadIdentifierKey:"threadIdentifierKey"},outputs:{sendMessage:"sendMessage",typingEvent:"typingEvent",focusTypingBox:"focusTypingBox",addAttachment:"addAttachment"},features:[p.Eb],decls:6,vars:8,consts:function(){let e,t;return e="Enter your message...",t=" Send ",[[1,"TypingBox",3,"ngClass"],["appAutoGrow","","flTrackingLabel","TypingBox","placeholder",e,"rows","1","data-uitest-target","chatbox-input-field","maxlength","15000",1,"TextArea",3,"ngModel","ngModelChange","keydown","keyup","paste"],["textarea","autogrow"],[1,"TrayItem",3,"disabled","flMarginRight","mousedown","emojiPicked"],["class","TrayItem","flTrackingLabel","fileAttachment",3,"flMarginRight","multiple","fileSelectMode","active","onFileDropped",4,"flFeature"],["flTrackingLabel","SendMessageLink",3,"size","color","disabled","mousedown","click",4,"ngIf"],["flTrackingLabel","fileAttachment",1,"TrayItem",3,"flMarginRight","multiple","fileSelectMode","active","onFileDropped"],["flTrackingLabel","SendMessageLink",3,"size","color","disabled","mousedown","click"],t]},template:function(e,t){1&e&&(p.Yb(0,"fl-bit",0),p.Yb(1,"textarea",1,2),p.nc("ngModelChange",function(e){return t.textValue=e})("keydown",function(e){return t.handleKeyDownEvent(e)})("keyup",function(e){return t.handleKeyUpEvent(e)})("paste",function(e){return t.handlePasteEvent(e)}),p.Xb(),p.Yb(3,"fl-emoji-picker",3),p.nc("mousedown",function(e){return t.keepTextareaFocused(e)})("emojiPicked",function(e){return t.handleEmojiPicked(e)}),p.Xb(),p.Zc(4,oa,1,4,"fl-file-select",4),p.Zc(5,ra,2,3,"fl-button",5),p.Xb()),2&e&&(p.zc("ngClass",p.Ec(6,ca,!t.isChatBoxMode)),p.Gb(1),p.zc("ngModel",t.textValue),p.Gb(2),p.zc("disabled",t.thread&&!t.thread.isFake&&"none"===t.thread.writePrivacy)("flMarginRight",t.isChatBoxMode?t.Margin.NONE:t.Margin.XXSMALL),p.Gb(1),p.zc("flFeature",t.Feature.FILEUPLOAD),p.Gb(1),p.zc("ngIf",!t.isChatBoxMode))},directives:[Ee.a,i.o,s.c,ea,ve.a,s.k,s.o,s.r,ia.a,me.b,sa.a,i.q,ta.a,fe.b],styles:[".TypingBox[_ngcontent-%COMP%]{padding-bottom:env(safe-area-inset-bottom);align-items:center;border-top:1px solid #dedede;display:flex;justify-content:space-between;width:100%}.TypingBox-inboxChatContainer[_ngcontent-%COMP%]{padding:8px}@supports (padding:max(0px)){.TypingBox-inboxChatContainer[_ngcontent-%COMP%]{padding-bottom:max(8px,env(safe-area-inset-bottom))}}.TextArea[_ngcontent-%COMP%]{font-size:14px;line-height:1.43;background-color:transparent;border:0;border-radius:0;display:block;height:36px;margin:0;overflow-y:auto;padding:8px;resize:none;width:100%}.TextArea[_ngcontent-%COMP%]:-ms-input-placeholder{color:#4d525b;font-weight:400}.TextArea[_ngcontent-%COMP%]::placeholder{color:#4d525b;font-weight:400}.TextArea[_ngcontent-%COMP%]:focus, .TextArea[_ngcontent-%COMP%]:hover{box-shadow:none;outline:none}.TrayItem[_ngcontent-%COMP%]{padding-right:4px}"],changeDetection:0}),e})();var da=n("2zwU"),ha=n("7v0r"),ga=n("3bYl");let ua=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=p.Qb({type:e}),e.\u0275inj=p.Pb({imports:[[s.j,i.c,ne.a,Ks.a,te.a,ne.a,se.b,a.a,ee.a,o.a,m,M.a,P,_.a,R.a,j.a,U.a,B.a,$.a,G.a,F.a,D.a,H,V.a,Z.a,W.a,q.a,Q.a,K.a,J.a,ie.a,oe.a,ae.a]]}),e})();p.Tc(Pt.a,[Ee.a,gn.a,i.q,en,xt,ze.a,ta.a,Mt,Ci,i.o,kt,i.s,i.t,Rt,i.u,pe.b,ve.a,la,me.b,da.b,ha.a,Rs,Ws,Qs,as,ga.a],[_e.a])},ZotQ:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(e){return e.ASSIGN="assign",e.REASSIGN="reassign",e.RESOLVE="resolve",e.AVAILABILITY="availability",e.ENQUEUE="enqueue",e.NO_AGENTS_AVAILABLE="no_agents_available",e}({})},b6KT:function(e,t,n){"use strict";n.d(t,"h",function(){return d}),n.d(t,"e",function(){return h}),n.d(t,"b",function(){return g}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return b}),n.d(t,"a",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"c",function(){return m});var i=n("OpNG"),s=n("etQe"),a=n("fYbj"),o=n("f6cb"),r=n("tsv4"),c=n("lJxs"),l=n("pLZG");const d=(e,t)=>{if(void 0===e||void 0===t)return!1;if(e.id===t.id)return!0;const n=e.context.type!==r.ContextTypeApi.NONE&&t.context.type!==r.ContextTypeApi.NONE&&e.context.type===t.context.type&&e.context.id===t.context.id||e.context.type===r.ContextTypeApi.NONE&&t.context.type===r.ContextTypeApi.NONE,i=e.threadType===t.threadType,s=new Set(t.members),a=e.members.every(e=>s.has(e))&&e.members.length===t.members.length;return n&&i&&a};function h(e,t){return void 0!==e&&void 0!==t&&e.message===t.message&&e.messageId===t.messageId&&e.threadId===t.threadId&&e.timeCreated===t.timeCreated&&Object(a.h)(e.attachments,t.attachments)}function g(e,t="",n){const i=Date.now(),a={attachments:[],clientMessageId:i,fromUser:n,id:i,message:t,messageSource:r.SourceTypeApi.CHAT_BOX,threadId:e.id,timeCreated:Date.now(),sendStatus:s.a.SENDING};return Object.assign(Object.assign({},e),{message:a,isFake:!1})}function u(e){return!!(e&&e.supportStatus&&e.supportStatus.type)}function b(e,t){const n=e.reduce((e,n)=>n.context.type===t&&n.context.id?[...e,n.context.id.toString()]:e,[]);return Array.from(new Set(n))}function f(e){return{id:e.id,threadType:e.threadType,context:e.context,members:e.members,isFake:e.isFake}}function p(e){return Object(o.o)(e)||""}function m(e,t){return e.pipe(Object(c.a)(e=>{const{context:n,threadType:s}=t.threadIdentifier;if(n.type===r.ContextTypeApi.TEAM&&n.id&&e[n.id])return e[n.id];if(n.type===r.ContextTypeApi.PROJECT&&s===r.ThreadTypeApi.TEAM){const n=Object(i.i)(Object.values(e),e=>e.ownerUserId),s=Object.keys(n).find(e=>t.threadIdentifier.members.includes(Object(o.s)(e)));if(s)return n[Object(o.s)(s)]}}),Object(l.a)(o.h))}},cFvg:function(e,t,n){"use strict";function i(e,t){const n=t[e.session_id];if(void 0===n)throw new Error("Agent sessions should always have an associated session.");return Object.assign(Object.assign({},a(e)),function(e){return{sessionId:e.id,sessionType:e.support_type,sessionOwnerId:e.user_id,sessionCreateTime:1e3*e.create_time,sessionSourceType:e.source.type,sessionSourceId:e.source.id}}(n))}function s(e,t){return Object.assign(Object.assign({},t),a(e))}function a(e){return{id:e.id,type:e.support_type,state:e.state,latest:e.is_latest,createTime:1e3*e.create_time,resolvedTime:e.resolved_time?1e3*e.resolved_time:void 0,resolvedReason:e.resolved_reason||void 0,agentId:e.agent_id||void 0,starred:e.is_starred?e.is_starred:void 0}}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s})},g6qU:function(e,t,n){"use strict";n.d(t,"a",function(){return I});var i=n("B23V"),s=n("dO68"),a=n("4ykm"),o=n("cs8y"),r=n("ueDg"),c=n("MmDv"),l=n("8Y7J"),d=n("eCtd"),h=n("3A0Z"),g=n("iInd"),u=n("565b"),b=n("DSso"),f=n("SVse");function p(e,t){1&e&&(l.Wb(0),l.cc(1,2),l.Vb())}function m(e,t){1&e&&(l.Wb(0),l.cc(1,3),l.Vb())}function M(e,t){1&e&&(l.Wb(0),l.cc(1,4),l.Vb())}function C(e,t){1&e&&(l.Wb(0),l.cc(1,5),l.Vb())}function S(e,t){1&e&&(l.Wb(0),l.cc(1,6),l.Vb())}function T(e,t){1&e&&(l.Wb(0),l.cc(1,7),l.Vb())}function x(e,t){1&e&&(l.Wb(0),l.cc(1,8),l.Vb())}function y(e,t){1&e&&(l.Wb(0),l.cc(1,9),l.Vb())}let I=(()=>{class e{constructor(e,t,n,a){this.changeDetectorRef=e,this.datastore=t,this.modalService=n,this.router=a,this.ButtonColor=i.a,this.ButtonSize=s.a,this.NON_CTA_CONTEXT_BOX_STATE_NAME=c.a,this.buttonBusy=!1,this.buttonColor=i.a.SECONDARY,this.greenButtonStates=["projectAcceptHourly","projectAcceptFixed","projectAcceptRedirect","projectAwardHourly","projectAwardFixed"]}ngOnChanges(e){var t,n,s;if(e.contextBoxState&&this.contextBoxState)if(this.buttonColor=this.greenButtonStates.includes(this.contextBoxState.name)?i.a.SUCCESS:i.a.SECONDARY,null===(t=this.contextBoxState)||void 0===t?void 0:t.button)switch(this.contextBoxState.button.data.type){case"LINK":this.contextButtonUrl=this.contextBoxState.button.data.buttonUrl,this.contextButtonUrlQueryParams=null===(n=this.contextBoxState.button.data.buttonExtras)||void 0===n?void 0:n.queryParams,this.contextButtonUrlFragment=null===(s=this.contextBoxState.button.data.buttonExtras)||void 0===s?void 0:s.fragment;break;case"REQUEST_MILESTONE":this.contextButtonUrl=`/projects/${this.contextBoxState.button.data.projectId}/payments`,this.contextButtonUrlQueryParams={request_milestone:1},this.contextButtonUrlFragment=void 0;break;default:this.contextButtonUrl=void 0,this.contextButtonUrlQueryParams=void 0,this.contextButtonUrlFragment=void 0}else this.contextButtonUrl=void 0,this.contextButtonUrlQueryParams=void 0,this.contextButtonUrlFragment=void 0}handleButtonClick(){var e,t;if(this.contextBoxState&&this.contextBoxState.name&&"LINK"!==(null===(e=this.contextBoxState.button)||void 0===e?void 0:e.data.type)&&"REQUEST_MILESTONE"!==(null===(t=this.contextBoxState.button)||void 0===t?void 0:t.data.type))switch(this.contextBoxState.name){case"projectAcceptHourly":case"projectAcceptFixed":this.accept();break;case"projectAwardFixed":this.awardFixed();break;case"milestoneCreate":case"milestoneCreateInitial":case"milestoneCreateFromRequest":this.createMilestone();break;default:console.warn("Unknown context box state button clicked")}}goToUrl(e,t){t?this.router.navigate([e],t):this.router.navigate([e])}awardFixed(){if(this.contextBoxState&&this.contextBoxState.button&&"AWARD_FIXED"===this.contextBoxState.button.data.type){const{bidId:e,projectId:t}=this.contextBoxState.button.data;this.buttonBusy=!0;const n=this.modalService.open("AwardModal",{inputs:{bidId:e,projectId:t},size:a.a.LARGE,edgeToEdge:!0,mobileFullscreen:!0});n.afterOpen().toPromise().then(e=>{this.buttonBusy=!1,this.changeDetectorRef.markForCheck()}),n.afterClosed().toPromise().then(e=>{e&&this.goToUrl(`/projects/${t}.html`,{fragment:"/management"})})}}createMilestone(){if(this.contextBoxState&&this.contextBoxState.button&&"CREATE_MILESTONE"===this.contextBoxState.button.data.type&&"hireme"!==this.contextBoxState.name){this.buttonBusy=!0;const{bidderId:e,bidId:t,projectId:n,currencyDetails:i}=this.contextBoxState.button.data;this.modalService.open("MilestoneCreateModal",{inputs:{bidId:t,projectId:n,currencyDetails:i,username:this.contextBoxState.otherUserName,bidderId:e},size:a.a.SMALL}).afterOpen().toPromise().then(()=>{this.changeDetectorRef.markForCheck(),this.buttonBusy=!1})}}accept(){if(this.contextBoxState&&this.contextBoxState.button&&"ACCEPT"===this.contextBoxState.button.data.type){this.buttonBusy=!0;const{projectId:e}=this.contextBoxState.button.data;this.datastore.collection("bids",t=>t.where("projectId","==",e)).update(this.contextBoxState.button.data.bidId,{awardStatus:r.BidAwardStatusApi.AWARDED}).then(t=>{this.buttonBusy=!1,this.changeDetectorRef.markForCheck(),"error"!==t.status||t.errorCode!==o.ErrorCodeApi.ESCROWCOM_ACCOUNT_UNLINKED&&t.errorCode!==o.ErrorCodeApi.PROFILE_INCOMPLETE&&t.errorCode!==o.ErrorCodeApi.NDA_NOT_SIGNED||this.goToUrl(`/projects/${e}`)})}}}return e.\u0275fac=function(t){return new(t||e)(l.Sb(l.h),l.Sb(d.a),l.Sb(h.b),l.Sb(g.e))},e.\u0275cmp=l.Mb({type:e,selectors:[["app-messaging-context-button"]],inputs:{contextBoxState:"contextBoxState"},features:[l.Eb],decls:9,vars:15,consts:function(){let e,t,n,i,s,a,o,r;return e=" Award ",t=" Setup Billing ",n=" Create Milestone ",i=" Pay Now ",s=" Hire Me ",a=" Accept ",o=" Track Time ",r=" Request Milestone ",[[3,"flTrackingLabel","busy","color","fragment","link","queryParams","size","click"],[4,"ngIf"],e,t,n,i,s,a,o,r]},template:function(e,t){1&e&&(l.Yb(0,"fl-button",0),l.nc("click",function(){return t.handleButtonClick()}),l.Zc(1,p,2,0,"ng-container",1),l.Zc(2,m,2,0,"ng-container",1),l.Zc(3,M,2,0,"ng-container",1),l.Zc(4,C,2,0,"ng-container",1),l.Zc(5,S,2,0,"ng-container",1),l.Zc(6,T,2,0,"ng-container",1),l.Zc(7,x,2,0,"ng-container",1),l.Zc(8,y,2,0,"ng-container",1),l.Xb()),2&e&&(l.Bc("flTrackingLabel","ChatboxContextButton-",null==t.contextBoxState?null:t.contextBoxState.name,""),l.zc("busy",t.buttonBusy)("color",t.buttonColor)("fragment",t.contextButtonUrlFragment)("link",t.contextButtonUrl)("queryParams",t.contextButtonUrlQueryParams)("size",t.ButtonSize.SMALL),l.Gb(1),l.zc("ngIf","projectAwardHourly"===(null==t.contextBoxState?null:t.contextBoxState.name)||"projectAwardFixed"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","setupBilling"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","milestoneCreate"===(null==t.contextBoxState?null:t.contextBoxState.name)||"milestoneCreateFromRequest"===(null==t.contextBoxState?null:t.contextBoxState.name)||"milestoneCreateInitial"===(null==t.contextBoxState?null:t.contextBoxState.name)||"milestoneCreateRedirect"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","payFailedInvoices"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","hireme"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","projectAcceptHourly"===(null==t.contextBoxState?null:t.contextBoxState.name)||"projectAcceptFixed"===(null==t.contextBoxState?null:t.contextBoxState.name)||"projectAcceptRedirect"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","trackTime"===(null==t.contextBoxState?null:t.contextBoxState.name)),l.Gb(1),l.zc("ngIf","requestMilestone"===(null==t.contextBoxState?null:t.contextBoxState.name)||"requestMilestoneRedirect"===(null==t.contextBoxState?null:t.contextBoxState.name)))},directives:[i.b,u.a,b.a,f.q],encapsulation:2,changeDetection:0}),e})()},gJiX:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n("SVse"),s=n("s7LF"),a=n("oA5+"),o=n("EXHp"),r=n("18b0"),c=n("cokP"),l=n("iAS6"),d=n("OS7q"),h=n("Z13H"),g=n("8Y7J");let u=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.Qb({type:e}),e.\u0275inj=g.Pb({imports:[[i.c,s.j,o.a,r.a,c.a,h.a,l.a,d.a]]}),e})(),b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.Qb({type:e}),e.\u0275inj=g.Pb({imports:[[i.c,a.a,s.j,o.a,r.a,c.a,l.a,u]]}),e})()},gKBM:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var i=n("9u4R"),s=n("tqRt"),a=n("sGoS"),o=n("cUs2"),r=n("ZotQ"),c=n("cFvg");function l(e={},t){switch(t.type){case"API_FETCH_SUCCESS":if("agentSessions"===t.payload.type){const{result:n,ref:i,order:s}=t.payload;return n.agent_sessions&&n.sessions?Object(o.o)(e,Object(o.z)(n.agent_sessions,c.b,n.sessions),s,i):e}return e;case"API_UPDATE_SUCCESS":if("agentSessions"===t.payload.type){const{originalDocument:n,result:i,ref:s}=t.payload;return Object(o.q)(e,Object(o.z)([i.agent_session],c.a,n),s)}return e;case"WS_MESSAGE":{const{payload:n}=t;if("supportQueueEvent"===n.type)switch(n.data.queueEventType){case r.a.ENQUEUE:case r.a.REASSIGN:return Object(o.b)(e,n.data.agent_sessions,c.b,{path:{collection:"agentSessions",authUid:n.toUserId}},n.data.sessions);default:return e}if("supportAgentSession"===n.type)switch(n.data.type){case"created":case"assigned":case"resolved":case"starred":return Object(o.b)(e,[n.data.agentSession],c.b,{path:{collection:"agentSessions",authUid:n.toUserId}},{[n.data.session.id]:n.data.session});default:return e}return e}default:return e}}var d=n("8Y7J");let h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.Qb({type:e}),e.\u0275inj=d.Pb({imports:[[s.j.forFeature("agentSessions",l),i.d.forFeature("agentSessions",a.a)]]}),e})()},iAS6:function(e,t,n){"use strict";n.d(t,"a",function(){return Ot});var i=n("SVse"),s=n("s7LF"),a=n("oA5+"),o=n("EXHp"),r=n("18b0"),c=n("cokP"),l=n("yotz"),d=n("ltMK"),h=n("8Y7J"),g=n("KtYJ"),u=n("HLWz"),b=n("/zj7"),f=n("KUXl"),p=n("HsDr"),m=n("9Aot"),M=n("Rnop"),C=n("o9eT"),S=n("2Gc0"),T=n("DSso"),x=n("w13q"),y=n("J301");function I(e,t){if(1&e&&(h.Yb(0,"fl-bit"),h.Yb(1,"fl-text",7),h.cc(2,8),h.Xb(),h.Yb(3,"fl-progress-bar",9),h.ec(4,10),h.Xb(),h.Xb()),2&e){const e=h.rc();h.Gb(1),h.zc("size",e.TextSize.XXXSMALL)("color",e.FontColor.INHERIT),h.Gb(2),h.gc(e.attachment.name),h.dc(4),h.zc("progressPercentage",e.uploadPercentage)}}function O(e,t){if(1&e&&(h.Yb(0,"fl-text",11),h.cc(1,12),h.Xb()),2&e){const e=h.rc();h.zc("size",e.TextSize.XXXSMALL)("color",e.FontColor.ERROR)}}function A(e,t){if(1&e&&h.Tb(0,"fl-icon",13),2&e){const e=h.rc();h.zc("color",e.IconColor.MID)("name","ui-tick")("size",e.IconSize.SMALL)}}function v(e,t){if(1&e&&(h.Yb(0,"fl-text",11),h.cc(1,14),h.Xb()),2&e){const e=h.rc();h.zc("size",e.TextSize.XXXSMALL)("color",e.FontColor.MID)}}function w(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-icon",15),h.nc("click",function(){return h.Pc(e),h.rc().retryUpload.emit()}),h.Xb()}if(2&e){const e=h.rc();h.zc("clickable",!0)("name","ui-refresh")("size",e.IconSize.SMALL)}}const E=function(e){return{"Title--inboxPage":e}};let z=(()=>{class e{constructor(){this.FontColor=M.a,this.IconColor=p.c,this.IconSize=p.e,this.Margin=m.a,this.TextSize=C.f,this.retryUpload=new h.n,this.successfulUpload=new h.n}ngOnChanges(e){var t,n;"success"===(null===(n=null===(t=e.uploadTaskEvent)||void 0===t?void 0:t.currentValue)||void 0===n?void 0:n.state)&&this.successfulUpload.emit()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-attachment-list-item"]],inputs:{attachment:"attachment",chatboxMode:"chatboxMode",uploadPercentage:"uploadPercentage",uploadTaskEvent:"uploadTaskEvent",previewUrl:"previewUrl"},outputs:{retryUpload:"retryUpload",successfulUpload:"successfulUpload"},features:[h.Eb],decls:9,vars:12,consts:function(){let e,t,n,i,s,a,o;return e="Attachment preview",t="File uploaded",n="Retry",i=" Uploading... ",s="" + "\ufffd0\ufffd" + " upload",a=" The upload failed. Please try again. ",o=" Attached ",[["flTrackingLabel","ChangeAttachmentDetails","alt",e,3,"flMarginRight","src"],[1,"Details",3,"flMarginRight"],[1,"Title",3,"ngClass"],[4,"ngIf"],[3,"size","color",4,"ngIf"],["label",t,3,"color","name","size",4,"ngIf"],["label",n,"flTrackingLabel","RetryIcon",3,"clickable","name","size","click",4,"ngIf"],[1,"UploadingState",3,"size","color"],i,[3,"progressPercentage",6,"label"],["label",s],[3,"size","color"],a,["label",t,3,"color","name","size"],o,["label",n,"flTrackingLabel","RetryIcon",3,"clickable","name","size","click"]]},template:function(e,t){1&e&&(h.Tb(0,"fl-file-display",0),h.Yb(1,"fl-bit",1),h.Yb(2,"fl-text",2),h.bd(3),h.Xb(),h.Zc(4,I,5,4,"fl-bit",3),h.Zc(5,O,2,2,"fl-text",4),h.Zc(6,A,1,3,"fl-icon",5),h.Zc(7,v,2,2,"fl-text",4),h.Xb(),h.Zc(8,w,1,3,"fl-icon",6)),2&e&&(h.zc("flMarginRight",t.Margin.XXSMALL)("src",t.previewUrl),h.Gb(1),h.zc("flMarginRight",t.Margin.XXSMALL),h.Gb(1),h.zc("ngClass",h.Ec(10,E,!t.chatboxMode)),h.Gb(1),h.dd(" ",t.attachment.name," "),h.Gb(1),h.zc("ngIf","running"===(null==t.uploadTaskEvent?null:t.uploadTaskEvent.state)),h.Gb(1),h.zc("ngIf","error"===(null==t.uploadTaskEvent?null:t.uploadTaskEvent.state)),h.Gb(1),h.zc("ngIf","success"===(null==t.uploadTaskEvent?null:t.uploadTaskEvent.state)),h.Gb(1),h.zc("ngIf",!t.uploadTaskEvent),h.Gb(1),h.zc("ngIf","error"===(null==t.uploadTaskEvent?null:t.uploadTaskEvent.state)))},directives:[S.a,T.a,m.b,x.a,C.e,i.o,i.q,y.a,p.d],styles:["[_nghost-%COMP%]{align-items:center;display:flex}.Details[_ngcontent-%COMP%]{flex:1}.Title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:175px}@media (min-width:960px){.Title--inboxPage[_ngcontent-%COMP%]{width:400px}}.UploadingState[_ngcontent-%COMP%]{color:#139ff0}"],changeDetection:0}),e})();var L=n("al+g");function k(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-list-item",2),h.nc("dismiss",function(){h.Pc(e);const n=t.$implicit;return h.rc().removeAttachment.emit(n.key)}),h.Yb(1,"app-messaging-attachment-list-item",3),h.nc("retryUpload",function(){h.Pc(e);const n=t.$implicit;return h.rc().retryUpload.emit(n.key)})("successfulUpload",function(){h.Pc(e);const n=t.$implicit;return h.rc().successfulUpload.emit(n.key)}),h.sc(2,"flAsync"),h.sc(3,"flAsync"),h.sc(4,"flAsync"),h.Xb(),h.Xb()}if(2&e){const e=t.$implicit,n=h.rc();h.Gb(1),h.zc("attachment",e.value.file)("chatboxMode",n.chatboxMode)("uploadPercentage",h.tc(2,5,e.value.uploadPercentage$))("uploadTaskEvent",h.tc(3,7,e.value.uploadTaskEvent$))("previewUrl",h.tc(4,9,e.value.previewUrl$))}}let P=(()=>{class e{constructor(){this.ListItemPadding=g.e,this.ListItemType=g.f,this.removeAttachment=new h.n,this.successfulUpload=new h.n,this.retryUpload=new h.n}identifyUpload(e,t){return t.key}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-attachment-list"]],inputs:{chatboxMode:"chatboxMode",fileAttachmentMap:"fileAttachmentMap"},outputs:{removeAttachment:"removeAttachment",successfulUpload:"successfulUpload",retryUpload:"retryUpload"},decls:4,vars:7,consts:[["flTrackingSection","MessagingAttachmentList",3,"padding","bodyEdgeToEdge","type"],[3,"dismiss",4,"ngFor","ngForOf","ngForTrackBy"],[3,"dismiss"],[3,"attachment","chatboxMode","uploadPercentage","uploadTaskEvent","previewUrl","retryUpload","successfulUpload"]],template:function(e,t){1&e&&(h.Yb(0,"fl-scrollable-content"),h.Yb(1,"fl-list",0),h.Zc(2,k,5,11,"fl-list-item",1),h.sc(3,"keyvalue"),h.Xb(),h.Xb()),2&e&&(h.Gb(1),h.zc("padding",t.ListItemPadding.XXSMALL)("bodyEdgeToEdge",!0)("type",t.ListItemType.DISMISS),h.Gb(1),h.zc("ngForOf",h.tc(3,5,t.fileAttachmentMap))("ngForTrackBy",t.identifyUpload))},directives:[u.a,b.a,f.a,i.p,g.b,z],pipes:[i.j,L.a],styles:["[_nghost-%COMP%]{display:block;max-height:128px;overflow-x:hidden;overflow-y:auto}"],changeDetection:0}),e})();var _=n("mrSG"),R=n("B23V"),j=n("dO68"),U=n("IzEk"),B=n("L1P6"),$=n("Krui");function G(e,t){if(1&e&&(h.Yb(0,"fl-text",6),h.cc(1,7),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("maxLines",3)("maxHeight",e.TextSize.INHERIT)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(1),h.gc(e.otherUser.displayName)(e.project.title),h.dc(1)}}function F(e,t){if(1&e&&(h.Yb(0,"fl-text",6),h.cc(1,8),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("maxLines",3)("maxHeight",e.TextSize.INHERIT)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(1),h.gc(e.otherUser.displayName)(e.project.title),h.dc(1)}}let D=(()=>{class e{constructor(){this.Margin=m.a,this.TextAlign=C.d,this.TextSize=C.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding-intro"]],inputs:{thread:"thread",otherUser:"otherUser",project:"project"},decls:7,vars:8,consts:function(){let e,t,n;return e=" Click 'Next' to see a few tips on how to make sure you and " + "\ufffd0\ufffd" + " have a great experience working together. ",t=" " + "\ufffd0\ufffd" + " would like to chat to you about " + "\ufffd1\ufffd" + " ",n=" You are about to start chatting to " + "\ufffd0\ufffd" + " about " + "\ufffd1\ufffd" + " ",[[1,"MessagingOnboarding-container",3,"flMarginBottom"],["alt","",1,"MessagingOnboarding-image",3,"src","boundedHeight","boundedWidth"],[3,"flMarginBottom","maxLines","maxHeight","size","textAlign",4,"ngIf","ngIfElse"],["noThread",""],[3,"textAlign"],e,[3,"flMarginBottom","maxLines","maxHeight","size","textAlign"],t,n]},template:function(e,t){if(1&e&&(h.Yb(0,"fl-bit",0),h.Tb(1,"fl-picture",1),h.Xb(),h.Zc(2,G,2,7,"fl-text",2),h.Zc(3,F,2,7,"ng-template",null,3,h.ad),h.Yb(5,"fl-text",4),h.cc(6,5),h.Xb()),2&e){const e=h.Mc(4);h.zc("flMarginBottom",t.Margin.MID),h.Gb(1),h.zc("src","messaging/ui-live-chat-v2.svg")("boundedHeight",!0)("boundedWidth",!0),h.Gb(1),h.zc("ngIf",t.thread)("ngIfElse",e),h.Gb(3),h.zc("textAlign",t.TextAlign.CENTER),h.Gb(1),h.gc(t.otherUser.displayName),h.dc(6)}},directives:[x.a,m.b,$.a,i.q,C.e],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-container[_ngcontent-%COMP%]{align-items:flex-end;display:flex;height:78px}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})();var N=n("4BSF");let X=(()=>{class e{constructor(e){this.siteName=e,this.Margin=m.a,this.TextAlign=C.d,this.TextSize=C.f}}return e.\u0275fac=function(t){return new(t||e)(h.Sb(N.e))},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding-offsite"]],decls:6,vars:11,consts:function(){let e,t;return e=" Always communicate and make payments through " + "\ufffd0\ufffd" + " ",t=" Stay protected from scams and ensure you get paid by only communicating using the " + "[\ufffd0\ufffd|\ufffd1\ufffd]" + " chat system. Never make payments outside " + "[\ufffd0\ufffd|\ufffd1\ufffd]" + ". ",t=h.hc(t),[[1,"MessagingOnboarding-container",3,"flMarginBottom"],["alt","",1,"MessagingOnboarding-image",3,"src","boundedHeight","boundedWidth"],[3,"size","flMarginBottom","textAlign"],e,[3,"textAlign"],t]},template:function(e,t){1&e&&(h.Yb(0,"fl-bit",0),h.Tb(1,"fl-picture",1),h.Xb(),h.Yb(2,"fl-text",2),h.cc(3,3),h.Xb(),h.Yb(4,"fl-text",4),h.cc(5,5),h.Xb()),2&e&&(h.zc("flMarginBottom",t.Margin.MID),h.Gb(1),h.zc("src","messaging/ui-payment-chat.svg")("boundedHeight",!0)("boundedWidth",!0),h.Gb(1),h.zc("size",t.TextSize.MID)("flMarginBottom",t.Margin.XSMALL)("textAlign",t.TextAlign.CENTER),h.Gb(1),h.gc(t.siteName),h.dc(3),h.Gb(1),h.zc("textAlign",t.TextAlign.CENTER),h.Gb(1),h.gc(t.siteName)(t.siteName),h.dc(5))},directives:[x.a,m.b,$.a,C.e],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-container[_ngcontent-%COMP%]{align-items:flex-end;display:flex;height:78px}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})(),Y=(()=>{class e{constructor(){this.Margin=m.a,this.TextAlign=C.d,this.TextSize=C.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding-discuss"]],inputs:{otherUser:"otherUser"},decls:6,vars:9,consts:function(){let e,t;return e=" Don't forget to discuss goals and deadlines ",t=" Make sure you and " + "\ufffd0\ufffd" + " agree on exactly what the tasks to be completed are, and when each of them is due. ",[[1,"MessagingOnboarding-container",3,"flMarginBottom"],["alt","",1,"MessagingOnboarding-image",3,"src","boundedHeight","boundedWidth"],[3,"flMarginBottom","size","textAlign"],e,[3,"textAlign"],t]},template:function(e,t){1&e&&(h.Yb(0,"fl-bit",0),h.Tb(1,"fl-picture",1),h.Xb(),h.Yb(2,"fl-text",2),h.cc(3,3),h.Xb(),h.Yb(4,"fl-text",4),h.cc(5,5),h.Xb()),2&e&&(h.zc("flMarginBottom",t.Margin.MID),h.Gb(1),h.zc("src","messaging/ui-goals-and-deadlines.svg")("boundedHeight",!0)("boundedWidth",!0),h.Gb(1),h.zc("flMarginBottom",t.Margin.XSMALL)("size",t.TextSize.MID)("textAlign",t.TextAlign.CENTER),h.Gb(2),h.zc("textAlign",t.TextAlign.CENTER),h.Gb(1),h.gc(t.otherUser.displayName),h.dc(5))},directives:[x.a,m.b,$.a,C.e],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-container[_ngcontent-%COMP%]{align-items:flex-end;display:flex;height:78px}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})();var H=n("lDT0");function V(e,t){if(1&e&&(h.Wb(0),h.Yb(1,"fl-text",5),h.cc(2,6),h.Xb(),h.Yb(3,"fl-text",7),h.cc(4,8),h.Xb(),h.Vb()),2&e){const e=h.rc(2);h.Gb(1),h.zc("flMarginBottom",e.Margin.XSMALL)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(2),h.zc("textAlign",e.TextAlign.CENTER),h.Gb(1),h.gc(e.otherUser.displayName),h.dc(4)}}function Z(e,t){if(1&e&&(h.Yb(0,"fl-text",5),h.cc(1,9),h.Xb(),h.Yb(2,"fl-text",7),h.ic(3,10),h.Tb(4,"fl-link",11),h.fc(),h.Xb()),2&e){const e=h.rc(2);h.zc("flMarginBottom",e.Margin.XSMALL)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(2),h.zc("textAlign",e.TextAlign.CENTER),h.Gb(2),h.zc("link",e.MOBILE_APP_DOWNLOAD_LINK),h.gc(e.otherUser.displayName),h.dc(3)}}function W(e,t){if(1&e&&(h.Wb(0),h.Zc(1,V,5,5,"ng-container",2),h.Zc(2,Z,5,6,"ng-template",null,4,h.ad),h.Vb()),2&e){const e=h.Mc(3),t=h.rc();h.Gb(1),h.zc("ngIf",!t.project.local)("ngIfElse",e)}}function q(e,t){if(1&e&&(h.Yb(0,"fl-text",5),h.cc(1,12),h.Xb(),h.Yb(2,"fl-text",7),h.cc(3,13),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("size",e.TextSize.MID)("textAlign",e.TextAlign.CENTER),h.Gb(2),h.zc("textAlign",e.TextAlign.CENTER),h.Gb(1),h.gc(e.otherUser.displayName),h.dc(3)}}let Q=(()=>{class e{constructor(){this.Margin=m.a,this.TextAlign=C.d,this.TextSize=C.f,this.MOBILE_APP_DOWNLOAD_LINK="https://bnc.lt/Ed5l/VcovUszaWr"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding-milestone"]],inputs:{isHourlyProject:"isHourlyProject",otherUser:"otherUser",project:"project"},decls:5,vars:6,consts:function(){let e,t,n,i,s,a;return e=" Track time to get paid ",t=" If " + "\ufffd0\ufffd" + " has enabled time tracking, simply track time with the Desktop App or from the Time Tracking tab to get paid. ",n=" Track location to get paid ",i=" For " + "\ufffd0\ufffd" + " to see your location, you need to use our " + "\ufffd#4\ufffd" + "mobile app" + "\ufffd/#4\ufffd" + " while on the job. ",s=" Only ask for payment to be released after you have completed work ",a=" Ask " + "\ufffd0\ufffd" + " to create milestone payments for work you agree to complete, and only ask for it to be released once you complete the task. ",[[1,"MessagingOnboarding-container",3,"flMarginBottom"],["alt","",1,"MessagingOnboarding-image",3,"src","boundedHeight","boundedWidth"],[4,"ngIf","ngIfElse"],["default",""],["localProject",""],[3,"flMarginBottom","size","textAlign"],e,[3,"textAlign"],t,n,i,["flTrackingLabel","DownloadMobileAppLink",3,"link"],s,a]},template:function(e,t){if(1&e&&(h.Yb(0,"fl-bit",0),h.Tb(1,"fl-picture",1),h.Xb(),h.Zc(2,W,4,2,"ng-container",2),h.Zc(3,q,4,5,"ng-template",null,3,h.ad)),2&e){const e=h.Mc(4);h.zc("flMarginBottom",t.Margin.MID),h.Gb(1),h.zc("src","messaging/ui-transaction-v2.svg")("boundedHeight",!0)("boundedWidth",!0),h.Gb(1),h.zc("ngIf",t.isHourlyProject)("ngIfElse",e)}},directives:[x.a,m.b,$.a,i.q,C.e,H.b,T.a],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-container[_ngcontent-%COMP%]{align-items:flex-end;display:flex;height:78px}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})();function K(e,t){if(1&e&&h.Tb(0,"app-messaging-chat-onboarding-intro",13),2&e){const e=h.rc();h.zc("otherUser",e.otherMember)("project",e.project)("thread",e.thread)}}function J(e,t){1&e&&h.Tb(0,"app-messaging-chat-onboarding-offsite",14)}function ee(e,t){if(1&e&&h.Tb(0,"app-messaging-chat-onboarding-discuss",15),2&e){const e=h.rc();h.zc("otherUser",e.otherMember)}}function te(e,t){if(1&e&&h.Tb(0,"app-messaging-chat-onboarding-milestone",16),2&e){const e=h.rc();h.zc("project",e.project)("otherUser",e.otherMember)("isHourlyProject",e.isHourlyProject)}}function ne(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-button",17),h.nc("click",function(){return h.Pc(e),h.rc().nextClicked()}),h.cc(1,18),h.Xb()}if(2&e){const e=h.rc();h.zc("color",e.ButtonColor.SECONDARY)("size",e.ButtonSize.SMALL)}}function ie(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-button",19),h.nc("click",function(){h.Pc(e);const t=h.rc();return t.endClicked(t.thread)}),h.cc(1,20),h.Xb()}if(2&e){const e=h.rc();h.zc("color",e.ButtonColor.SECONDARY)("size",e.ButtonSize.SMALL)}}const se=function(e){return{IsHidden:e}};var ae=function(e){return e[e.INTRO=0]="INTRO",e[e.OFFSITE=1]="OFFSITE",e[e.DISCUSS=2]="DISCUSS",e[e.MILESTONE=3]="MILESTONE",e}({});let oe=(()=>{class e{constructor(e){this.localStorage=e,this.ButtonColor=R.a,this.ButtonSize=j.a,this.Margin=m.a,this.OnboardingStep=ae,this.closeOnboarding=new h.n,this.currentStep=ae.INTRO,this.NUM_STEPS=Object.keys(ae).length/2,this.FIRST_STEP=0,this.LAST_STEP=this.NUM_STEPS-1}backClicked(){this.currentStep!==this.FIRST_STEP&&this.currentStep--}nextClicked(){this.currentStep!==this.LAST_STEP&&this.currentStep++}endClicked(e){return Object(_.a)(this,void 0,void 0,function*(){const t=yield this.localStorage.get("projectOverlayThreadComplete").pipe(Object(U.a)(1)).toPromise(),n=Object.assign(Object.assign({},t),{[e.id]:!0});yield this.localStorage.set("projectOverlayThreadComplete",n),yield this.localStorage.set("projectOverlayFullFlowComplete",!0),this.closeOnboarding.emit()})}}return e.\u0275fac=function(t){return new(t||e)(h.Sb(B.a))},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-chat-onboarding"]],inputs:{otherMember:"otherMember",project:"project",thread:"thread",isHourlyProject:"isHourlyProject"},outputs:{closeOnboarding:"closeOnboarding"},decls:14,vars:15,consts:function(){let e,t,n,i;return e=" Back ",t="Messaging Onboarding progress",n=" Next ",i=" Chat ",[["flTrackingSection","MessagingOnboarding"],[3,"ngSwitch"],["class","MessagingOnboarding-body",3,"otherUser","project","thread",4,"ngSwitchCase"],["class","MessagingOnboarding-body",4,"ngSwitchCase"],["class","MessagingOnboarding-body",3,"otherUser",4,"ngSwitchCase"],["class","MessagingOnboarding-body",3,"project","otherUser","isHourlyProject",4,"ngSwitchCase"],[1,"MessagingOnboarding-footer"],[1,"MessagingOnboarding-footer-content"],["flTrackingLabel","MessagingOnboardingBackButton",3,"ngClass","color","flMarginRight","size","click"],e,["label",t,3,"flMarginRight","progressPercentage"],["flTrackingLabel","MessagingOnboardingNextButton",3,"color","size","click",4,"ngIf","ngIfElse"],["chatCta",""],[1,"MessagingOnboarding-body",3,"otherUser","project","thread"],[1,"MessagingOnboarding-body"],[1,"MessagingOnboarding-body",3,"otherUser"],[1,"MessagingOnboarding-body",3,"project","otherUser","isHourlyProject"],["flTrackingLabel","MessagingOnboardingNextButton",3,"color","size","click"],n,["flTrackingLabel","MessagingOnboardingChatButton",3,"color","size","click"],i]},template:function(e,t){if(1&e&&(h.Wb(0,0),h.Yb(1,"fl-scrollable-content",1),h.Zc(2,K,1,3,"app-messaging-chat-onboarding-intro",2),h.Zc(3,J,1,0,"app-messaging-chat-onboarding-offsite",3),h.Zc(4,ee,1,1,"app-messaging-chat-onboarding-discuss",4),h.Zc(5,te,1,3,"app-messaging-chat-onboarding-milestone",5),h.Xb(),h.Yb(6,"fl-bit",6),h.Yb(7,"fl-bit",7),h.Yb(8,"fl-button",8),h.nc("click",function(){return t.backClicked()}),h.cc(9,9),h.Xb(),h.Tb(10,"fl-progress-bar",10),h.Zc(11,ne,2,2,"fl-button",11),h.Zc(12,ie,2,2,"ng-template",null,12,h.ad),h.Xb(),h.Xb(),h.Vb()),2&e){const e=h.Mc(13);h.Gb(1),h.zc("ngSwitch",t.currentStep),h.Gb(1),h.zc("ngSwitchCase",t.OnboardingStep.INTRO),h.Gb(1),h.zc("ngSwitchCase",t.OnboardingStep.OFFSITE),h.Gb(1),h.zc("ngSwitchCase",t.OnboardingStep.DISCUSS),h.Gb(1),h.zc("ngSwitchCase",t.OnboardingStep.MILESTONE),h.Gb(3),h.zc("ngClass",h.Ec(13,se,t.currentStep===t.OnboardingStep.INTRO))("color",t.ButtonColor.TRANSPARENT_DARK)("flMarginRight",t.Margin.LARGE)("size",t.ButtonSize.SMALL),h.Gb(2),h.zc("flMarginRight",t.Margin.LARGE)("progressPercentage",100*(t.currentStep+1)/t.NUM_STEPS),h.Gb(1),h.zc("ngIf",t.currentStep!==t.OnboardingStep.MILESTONE)("ngIfElse",e)}},directives:[f.a,u.a,i.s,i.t,x.a,R.b,T.a,i.o,m.b,y.a,i.q,D,X,Y,Q],styles:["[_nghost-%COMP%]{display:flex;flex:1 0;flex-direction:column;height:calc(100% - 56px)}.MessagingOnboarding-container[_ngcontent-%COMP%]{align-items:flex-end;display:flex;height:78px}.MessagingOnboarding-image[_ngcontent-%COMP%]{max-width:75px}.MessagingOnboarding-body[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:auto;padding:24px 12px 0}.MessagingOnboarding-footer[_ngcontent-%COMP%]{flex:0 0 auto}.MessagingOnboarding-footer-content[_ngcontent-%COMP%]{align-items:center;display:flex;padding:24px}.IsHidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),e})();var re=n("23iI"),ce=n("KHGu"),le=n("VOe3"),de=n("UztC"),he=n("0RCC"),ge=n("1YM7");let ue=(()=>{class e{constructor(){this.Margin=m.a,this.TextAlign=C.d,this.TextSize=C.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-message-list-empty"]],decls:4,vars:4,consts:function(){let e,t;return e="Messaging chat image",t=" There's nothing here yet. Start the conversation! ",[["alt",e,3,"flMarginBottom","src"],[1,"EmptyStateMessageContainer"],[3,"size","textAlign"],t]},template:function(e,t){1&e&&(h.Tb(0,"fl-picture",0),h.Yb(1,"fl-bit",1),h.Yb(2,"fl-text",2),h.cc(3,3),h.Xb(),h.Xb()),2&e&&(h.zc("flMarginBottom",t.Margin.XSMALL)("src","messaging/live-chat.svg"),h.Gb(2),h.zc("size",t.TextSize.SMALL)("textAlign",t.TextAlign.CENTER))},directives:[$.a,m.b,x.a,C.e],styles:["[_nghost-%COMP%]{align-items:center;display:flex;flex-direction:column;height:100%;justify-content:center;overflow:hidden;padding:12px}.EmptyStateMessageContainer[_ngcontent-%COMP%]{width:269px}"]}),e})();var be=n("jASZ"),fe=n("b6KT"),pe=n("etQe"),me=n("YKAE"),Me=n("71eJ"),Ce=n("f6cb"),Se=n("wZbG"),Te=n("AJ15"),xe=n("4kPF"),ye=n("os2j"),Ie=n("fYbj"),Oe=n("KrVf");function Ae(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-button",4),h.nc("click",function(){return h.Pc(e),h.rc().handleViewAttachment()}),h.Tb(1,"fl-picture",5),h.sc(2,"flAsync"),h.Xb()}if(2&e){const e=h.rc();h.zc("display","block")("flMarginBottom",e.Margin.XXXSMALL),h.Gb(1),h.zc("src",h.tc(2,7,e.pathPromise))("alt",e.attachment)("externalSrc",!0)("boundedWidth",!0)("objectFit",e.PictureObjectFit.COVER)}}function ve(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-file-display",6),h.nc("click",function(){return h.Pc(e),h.rc().handleViewAttachment()}),h.Xb()}if(2&e){const e=h.rc();h.zc("alt",e.attachment)("flMarginRight",e.Margin.XXSMALL)("src",e.attachment)}}let we=(()=>{class e{constructor(e){this.fileStorage=e,this.HighlightColor=M.b,this.LinkWeight=H.f,this.Margin=m.a,this.PictureObjectFit=$.c,this.FileType=Ie.b,this.viewAttachment=new h.n}ngOnChanges(e){"attachment"in e&&(this.fileType=Object(Ie.f)(this.attachment)),this.pathPromise=this.fileStorage.getDownloadURL(ye.a.MESSAGING_ATTACHMENTS,this.attachment,{messageId:this.messageId.toString()}).then(e=>"success"===e.status?e.downloadURL:void 0)}handleViewAttachment(){this.viewAttachment.emit({name:this.attachment,messageId:this.messageId,type:this.fileType})}}return e.\u0275fac=function(t){return new(t||e)(h.Sb(Oe.a))},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-message-attachment"]],inputs:{attachment:"attachment",messageId:"messageId"},outputs:{viewAttachment:"viewAttachment"},features:[h.Eb],decls:6,vars:6,consts:[[3,"ngClass"],["flTrackingLabel","ViewThumbnail",3,"display","flMarginBottom","click",4,"ngIf","ngIfElse"],["nonImageAttachment",""],["flTrackingLabel","OpenFileAttachment-link",3,"highlightColor","weight","click"],["flTrackingLabel","ViewThumbnail",3,"display","flMarginBottom","click"],[1,"AttachmentImage-image",3,"src","alt","externalSrc","boundedWidth","objectFit"],["flTrackingLabel","ViewThumbnail",1,"AttachmentNonImage-icon",3,"alt","flMarginRight","src","click"]],template:function(e,t){if(1&e&&(h.Yb(0,"fl-bit",0),h.Zc(1,Ae,3,9,"fl-button",1),h.Zc(2,ve,1,3,"ng-template",null,2,h.ad),h.Yb(4,"fl-link",3),h.nc("click",function(){return t.handleViewAttachment()}),h.bd(5),h.Xb(),h.Xb()),2&e){const e=h.Mc(3);h.zc("ngClass",t.fileType===t.FileType.IMAGE?"AttachmentImage":"AttachmentNonImage"),h.Gb(1),h.zc("ngIf",t.fileType===t.FileType.IMAGE)("ngIfElse",e),h.Gb(3),h.zc("highlightColor",t.HighlightColor.BLUE)("weight",t.LinkWeight.BOLD),h.Gb(1),h.dd(" ",t.attachment," ")}},directives:[x.a,i.o,i.q,H.b,T.a,R.b,m.b,$.a,S.a],pipes:[L.a],styles:[".AttachmentNonImage[_ngcontent-%COMP%]{align-items:center;display:flex;flex-direction:row;width:100%}.AttachmentNonImage-icon[_ngcontent-%COMP%]{flex-shrink:0}.AttachmentImage[_ngcontent-%COMP%]{display:block}.AttachmentImage-image[_ngcontent-%COMP%]{height:220px}"],changeDetection:0}),e})();function Ee(e,t){if(1&e&&(h.Yb(0,"fl-text",13),h.cc(1,14),h.Xb()),2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("color",e.FontColor.INHERIT)("size",e.TextSize.XXXSMALL)("textTransform",e.TextTransform.UPPERCASE)}}const ze=function(e,t){return{"Message-headerText":e,"Message-headerText--firstMessage":t}};function Le(e,t){if(1&e&&(h.Yb(0,"fl-bit",15),h.Yb(1,"fl-text",16),h.bd(2),h.sc(3,"date"),h.Xb(),h.Tb(4,"fl-hr"),h.Xb()),2&e){const e=h.rc();h.zc("ngClass",h.Fc(11,ze,!e.isFirst,e.isFirst))("flMarginBottom",e.Margin.XSMALL),h.Gb(1),h.zc("flMarginBottom",e.Margin.XXXSMALL)("color",e.FontColor.MID)("highlightColor",e.HighlightColor.BLUE)("size",e.TextSize.XXSMALL)("textTransform",e.TextTransform.UPPERCASE),h.Gb(1),h.dd(" ",h.uc(3,8,e.message.timeCreated,"MMM dd, yyyy")," ")}}function ke(e,t){if(1&e&&(h.Yb(0,"fl-bit",17),h.Yb(1,"fl-text",18),h.bd(2),h.sc(3,"date"),h.Xb(),h.Xb()),2&e){const e=h.rc();h.Gb(1),h.zc("color",e.FontColor.MID)("highlightColor",e.HighlightColor.BLUE)("size",e.TextSize.XXSMALL)("color",e.isSending?e.FontColor.LIGHT:e.FontColor.INHERIT),h.Gb(1),h.dd(" ",h.uc(3,5,e.message.timeCreated,"h:mm a")," ")}}function Pe(e,t){if(1&e&&(h.Yb(0,"fl-text",19),h.bd(1),h.Xb()),2&e){const e=h.rc();h.zc("color",e.isSending?e.FontColor.LIGHT:e.FontColor.INHERIT)("flMarginRight",e.Margin.XXXSMALL)("highlightColor",e.HighlightColor.BLUE)("weight",e.FontWeight.MEDIUM),h.Gb(1),h.dd(" ",null==e.user?null:e.user.displayName," ")}}function _e(e,t){if(1&e&&h.Tb(0,"app-rich-message",20),2&e){const e=h.rc();h.zc("isOldChatbox",!1)("chatboxMode",e.chatboxMode)("currentUserId",e.loggedInUserId)("messageId",e.message.id)("richMessage",e.message.richMessage)}}function Re(e,t){if(1&e){const e=h.Zb();h.Yb(0,"app-messaging-message-attachment",24),h.nc("viewAttachment",function(t){return h.Pc(e),h.rc(2).viewAttachment.emit(t)}),h.Xb()}if(2&e){const e=t.$implicit,n=h.rc(2);h.zc("attachment",e)("messageId",n.message.id)}}function je(e,t){if(1&e&&h.Tb(0,"fl-icon",28),2&e){const e=h.rc(3);h.zc("color",e.IconColor.MID)("name","ui-tick")("size",e.IconSize.XSMALL)}}function Ue(e,t){if(1&e&&h.Tb(0,"fl-icon",28),2&e){const e=h.rc(4);h.zc("color",e.IconColor.PRIMARY)("name","ui-done-all")("size",e.IconSize.XSMALL)}}function Be(e,t){if(1&e&&(h.Yb(0,"fl-tooltip",30),h.sc(1,"date"),h.ec(2,31),h.Tb(3,"fl-icon",28),h.Xb()),2&e){const e=h.rc(4);h.gc(h.uc(1,5,e.lastReadTime,"MMM dd, yyyy \u2022 h:mm a")),h.dc(2),h.zc("position",e.TooltipPosition.BOTTOM_CENTER),h.Gb(3),h.zc("color",e.IconColor.PRIMARY)("name","ui-done-all")("size",e.IconSize.XSMALL)}}function $e(e,t){if(1&e&&(h.Zc(0,Ue,1,3,"fl-icon",26),h.Zc(1,Be,4,8,"ng-template",null,29,h.ad)),2&e){const e=h.Mc(2),t=h.rc(3);h.zc("ngIf",t.isGroupChat)("ngIfElse",e)}}function Ge(e,t){if(1&e&&(h.Yb(0,"fl-bit",25),h.Zc(1,je,1,3,"fl-icon",26),h.Zc(2,$e,3,2,"ng-template",null,27,h.ad),h.Xb()),2&e){const e=h.Mc(3),t=h.rc(2);h.zc("flMarginRight",t.Margin.XSMALL)("flMarginBottom",t.Margin.XXSMALL),h.Gb(1),h.zc("ngIf",!t.lastReadTime)("ngIfElse",e)}}function Fe(e,t){if(1&e&&(h.Yb(0,"fl-tooltip",21),h.sc(1,"date"),h.Tb(2,"fl-interactive-text",22),h.Xb(),h.Zc(3,Re,1,2,"app-messaging-message-attachment",23),h.Zc(4,Ge,4,4,"fl-bit",11)),2&e){const e=h.rc();h.Ac("message",h.uc(1,12,e.message.timeCreated,"MMM dd, yyyy \u2022 h:mm a")),h.zc("position",e.TooltipPosition.BOTTOM_CENTER),h.Gb(2),h.zc("content",e.message.message)("emoji",!0)("flMarginRight",e.Margin.XSMALL)("link",!0)("fontColor",e.isSending?e.FontColor.LIGHT:e.FontColor.INHERIT)("fontSize",e.TextSize.XSMALL)("highlightColor",e.HighlightColor.BLUE),h.Gb(1),h.zc("ngForOf",e.message.attachments)("ngForTrackBy",e.identifyAttachment),h.Gb(1),h.zc("ngIf",e.isSent&&e.fromLoggedInUser)}}function De(e,t){if(1&e&&(h.Yb(0,"fl-bit",25),h.Tb(1,"fl-icon",28),h.Xb()),2&e){const e=h.rc();h.zc("flMarginRight",e.Margin.XSMALL)("flMarginBottom",e.Margin.XXSMALL),h.Gb(1),h.zc("color",e.IconColor.ERROR)("name","ui-warning-v2")("size",e.IconSize.XSMALL)}}function Ne(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-text",32),h.ic(1,33),h.Yb(2,"fl-link",34),h.nc("click",function(){h.Pc(e);const t=h.rc();return t.resendMessage.emit(t.message)}),h.Tb(3,"fl-icon",35),h.Xb(),h.fc(),h.Xb()}if(2&e){const e=h.rc();h.zc("flMarginBottom",e.Margin.XSMALL)("color",e.FontColor.ERROR)("size",e.TextSize.XXXSMALL),h.Gb(2),h.zc("color",e.LinkColor.INHERIT)("hoverColor",e.LinkHoverColor.INHERIT)("size",e.TextSize.XXXSMALL)("weight",e.LinkWeight.BOLD),h.Gb(1),h.zc("color",e.IconColor.ERROR)("name","ui-refresh")("size",e.IconSize.XSMALL)}}const Xe=function(e){return{"Message-item--fromLoggedInUser":e}},Ye=function(e){return{IsHidden:e}},He=function(e){return[e]},Ve=function(e,t,n,i,s,a){return{"Message-bubble--loggedInArrowRecruiter":e,"Message-bubble--pointer":t,"Message-bubble--pointer--dark":n,"Message-bubble--pointer--loggedInArrowRecruiter":i,"Message-bubble--flatBottomCorner":s,"Message-bubble--sending":a}};let Ze=(()=>{class e{constructor(){this.AvatarSize=Me.a,this.FontColor=M.a,this.FontWeight=C.c,this.HighlightColor=M.b,this.IconColor=p.c,this.IconSize=p.e,this.LinkColor=H.a,this.LinkHoverColor=H.c,this.LinkWeight=H.f,this.Margin=m.a,this.TextSize=C.f,this.TextTransform=C.g,this.TooltipPosition=me.b,this.MessageSendStatus=pe.a,this.avatarSize=Me.a.SMALL,this.chatboxMode=!1,this.isGroupChat=!1,this.isFirst=!1,this.resendMessage=new h.n,this.viewAttachment=new h.n,this.fromLoggedInUser=!1,this.showDateDivider=!1,this.showUserHeader=!0,this.showHeaderInNextMessage=!1,this.showUnreadMessagesDivider=!1,this.isRecruiter=!1,this.isSending=!1,this.isSent=!0,this.messageMarginBottom=m.a.NONE,this.TIME_GAP_TO_SHOW_HEADER=144e5}checkIfSameDate(e,t){const n=new Date(e),i=new Date(t);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()&&n.getDate()===i.getDate()}ngOnChanges(e){var t;"message"in e&&(this.isSending=this.message.sendStatus===pe.a.SENDING,this.isSent=this.message.sendStatus===pe.a.SENT),("message"in e||"previousMessage"in e)&&(this.showDateDivider=!this.previousMessage||!this.checkIfSameDate(this.message.timeCreated,this.previousMessage.timeCreated),this.showUserHeader=this.shouldDisplayHeader(this.previousMessage)),("message"in e||"nextMessage"in e)&&(this.showHeaderInNextMessage=this.shouldDisplayHeader(this.nextMessage),this.message&&this.nextMessage?(this.nextMessage.fromUser===this.message.fromUser&&(this.messageMarginBottom=m.a.XXXSMALL),this.nextMessage.fromUser!==this.message.fromUser&&(this.messageMarginBottom=m.a.XXSMALL),!Object(fe.e)(this.nextMessage,this.firstUnreadMessage)&&this.checkIfSameDate(this.message.timeCreated,this.nextMessage.timeCreated)||(this.messageMarginBottom=m.a.NONE)):this.messageMarginBottom=m.a.NONE),"loggedInUser"in e&&this.loggedInUser&&(this.loggedInUserId=e.loggedInUser.currentValue.id.toString()),this.loggedInUser&&this.user&&("message"in e||"user"in e||"loggedInUser"in e)&&(this.fromLoggedInUser=this.user.id===this.loggedInUser.id,this.isRecruiter=!!(null===(t=this.loggedInUser.supportStatus)||void 0===t?void 0:t.type)),this.loggedInUser&&("message"in e||"userReadTimes"in e||"loggedInUser"in e)&&(this.lastReadTime=Object.entries(this.userReadTimes).filter(([e,t])=>Object(Ce.s)(e)!==this.loggedInUser.id&&t>=this.message.timeCreated).map(([e,t])=>t).reduce((e,t)=>e>t?e:t,0)),("firstUnreadMessage"in e||"message"in e)&&(this.showUnreadMessagesDivider=Object(fe.e)(this.message,this.firstUnreadMessage)),this.loggedInUser&&("message"in e||"loggedInUser"in e)&&(this.isFailed=this.fromLoggedInUser&&this.message.sendStatus===pe.a.FAILED)}identifyAttachment(e,t){return t}shouldDisplayHeader(e){return!e||e.fromUser!==this.message.fromUser||Math.abs(e.timeCreated-this.message.timeCreated)>this.TIME_GAP_TO_SHOW_HEADER}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-message-item"]],inputs:{avatarSize:"avatarSize",chatboxMode:"chatboxMode",isGroupChat:"isGroupChat",loggedInUser:"loggedInUser",message:"message",previousMessage:"previousMessage",nextMessage:"nextMessage",isFirst:"isFirst",firstUnreadMessage:"firstUnreadMessage",user:"user",userIsOnline:"userIsOnline",userReadTimes:"userReadTimes"},outputs:{resendMessage:"resendMessage",viewAttachment:"viewAttachment"},features:[h.Eb],decls:14,vars:30,consts:function(){let e,t,n;return e=" New Messages ",t="Read on " + "\ufffd0\ufffd" + "",n=" Message not sent. " + "\ufffd#2\ufffd" + " Retry " + "\ufffd#3\ufffd" + "" + "\ufffd/#3\ufffd" + "" + "\ufffd/#2\ufffd" + "",[["class","Message-newMessages-text",3,"flMarginBottom","color","size","textTransform",4,"ngIf"],[3,"ngClass","flMarginBottom",4,"ngIf"],[1,"Message",3,"flMarginBottom"],[1,"Message-item",3,"ngClass"],[3,"ngClass","flMarginRight","size","users","isOnline"],[1,"Message-bubble",3,"ngClass"],[1,"Message-bubble-contents",3,"flMarginRight"],["class","Message-bubble-timestamp",4,"ngIf"],["class","Message-item-header",3,"color","flMarginRight","highlightColor","weight",4,"ngIf"],[3,"isOldChatbox","chatboxMode","currentUserId","messageId","richMessage",4,"ngIf","ngIfElse"],["userMessage",""],["class","Message-bubble-readMarker",3,"flMarginRight","flMarginBottom",4,"ngIf"],["class","Message-error",3,"flMarginBottom","color","size",4,"ngIf"],[1,"Message-newMessages-text",3,"flMarginBottom","color","size","textTransform"],e,[3,"ngClass","flMarginBottom"],[3,"flMarginBottom","color","highlightColor","size","textTransform"],[1,"Message-bubble-timestamp"],[3,"color","highlightColor","size"],[1,"Message-item-header",3,"color","flMarginRight","highlightColor","weight"],[3,"isOldChatbox","chatboxMode","currentUserId","messageId","richMessage"],[1,"Message-item-tooltip",3,"message","position"],[3,"content","emoji","flMarginRight","link","fontColor","fontSize","highlightColor"],[3,"attachment","messageId","viewAttachment",4,"ngFor","ngForOf","ngForTrackBy"],[3,"attachment","messageId","viewAttachment"],[1,"Message-bubble-readMarker",3,"flMarginRight","flMarginBottom"],[3,"color","name","size",4,"ngIf","ngIfElse"],["readMarker",""],[3,"color","name","size"],["privateChatReadMarker",""],[3,"position",6,"message"],["message",t],[1,"Message-error",3,"flMarginBottom","color","size"],n,["flTrackingLabel","MessageResend",3,"color","hoverColor","size","weight","click"],[1,"Message--resendIcon",3,"color","name","size"]]},template:function(e,t){if(1&e&&(h.Zc(0,Ee,2,4,"fl-text",0),h.Zc(1,Le,5,14,"fl-bit",1),h.Yb(2,"fl-bit",2),h.Yb(3,"fl-bit",3),h.Tb(4,"fl-user-avatar",4),h.Yb(5,"fl-bit",5),h.Yb(6,"fl-bit",6),h.Zc(7,ke,4,8,"fl-bit",7),h.Zc(8,Pe,2,5,"fl-text",8),h.Zc(9,_e,1,5,"app-rich-message",9),h.Zc(10,Fe,5,15,"ng-template",null,10,h.ad),h.Zc(12,De,2,5,"fl-bit",11),h.Xb(),h.Xb(),h.Xb(),h.Zc(13,Ne,4,10,"fl-text",12),h.Xb()),2&e){const e=h.Mc(11);h.zc("ngIf",t.showUnreadMessagesDivider&&!t.showDateDivider),h.Gb(1),h.zc("ngIf",t.showDateDivider&&!t.showUnreadMessagesDivider),h.Gb(1),h.zc("flMarginBottom",t.messageMarginBottom),h.Gb(1),h.zc("ngClass",h.Ec(17,Xe,t.fromLoggedInUser)),h.Gb(1),h.zc("ngClass",h.Ec(19,Ye,!t.showUserHeader&&!t.showUnreadMessagesDivider))("flMarginRight",t.Margin.XSMALL)("size",t.avatarSize)("users",h.Ec(21,He,t.user))("isOnline",t.userIsOnline),h.Gb(1),h.zc("ngClass",h.Ic(23,Ve,t.fromLoggedInUser&&t.isRecruiter,t.showUserHeader||t.showUnreadMessagesDivider,(t.showUserHeader||t.showUnreadMessagesDivider)&&t.isSending,(t.showUserHeader||t.showUnreadMessagesDivider)&&t.fromLoggedInUser&&t.isRecruiter,!t.showHeaderInNextMessage,t.isSending)),h.Gb(1),h.zc("flMarginRight",t.Margin.XXXSMALL),h.Gb(1),h.zc("ngIf",t.showUserHeader||t.showUnreadMessagesDivider),h.Gb(1),h.zc("ngIf",t.showUserHeader||t.showUnreadMessagesDivider),h.Gb(1),h.zc("ngIf",!!t.message.richMessage)("ngIfElse",e),h.Gb(3),h.zc("ngIf",t.isFailed),h.Gb(1),h.zc("ngIf",t.isFailed)}},directives:[i.q,x.a,m.b,i.o,Me.b,C.e,Se.a,Te.a,me.a,xe.a,i.p,we,p.d,H.b,T.a],pipes:[i.f],styles:['[_nghost-%COMP%]{display:block}.Message-item[_ngcontent-%COMP%]{word-break:break-word;word-wrap:break-word;display:flex;max-width:100%}.Message-item-header[_ngcontent-%COMP%]{display:flex}.Message-item-tooltip[_ngcontent-%COMP%]{width:100%}.Message-item[_ngcontent-%COMP%]   .IsHidden[_ngcontent-%COMP%]{height:0;visibility:hidden}.Message-headerText[_ngcontent-%COMP%]{padding-top:16px}.Message-headerText--firstMessage[_ngcontent-%COMP%]{padding-top:4px}.Message-bubble[_ngcontent-%COMP%]{align-items:flex-start;border:1px solid #dedede;border-radius:12px;border-top-left-radius:0;display:flex;padding:8px;position:relative;width:100%}.Message-bubble-contents[_ngcontent-%COMP%]{flex:1}.Message-bubble-timestamp[_ngcontent-%COMP%]{float:right;margin-bottom:1px;margin-left:12px}.Message-bubble-readMarker[_ngcontent-%COMP%]{bottom:0;position:absolute;right:0}.Message-bubble--pointer[_ngcontent-%COMP%]:after, .Message-bubble--pointer[_ngcontent-%COMP%]:before{content:"";height:0;position:absolute;width:0}.Message-bubble--pointer[_ngcontent-%COMP%]:before{border-color:#dedede #dedede transparent transparent;border-style:solid;border-width:2px 10px 10px 2px;left:-12px;top:-1px}.Message-bubble--pointer[_ngcontent-%COMP%]:after{border-color:#fff #fff transparent transparent;border-style:solid;border-width:2px 9px 9px 2px;left:-10px;top:0}.Message-bubble--pointer--dark[_ngcontent-%COMP%]:after{border-right-color:#dedede;border-top-color:#dedede}.Message-bubble--pointer--loggedInArrowRecruiter[_ngcontent-%COMP%]:after{border-right-color:#fff;border-top-color:#fff}.Message-bubble--flatBottomCorner[_ngcontent-%COMP%]{border-bottom-left-radius:0}.Message-bubble--sending[_ngcontent-%COMP%]{background-color:#dedede;color:#fff}.Message-bubble--loggedInArrowRecruiter[_ngcontent-%COMP%]{background-color:#fff;color:#0e1724}.Message-newMessages-text[_ngcontent-%COMP%]{border-bottom:1px solid #007fed;color:#007fed;padding-bottom:4px;padding-top:16px;width:100%}.Message[_ngcontent-%COMP%]:hover   .Message--resendIcon[_ngcontent-%COMP%]{display:inline-block}.Message--resendIcon[_ngcontent-%COMP%]{display:none}.Message-error[_ngcontent-%COMP%]{padding-left:44px;padding-top:12px}'],changeDetection:0}),e})();var We=n("565b"),qe=n("v01h");const Qe=["scrollableContent"];function Ke(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-link",9),h.nc("click",function(){return h.Pc(e),h.rc(2).loadMoreMessage.emit()}),h.cc(1,10),h.Xb()}}function Je(e,t){if(1&e&&h.Tb(0,"fl-spinner",11),2&e){const e=h.rc(2);h.zc("size",e.SpinnerSize.SMALL)}}function et(e,t){if(1&e&&(h.Yb(0,"fl-bit",6),h.Zc(1,Ke,2,0,"fl-link",7),h.Zc(2,Je,1,1,"ng-template",null,8,h.ad),h.Xb()),2&e){const e=h.Mc(3),t=h.rc();h.zc("flMarginBottom",t.Margin.XXSMALL),h.Gb(1),h.zc("ngIf",!t.loading)("ngIfElse",e)}}function tt(e,t){if(1&e){const e=h.Zb();h.Yb(0,"app-messaging-message-item",12),h.nc("resendMessage",function(t){return h.Pc(e),h.rc().resendMessage.emit(t)})("viewAttachment",function(t){return h.Pc(e),h.rc().viewAttachment.emit(t)}),h.Xb()}if(2&e){const e=t.$implicit,n=t.index,i=t.first,s=t.last,a=h.rc();h.zc("chatboxMode",a.chatboxMode)("loggedInUser",a.loggedInUser)("message",e)("previousMessage",0!==n?a.messages[n-1]:void 0)("nextMessage",s?void 0:a.messages[n+1])("user",a.usersMap[e.fromUser])("userReadTimes",a.userReadTimes)("userIsOnline",a.usersIsOnlineMap[e.fromUser])("isFirst",i)("isGroupChat",a.isGroupChat)("firstUnreadMessage",a.firstUnreadMessage)}}function nt(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-floating-action",13),h.nc("click",function(){return h.Pc(e),h.rc().scrollToBottom()}),h.Xb()}2&e&&h.zc("icon","ui-arrow-down")}let it=(()=>{class e{constructor(){this.Margin=m.a,this.SpinnerSize=be.d,this.chatboxMode=!1,this.isGroupChat=!1,this.loading=!1,this.showLoadMore=!1,this.loadMoreMessage=new h.n,this.resendMessage=new h.n,this.viewAttachment=new h.n,this.showNewMessagesFloatingAction=!1}ngAfterViewInit(){this.scrollToBottom()}ngOnChanges(e){this.loggedInUser&&e.messages&&(!e.messages.previousValue||this.isAtBottom()||this.isMessageSent(e.messages.currentValue,e.messages.previousValue))&&this.scrollToBottom(),this.loggedInUser&&e.messages&&this.isMessageSent(e.messages.currentValue,e.messages.previousValue)&&(this.firstUnreadMessage=void 0),e.messages&&e.thread&&this.thread&&!this.isAtBottom()&&!this.thread.isRead&&!this.showNewMessagesFloatingAction&&(this.firstUnreadMessage=this.messages[this.messages.length-1],this.showNewMessagesFloatingAction=!0)}scrollToBottom(){this.scrollableContent&&(this.scrollableContent.scrollToBottom(),this.showNewMessagesFloatingAction=!1)}isAtBottom(){return!this.messageComponents||0===this.messageComponents.length||this.scrollableContent.isAtBottom(this.messageComponents.last.nativeElement.clientHeight)}isMessageSent(e,t){const n=e[e.length-1],i=t?t[t.length-1]:void 0;return n&&n.fromUser?!Object(fe.e)(n,i)&&n.fromUser===this.loggedInUser.id:!Object(fe.e)(n,i)}identifyMessage(e,t){return t.id}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-message-list"]],viewQuery:function(e,t){if(1&e&&(h.id(Qe,1),h.id(Ze,1,h.l)),2&e){let e;h.Lc(e=h.oc())&&(t.scrollableContent=e.first),h.Lc(e=h.oc())&&(t.messageComponents=e)}},inputs:{chatboxMode:"chatboxMode",isGroupChat:"isGroupChat",loading:"loading",loggedInUser:"loggedInUser",showLoadMore:"showLoadMore",messages:"messages",thread:"thread",userReadTimes:"userReadTimes",usersIsOnlineMap:"usersIsOnlineMap",usersMap:"usersMap"},outputs:{loadMoreMessage:"loadMoreMessage",resendMessage:"resendMessage",viewAttachment:"viewAttachment"},features:[h.Eb],decls:6,vars:4,consts:function(){let e,t;return e="Show new messages",t=" Load More... ",[[1,"MessageList-scrollableContent"],["scrollableContent",""],[1,"MessageList"],["class","MessageList-loadMore",3,"flMarginBottom",4,"ngIf"],["class","MessageList-item",3,"chatboxMode","loggedInUser","message","previousMessage","nextMessage","user","userReadTimes","userIsOnline","isFirst","isGroupChat","firstUnreadMessage","resendMessage","viewAttachment",4,"ngFor","ngForOf","ngForTrackBy"],["flTrackingLabel","showNewMessagesFloatingAction","text",e,3,"icon","click",4,"ngIf"],[1,"MessageList-loadMore",3,"flMarginBottom"],["flTrackingLabel","LoadMoreMessages",3,"click",4,"ngIf","ngIfElse"],["loadingMessages",""],["flTrackingLabel","LoadMoreMessages",3,"click"],t,["flTrackingLabel","MoreMessagesLoading",3,"size"],[1,"MessageList-item",3,"chatboxMode","loggedInUser","message","previousMessage","nextMessage","user","userReadTimes","userIsOnline","isFirst","isGroupChat","firstUnreadMessage","resendMessage","viewAttachment"],["flTrackingLabel","showNewMessagesFloatingAction","text",e,3,"icon","click"]]},template:function(e,t){1&e&&(h.Yb(0,"fl-scrollable-content",0,1),h.Yb(2,"fl-bit",2),h.Zc(3,et,4,3,"fl-bit",3),h.Zc(4,tt,1,11,"app-messaging-message-item",4),h.Xb(),h.Xb(),h.Zc(5,nt,1,1,"fl-floating-action",5)),2&e&&(h.Gb(3),h.zc("ngIf",t.showLoadMore||t.loading),h.Gb(1),h.zc("ngForOf",t.messages)("ngForTrackBy",t.identifyMessage),h.Gb(1),h.zc("ngIf",t.showNewMessagesFloatingAction))},directives:[u.a,x.a,i.q,i.p,m.b,H.b,T.a,We.a,be.c,Ze,qe.a],styles:["[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column;overflow:auto;position:relative}.MessageList[_ngcontent-%COMP%]{padding:8px}.MessageList-scrollableContent[_ngcontent-%COMP%]{bottom:0;flex:1 0 100%;left:0;overflow-y:auto;position:absolute;right:0;top:0}.MessageList-loadMore[_ngcontent-%COMP%]{text-align:center}.MessageList-item[_ngcontent-%COMP%]{display:flex;flex-direction:column}"],changeDetection:0}),e})();var st=n("7v0r"),at=n("Np1b"),ot=n("a293");function rt(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-banner-alert",4),h.nc("close",function(){return h.Pc(e),h.rc().clearErrors.emit()}),h.Xb()}if(2&e){const e=h.rc();h.zc("type",e.BannerAlertType.ERROR)}}function ct(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-banner-alert",5),h.nc("close",function(){return h.Pc(e),h.rc().clearErrors.emit()}),h.Xb()}if(2&e){const e=h.rc();h.zc("type",e.BannerAlertType.ERROR)}}function lt(e,t){if(1&e){const e=h.Zb();h.Yb(0,"fl-banner-alert",6),h.nc("close",function(){return h.Pc(e),h.rc().clearErrors.emit()}),h.Tb(1,"fl-generic-error",7),h.Xb()}if(2&e){const e=h.rc();h.zc("type",e.BannerAlertType.ERROR),h.Gb(1),h.zc("error",e.errorObject)}}let dt=(()=>{class e{constructor(){this.BannerAlertType=st.c,this.ThreadErrorType=at.b,this.clearErrors=new h.n}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-thread-view-errors"]],inputs:{errorType:"errorType",errorObject:"errorObject"},outputs:{clearErrors:"clearErrors"},decls:4,vars:4,consts:function(){let e,t,n;return e="Please enter a message",t="Unfortunately, you are not allowed to send a message to this thread.",n="Message sending failed.",[[3,"ngSwitch"],["bannerTitle",e,3,"type","close",4,"ngSwitchCase"],["bannerTitle",t,3,"type","close",4,"ngSwitchCase"],["bannerTitle",n,3,"type","close",4,"ngSwitchCase"],["bannerTitle",e,3,"type","close"],["bannerTitle",t,3,"type","close"],["bannerTitle",n,3,"type","close"],[3,"error"]]},template:function(e,t){1&e&&(h.Wb(0,0),h.Zc(1,rt,1,1,"fl-banner-alert",1),h.Zc(2,ct,1,1,"fl-banner-alert",2),h.Zc(3,lt,2,2,"fl-banner-alert",3),h.Vb()),2&e&&(h.zc("ngSwitch",t.errorType),h.Gb(1),h.zc("ngSwitchCase",t.ThreadErrorType.ATTACHMENT_WITH_NO_MESSSAGE),h.Gb(1),h.zc("ngSwitchCase",t.ThreadErrorType.USER_NOT_ALLOWED),h.Gb(1),h.zc("ngSwitchCase",t.ThreadErrorType.GENERIC_ERROR))},directives:[i.s,i.t,st.a,ot.b],styles:["[_nghost-%COMP%]{display:block;width:100vw}@media (min-width:768px){[_nghost-%COMP%]{width:auto}}"],changeDetection:0}),e})();var ht=n("5f+h");function gt(e,t){if(1&e&&(h.Wb(0),h.cc(1,3),h.Vb()),2&e){const e=h.rc(2);h.Gb(1),h.gc(e.usersTyping[0].displayName),h.dc(1)}}function ut(e,t){if(1&e&&(h.Wb(0),h.cc(1,4),h.Vb()),2&e){const e=h.rc(2);h.Gb(1),h.gc(e.usersTyping[0].displayName),h.dc(1)}}function bt(e,t){if(1&e&&(h.Wb(0),h.cc(1,5),h.Vb()),2&e){const e=h.rc(2);h.Gb(1),h.gc(e.usersTyping[0].displayName)(e.usersTyping.length-1),h.dc(1)}}function ft(e,t){if(1&e&&(h.Yb(0,"fl-text",1),h.Zc(1,gt,2,1,"ng-container",2),h.Zc(2,ut,2,1,"ng-container",2),h.Zc(3,bt,2,2,"ng-container",2),h.Xb()),2&e){const e=h.rc();h.zc("color",e.FontColor.MID)("highlightColor",e.HighlightColor.BLUE)("size",e.TextSize.XSMALL),h.Gb(1),h.zc("ngIf",1===e.usersTyping.length),h.Gb(1),h.zc("ngIf",2===e.usersTyping.length),h.Gb(1),h.zc("ngIf",e.usersTyping.length>2)}}let pt=(()=>{class e{constructor(){this.FontColor=M.a,this.HighlightColor=M.b,this.TextSize=C.f}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Mb({type:e,selectors:[["app-messaging-typing-indicator"]],inputs:{usersTyping:"usersTyping"},decls:1,vars:1,consts:function(){let e,t,n;return e=" " + "\ufffd0\ufffd" + " is typing... ",t=" " + "\ufffd0\ufffd" + " and 1 other are typing... ",n=" " + "\ufffd0\ufffd" + " and " + "\ufffd1\ufffd" + " others are typing... ",[["class","TypingIndicator",3,"color","highlightColor","size",4,"ngIf"],[1,"TypingIndicator",3,"color","highlightColor","size"],[4,"ngIf"],e,t,n]},template:function(e,t){1&e&&h.Zc(0,ft,4,6,"fl-text",0),2&e&&h.zc("ngIf",null==t.usersTyping?null:t.usersTyping.length)},directives:[i.q,C.e],styles:["[_nghost-%COMP%]{display:block}.TypingIndicator[_ngcontent-%COMP%]{padding:12px 16px}"],changeDetection:0}),e})();var mt=n("Uw4d"),Mt=n("Z13H"),Ct=n("puO/"),St=n("SMHo"),Tt=n("v5ZQ"),xt=n("5i9J"),yt=n("8FIo"),It=n("BFOf");let Ot=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=h.Qb({type:e}),e.\u0275inj=h.Pb({imports:[[i.c,a.a,s.j,o.a,l.b,mt.a,r.a,c.a,Mt.a,d.MessagingAddPeopleModalModule,le.a,he.MessagingGroupMembersModalModule,ce.MessagingRemoveUserModalModule]]}),e})();h.Tc(Ct.b,[i.q,x.a,f.a,i.o,ge.a,de.a,St.a,at.a,re.a,Tt.a,xt.a,yt.a,oe],[L.a]),h.Tc(at.a,[It.a,T.a,i.q,x.a,We.a,be.c,ue,it,pt,Se.a,P,dt,ht.a],[L.a])},n0rP:function(e,t,n){"use strict";var i,s,a,o,r,c;Object.defineProperty(t,"__esModule",{value:!0}),(c=t.SupportTypeApi||(t.SupportTypeApi={})).TECHNICAL="technical",c.RECRUITER="recruiter",c.GENERAL="general",c.LOCAL="local",c.DEPOSIT_FAILURE="deposit_failure",c.EQA="eqa",c.OFFSITE_MESSAGING="offsite_messaging",c.BRIEF_IMPROVEMENT="brief_improvement",c.META_MODERATE="meta_moderate",c.PFP_APPLICATIONS="pfp_applications",c.SALES="sales",c.PAYMENT_SATISFACTION="payment_satisfaction",c.PFP_TICKETS="pfp_tickets",c.PROJECT_QUALITY_AUDIT="project_quality_audit",c.MEMBERSHIP_CURATION="membership_curation",c.PROJECT_MANAGEMENT="project_management",c.EXPERT_FREELANCER_SCREENING="expert_freelancer_screening",c.ACCOUNT_CLOSURE="account_closure",c.SUCCESS_MANAGER="success_manager",c.PROFILE_PICTURE_CURATION="profile_picture_curation",c.DISCOVER="discover",c.PJP_ASSISTANT="pjp_assistant",c.ARROW_CONCIERGE="arrow_concierge",c.AWAITING_VERIFICATION="awaiting_verification",c.FREELANCER_VERIFIED="freelancer_verified",t.SupportExceptionCodesApi||(t.SupportExceptionCodesApi={}),(r=t.AgentStateApi||(t.AgentStateApi={})).DISABLED="disabled",r.AVAILABLE="available",r.UNAVAILABLE="unavailable",r.AWAY="away",(o=t.AgentOwnerTypeApi||(t.AgentOwnerTypeApi={})).FREELANCER_ADMIN="freelancer_admin",o.ARROW_SUPER_USER="arrow_super_user",(a=t.SourceTypeApi||(t.SourceTypeApi={})).USER="user",a.PROJECT="project",a.INVOICE="invoice",a.OFFSITE="offsite",a.TRANSACTION="transaction",a.TICKET="ticket",(s=t.AgentSessionStateApi||(t.AgentSessionStateApi={})).UNASSIGNED="unassigned",s.ASSIGNED="assigned",s.RESOLVED="resolved",(i=t.AgentSessionOrderByApi||(t.AgentSessionOrderByApi={})).SESSION_CREATE_TIME_ASC="session_create_time_asc",i.SESSION_CREATE_TIME_DSC="session_create_time_dsc",i.AGENT_SESSION_CREATE_TIME_ASC="agent_session_create_time_asc",i.AGENT_SESSION_CREATE_TIME_DSC="agent_session_create_time_dsc",i.AGENT_SESSION_RESOLVED_TIME_ASC="agent_session_resolved_time_asc",i.AGENT_SESSION_RESOLVED_TIME_DSC="agent_session_resolved_time_dsc"},nSbf:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("8Y7J"),s=n("fYbj"),a=n("NdQK"),o=n("7Siu"),r=n("HsDr"),c=n("B23V"),l=n("SVse"),d=n("w13q");function h(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-emoji",5),i.nc("click",function(){i.Pc(e);const n=t.$implicit;return i.rc(2).handleEmojiPick(n)}),i.Xb()}if(2&e){const e=t.$implicit,n=i.rc(2);i.zc("emoji",e)("size",n.EmojiSize.SMALL)}}function g(e,t){if(1&e&&(i.Yb(0,"fl-bit",3),i.Zc(1,h,1,2,"fl-emoji",4),i.Xb()),2&e){const e=i.rc();i.Gb(1),i.zc("ngForOf",e.emojiLongnameList)("ngForTrackBy",e.trackByValue)}}let u=(()=>{class e{constructor(e){this.elementRef=e,this.EmojiSize=a.b,this.IconColor=r.c,this.IconSize=r.e,this.HoverColor=r.a,this.trackByValue=s.n,this.disabled=!1,this.pickerSize=r.e.SMALL,this.emojiPicked=new i.n,this.emojiLongnameList=o.c,this.emojiPickerIsOpen=!1}handleClickOutsideEmojiPicker(e){this.emojiPickerIsOpen&&!this.elementRef.nativeElement.contains(e.target)&&(this.emojiPickerIsOpen=!1)}handleEmojiPick(e){this.emojiPickerIsOpen=!1,this.emojiPicked.emit(e)}handleEmojiButtonClick(){this.emojiPickerIsOpen=!this.emojiPickerIsOpen}}return e.\u0275fac=function(t){return new(t||e)(i.Sb(i.l))},e.\u0275cmp=i.Mb({type:e,selectors:[["fl-emoji-picker"]],hostBindings:function(e,t){1&e&&i.nc("click",function(e){return t.handleClickOutsideEmojiPicker(e)},!1,i.Nc)},inputs:{disabled:"disabled",pickerSize:"pickerSize"},outputs:{emojiPicked:"emojiPicked"},decls:3,vars:6,consts:function(){let e;return e="Pick an emoji",[["flTrackingLabel","emojiPicker","data-uitest-target","emojipicker-button",3,"disabled","click"],["label",e,3,"color","size","hoverColor","name"],["class","EmojiPicker-card","data-uitest-target","emojipicker",4,"ngIf"],["data-uitest-target","emojipicker",1,"EmojiPicker-card"],["class","EmojiPicker-item",3,"emoji","size","click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"EmojiPicker-item",3,"emoji","size","click"]]},template:function(e,t){1&e&&(i.Yb(0,"fl-button",0),i.nc("click",function(){return t.handleEmojiButtonClick()}),i.Tb(1,"fl-icon",1),i.Xb(),i.Zc(2,g,2,2,"fl-bit",2)),2&e&&(i.zc("disabled",t.disabled),i.Gb(1),i.zc("color",t.disabled?t.IconColor.MID:t.IconColor.DARK)("size",t.pickerSize)("hoverColor",t.HoverColor.PRIMARY)("name","ui-smile-outline"),i.Gb(1),i.zc("ngIf",t.emojiPickerIsOpen))},directives:[c.b,r.d,l.q,d.a,l.p,a.a],styles:["[_nghost-%COMP%]{position:relative}.EmojiPicker-card[_ngcontent-%COMP%]{align-items:center;background:#fff;border-radius:0;bottom:24px;box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12);display:flex;flex-wrap:wrap;height:140px;overflow-y:hidden;padding:8px;position:absolute;right:0;width:130px;z-index:1030}.EmojiPicker-item[_ngcontent-%COMP%]{cursor:pointer;padding:4px}.EmojiPicker-item[_ngcontent-%COMP%]:hover{background-color:#56c7ff;border-radius:0}.EmojiPicker-container[_ngcontent-%COMP%]{height:24px;position:relative;width:24px}"],changeDetection:0}),e})()},"puO/":function(e,t,n){"use strict";n.d(t,"a",function(){return p}),n.d(t,"b",function(){return m});var i=n("8Y7J"),s=n("tsv4"),a=n("2Vo4"),o=n("v5ZQ");function r(e,t){if(1&e&&i.Tb(0,"app-messaging-context-box",11),2&e){const e=i.rc(2);i.zc("flHide",e.currentScreen!==e.CurrentScreen.THREAD_VIEW)("contextBoxState",e.contextBoxState)}}function c(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-thread-view",12),i.nc("click",function(){i.Pc(e);const t=i.rc(2);return t.focusChat.emit(t.threadIdentifier)})("previewModalOpen",function(){return i.Pc(e),i.rc(2).unfocusChat.emit()})("previewModalClose",function(){i.Pc(e);const t=i.rc(2);return t.focusChat.emit(t.threadIdentifier)})("usersTyping",function(){return i.Pc(e),i.rc(2).markAsRead.emit()}),i.Xb()}if(2&e){const e=i.rc(2);i.zc("flHide",e.currentScreen!==e.CurrentScreen.THREAD_VIEW)("allChatMembers",e.allChatMembers)("chatboxMode",!0)("loggedInUser",e.loggedInUser)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("membersActivityStatus",e.membersActivityStatus)("thread",e.thread)("threadIdentifier",e.threadIdentifier)}}function l(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-chat-details",13),i.nc("makingCall",function(t){return i.Pc(e),i.rc(2).makingCall.emit(t)})("showAddPeopleScreen",function(){return i.Pc(e),i.rc(2).showAddPeopleScreen()})("showAllMembers",function(){return i.Pc(e),i.rc(2).showAllMembersScreen()})("removeMember",function(t){return i.Pc(e),i.rc(2).showRemoveMemberScreen(t)}),i.Xb()}if(2&e){const e=i.rc(2);i.zc("callsEnabled",e.callsEnabled)("canUserManageThreadMembers",e.canUserManageThreadMembers)("contextBoxState",e.contextBoxState)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("isLoggedInUserThreadOwner",e.isLoggedInUserThreadOwner)("isReportSettingEnabled",e.isReportSettingEnabled)("loggedInUser",e.loggedInUser)("otherMembers",e.activeOtherMembers)("supportAgent",e.supportAgent)("team",e.team)("thread",e.thread)("threadBidders",e.threadBidders)("threadCollaborators",e.threadCollaborators)("threadContacts",e.threadContacts)}}function d(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-add-people",14),i.nc("hideAddPeopleScreen",function(){return i.Pc(e),i.rc(2).hideAddPeopleScreen()})("addChatMembers",function(t){return i.Pc(e),i.rc(2).addChatMembers.emit(t)}),i.Xb()}if(2&e){const e=i.rc(2);i.zc("chatboxMode",!0)("isLoggedInUserSupportAgent",e.isLoggedInUserSupportAgent)("threadBidders",e.threadBidders)("threadCollaborators",e.threadCollaborators)("threadContacts",e.threadContacts)}}function h(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-group-members",15),i.nc("addPeople",function(){return i.Pc(e),i.rc(2).showAddPeopleScreen()})("removeMember",function(t){return i.Pc(e),i.rc(2).showRemoveMemberScreen(t)}),i.Xb()}if(2&e){const e=i.rc(2);i.zc("chatboxMode",!0)("loggedInUser",e.loggedInUser)("otherMembers",e.activeOtherMembers)("showAddPeopleCta",e.canUserManageThreadMembers)("showRemoveCta",e.isLoggedInUserThreadOwner)}}function g(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-remove-user",16),i.nc("cancel",function(){return i.Pc(e),i.rc(2).hideRemoveMemberScreen()})("removeMember",function(t){return i.Pc(e),i.rc(2).handleRemoveMember(t)}),i.sc(1,"flAsync"),i.Xb()}if(2&e){const e=i.rc(2);i.zc("chatboxMode",!0)("isLoggedInUserThreadOwner",e.isLoggedInUserThreadOwner)("user",i.tc(1,4,e.userToRemove$))("loggedInUser",e.loggedInUser)}}function u(e,t){if(1&e){const e=i.Zb();i.Yb(0,"app-messaging-chat-onboarding",17),i.nc("closeOnboarding",function(){return i.Pc(e),i.rc(2).closeOnboarding.emit()}),i.Xb()}if(2&e){const e=i.rc(2);i.zc("otherMember",e.privateChatOtherUser)("project",e.project)("thread",e.thread)("isHourlyProject",e.isHourlyProject)}}const b=function(e,t,n,i,s,a){return{IsArrowProject:e,IsFocused:t,IsRecruiter:n,IsThreadSupportSession:i,IsUnread:s,IsUserRecruiter:a}};function f(e,t){if(1&e){const e=i.Zb();i.Yb(0,"fl-bit",1),i.Yb(1,"fl-bit",2),i.Yb(2,"app-messaging-header",3),i.nc("click",function(){i.Pc(e);const t=i.rc();return t.minimiseChat.emit(t.threadIdentifier)})("closeChat",function(){i.Pc(e);const t=i.rc();return t.closeChat.emit(t.threadIdentifier)})("showChatDetails",function(){return i.Pc(e),i.rc().showChatDetails()})("back",function(){return i.Pc(e),i.rc().goBackToPreviousScreen()})("toggleSize",function(){i.Pc(e);const t=i.rc();return t.toggleSize.emit(t.threadIdentifier)}),i.Xb(),i.Xb(),i.Zc(3,r,1,2,"app-messaging-context-box",4),i.Zc(4,c,1,8,"app-messaging-thread-view",5),i.Zc(5,l,1,14,"app-messaging-chat-details",6),i.Zc(6,d,1,5,"app-messaging-add-people",7),i.Zc(7,h,1,5,"app-messaging-group-members",8),i.Zc(8,g,2,6,"app-messaging-remove-user",9),i.Zc(9,u,1,4,"app-messaging-chat-onboarding",10),i.Xb()}if(2&e){const e=i.rc();i.Gb(1),i.zc("ngClass",i.Ic(18,b,!(!e.project||!e.project.isArrowProject),e.isFocused,void 0!==e.supportAgent||"admin_preferred_chat"===e.thread.threadType,e.thread.context&&e.thread.contextType===e.ContextTypeApi.SUPPORT_SESSION,e.thread.messageUnreadCount>0,e.isLoggedInUserSupportAgent)),i.Gb(1),i.zc("contextBoxState",e.contextBoxState)("currentScreen",e.currentScreen)("isMinimised",e.isMinimised)("isOnboarding",e.showOnboarding)("loggedInUser",e.loggedInUser)("membersActivityStatus",e.membersActivityStatus)("otherMembers",e.activeOtherMembers)("project",e.project)("supportAgent",e.supportAgent)("thread",e.thread),i.Gb(1),i.zc("ngIf",!e.showOnboarding),i.Gb(1),i.zc("ngIf",!e.showOnboarding),i.Gb(1),i.zc("ngIf",e.currentScreen===e.CurrentScreen.CHAT_DETAILS&&!e.isMinimised),i.Gb(1),i.zc("ngIf",e.currentScreen===e.CurrentScreen.ADD_PEOPLE&&!e.isMinimised),i.Gb(1),i.zc("ngIf",e.currentScreen===e.CurrentScreen.ALL_GROUP_MEMBERS&&!e.isMinimised),i.Gb(1),i.zc("ngIf",(e.currentScreen===e.CurrentScreen.REMOVE_MEMBER||e.currentScreen===e.CurrentScreen.LEAVE_CHAT)&&!e.isMinimised),i.Gb(1),i.zc("ngIf",e.showOnboarding&&e.privateChatOtherUser)}}var p=function(e){return e[e.THREAD_VIEW=0]="THREAD_VIEW",e[e.CHAT_DETAILS=1]="CHAT_DETAILS",e[e.ADD_PEOPLE=2]="ADD_PEOPLE",e[e.ALL_GROUP_MEMBERS=3]="ALL_GROUP_MEMBERS",e[e.REMOVE_MEMBER=4]="REMOVE_MEMBER",e[e.LEAVE_CHAT=5]="LEAVE_CHAT",e}({});let m=(()=>{class e{constructor(){this.ContextTypeApi=s.ContextTypeApi,this.CurrentScreen=p,this.isReportSettingEnabled=!1,this.addChatMembers=new i.n,this.closeChat=new i.n,this.closeOnboarding=new i.n,this.focusChat=new i.n,this.unfocusChat=new i.n,this.minimiseChat=new i.n,this.toggleSize=new i.n,this.markAsRead=new i.n,this.makingCall=new i.n,this.removeChatMembers=new i.n,this.screenBacktrack=[p.THREAD_VIEW],this.currentScreen=p.THREAD_VIEW,this.userToRemoveSubject$=new a.a(void 0),this.userToRemove$=this.userToRemoveSubject$.asObservable()}showThreadView(){this.currentScreen=p.THREAD_VIEW,this.pushScreenToBacktrackStack(p.THREAD_VIEW)}showChatDetails(){this.currentScreen=p.CHAT_DETAILS,this.pushScreenToBacktrackStack(p.CHAT_DETAILS)}showAddPeopleScreen(){this.currentScreen=p.ADD_PEOPLE,this.pushScreenToBacktrackStack(p.ADD_PEOPLE)}hideAddPeopleScreen(){this.messagingAddPeopleComponent.clearSelectedUsers(),this.goBackToPreviousScreen()}showAllMembersScreen(){this.currentScreen=p.ALL_GROUP_MEMBERS,this.pushScreenToBacktrackStack(p.ALL_GROUP_MEMBERS)}showRemoveMemberScreen(e){this.userToRemoveSubject$.next(e),this.loggedInUser.id===e.id?(this.currentScreen=p.LEAVE_CHAT,this.pushScreenToBacktrackStack(p.LEAVE_CHAT)):(this.currentScreen=p.REMOVE_MEMBER,this.pushScreenToBacktrackStack(p.REMOVE_MEMBER))}hideRemoveMemberScreen(){this.userToRemoveSubject$.next(void 0),this.goBackToPreviousScreen()}goBackToPreviousScreen(){const e=this.popLastScreenFromBacktrackStack();this.currentScreen=this.screenBacktrack[this.screenBacktrack.length-1],e===p.ADD_PEOPLE&&this.messagingAddPeopleComponent.clearSelectedUsers()}pushScreenToBacktrackStack(e){this.screenBacktrack=[...this.screenBacktrack,e]}popLastScreenFromBacktrackStack(){const e=this.screenBacktrack.length-1,t=this.screenBacktrack[e];return this.screenBacktrack=this.screenBacktrack.slice(0,e),t}handleRemoveMember(e){this.removeChatMembers.emit([e.id])}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=i.Mb({type:e,selectors:[["app-messaging-chat-box"]],viewQuery:function(e,t){if(1&e&&i.id(o.a,1),2&e){let e;i.Lc(e=i.oc())&&(t.messagingAddPeopleComponent=e.first)}},inputs:{activeOtherMembers:"activeOtherMembers",allChatMembers:"allChatMembers",canUserManageThreadMembers:"canUserManageThreadMembers",contextBoxState:"contextBoxState",callsEnabled:"callsEnabled",isFocused:"isFocused",isHourlyProject:"isHourlyProject",isLoggedInUserSupportAgent:"isLoggedInUserSupportAgent",isLoggedInUserThreadOwner:"isLoggedInUserThreadOwner",isReportSettingEnabled:"isReportSettingEnabled",isMinimised:"isMinimised",loggedInUser:"loggedInUser",membersActivityStatus:"membersActivityStatus",privateChatOtherUser:"privateChatOtherUser",project:"project",supportAgent:"supportAgent",showOnboarding:"showOnboarding",team:"team",thread:"thread",threadBidders:"threadBidders",threadCollaborators:"threadCollaborators",threadContacts:"threadContacts",threadIdentifier:"threadIdentifier"},outputs:{addChatMembers:"addChatMembers",closeChat:"closeChat",closeOnboarding:"closeOnboarding",focusChat:"focusChat",unfocusChat:"unfocusChat",minimiseChat:"minimiseChat",toggleSize:"toggleSize",markAsRead:"markAsRead",makingCall:"makingCall",removeChatMembers:"removeChatMembers"},decls:1,vars:1,consts:[["class","ChatBox","flTrackingSection","Chatbox",4,"ngIf"],["flTrackingSection","Chatbox",1,"ChatBox"],[1,"HeaderColor",3,"ngClass"],[3,"contextBoxState","currentScreen","isMinimised","isOnboarding","loggedInUser","membersActivityStatus","otherMembers","project","supportAgent","thread","click","closeChat","showChatDetails","back","toggleSize"],[3,"flHide","contextBoxState",4,"ngIf"],["class","ChatBox-threadView",3,"flHide","allChatMembers","chatboxMode","loggedInUser","isLoggedInUserSupportAgent","membersActivityStatus","thread","threadIdentifier","click","previewModalOpen","previewModalClose","usersTyping",4,"ngIf"],["class","ChatDetails-content",3,"callsEnabled","canUserManageThreadMembers","contextBoxState","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isReportSettingEnabled","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","makingCall","showAddPeopleScreen","showAllMembers","removeMember",4,"ngIf"],[3,"chatboxMode","isLoggedInUserSupportAgent","threadBidders","threadCollaborators","threadContacts","hideAddPeopleScreen","addChatMembers",4,"ngIf"],[3,"chatboxMode","loggedInUser","otherMembers","showAddPeopleCta","showRemoveCta","addPeople","removeMember",4,"ngIf"],["class","RemoveUser",3,"chatboxMode","isLoggedInUserThreadOwner","user","loggedInUser","cancel","removeMember",4,"ngIf"],[3,"otherMember","project","thread","isHourlyProject","closeOnboarding",4,"ngIf"],[3,"flHide","contextBoxState"],[1,"ChatBox-threadView",3,"flHide","allChatMembers","chatboxMode","loggedInUser","isLoggedInUserSupportAgent","membersActivityStatus","thread","threadIdentifier","click","previewModalOpen","previewModalClose","usersTyping"],[1,"ChatDetails-content",3,"callsEnabled","canUserManageThreadMembers","contextBoxState","isLoggedInUserSupportAgent","isLoggedInUserThreadOwner","isReportSettingEnabled","loggedInUser","otherMembers","supportAgent","team","thread","threadBidders","threadCollaborators","threadContacts","makingCall","showAddPeopleScreen","showAllMembers","removeMember"],[3,"chatboxMode","isLoggedInUserSupportAgent","threadBidders","threadCollaborators","threadContacts","hideAddPeopleScreen","addChatMembers"],[3,"chatboxMode","loggedInUser","otherMembers","showAddPeopleCta","showRemoveCta","addPeople","removeMember"],[1,"RemoveUser",3,"chatboxMode","isLoggedInUserThreadOwner","user","loggedInUser","cancel","removeMember"],[3,"otherMember","project","thread","isHourlyProject","closeOnboarding"]],template:function(e,t){1&e&&i.Zc(0,f,10,25,"fl-bit",0),2&e&&i.zc("ngIf",t.threadIdentifier)},styles:["@keyframes pulse{10%{opacity:1}50%{opacity:.5}to{opacity:1}}.ChatBox[_ngcontent-%COMP%]{background:#fff;display:flex;flex-flow:column;height:100%;padding-bottom:env(safe-area-inset-bottom);width:100%}.ChatBox-threadView[_ngcontent-%COMP%]{height:calc(100% - 56px - 48px)}.HeaderColor[_ngcontent-%COMP%]{background-color:#4d525b;border-left:2px solid transparent;border-top:2px solid transparent;transition:background-color .3s linear}.HeaderColor.IsFocused[_ngcontent-%COMP%]{background-color:#0e1724}.HeaderColor.IsFocused.IsRecruiter[_ngcontent-%COMP%]{background-color:#7d30c9}.HeaderColor.IsFocused.IsRecruiter.IsThreadSupportSession.IsUserRecruiter[_ngcontent-%COMP%]{background-color:#000}.HeaderColor.IsFocused.IsRecruiter.IsThreadSupportSession.IsUserRecruiter.IsArrowProject[_ngcontent-%COMP%]{background-color:#eb3730}.HeaderColor.IsRecruiter[_ngcontent-%COMP%]{background-color:rgba(125,48,201,.5)}.HeaderColor.IsRecruiter.IsThreadSupportSession.IsUserRecruiter[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.5)}.HeaderColor.IsRecruiter.IsThreadSupportSession.IsUserRecruiter.IsArrowProject[_ngcontent-%COMP%]{background-color:rgba(235,55,48,.5)}.HeaderColor.IsUnread[_ngcontent-%COMP%]{animation:pulse 1.5s ease-in-out infinite}.RemoveUser[_ngcontent-%COMP%]{padding:24px}"],changeDetection:0}),e})()},rurT:function(e,t,n){"use strict";n.d(t,"a",function(){return we});var i=n("mrSG"),s=n("8Y7J"),a=n("4BSF"),o=n("97vJ"),r=n("fVXH"),c=n("3f1L"),l=n("riYv"),d=n("etQe"),h=n("UlxN"),g=n("tlTr"),u=n("7v0r"),b=n("9Aot"),f=n("4ykm"),p=n("2zwU"),m=n("Rnop"),M=n("o9eT"),C=n("f6cb"),S=n("tsv4"),T=n("DXEH"),x=n("ueDg"),y=n("n0rP"),I=n("b6KT"),O=n("2Vo4"),A=n("itXk"),v=n("VRyK"),w=n("LRne"),E=n("05l1"),z=n("x+ZX"),L=n("lJxs"),k=n("/uUt"),P=n("pLZG"),_=n("vkgz"),R=n("zp1y"),j=n("CqXF"),U=n("JX91"),B=n("5+tZ"),$=n("IzEk"),G=n("MmDv"),F=n("eCtd"),D=n("w792"),N=n("/wLE"),X=n("C825"),Y=n("WEYi"),H=n("DsW6"),V=n("3A0Z"),Z=n("YFxV"),W=n("LE8X"),q=n("HEOu"),Q=n("L1P6");const K=["typingBox"],J=["onboardingOverlay"],ee=["chatOptionsDrawer"];function te(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-header",11),s.nc("click",function(){return s.Pc(e),s.rc().toggleMinimised()})("closeChat",function(){return s.Pc(e),s.rc().close()})("handleSettingsHeaderClick",function(){s.Pc(e);const t=s.rc();return t.toggleOverlay(t.Overlay.SETTINGS)})("handleGroupchatHeaderClick",function(){s.Pc(e);const t=s.rc();return t.toggleOverlay(t.Overlay.GROUP)})("makingCall",function(t){return s.Pc(e),s.rc().passMakingCallState(t)}),s.sc(1,"flAsync"),s.sc(2,"flAsync"),s.sc(3,"flAsync"),s.sc(4,"flAsync"),s.sc(5,"flAsync"),s.sc(6,"flAsync"),s.sc(7,"flAsync"),s.sc(8,"flAsync"),s.sc(9,"flAsync"),s.sc(10,"flAsync"),s.sc(11,"flAsync"),s.sc(12,"flAsync"),s.sc(13,"flAsync"),s.Xb()}if(2&e){const e=s.rc();s.zc("callsEnabled",s.tc(1,16,e.callsEnabled$))("isMinimised",e.isMinimised)("thread",s.tc(2,18,e.attributes.thread$))("project",s.tc(3,20,e.projectDoc.valueChanges()))("contest",s.tc(4,22,e.contestDoc.valueChanges()))("agentSession",s.tc(5,24,e.agentSession$))("currentUserId",s.tc(6,26,e.currentUserId$))("currentUser",s.tc(7,28,e.currentUser$))("otherMembers",s.tc(8,30,e.otherMembers$))("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("focusState",e.attributes.focus)("isThreadOwner",s.tc(9,32,e.isThreadOwner$))("candidatesExist",s.tc(10,34,e.candidatesExist$))("team",s.tc(11,36,e.team$))("isUserSupportAgent",s.tc(12,38,e.isUserSupportAgent$))("supportAgentMembers",s.tc(13,40,e.supportAgentMembers$))}}function ne(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-messaging-inbox-header",12),s.nc("chatOptionsDrawerToggle",function(t){return s.Pc(e),s.rc().handleChatOptionsDrawerToggle(t)}),s.sc(1,"flAsync"),s.sc(2,"flAsync"),s.sc(3,"flAsync"),s.sc(4,"flAsync"),s.Xb()}if(2&e){const e=s.rc();s.zc("emptyState",!1)("isOnline",s.tc(1,6,e.onlineOffline$))("contextBoxState",s.tc(2,8,e.contextBoxState$))("isGroupChatThread",s.tc(3,10,e.isGroupChatThread$))("otherMembers",s.tc(4,12,e.otherMembers$))("flHideDesktop",!0)}}function ie(e,t){if(1&e&&(s.Yb(0,"fl-bit"),s.Tb(1,"app-context-box",20),s.Xb()),2&e){const e=t.$implicit,n=s.rc(3);s.Gb(1),s.zc("chatBoxMode",n.chatBoxMode)("state",e)}}function se(e,t){if(1&e&&(s.Wb(0),s.Zc(1,ie,2,2,"fl-bit",6),s.sc(2,"flAsync"),s.Vb()),2&e){const e=s.rc(2);s.Gb(1),s.zc("ngIf",s.tc(2,1,e.contextBoxState$))}}function ae(e,t){1&e&&(s.ic(0,25,1),s.Ub(1),s.fc())}function oe(e,t){1&e&&(s.ic(0,25,2),s.Ub(1),s.fc())}function re(e,t){1&e&&(s.ic(0,25,3),s.Wb(1),s.Tb(2,"fl-link",28),s.Vb(),s.fc()),2&e&&(s.Gb(2),s.zc("link","/support/"))}function ce(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-error-alert",24),s.nc("close",function(){return s.Pc(e),s.rc(3).clearThreadError()}),s.ic(1,25),s.Wb(2,21),s.Zc(3,ae,2,0,"ng-container",26),s.Zc(4,oe,2,0,"ng-container",26),s.Zc(5,re,3,1,"ng-container",27),s.Vb(),s.fc(),s.Xb()}if(2&e){const e=s.rc(3);s.Gb(2),s.zc("ngSwitch",e.error.code),s.Gb(1),s.zc("ngSwitchCase",e.ChatOperationError.FORBIDDEN),s.Gb(1),s.zc("ngSwitchCase",e.ChatOperationError.MESSAGE_REQUIRED)}}function le(e,t){1&e&&(s.ic(0,29,1),s.Ub(1),s.fc())}function de(e,t){1&e&&(s.ic(0,29,2),s.Wb(1),s.Tb(2,"fl-link",28),s.Vb(),s.fc()),2&e&&(s.Gb(2),s.zc("link","/support/"))}function he(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-error-alert",24),s.nc("close",function(){return s.Pc(e),s.rc(3).clearThreadError()}),s.ic(1,29),s.Wb(2,21),s.Zc(3,le,2,0,"ng-container",26),s.Zc(4,de,3,1,"ng-container",27),s.Vb(),s.fc(),s.Xb()}if(2&e){const e=s.rc(3);s.Gb(2),s.zc("ngSwitch",e.error.code),s.Gb(1),s.zc("ngSwitchCase",e.ChatOperationError.FORBIDDEN)}}function ge(e,t){if(1&e&&(s.Yb(0,"fl-bit",21),s.Zc(1,ce,6,3,"app-error-alert",22),s.Zc(2,he,5,2,"app-error-alert",23),s.Xb()),2&e){const e=s.rc(2);s.zc("ngSwitch",null==e.error?null:e.error.operation),s.Gb(1),s.zc("ngSwitchCase",e.ChatOperation.SEND_MESSAGE)}}const ue=function(e){return{"Inbox-typingBox":e}};function be(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-typing-box",30,31),s.nc("sendMessage",function(t){return s.Pc(e),s.rc(2).enqueueMessage(t)})("typingEvent",function(t){return s.Pc(e),s.rc(2).handleTypingEvent(t)})("focusTypingBox",function(){return s.Pc(e),s.rc(2).focusTypingBox()})("addAttachment",function(t){return s.Pc(e),s.rc(2).handleAddAttachment(t)}),s.sc(2,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2);s.zc("ngClass",s.Ec(12,ue,!e.chatBoxMode))("isChatBoxMode",e.chatBoxMode)("hasAttachments",e.messageAttachments.length>0)("thread",s.tc(2,10,e.attributes.thread$))("threadIdentifierKey",e.threadIdentifierKey)("flMarginBottom",e.Margin.NONE)("flSticky",!e.chatBoxMode)("flStickyBehaviour",e.StickyBehaviour.ALWAYS)("flStickyPosition",e.StickyPosition.BOTTOM)("flStickyFullWidth",!1)}}function fe(e,t){if(1&e&&(s.Yb(0,"fl-banner-alert",32),s.cc(1,33),s.Xb()),2&e){const e=s.rc(2);s.zc("type",e.BannerAlertType.WARNING)("closeable",!1)("flMarginBottom",e.Margin.XXSMALL)}}const pe=function(e){return{"Inbox-wrapper":e}};function me(e,t){if(1&e){const e=s.Zb();s.Yb(0,"fl-file-select",13),s.nc("onFileDropped",function(t){return s.Pc(e),s.rc().handleAddAttachment(t)}),s.sc(1,"flAsync"),s.Zc(2,se,3,3,"ng-container",6),s.Yb(3,"app-message-list",14),s.nc("previewModalClose",function(){s.Pc(e);const t=s.rc();return t.focusClick.emit(t.attributes.threadIdentifier)})("previewModalOpen",function(){return s.Pc(e),s.rc().blurClick.emit()})("resendMessage",function(t){return s.Pc(e),s.rc().handleMessageResend(t)})("loadMoreMessages",function(){return s.Pc(e),s.rc().handleLoadMessages()}),s.sc(4,"flAsync"),s.sc(5,"flAsync"),s.sc(6,"flAsync"),s.sc(7,"flAsync"),s.sc(8,"flAsync"),s.sc(9,"flAsync"),s.sc(10,"flAsync"),s.sc(11,"flAsync"),s.Xb(),s.Yb(12,"fl-bit",15),s.Yb(13,"app-attachment-list",16),s.nc("removeAttachment",function(t){return s.Pc(e),s.rc().handleRemoveAttachment(t)})("removeUpload",function(t){return s.Pc(e),s.rc().handleRemoveUpload(t)}),s.sc(14,"flAsync"),s.sc(15,"flAsync"),s.Xb(),s.Zc(16,ge,3,2,"fl-bit",17),s.Zc(17,be,3,14,"app-typing-box",18),s.sc(18,"flAsync"),s.sc(19,"flAsync"),s.Zc(20,fe,2,3,"fl-banner-alert",19),s.sc(21,"flAsync"),s.sc(22,"flAsync"),s.Xb(),s.Xb()}if(2&e){const e=s.rc();let t=null,n=null;s.zc("multiple",!0)("active",!e.attributes.threadIdentifier.isFake&&s.tc(1,20,e.fileUploadEnabled$)),s.Gb(2),s.zc("ngIf",e.chatBoxMode),s.Gb(1),s.zc("currentUserId",s.tc(4,22,e.currentUserId$))("usersTyping",e.usersTyping)("members",s.tc(5,24,e.allChatMembers$))("messages",s.tc(6,26,e.sortedMessages$))("otherMembers",s.tc(7,28,e.otherMembers$))("thread",s.tc(8,30,e.attributes.thread$))("chatBoxMode",e.chatBoxMode)("canLoadMore",s.tc(9,32,e.canLoadMore$))("showLoadingMoreSpinner",s.tc(10,34,e.messagesLoadingMore$))("useThumbnailService",s.tc(11,36,e.useThumbnailService$)),s.Gb(9),s.zc("ngClass",s.Ec(50,pe,!e.chatBoxMode)),s.Gb(1),s.zc("thread",s.tc(14,38,e.attributes.thread$))("attachments",e.messageAttachments)("uploads",s.tc(15,40,e.uploads$)),s.Gb(3),s.zc("ngIf",e.error),s.Gb(1),s.zc("ngIf",s.tc(18,42,e.isUserSupportAgent$)||"none"!==(null==(t=s.tc(19,44,e.attributes.thread$))?null:t.writePrivacy)),s.Gb(3),s.zc("ngIf",!s.tc(21,46,e.isUserSupportAgent$)&&"none"===(null==(n=s.tc(22,48,e.attributes.thread$))?null:n.writePrivacy))}}function Me(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-onboarding-overlay",37,38),s.nc("closeOverlay",function(){return s.Pc(e),s.rc(2).closeOnboardingOverlay()}),s.sc(2,"flAsync"),s.sc(3,"flAsync"),s.sc(4,"flAsync"),s.sc(5,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2);s.zc("hourlyContracts",s.tc(2,4,e.hourlyContracts$))("thread",s.tc(3,6,e.attributes.thread$))("otherMembers",s.tc(4,8,e.otherMembers$))("project",s.tc(5,10,e.projectDoc.valueChanges()))}}function Ce(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-groupchat-overlay",39),s.nc("hideGroupchatOverlay",function(){s.Pc(e);const t=s.rc(2);return t.toggleOverlay(t.Overlay.GROUP)})("modifyMembers",function(t){return s.Pc(e),s.rc(2).modifyMembers(t)}),s.sc(1,"flAsync"),s.sc(2,"flAsync"),s.sc(3,"flAsync"),s.sc(4,"flAsync"),s.sc(5,"flAsync"),s.sc(6,"flAsync"),s.sc(7,"flAsync"),s.sc(8,"flAsync"),s.sc(9,"flAsync"),s.sc(10,"flAsync"),s.sc(11,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2);s.zc("participants",s.tc(1,12,e.members$))("isThreadOwner",s.tc(2,14,e.isThreadOwner$))("isRecruiter",s.tc(3,16,e.isUserSupportAgent$))("candidatesExist",s.tc(4,18,e.candidatesExist$))("currentUser",s.tc(5,20,e.currentUser$))("candidateBidders",s.tc(6,22,e.bidders$))("candidateContacts",s.tc(7,24,e.contacts$))("candidateCollaborators",s.tc(8,26,e.collaborators$))("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("thread",s.tc(9,28,e.attributes.thread$))("team",s.tc(10,30,e.team$))("showAddPeopleOption",s.tc(11,32,e.showAddPeopleOption$))}}function Se(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-settings-overlay",40),s.nc("archiveChatToggle",function(){return s.Pc(e),s.rc(2).archiveChatToggle()})("blockChatToggle",function(){return s.Pc(e),s.rc(2).blockChatToggle()})("muteChatToggle",function(){return s.Pc(e),s.rc(2).muteChatToggle()})("hideSettingsOverlay",function(){s.Pc(e);const t=s.rc(2);return t.toggleOverlay(t.Overlay.SETTINGS)}),s.sc(1,"flAsync"),s.sc(2,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2);s.zc("showReportCta",s.tc(1,2,e.showReportCta$))("thread",s.tc(2,4,e.attributes.thread$))}}function Te(e,t){if(1&e&&(s.Wb(0),s.Zc(1,Me,6,12,"app-onboarding-overlay",34),s.sc(2,"flAsync"),s.Zc(3,Ce,12,34,"app-groupchat-overlay",35),s.sc(4,"flAsync"),s.Zc(5,Se,3,6,"app-settings-overlay",36),s.sc(6,"flAsync"),s.Vb()),2&e){const e=s.rc();s.Gb(1),s.zc("ngIf",s.tc(2,3,e.showOnboardingOverlay$)),s.Gb(2),s.zc("ngIf","group"===e.activeOverlay&&!s.tc(4,5,e.showOnboardingOverlay$)),s.Gb(2),s.zc("ngIf","settings"===e.activeOverlay&&!s.tc(6,7,e.showOnboardingOverlay$))}}function xe(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-messaging-sidebar",41),s.nc("archiveChatToggle",function(){return s.Pc(e),s.rc().archiveChatToggle()})("blockChatToggle",function(){return s.Pc(e),s.rc().blockChatToggle()})("muteChatToggle",function(){return s.Pc(e),s.rc().muteChatToggle()})("userAdd",function(){return s.Pc(e),s.rc().popManagementModal()})("userRemove",function(t){return s.Pc(e),s.rc().handleUserRemoved(t)}),s.sc(1,"flAsync"),s.sc(2,"flAsync"),s.sc(3,"flAsync"),s.sc(4,"flAsync"),s.sc(5,"flAsync"),s.sc(6,"flAsync"),s.sc(7,"flAsync"),s.sc(8,"flAsync"),s.sc(9,"flAsync"),s.sc(10,"flAsync"),s.Xb()}if(2&e){const e=s.rc();s.zc("candidatesExist",s.tc(1,14,e.candidatesExist$))("contextBoxState",s.tc(2,16,e.contextBoxState$))("currentUser",s.tc(3,18,e.currentUser$))("isRecruiter",s.tc(4,20,e.isUserSupportAgent$))("isThreadOwner",s.tc(5,22,e.isThreadOwner$))("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("showReportCta",s.tc(6,24,e.showReportCta$))("thread",s.tc(7,26,e.attributes.thread$))("threadId$",e.threadId$)("members",s.tc(8,28,e.members$))("team",s.tc(9,30,e.team$))("showAddPeopleOption",s.tc(10,32,e.showAddPeopleOption$))("flHideTablet",!0)("flHideMobile",!0)}}function ye(e,t){if(1&e){const e=s.Zb();s.Yb(0,"app-messaging-sidebar",43),s.nc("archiveChatToggle",function(){return s.Pc(e),s.rc(2).archiveChatToggle()})("blockChatToggle",function(){return s.Pc(e),s.rc(2).blockChatToggle()})("muteChatToggle",function(){return s.Pc(e),s.rc(2).muteChatToggle()})("userAdd",function(){return s.Pc(e),s.rc(2).popManagementModal()})("userRemove",function(t){return s.Pc(e),s.rc(2).handleUserRemoved(t)}),s.sc(1,"flAsync"),s.sc(2,"flAsync"),s.sc(3,"flAsync"),s.sc(4,"flAsync"),s.sc(5,"flAsync"),s.sc(6,"flAsync"),s.sc(7,"flAsync"),s.sc(8,"flAsync"),s.sc(9,"flAsync"),s.sc(10,"flAsync"),s.Xb()}if(2&e){const e=s.rc(2);s.zc("candidatesExist",s.tc(1,12,e.candidatesExist$))("contextBoxState",s.tc(2,14,e.contextBoxState$))("currentUser",s.tc(3,16,e.currentUser$))("isRecruiter",s.tc(4,18,e.isUserSupportAgent$))("isThreadOwner",s.tc(5,20,e.isThreadOwner$))("onlineOfflineStatuses$",e.onlineOfflineStatuses$)("showReportCta",s.tc(6,22,e.showReportCta$))("thread",s.tc(7,24,e.attributes.thread$))("threadId$",e.threadId$)("members",s.tc(8,26,e.members$))("team",s.tc(9,28,e.team$))("showAddPeopleOption",s.tc(10,30,e.showAddPeopleOption$))}}function Ie(e,t){if(1&e&&s.Zc(0,ye,11,32,"app-messaging-sidebar",42),2&e){const e=s.rc();s.zc("ngIf",!e.chatBoxMode)}}var Oe=function(e){return e.ARCHIVE_CHAT="archive-chat",e.BLOCK_CHAT="block-chat",e.MUTE_CHAT="mute-chat",e.SEND_MESSAGE="send-message",e}({}),Ae=function(e){return e.FORBIDDEN="FORBIDDEN",e.UNKNOWN="UNKNOWN_ERROR",e.MESSAGE_REQUIRED="MESSAGE_REQUIRED",e}({}),ve=function(e){return e.GROUP="group",e.SETTINGS="settings",e}({});let we=(()=>{class e{constructor(e,t,n,i,a,o,r,c,l,d,g,f){this.environment=e,this.datastore=t,this.auth=n,this.abtestService=i,this.fileUpload=a,this.webSocketService=o,this.tracking=r,this.modalService=c,this.timeUtils=l,this.userAgent=d,this.featureFlagService=g,this.localStorage=f,this.Margin=b.a,this.FontColor=m.a,this.FontWeight=M.c,this.TextSize=M.f,this.Overlay=ve,this.TextAlign=M.d,this.BannerAlertType=u.c,this.ChatOperation=Oe,this.ChatOperationError=Ae,this.Feature=h.b,this.StickyBehaviour=p.a,this.StickyPosition=p.c,this.closeChat=new s.n,this.minimiseChat=new s.n,this.makingCall=new s.n,this.blurClick=new s.n,this.focusClick=new s.n,this.chatBoxMode=!0,this.isMinimised=!1,this.usersTyping={},this.lastSentTyping=0,this.projectOverlayClosedSubject$=new O.a(!1),this.messageSendQueue=[],this.messageSendQueueSubject$=new O.a([]),this.messageSend$=this.messageSendQueueSubject$.asObservable().pipe(Object(E.a)(1),Object(z.a)()),this.messageErrorQueue=[],this.messageErrorQueueSubject$=new O.a([]),this.messageError$=this.messageErrorQueueSubject$.asObservable().pipe(Object(E.a)(1),Object(z.a)()),this.defaultLimit=50,this.limitIncreaseStep=50,this.maxLimit=5e3,this.currentLimit=this.defaultLimit,this.messagesLimitSubject$=new O.a(this.defaultLimit),this.XXX_SKILL_ID=88,this.PROD_RECRUITER_USER_IDS_WHITELIST=[35863928,29840291,25020397,24369472],this.DEV_RECRUITER_USER_IDS_WHITELIST=[30760668,31624149]}ngOnInit(){this.fileUploadEnabled$=this.featureFlagService.getFlag(h.b.FILEUPLOAD),this.preAwardAudioCallFeatureEnabled$=this.featureFlagService.getFlag(h.b.PRE_AWARD_AUDIO_CALL),this.threadIdentifierKey=Object(I.d)(this.attributes.threadIdentifier),this.currentUserId$=this.auth.getUserId(),this.threadId$=this.attributes.thread$.pipe(Object(L.a)(e=>e.id),Object(k.a)()),this.isGroupChatThread$=this.attributes.thread$.pipe(Object(L.a)(e=>e.threadType===S.ThreadTypeApi.GROUP||e.threadType===S.ThreadTypeApi.TEAM)),this.useThumbnailService$=this.currentUserId$.pipe(Object(L.a)(e=>this.abtestService.isWhitelistUser()||this.abtestService.shouldEnrol("T90189-image-thumbnail-service",e,.01))),this.threadCloseSubscription=A.a([this.attributes.threadCollection.valueChanges(),this.attributes.thread$]).subscribe(([e,t])=>{0!==e.length||t.isFake||this.close()}),this.fileUploadSession=this.fileUpload.createSession(),this.files$=this.fileUploadSession.files$,this.uploads$=this.fileUploadSession.uploads$,this.messageAttachmentsSubscription=this.files$.subscribe(e=>this.messageAttachments=e),this.allChatMembers$=this.datastore.collection("users",this.attributes.thread$.pipe(Object(L.a)(e=>[...e.inactiveMembers.map(e=>e.toString()),...e.members.map(e=>e.toString())]))).valueChanges().pipe(Object(E.a)(1),Object(z.a)(),Object(o.a)()),this.onlineOfflineStatuses$=this.datastore.collection("onlineOffline",this.attributes.thread$.pipe(Object(L.a)(e=>e.members))).valueChanges(),this.members$=A.a([this.allChatMembers$,this.attributes.thread$]).pipe(Object(L.a)(([e,t])=>e.filter(e=>t.members.includes(e.id)))),this.nonGroupChat$=this.members$.pipe(Object(L.a)(e=>2===e.length)),this.currentUser$=A.a([this.members$,this.currentUserId$]).pipe(Object(L.a)(([e,t])=>e.find(e=>e.id===Object(C.s)(t))),Object(P.a)(C.h)),this.otherMembers$=A.a([this.members$,this.currentUserId$]).pipe(Object(L.a)(([e,t])=>e.filter(e=>e.id!==Object(C.s)(t)))),this.otherUserId$=this.otherMembers$.pipe(Object(L.a)(e=>e[0]),Object(P.a)(C.h),Object(L.a)(e=>e.id));const e=this.datastore.document("projectViewUsers",this.otherUserId$).valueChanges();this.onlineOffline$=this.datastore.document("onlineOffline",this.otherUserId$).valueChanges().pipe(Object(L.a)(e=>e.status===l.OnlineOfflineStatusApi.ONLINE)),this.isThreadOwner$=A.a([this.attributes.thread$,this.currentUserId$]).pipe(Object(L.a)(([e,t])=>!e.isFake&&e.owner===Object(C.s)(t))),this.agentSession$=this.datastore.collection("agentSessions",e=>e.where("sessionId","==",this.attributes.thread$.pipe(Object(L.a)(({context:e})=>e),Object(L.a)(e=>e&&e.type===S.ContextTypeApi.SUPPORT_SESSION?e.id:void 0),Object(P.a)(C.h)))).valueChanges().pipe(Object(L.a)(e=>e[0]),Object(P.a)(C.h)),this.supportAgentMembers$=this.datastore.collection("agents",e=>e.where("userId","in",this.members$.pipe(Object(L.a)(e=>e.map(e=>e.id)))).where("state","in",[y.AgentStateApi.AVAILABLE,y.AgentStateApi.AWAY,y.AgentStateApi.UNAVAILABLE])).valueChanges(),this.isUserSupportAgent$=A.a([this.currentUserId$.pipe(Object(L.a)(C.s),Object(P.a)(C.h)),this.supportAgentMembers$]).pipe(Object(L.a)(([e,t])=>t.some(t=>t.userId===e))),this.messagesCollection=this.datastore.collection("messages",e=>this.attributes.thread$.pipe(Object(P.a)(e=>!e.isFake&&e.id>0),Object(L.a)(e=>e.id),Object(k.a)(),Object(_.a)(()=>{this.currentLimit=this.defaultLimit,this.messagesLimitSubject$.next(this.currentLimit)}),Object(L.a)(t=>e.where("threadId","==",t).limit(this.messagesLimitSubject$.asObservable())))),this.messagesLoadingMore$=this.messagesCollection.status$.pipe(Object(L.a)(e=>!e.ready)),this.canLoadMore$=this.messagesCollection.valueChanges().pipe(Object(L.a)(e=>this.currentLimit<this.maxLimit&&e.length>=this.currentLimit)),this.sortedMessages$=A.a([A.a([this.messagesCollection.valueChanges(),this.messageError$,this.threadId$]).pipe(Object(L.a)(([e,t,n])=>{const i=t.filter(e=>e.threadId===n),s=new Set(e.map(e=>e.clientMessageId)),[a,o]=Object(C.q)(i,e=>s.has(e.clientMessageId));a.length>0&&(this.messageErrorQueue=[...o],this.messageErrorQueueSubject$.next(this.messageErrorQueue));const r=[...e,...o].sort((e,t)=>e.timeCreated===t.timeCreated?e.id-t.id:e.timeCreated-t.timeCreated),c={};return r.reduceRight((e,t)=>{const n=JSON.parse(JSON.stringify(t));return n.richMessage&&(c[n.richMessage.category]&&(n.richMessage.disabled=!0),c[n.richMessage.category]=!0),[n,...e]},[])})),this.messageSend$]).pipe(Object(L.a)(([e,t])=>{const n=new Set(e.map(e=>e.clientMessageId)),i=t.filter(e=>!n.has(e.clientMessageId));return e.concat(i)})),this.typingSubscription=this.webSocketService.fromServerStream$.pipe(Object(P.a)(r.a),Object(R.a)(this.threadId$),Object(P.a)(([e,t])=>"messages"===e.body.parent_type&&"typing"===e.body.type&&e.body.data.thread===t)).subscribe(([e,t])=>{this.usersTyping[e.body.data.from_user]=A.a([this.timeUtils.rxTimer(5e3).pipe(Object(j.a)(!1),Object(U.a)(!0)),this.sortedMessages$.pipe(Object(L.a)(e=>e.filter(e=>e.sendStatus===d.a.SENT))),this.attributes.thread$.pipe(Object(L.a)(e=>e.userReadTimes))]).pipe(Object(L.a)(([t,n,i])=>{const s=e.body.data.from_user,a=n.pop();return t&&!!a&&i[s]>=a.timeCreated&&(a.fromUser!==s||1e3*e.body.timestamp>a.timeCreated)}))}),this.autochatTracking=this.sortedMessages$.subscribe(e=>{const t=e[e.length-1];t&&("autochat"===t.messageSource||t.richMessage&&t.richMessage.category&&t.richMessage.category.startsWith("AUTOCHAT"))&&"project"===this.attributes.threadIdentifier.context.type&&t.fromUser!==Object(C.s)(this.currentUserIdValue)&&this.tracking.track("user_action",{reference:"project_id",reference_id:this.attributes.threadIdentifier.context.id,section:"ProjectViewPage",subsection:"AutoChat",label:"ShowChatBox",name:"user_id",value:t.fromUser})}),this.contacts$=A.a([this.allContacts$,this.attributes.thread$]).pipe(Object(L.a)(([e,t])=>e.filter(e=>!t.members.includes(e.id)))),this.isDeloitteUser$=this.datastore.document("users",this.auth.getUserId()).valueChanges().pipe(Object(L.a)(e=>!!e.isDeloitteDcUser));const t=v.a(this.attributes.thread$.pipe(Object(L.a)(({context:e})=>e),Object(L.a)(e=>e&&e.type===S.ContextTypeApi.PROJECT?e.id:void 0),Object(P.a)(C.h)),this.agentSession$.pipe(Object(P.a)(e=>e.sessionSourceType===y.SourceTypeApi.PROJECT),Object(L.a)(e=>e.sessionSourceId)));this.projectDoc=this.datastore.document("threadProjects",t);const n=this.projectDoc.valueChanges().pipe(Object(L.a)(e=>e.ownerId)),i=A.a([n,this.otherUserId$,this.currentUser$.pipe(Object(L.a)(e=>Object(C.s)(e.id)))]).pipe(Object(L.a)(([e,t,n])=>e===n?t:n),Object(k.a)());this.userAwardedBidCollection=this.datastore.collection("bids",e=>e.where("projectId","==",t).where("awardStatus","==",x.BidAwardStatusApi.AWARDED).where("bidderId","==",i)),this.contestDoc=this.datastore.document("contests",this.attributes.thread$.pipe(Object(L.a)(({context:e})=>e),Object(P.a)(C.h),Object(P.a)(e=>"contest"===e.type),Object(L.a)(e=>"contest"===e.type&&e.id||void 0),Object(P.a)(C.h)));const s=this.datastore.collection("bids",e=>e.where("projectId","==",this.projectDoc.valueChanges().pipe(Object(L.a)(e=>e.id)))),g=A.a([s.valueChanges(),this.attributes.thread$]).pipe(Object(L.a)(([e,t])=>e.map(e=>e.bidderId).filter(e=>!t.members.includes(e)).filter(e=>void 0!==e)),Object(P.a)(e=>e.length>0)),u=this.datastore.collection("milestones",e=>A.a([this.projectDoc.valueChanges(),this.currentUserId$]).pipe(Object(L.a)(([n,i])=>n.ownerId===Object(C.s)(i)?e.where("projectId","==",t):e.where("projectId","==",t).where("bidderId","==",Object(C.s)(i))))),b=this.datastore.collection("milestoneRequests",e=>A.a([this.projectDoc.valueChanges(),this.currentUserId$]).pipe(Object(L.a)(([n,i])=>n.ownerId===Object(C.s)(i)?e.where("projectId","==",t):e.where("projectId","==",t).where("bidderId","==",Object(C.s)(i))))),f=this.datastore.collection("hourlyContracts",e=>e.where("projectId","==",this.projectDoc.valueChanges().pipe(Object(P.a)(C.h),Object(P.a)(e=>e.type===x.ProjectTypeApi.HOURLY),Object(L.a)(e=>e.id))).where("bidderId","==",i));this.hourlyContracts$=f.valueChanges();const p=this.datastore.collection("bids",e=>e.where("projectId","==",t).where("bidderId","==",i)),m=this.datastore.collection("invoices",e=>e.where("projectId","==",t).where("freelancerId","==",i).where("milestoneLinkedStatus","==",T.ProjectInvoiceMilestoneLinkedStatusesApi.UNLINKED).limit(1)),M=this.currentUserId$.pipe(Object(L.a)(e=>this.environment===a.d.PROD?this.PROD_RECRUITER_USER_IDS_WHITELIST.includes(Object(C.s)(e)):this.environment===a.d.DEV&&this.DEV_RECRUITER_USER_IDS_WHITELIST.includes(Object(C.s)(e))));this.stateManagerSubscription=M.subscribe(e=>{this.stateManager=new G.b(this.auth,this.attributes.thread$,this.members$,this.projectDoc.valueChanges(),this.contestDoc.valueChanges(),p.valueChanges(),u.valueChanges(),b.valueChanges(),this.hourlyContracts$,this.agentSession$,this.team$,m.valueChanges(),e?this.tracking:void 0)}),this.contextBoxState$=this.stateManager.getState(),this.bidders$=this.datastore.collection("users",g).valueChanges().pipe(Object(E.a)(1),Object(z.a)(),Object(o.a)());const O=A.a([this.projectDoc.valueChanges(),this.attributes.thread$]).pipe(Object(L.a)(([e,t])=>(e.projectCollaborations||[]).map(e=>e.userId||-1).filter(e=>e>0&&!t.members.includes(e))),Object(P.a)(e=>e.length>0));this.collaborators$=this.datastore.collection("users",O).valueChanges().pipe(Object(E.a)(1),Object(z.a)(),Object(o.a)());const w=this.userAwardedBidCollection.valueChanges().pipe(Object(L.a)(e=>e.length>0),Object(U.a)(!1)),B=A.a([this.currentUserId$,n]).pipe(Object(L.a)(([e,t])=>Object(C.s)(e)===t),Object(U.a)(!1)),$=A.a([w,B,e,this.preAwardAudioCallFeatureEnabled$]).pipe(Object(L.a)(([e,t,n,i])=>!e&&t&&(n.preferredFreelancer&&n.status.freelancerVerifiedUser||i)),Object(U.a)(!1)),F=this.projectDoc.valueChanges().pipe(Object(L.a)(e=>!e.skills.map(e=>e.id).includes(this.XXX_SKILL_ID)),Object(U.a)(!1)),D=this.datastore.document("membershipBenefits","free_pre_awarded_voip").valueChanges().pipe(Object(L.a)(e=>0!==e.value));this.callsEnabled$=Object(c.a)([w,this.nonGroupChat$,this.onlineOffline$,this.inCall$,this.isUserSupportAgent$,this.attributes.thread$,F,$,D,B]).pipe(Object(L.a)(([e,t,n,i,s,a,o,r,c,l])=>{const d=this.attributes.threadIdentifier.isFake;let h="";if(t?s?h="":"none"===a.writePrivacy?h="Thread is blocked":e?n?this.isCallSupportedBrowser()?i?h="Already in a call":o?d&&(h="Start chatting to enable calls"):h="Not allowed for this project":h="Your browser is unsupported":h="The user is offline":h="Awarded and accepted projects only":h="Private chats only",s&&t)return{audio:{enabled:!0,recorded:!1},video:{enabled:!0,recorded:!1},reason:h};const g=t&&n&&this.isCallSupportedBrowser()&&!i&&"none"!==a.writePrivacy&&o&&!d,u=g&&c&&l,b=("admin_preferred_chat"===a.threadType||!s)&&g;return{audio:{enabled:(e||r)&&b||u,recorded:r&&b},video:{enabled:!s&&"admin_preferred_chat"!==a.threadType&&e&&g||u,recorded:!1},reason:h}}),Object(U.a)({audio:{enabled:!1,recorded:!1},video:{enabled:!1,recorded:!1}}),Object(E.a)(1),Object(z.a)()),this.candidatesExist$=A.a([this.contacts$,this.collaborators$,this.bidders$]).pipe(Object(L.a)(e=>e.some(e=>e.length>0))),this.showOnboardingOverlay$=Object(c.a)([this.projectOverlayClosedSubject$,s.valueChanges(),this.currentUserId$,this.attributes.thread$,this.localStorage.get("projectOverlayThreadComplete"),this.isDeloitteUser$,this.projectDoc.valueChanges().pipe(Object(L.a)(e=>e.isInsourceProject))]).pipe(Object(L.a)(([e,t,n,i,s,a,o])=>this.chatBoxMode&&!e&&"project"===i.context.type&&"private_chat"===i.threadType&&!(s&&s[i.id])&&void 0!==t.find(e=>e.bidderId===Object(C.s)(n))&&!a&&!o)),this.showAddPeopleOption$=A.a([this.attributes.thread$,this.team$.pipe(Object(U.a)(void 0)),this.isThreadOwner$,this.isUserSupportAgent$,this.candidatesExist$]).pipe(Object(L.a)(([e,t,n,i,s])=>e.context.type!==S.ContextTypeApi.NONE&&(!!(e.context.type===S.ContextTypeApi.TEAM&&e.threadType!==S.ThreadTypeApi.TEAM_OFFICIAL||e.threadType===S.ThreadTypeApi.TEAM&&t)||e.threadType!==S.ThreadTypeApi.TEAM_OFFICIAL&&(n&&s||i))));const N=this.attributes.thread$.pipe(Object(L.a)(({context:e})=>e),Object(L.a)(e=>e&&e.type===S.ContextTypeApi.PROJECT?e.id:void 0),Object(P.a)(C.h)),X=this.datastore.document("projectViewProjects",N);this.showReportCta$=A.a([this.attributes.thread$,X.valueChanges().pipe(Object(U.a)(void 0)),this.contestDoc.valueChanges().pipe(Object(U.a)(void 0))]).pipe(Object(L.a)(([e,t,n])=>{const i=e.context.type===S.ContextTypeApi.CONTEST&&e.context.id===(null==n?void 0:n.id);if(e.context.type===S.ContextTypeApi.PROJECT&&e.context.id===(null==t?void 0:t.id)){const e=null==t?void 0:t.projectCollaborations.some(e=>e.status===x.ProjectCollaborationStatusApi.ACTIVE&&e.userId===Object(C.s)(this.currentUserIdValue));return!((null==t?void 0:t.ownerId)===Object(C.s)(this.currentUserIdValue)||e)}return!!i&&(null==n?void 0:n.ownerId)!==Object(C.s)(this.currentUserIdValue)}),Object(U.a)(!1),Object(k.a)())}ngOnDestroy(){this.autochatTracking&&this.autochatTracking.unsubscribe(),this.threadCloseSubscription&&this.threadCloseSubscription.unsubscribe(),this.messageAttachmentsSubscription&&this.messageAttachmentsSubscription.unsubscribe(),this.typingSubscription&&this.typingSubscription.unsubscribe(),this.stateManagerSubscription&&this.stateManagerSubscription.unsubscribe()}onClick(){this.focusChatbox(),this.onboardingOverlay||this.markAsRead()}escCloseChat(e){"Escape"!==e.key||this.attributes.focus!==g.a.Header&&this.attributes.focus!==g.a.HeaderAndTypingBox||setTimeout(()=>this.close())}passMakingCallState(e){this.makingCall.emit(e)}closeOnboardingOverlay(){this.projectOverlayClosedSubject$.next(!0)}toggleMinimised(){this.minimiseChat.emit(this.attributes.threadIdentifier)}ngAfterViewInit(){this.attributes.focus&&this.focusTypingBox()}ngOnChanges(e){var t,n,i;"attributes"in e&&(this.isMinimised=e.attributes.currentValue.minimised,(null===(t=this.attributes)||void 0===t?void 0:t.focus)!==g.a.Neither&&(this.chatBoxMode&&(null===(n=e.attributes.previousValue)||void 0===n?void 0:n.focus)!==e.attributes.currentValue.focus||!this.chatBoxMode&&(null===(i=e.attributes.previousValue)||void 0===i?void 0:i.threadIdentifier)!==e.attributes.currentValue.threadIdentifier)&&this.markAsRead(),this.chatBoxMode||this.clearThreadError(),e.attributes.previousValue&&e.attributes.previousValue.threadIdentifier&&e.attributes.previousValue.threadIdentifier===e.attributes.currentValue.threadIdentifier||(this.threadIdentifierKey=Object(I.d)(e.attributes.currentValue.threadIdentifier)))}handleMessageResend(e){const t=this.messageErrorQueue.findIndex(t=>t.clientMessageId===e.clientMessageId);t>=0&&(this.messageErrorQueue=[...this.messageErrorQueue.slice(0,t),...this.messageErrorQueue.slice(t+1)],this.messageErrorQueueSubject$.next(this.messageErrorQueue),this.enqueueMessage(e.message))}enqueueMessage(e){const t=Date.now(),n=this.attributes.threadIdentifier.isFake,i=void 0===e||0===e.trim().length;if(!n){const e=this.attributes.threadIdentifier.id.toString();this.fileUploadSession.send({endpoint:`messages/0.1/threads/${e}/messages/`,extraParams:{thread_id:e,client_message_id:t.toString()}})}n&&i&&this.messageAttachments.length>0?this.error={code:Ae.MESSAGE_REQUIRED,operation:Oe.SEND_MESSAGE}:i||(this.messageSendQueue=[...this.messageSendQueue,{attachments:[],clientMessageId:t,fromUser:Object(C.s)(this.currentUserIdValue),id:t,message:e,messageSource:S.SourceTypeApi.CHAT_BOX,threadId:this.attributes.threadIdentifier.id,timeCreated:Date.now(),sendStatus:d.a.SENDING}],this.messageSendQueueSubject$.next(this.messageSendQueue),1===this.messageSendQueue.length&&this.sendQueuedMessage())}sendQueuedMessage(){if(0===this.messageSendQueue.length)return;const e=this.messageSendQueue[0];this.messageSendQueueSubject$.next(this.messageSendQueue),this.sendMessage(e).then(()=>{this.messageSendQueue=this.messageSendQueue.slice(1),this.messageSendQueueSubject$.next(this.messageSendQueue),this.sendQueuedMessage()}).catch(t=>{this.messageErrorQueue=[...this.messageErrorQueue,Object.assign(Object.assign({},e),{timeCreated:Date.now(),sendStatus:d.a.FAILED})],this.messageErrorQueueSubject$.next(this.messageErrorQueue),this.messageSendQueue=this.messageSendQueue.slice(1),this.messageSendQueueSubject$.next(this.messageSendQueue),this.sendQueuedMessage()})}sendMessage(e){return w.a(e).pipe(Object(R.a)(this.auth.getUserId(),this.attributes.thread$),Object(B.b)(([e,t,n])=>{if(!n.isFake)return this.messagesCollection.push(e).then(e=>{if("success"!==e.status)throw this.error={code:e.errorCode,operation:"send-message"},new Error(e.errorCode);this.error&&this.clearThreadError()});const i=Object(I.b)(n,e.message,Object(C.s)(t));return this.attributes.threadCollection.push(i).then(e=>{if("success"!==e.status)throw this.error={code:e.errorCode,operation:"send-message"},new Error(e.errorCode);return this.error&&this.clearThreadError(),e.id}).then(e=>{this.fileUploadSession.send({endpoint:`messages/0.1/threads/${e}/messages/`,extraParams:{thread_id:e.toString(),client_message_id:Date.now().toString()}})})})).toPromise()}focusChatbox(){this.focusClick.emit(this.attributes.threadIdentifier),this.focusTypingBox()}focusTypingBox(){this.isMinimised||!this.typingBox||this.attributes.focus!==g.a.Header&&this.attributes.focus!==g.a.HeaderAndTypingBox||this.typingBox.focus()}close(){this.closeChat.emit(this.attributes.threadIdentifier)}toggleOverlay(e){e===ve.SETTINGS&&this.isMinimised&&this.toggleMinimised(),this.activeOverlay=this.chatBoxMode&&this.activeOverlay!==e?e:void 0}markAsRead(){w.a(this.attributes.threadIdentifier.isFake).pipe(Object(R.a)(this.attributes.thread$),Object(L.a)(([e,t])=>!(e||t.isRead&&0===t.messageUnreadCount)&&this.attributes.threadCollection.update(t.id,{isRead:!0,messageUnreadCount:0}))).toPromise()}muteChatToggle(){w.a(this.attributes.threadIdentifier.isFake).pipe(Object(R.a)(this.attributes.thread$),Object(L.a)(([e,t])=>!e&&this.attributes.threadCollection.update(t.id,{isMuted:!t.isMuted}).then(e=>{"success"!==e.status&&(this.error={code:e.errorCode,operation:"mute-chat"})}))).toPromise()}blockChatToggle(){w.a(this.attributes.threadIdentifier.isFake).pipe(Object(R.a)(this.attributes.thread$),Object(L.a)(([e,t])=>!e&&this.attributes.threadCollection.update(t.id,{isBlocked:!t.isBlocked}).then(e=>{"success"!==e.status&&(this.error={code:e.errorCode,operation:"block-chat"})}))).toPromise()}archiveChatToggle(){w.a(this.attributes.threadIdentifier.isFake).pipe(Object(R.a)(this.attributes.thread$),Object(L.a)(([e,t])=>!e&&this.attributes.threadCollection.update(t.id,{folder:t.folder===S.FolderApi.INBOX?S.FolderApi.ARCHIVED:S.FolderApi.INBOX}).then(e=>{"success"!==e.status&&(this.error={code:e.errorCode,operation:"archive-chat"})}))).toPromise()}handleTypingEvent(e){this.markAsRead(),!this.attributes.threadIdentifier.isFake&&Date.now()>this.lastSentTyping+5e3&&(this.lastSentTyping=Date.now(),this.attributes.threadCollection.update(this.attributes.threadIdentifier.id,{typing:!0})),this.threadIdentifierKey&&(e&&e.length>0?this.saveDraftMessage(this.threadIdentifierKey,e):this.clearDraftMessage(this.threadIdentifierKey))}clearThreadError(){this.error=void 0}modifyMembers(e){w.a(e).pipe(Object(R.a)(this.attributes.thread$,this.currentUserId$),Object(L.a)(([t,n,i])=>{if(n.isFake)return;const s="add"===t.action?[...n.members,...t.userIds]:n.members.filter(e=>!t.userIds.includes(e)),a=s.filter(e=>e!==Object(C.s)(i)),o="add"===t.action?n.inactiveMembers.filter(e=>!t.userIds.includes(e)):[...n.inactiveMembers,...t.userIds];return this.attributes.threadCollection.update(n.id,{inactiveMembers:o,members:s,otherMembers:a}).then(t=>{"success"===t.status&&"remove"===e.action&&e.userIds.includes(Object(C.s)(i))&&this.close()})})).toPromise()}handleUserRemoved(e){this.modifyMembers({action:"remove",userIds:[e.id]})}popManagementModal(){this.modalService.open("GroupchatManagementModal",{inputs:{bidders$:this.bidders$,contacts$:this.contacts$,collaborators$:this.collaborators$,isRecruiter$:this.isUserSupportAgent$,thread$:this.attributes.thread$,team$:this.team$},size:f.a.SMALL}).afterClosed().toPromise().then(e=>{e&&e instanceof Array&&e.length>0&&this.modifyMembers({action:"add",userIds:e})})}isCallSupportedBrowser(){const e=this.userAgent.getUserAgent(),{name:t}=e.getBrowser();return"Chrome"===t||"Firefox"===t}handleAddAttachment(e){this.fileUploadSession.addFile(e),this.focusChatbox()}handleRemoveAttachment(e){this.fileUploadSession.removeFile(e.name)}handleRemoveUpload(e){this.fileUploadSession.removeUpload(e)}handleLoadMessages(){this.currentLimit=Math.min(this.currentLimit+this.limitIncreaseStep,this.maxLimit),this.messagesLimitSubject$.next(this.currentLimit)}handleChatOptionsDrawerToggle(e){e?this.chatOptionsDrawer.open():this.chatOptionsDrawer.close()}saveDraftMessage(e,t){const n={text:t,lastUpdated:Date.now()};this.localStorage.get("webappChatDraftMessages").pipe(Object($.a)(1)).toPromise().then((t={})=>Object(i.a)(this,void 0,void 0,function*(){if(e){const i=Object.assign(Object.assign({},t),{[e]:n});yield this.localStorage.set("webappChatDraftMessages",i)}}))}clearDraftMessage(e){this.localStorage.get("webappChatDraftMessages").pipe(Object($.a)(1)).toPromise().then(t=>Object(i.a)(this,void 0,void 0,function*(){if(t&&e){const n=t,s=e,a=Object(i.d)(n,["symbol"==typeof s?s:s+""]);yield this.localStorage.set("webappChatDraftMessages",a)}}))}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(a.c),s.Sb(F.a),s.Sb(N.a),s.Sb(X.a),s.Sb(Y.a),s.Sb(D.a),s.Sb(H.a),s.Sb(V.b),s.Sb(Z.a),s.Sb(W.a),s.Sb(q.a),s.Sb(Q.a))},e.\u0275cmp=s.Mb({type:e,selectors:[["app-chat-box"]],viewQuery:function(e,t){if(1&e&&(s.id(K,1),s.id(J,1),s.id(ee,1)),2&e){let e;s.Lc(e=s.oc())&&(t.typingBox=e.first),s.Lc(e=s.oc())&&(t.onboardingOverlay=e.first),s.Lc(e=s.oc())&&(t.chatOptionsDrawer=e.first)}},hostVars:4,hostBindings:function(e,t){1&e&&s.nc("click",function(){return t.onClick()})("keydown",function(e){return t.escCloseChat(e)},!1,s.Nc),2&e&&s.Kb("IsChatboxMode",t.chatBoxMode)("IsMinimised",t.isMinimised)},inputs:{attributes:"attributes",inCall$:"inCall$",allContacts$:"allContacts$",currentUserIdValue:"currentUserIdValue",team$:"team$",chatBoxMode:"chatBoxMode"},outputs:{closeChat:"closeChat",minimiseChat:"minimiseChat",makingCall:"makingCall",blurClick:"blurClick",focusClick:"focusClick"},features:[s.Eb],decls:13,vars:8,consts:function(){let e,t,n,i;return e="Chat Details",t="" + "\ufffd#2\ufffd" + "" + "\ufffd*3:1\ufffd\ufffd#1:1\ufffd" + " Unfortunately, you are not allowed to send a message to this thread. " + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*5:3\ufffd|\ufffd/#2\ufffd]" + "" + "\ufffd*4:2\ufffd\ufffd#1:2\ufffd" + " Please enter a message. " + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*5:3\ufffd|\ufffd/#2\ufffd]" + "" + "\ufffd*5:3\ufffd\ufffd#1:3\ufffd" + " Message sending failed. Please try again or " + "\ufffd#2:3\ufffd" + " contact support " + "\ufffd/#2:3\ufffd" + " if issue persists. " + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*5:3\ufffd|\ufffd/#2\ufffd]" + "" + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#1:3\ufffd\ufffd/*5:3\ufffd|\ufffd/#2\ufffd]" + "",t=s.hc(t),n="" + "\ufffd#2\ufffd" + "" + "\ufffd*3:1\ufffd\ufffd#1:1\ufffd" + " Unfortunately, you are not allowed to perform the requested operation. " + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#2\ufffd]" + "" + "\ufffd*4:2\ufffd\ufffd#1:2\ufffd" + " Attempting to perform requested operation failed. Please try again or " + "\ufffd#2:2\ufffd" + " contact support. " + "\ufffd/#2:2\ufffd" + "" + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#2\ufffd]" + "" + "[\ufffd/#1:1\ufffd\ufffd/*3:1\ufffd|\ufffd/#1:2\ufffd\ufffd/*4:2\ufffd|\ufffd/#2\ufffd]" + "",n=s.hc(n),i=" You cannot chat with this user ",[[1,"ChatBox",3,"flTrackingSection"],["data-uitest-target","chatbox-header",3,"callsEnabled","isMinimised","thread","project","contest","agentSession","currentUserId","currentUser","otherMembers","onlineOfflineStatuses$","focusState","isThreadOwner","candidatesExist","team","isUserSupportAgent","supportAgentMembers","click","closeChat","handleSettingsHeaderClick","handleGroupchatHeaderClick","makingCall",4,"ngIf"],["class","ChatBox-inboxHeader","flTrackingSection","inboxheader",3,"emptyState","isOnline","contextBoxState","isGroupChatThread","otherMembers","flHideDesktop","chatOptionsDrawerToggle",4,"ngIf"],[1,"ChatBox-main"],[1,"ChatBox-content"],["class","ChatBox-fileSelect","data-uitest-target","chatbox-window",3,"multiple","active","onFileDropped",4,"ngIf"],[4,"ngIf"],["class","Inbox-sidebar",3,"candidatesExist","contextBoxState","currentUser","isRecruiter","isThreadOwner","onlineOfflineStatuses$","showReportCta","thread","threadId$","members","team","showAddPeopleOption","flHideTablet","flHideMobile","archiveChatToggle","blockChatToggle","muteChatToggle","userAdd","userRemove",4,"ngIf"],["mobileHeaderTitle",e],["chatOptionsDrawer",""],["drawerTemplate",""],["data-uitest-target","chatbox-header",3,"callsEnabled","isMinimised","thread","project","contest","agentSession","currentUserId","currentUser","otherMembers","onlineOfflineStatuses$","focusState","isThreadOwner","candidatesExist","team","isUserSupportAgent","supportAgentMembers","click","closeChat","handleSettingsHeaderClick","handleGroupchatHeaderClick","makingCall"],["flTrackingSection","inboxheader",1,"ChatBox-inboxHeader",3,"emptyState","isOnline","contextBoxState","isGroupChatThread","otherMembers","flHideDesktop","chatOptionsDrawerToggle"],["data-uitest-target","chatbox-window",1,"ChatBox-fileSelect",3,"multiple","active","onFileDropped"],[3,"currentUserId","usersTyping","members","messages","otherMembers","thread","chatBoxMode","canLoadMore","showLoadingMoreSpinner","useThumbnailService","previewModalClose","previewModalOpen","resendMessage","loadMoreMessages"],[3,"ngClass"],[3,"thread","attachments","uploads","removeAttachment","removeUpload"],[3,"ngSwitch",4,"ngIf"],["class","ChatBox-typingBox",3,"ngClass","isChatBoxMode","hasAttachments","thread","threadIdentifierKey","flMarginBottom","flSticky","flStickyBehaviour","flStickyPosition","flStickyFullWidth","sendMessage","typingEvent","focusTypingBox","addAttachment",4,"ngIf"],[3,"type","closeable","flMarginBottom",4,"ngIf"],[1,"ChatBox-context",3,"chatBoxMode","state"],[3,"ngSwitch"],[3,"close",4,"ngSwitchCase"],[3,"close",4,"ngSwitchDefault"],[3,"close"],t,[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["flTrackingLabel","ChatSupportLink",3,"link"],n,[1,"ChatBox-typingBox",3,"ngClass","isChatBoxMode","hasAttachments","thread","threadIdentifierKey","flMarginBottom","flSticky","flStickyBehaviour","flStickyPosition","flStickyFullWidth","sendMessage","typingEvent","focusTypingBox","addAttachment"],["typingBox",""],[3,"type","closeable","flMarginBottom"],i,[3,"hourlyContracts","thread","otherMembers","project","closeOverlay",4,"ngIf"],[3,"participants","isThreadOwner","isRecruiter","candidatesExist","currentUser","candidateBidders","candidateContacts","candidateCollaborators","onlineOfflineStatuses$","thread","team","showAddPeopleOption","hideGroupchatOverlay","modifyMembers",4,"ngIf"],[3,"showReportCta","thread","archiveChatToggle","blockChatToggle","muteChatToggle","hideSettingsOverlay",4,"ngIf"],[3,"hourlyContracts","thread","otherMembers","project","closeOverlay"],["onboardingOverlay",""],[3,"participants","isThreadOwner","isRecruiter","candidatesExist","currentUser","candidateBidders","candidateContacts","candidateCollaborators","onlineOfflineStatuses$","thread","team","showAddPeopleOption","hideGroupchatOverlay","modifyMembers"],[3,"showReportCta","thread","archiveChatToggle","blockChatToggle","muteChatToggle","hideSettingsOverlay"],[1,"Inbox-sidebar",3,"candidatesExist","contextBoxState","currentUser","isRecruiter","isThreadOwner","onlineOfflineStatuses$","showReportCta","thread","threadId$","members","team","showAddPeopleOption","flHideTablet","flHideMobile","archiveChatToggle","blockChatToggle","muteChatToggle","userAdd","userRemove"],["class","Inbox-chatOptions",3,"candidatesExist","contextBoxState","currentUser","isRecruiter","isThreadOwner","onlineOfflineStatuses$","showReportCta","thread","threadId$","members","team","showAddPeopleOption","archiveChatToggle","blockChatToggle","muteChatToggle","userAdd","userRemove",4,"ngIf"],[1,"Inbox-chatOptions",3,"candidatesExist","contextBoxState","currentUser","isRecruiter","isThreadOwner","onlineOfflineStatuses$","showReportCta","thread","threadId$","members","team","showAddPeopleOption","archiveChatToggle","blockChatToggle","muteChatToggle","userAdd","userRemove"]]},template:function(e,t){1&e&&(s.Yb(0,"fl-bit",0),s.Zc(1,te,14,42,"app-header",1),s.Zc(2,ne,5,14,"app-messaging-inbox-header",2),s.Yb(3,"fl-bit",3),s.Yb(4,"fl-bit",4),s.Zc(5,me,23,52,"fl-file-select",5),s.sc(6,"flAsync"),s.Zc(7,Te,7,9,"ng-container",6),s.Xb(),s.Zc(8,xe,11,34,"app-messaging-sidebar",7),s.Yb(9,"fl-drawer",8,9),s.Zc(11,Ie,1,1,"ng-template",null,10,s.ad),s.Xb(),s.Xb(),s.Xb()),2&e&&(s.Ac("flTrackingSection",t.chatBoxMode?"chatbox":"inbox"),s.Gb(1),s.zc("ngIf",t.chatBoxMode),s.Gb(1),s.zc("ngIf",!t.chatBoxMode),s.Gb(3),s.zc("ngIf",!t.activeOverlay&&!s.tc(6,6,t.showOnboardingOverlay$)),s.Gb(2),s.zc("ngIf",t.chatBoxMode),s.Gb(1),s.zc("ngIf",!t.chatBoxMode))},styles:["[_nghost-%COMP%]{display:flex;height:100%;position:relative}.IsMinimised[_nghost-%COMP%]{bottom:-344px;height:380px!important;width:260px!important}.IsChatboxMode[_nghost-%COMP%]{border-left:2px solid transparent;border-top:2px solid transparent;height:380px;margin-right:8px;width:260px}.IsChatboxMode[_nghost-%COMP%]   .ChatBox-main[_ngcontent-%COMP%]{flex:1 1 100%;flex-direction:column}.IsChatboxMode[_nghost-%COMP%]   .ChatBox-content[_ngcontent-%COMP%]{flex:1 0 100%}[hidden][_ngcontent-%COMP%]{display:none!important}.ChatBox[_ngcontent-%COMP%]{background:#fff;border-radius:0 0 0 0;display:flex;flex-direction:column;width:100%}.ChatBox-context[_ngcontent-%COMP%]{align-items:center;background:#f7f7f7;border-bottom:1px solid #dedede;display:flex;flex:0 0 40px;height:40px;justify-content:space-between;padding:8px;width:100%}.ChatBox-main[_ngcontent-%COMP%]{display:flex;flex:1;max-height:100%;width:100%}.ChatBox-content[_ngcontent-%COMP%], .ChatBox-inboxHeader[_ngcontent-%COMP%]{border-left:1px solid #dedede}.ChatBox-content[_ngcontent-%COMP%]{border-right:1px solid #dedede;display:flex;flex:1 1 100%;flex-direction:column;width:100%}.ChatBox-fileSelect[_ngcontent-%COMP%]{flex:1 0 100%}.ChatBox-typingBox[_ngcontent-%COMP%]{display:block;min-width:100%}@media (min-width:768px){.ChatBox-typingBox[_ngcontent-%COMP%]{min-width:unset}}.Inbox-sidebar[_ngcontent-%COMP%]{flex:1 0 300px;max-width:30%;position:relative}.Inbox-chatOptions[_ngcontent-%COMP%]{min-height:calc(100vh - 86px);position:relative}.Inbox-wrapper[_ngcontent-%COMP%]{margin:0 auto;width:100%}@media (min-width:768px){.Inbox-wrapper[_ngcontent-%COMP%]{min-width:440px;width:75%}}.Inbox-typingBox[_ngcontent-%COMP%]{background:#fff;border-radius:0;box-shadow:0 0 4px 0 rgba(0,0,0,.08),0 2px 4px 0 rgba(0,0,0,.12)}@media (min-width:768px){.Inbox-typingBox[_ngcontent-%COMP%]{border:1px solid #dedede}}"],changeDetection:0}),e})()},sGoS:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c});var i=n("OpNG"),s=n("cUs2"),a=n("f6cb"),o=n("n0rP");function r(){return{defaultOrder:{field:"createTime",direction:i.a.DESC},fetch:(e,t,n,i)=>({endpoint:"support/0.1/agent_sessions/",isGaf:!1,params:c(t,n,i)}),push:void 0,set:void 0,update:(e,t,n)=>{if(Object(a.n)(t.agentId)&&n.state===o.AgentSessionStateApi.UNASSIGNED)return{endpoint:`support/0.1/agent_sessions/${n.id}/assign`,method:"POST",payload:{agent_id:t.agentId}};if(t.resolvedReason&&"string"==typeof t.resolvedReason.description&&n.state!==o.AgentSessionStateApi.RESOLVED)return{endpoint:`support/0.1/agent_sessions/${n.id}/resolve`,method:"POST",payload:{resolve_description:t.resolvedReason.description}};if(!1===t.starred)return{endpoint:`support/0.1/agent_sessions/${n.id}/unstar`,method:"POST",payload:{}};if(!0===t.starred)return{endpoint:`support/0.1/agent_sessions/${n.id}/star`,method:"POST",payload:{}};throw new Error(`Agent Sessions update not supported for delta ${t}`)},remove:void 0}}function c(e,t,n){return{agent_sessions:e,sessions:Object(s.h)(t,"sessionId"),agents:Object(s.h)(t,"agentId"),agent_session_states:Object(s.h)(t,"state"),starred:l(t,"starred"),latest:l(t,"latest"),source_type:Object(s.h)(t,"sessionSourceType")[0],sources:Object(s.h)(t,"sessionSourceId"),support_type:d(t),order_by:h(n),push:void 0,set:void 0,update:void 0,remove:void 0}}function l(e,t){return Object(s.h)(e,t,e=>{return"=="!==e.condition||"true"!==(t=e.value).toString()&&"false"!==t.toString()?void 0:e.value;var t})[0]}function d(e){return Object(s.h)(e,"type",e=>"=="===e.condition?e.value:void 0)[0]}function h(e){if(!e)return o.AgentSessionOrderByApi.AGENT_SESSION_CREATE_TIME_DSC;if(e.length>1)throw Error("Only single field orderings are supported by this collection");const t=e[0];if("createTime"===t.field&&t.direction===i.a.ASC)return o.AgentSessionOrderByApi.AGENT_SESSION_CREATE_TIME_ASC;if("createTime"===t.field&&t.direction===i.a.DESC)return o.AgentSessionOrderByApi.AGENT_SESSION_CREATE_TIME_DSC;if("sessionCreateTime"===t.field&&t.direction===i.a.ASC)return o.AgentSessionOrderByApi.SESSION_CREATE_TIME_ASC;if("sessionCreateTime"===t.field&&t.direction===i.a.DESC)return o.AgentSessionOrderByApi.SESSION_CREATE_TIME_DSC;throw Error(`Unexpected agent session ordering ${t.field}_${t.direction} given`)}},tbiQ:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return l});var i=n("SVse"),s=n("8Y7J"),a=n("2Vo4"),o=n("CqXF"),r=n("90vB"),c=function(e){return e.AUDIO="Audio",e.VIDEO="Video",e.NONE="NoCall",e}({});let l=(()=>{class e{constructor(e,t){this.platformId=e,this.freelancerHttp=t,this._inCallSubject$=new a.a(!1),this.inCall$=this._inCallSubject$.asObservable()}notifyAction(e,t){return this.freelancerHttp.put(`messages/0.1/videochat/${t}?action=${e}`,void 0).pipe(Object(o.a)(void 0)).toPromise()}openCallWindow({action:e,threadId:t,accepting:n,recorded:s=!1}){if(Object(i.E)(this.platformId))throw new Error("Cannot open videochat on page rendering. Please check code logic.");"NoCall"!==e&&window.open(`/users/messages/videochat.php?audioOnly=${"Audio"===e}&threadId=${t}&accepting=${n}&recorded=${s}`,"Freelancer Videochat",`width=${"Video"===e?880:400},height=575`)}setInCall(e){this._inCallSubject$.next(e)}getInCall(){return this.inCall$}}return e.\u0275fac=function(t){return new(t||e)(s.jc(s.D),s.jc(r.a))},e.\u0275prov=s.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},tlTr:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var i=function(e){return e[e.Header=0]="Header",e[e.HeaderAndTypingBox=1]="HeaderAndTypingBox",e[e.Neither=2]="Neither",e}({})},u4EQ:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("8Y7J"),s=n("wCWs");let a=(()=>{class e{constructor(e){this.assets=e,this.storageKey="sound_service_0.0.1",this.notificationWaitPeriod=1e3,this.millisecondsInADay=864e5,this.tabId=Date.now()+window.performance.now(),this.lastNotified=0,window.addEventListener("focus",e=>this.handleEvent(e)),window.addEventListener("unload",e=>this.handleEvent(e)),this.initialiseAsMaster(),this.messageSound=new Audio(this.assets.getUrl("sounds/message.mp3")),this.messageSound&&this.messageSound.load()}initialiseAsMaster(){const e=this.getState();e.master&&void 0!==e.master&&!document.hasFocus()||(e.master=this.tabId),e.registeredTabs=e.registeredTabs.filter(e=>e>this.tabId-this.millisecondsInADay),e.registeredTabs=[...e.registeredTabs,this.tabId],this.setState(e)}handleEvent(e){if("focus"===e.type){const e=this.getState();e.master=this.tabId,this.setState(e)}else if("unload"===e.type){const e=this.getState();e.registeredTabs=e.registeredTabs.filter(e=>e!==this.tabId),e.master===this.tabId&&(e.master=void 0),this.setState(e)}}handleNotification(e){const t=this.getState();void 0===t.master&&(t.master=this.tabId,this.setState(t)),this.lastNotified>Date.now()-this.notificationWaitPeriod||t.master!==this.tabId||"message"===e&&this.messageSound&&this.messageSound.play().then(()=>{this.lastNotified=Date.now()}).catch(e=>{console.warn(e)})}getState(){const e=localStorage.getItem(this.storageKey),t={master:void 0,registeredTabs:[]};try{return e?JSON.parse(e):t}catch(n){return t}}setState(e){localStorage&&localStorage.setItem(this.storageKey,JSON.stringify(e))}isAudioCapable(){return!!window.AudioContext||!!window.webkitAudioContext}}return e.\u0275fac=function(t){return new(t||e)(i.jc(s.a))},e.\u0275prov=i.Ob({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()},v01h:function(e,t,n){"use strict";n.d(t,"a",function(){return b});var i=n("HsDr"),s=n("9Aot"),a=n("jASZ"),o=n("Rnop"),r=n("o9eT"),c=n("8Y7J"),l=n("w13q"),d=n("SVse");function h(e,t){if(1&e&&(c.Yb(0,"fl-bit",5),c.Tb(1,"fl-icon",6),c.Xb()),2&e){const e=c.rc();c.zc("flMarginRight",e.Margin.XXXSMALL),c.Gb(1),c.zc("name",e.icon)("color",e.IconColor.LIGHT)("size",e.IconSize.SMALL)}}function g(e,t){if(1&e&&c.Tb(0,"fl-spinner",7),2&e){const e=c.rc();c.zc("size",e.SpinnerSize.SMALL)("color",e.SpinnerColor.LIGHT)}}const u=function(e){return{"FloatingAction--withIcon":e}};let b=(()=>{class e{constructor(){this.FontColor=o.a,this.TextSize=r.f,this.FontWeight=r.c,this.IconColor=i.c,this.IconSize=i.e,this.Margin=s.a,this.TextTransform=r.g,this.SpinnerColor=a.b,this.SpinnerSize=a.d,this.role="button",this.ariaLive="assertive"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=c.Mb({type:e,selectors:[["fl-floating-action"]],hostVars:3,hostBindings:function(e,t){2&e&&c.Hb("data-busy",t.busy)("role",t.role)("aria-live",t.ariaLive)},inputs:{icon:"icon",text:"text",busy:"busy"},decls:6,vars:11,consts:[[1,"FloatingAction",3,"ngClass"],[1,"FloatingAction-inner"],["class","FloatingAction-icon",3,"flMarginRight",4,"ngIf"],[1,"FloatingAction-text",3,"color","size","textTransform","weight"],["class","FloatingAction-spinner",3,"size","color",4,"ngIf"],[1,"FloatingAction-icon",3,"flMarginRight"],[3,"name","color","size"],[1,"FloatingAction-spinner",3,"size","color"]],template:function(e,t){1&e&&(c.Yb(0,"fl-bit",0),c.Yb(1,"fl-bit",1),c.Zc(2,h,2,4,"fl-bit",2),c.Yb(3,"fl-text",3),c.bd(4),c.Xb(),c.Xb(),c.Zc(5,g,1,2,"fl-spinner",4),c.Xb()),2&e&&(c.zc("ngClass",c.Ec(9,u,t.icon)),c.Hb("disabled",t.busy),c.Gb(2),c.zc("ngIf",t.icon),c.Gb(1),c.zc("color",t.FontColor.LIGHT)("size",t.TextSize.XXXSMALL)("textTransform",t.TextTransform.UPPERCASE)("weight",t.FontWeight.BOLD),c.Gb(1),c.dd(" ",t.text," "),c.Gb(1),c.zc("ngIf",t.busy))},directives:[l.a,d.o,d.q,r.e,s.b,i.d,a.c],styles:["[_nghost-%COMP%]{left:50%;position:absolute;transform:translateX(-50%);bottom:24px}[data-busy=true][_nghost-%COMP%]{pointer-events:none}[data-busy=true][_nghost-%COMP%]   .FloatingAction[_ngcontent-%COMP%]{max-width:32px;padding:0 4px;transform:translateY(-2px)}[data-busy=true][_nghost-%COMP%]   .FloatingAction-inner[_ngcontent-%COMP%]{opacity:0;visibility:hidden}.FloatingAction[_ngcontent-%COMP%]{background-color:#164188;border:0;border-radius:16px;box-shadow:0 0 6px 0 rgba(0,0,0,.12),0 4px 10px 0 rgba(0,0,0,.16);cursor:pointer;display:flex;font-family:inherit;height:32px;line-height:0;max-width:500px;padding:0 24px;position:relative;transition:box-shadow .3s ease-in-out,transform .3s ease-in-out,padding .5s linear,max-width .5s ease}.FloatingAction[_ngcontent-%COMP%]:focus{outline:none}.FloatingAction[_ngcontent-%COMP%]:hover{box-shadow:0 0 8px 0 rgba(0,0,0,.16),0 10px 18px 0 rgba(0,0,0,.2);transform:translateY(-2px)}.FloatingAction-inner[_ngcontent-%COMP%]{align-items:center;display:flex;justify-content:center}.FloatingAction-text[_ngcontent-%COMP%]{white-space:nowrap}.FloatingAction-spinner[_ngcontent-%COMP%]{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.FloatingAction--withIcon[_ngcontent-%COMP%]{padding-left:16px}"],changeDetection:0}),e})()},yotz:function(e,t,n){"use strict";n.d(t,"a",function(){return E}),n.d(t,"b",function(){return L});var i=n("SVse"),s=n("8Y7J"),a=n("XNiG"),o=n("VRyK"),r=n("EY2u"),c=n("HDdC"),l=(n("xgIS"),n("vkgz")),d=n("w1tV"),h=n("JX91"),g=n("lJxs"),u=n("eIep"),b=n("3UWI"),f=n("1G5W"),p=n("5+tZ"),m=n("IzEk"),M=n("Zy1z"),C=n("pLZG");const S="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0);function T(e,t,n=3){return Math.abs(e-t)<n}function x(e,t,n,i){const s={top:e.top,bottom:e.bottom,left:e.left,right:e.right};return t.top&&(s.top+=i),t.bottom&&(s.bottom+=i),t.left&&(s.left+=n),t.right&&(s.right+=n),s.height=s.bottom-s.top,s.width=s.right-s.left,s}function y({clientY:e,rect:t}){return e>=t.top&&e<=t.bottom}function I({clientX:e,rect:t}){return e>=t.left&&e<=t.right}function O({clientX:e,clientY:t,elm:n,allowedEdges:i,cursorPrecision:s}){const a=n.nativeElement.getBoundingClientRect(),o={};return i.left&&T(e,a.left,s)&&y({clientY:t,rect:a})&&(o.left=!0),i.right&&T(e,a.right,s)&&y({clientY:t,rect:a})&&(o.right=!0),i.top&&T(t,a.top,s)&&I({clientX:e,rect:a})&&(o.top=!0),i.bottom&&T(t,a.bottom,s)&&I({clientX:e,rect:a})&&(o.bottom=!0),o}const A=Object.freeze({topLeft:"nw-resize",topRight:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",leftOrRight:"col-resize",topOrBottom:"row-resize"});function v(e,t){return e.left&&e.top?t.topLeft:e.right&&e.top?t.topRight:e.left&&e.bottom?t.bottomLeft:e.right&&e.bottom?t.bottomRight:e.left||e.right?t.leftOrRight:e.top||e.bottom?t.topOrBottom:""}function w({edges:e,initialRectangle:t,newRectangle:n}){const i={};return Object.keys(e).forEach(e=>{i[e]=(n[e]||0)-(t[e]||0)}),i}let E=(()=>{class e{constructor(e,t,n,i){this.platformId=e,this.renderer=t,this.elm=n,this.zone=i,this.resizeEdges={},this.enableGhostResize=!1,this.resizeSnapGrid={},this.resizeCursors=A,this.resizeCursorPrecision=3,this.ghostElementPositioning="fixed",this.allowNegativeResizes=!1,this.mouseMoveThrottleMS=50,this.resizeStart=new s.n,this.resizing=new s.n,this.resizeEnd=new s.n,this.mouseup=new a.a,this.mousedown=new a.a,this.mousemove=new a.a,this.destroy$=new a.a,this.resizeEdges$=new a.a,this.pointerEventListeners=z.getInstance(t,i)}ngOnInit(){const e=Object(o.a)(this.pointerEventListeners.pointerDown,this.mousedown),t=Object(o.a)(this.pointerEventListeners.pointerMove,this.mousemove).pipe(Object(l.a)(({event:e})=>{i&&e.preventDefault()}),Object(d.a)()),n=Object(o.a)(this.pointerEventListeners.pointerUp,this.mouseup);let i;const s=()=>{i&&i.clonedNode&&(this.elm.nativeElement.parentElement.removeChild(i.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","inherit"))},a=()=>Object.assign({},A,this.resizeCursors);this.resizeEdges$.pipe(Object(h.a)(this.resizeEdges),Object(g.a)(()=>this.resizeEdges&&Object.keys(this.resizeEdges).some(e=>!!this.resizeEdges[e])),Object(u.a)(e=>e?t:r.a),Object(b.a)(this.mouseMoveThrottleMS),Object(f.a)(this.destroy$)).subscribe(({clientX:e,clientY:t})=>{const n=O({clientX:e,clientY:t,elm:this.elm,allowedEdges:this.resizeEdges,cursorPrecision:this.resizeCursorPrecision}),s=a();if(!i){const e=v(n,s);this.renderer.setStyle(this.elm.nativeElement,"cursor",e)}this.setElementClass(this.elm,"resize-left-hover",!0===n.left),this.setElementClass(this.elm,"resize-right-hover",!0===n.right),this.setElementClass(this.elm,"resize-top-hover",!0===n.top),this.setElementClass(this.elm,"resize-bottom-hover",!0===n.bottom)}),e.pipe(Object(p.b)(s=>{function a(e){return{clientX:e.clientX-s.clientX,clientY:e.clientY-s.clientY}}const r=()=>{const e={x:1,y:1};return i&&(this.resizeSnapGrid.left&&i.edges.left?e.x=+this.resizeSnapGrid.left:this.resizeSnapGrid.right&&i.edges.right&&(e.x=+this.resizeSnapGrid.right),this.resizeSnapGrid.top&&i.edges.top?e.y=+this.resizeSnapGrid.top:this.resizeSnapGrid.bottom&&i.edges.bottom&&(e.y=+this.resizeSnapGrid.bottom)),e};function c(e,t){return{x:Math.ceil(e.clientX/t.x),y:Math.ceil(e.clientY/t.y)}}return Object(o.a)(t.pipe(Object(m.a)(1)).pipe(Object(g.a)(e=>[,e])),t.pipe(Object(M.a)())).pipe(Object(g.a)(([e,t])=>[e?a(e):e,a(t)])).pipe(Object(C.a)(([e,t])=>{if(!e)return!0;const n=r(),i=c(e,n),s=c(t,n);return i.x!==s.x||i.y!==s.y})).pipe(Object(g.a)(([,e])=>{const t=r();return{clientX:Math.round(e.clientX/t.x)*t.x,clientY:Math.round(e.clientY/t.y)*t.y}})).pipe(Object(f.a)(Object(o.a)(n,e)))})).pipe(Object(C.a)(()=>!!i)).pipe(Object(g.a)(({clientX:e,clientY:t})=>x(i.startingRect,i.edges,e,t))).pipe(Object(C.a)(e=>this.allowNegativeResizes||!!(e.height&&e.width&&e.height>0&&e.width>0))).pipe(Object(C.a)(e=>!this.validateResize||this.validateResize({rectangle:e,edges:w({edges:i.edges,initialRectangle:i.startingRect,newRectangle:e})})),Object(f.a)(this.destroy$)).subscribe(e=>{i&&i.clonedNode&&(this.renderer.setStyle(i.clonedNode,"height",`${e.height}px`),this.renderer.setStyle(i.clonedNode,"width",`${e.width}px`),this.renderer.setStyle(i.clonedNode,"top",`${e.top}px`),this.renderer.setStyle(i.clonedNode,"left",`${e.left}px`)),this.resizing.observers.length>0&&this.zone.run(()=>{this.resizing.emit({edges:w({edges:i.edges,initialRectangle:i.startingRect,newRectangle:e}),rectangle:e})}),i.currentRect=e}),e.pipe(Object(g.a)(({clientX:e,clientY:t,edges:n})=>n||O({clientX:e,clientY:t,elm:this.elm,allowedEdges:this.resizeEdges,cursorPrecision:this.resizeCursorPrecision}))).pipe(Object(C.a)(e=>Object.keys(e).length>0),Object(f.a)(this.destroy$)).subscribe(e=>{i&&s();const t=function(e,t){let n=0,i=0;const s=e.nativeElement.style,a=["transform","-ms-transform","-moz-transform","-o-transform"].map(e=>s[e]).find(e=>!!e);if(a&&a.includes("translate")&&(n=a.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$1"),i=a.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$2")),"absolute"===t)return{height:e.nativeElement.offsetHeight,width:e.nativeElement.offsetWidth,top:e.nativeElement.offsetTop-i,bottom:e.nativeElement.offsetHeight+e.nativeElement.offsetTop-i,left:e.nativeElement.offsetLeft-n,right:e.nativeElement.offsetWidth+e.nativeElement.offsetLeft-n};{const t=e.nativeElement.getBoundingClientRect();return{height:t.height,width:t.width,top:t.top-i,bottom:t.bottom-i,left:t.left-n,right:t.right-n,scrollTop:e.nativeElement.scrollTop,scrollLeft:e.nativeElement.scrollLeft}}}(this.elm,this.ghostElementPositioning);i={edges:e,startingRect:t,currentRect:t};const n=a(),o=v(i.edges,n);this.renderer.setStyle(document.body,"cursor",o),this.setElementClass(this.elm,"resize-active",!0),this.enableGhostResize&&(i.clonedNode=this.elm.nativeElement.cloneNode(!0),this.elm.nativeElement.parentElement.appendChild(i.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","hidden"),this.renderer.setStyle(i.clonedNode,"position",this.ghostElementPositioning),this.renderer.setStyle(i.clonedNode,"left",`${i.startingRect.left}px`),this.renderer.setStyle(i.clonedNode,"top",`${i.startingRect.top}px`),this.renderer.setStyle(i.clonedNode,"height",`${i.startingRect.height}px`),this.renderer.setStyle(i.clonedNode,"width",`${i.startingRect.width}px`),this.renderer.setStyle(i.clonedNode,"cursor",v(i.edges,n)),this.renderer.addClass(i.clonedNode,"resize-ghost-element"),i.clonedNode.scrollTop=i.startingRect.scrollTop,i.clonedNode.scrollLeft=i.startingRect.scrollLeft),this.resizeStart.observers.length>0&&this.zone.run(()=>{this.resizeStart.emit({edges:w({edges:e,initialRectangle:t,newRectangle:t}),rectangle:x(t,{},0,0)})})}),n.pipe(Object(f.a)(this.destroy$)).subscribe(()=>{i&&(this.renderer.removeClass(this.elm.nativeElement,"resize-active"),this.renderer.setStyle(document.body,"cursor",""),this.renderer.setStyle(this.elm.nativeElement,"cursor",""),this.resizeEnd.observers.length>0&&this.zone.run(()=>{this.resizeEnd.emit({edges:w({edges:i.edges,initialRectangle:i.startingRect,newRectangle:i.currentRect}),rectangle:i.currentRect})}),s(),i=null)})}ngOnChanges(e){e.resizeEdges&&this.resizeEdges$.next(this.resizeEdges)}ngOnDestroy(){Object(i.D)(this.platformId)&&this.renderer.setStyle(document.body,"cursor",""),this.mousedown.complete(),this.mouseup.complete(),this.mousemove.complete(),this.resizeEdges$.complete(),this.destroy$.next()}setElementClass(e,t,n){n?this.renderer.addClass(e.nativeElement,t):this.renderer.removeClass(e.nativeElement,t)}}return e.\u0275fac=function(t){return new(t||e)(s.Sb(s.D),s.Sb(s.G),s.Sb(s.l),s.Sb(s.B))},e.\u0275dir=s.Nb({type:e,selectors:[["","mwlResizable",""]],inputs:{resizeEdges:"resizeEdges",enableGhostResize:"enableGhostResize",resizeSnapGrid:"resizeSnapGrid",resizeCursors:"resizeCursors",resizeCursorPrecision:"resizeCursorPrecision",ghostElementPositioning:"ghostElementPositioning",allowNegativeResizes:"allowNegativeResizes",mouseMoveThrottleMS:"mouseMoveThrottleMS",validateResize:"validateResize"},outputs:{resizeStart:"resizeStart",resizing:"resizing",resizeEnd:"resizeEnd"},features:[s.Eb]}),e})();class z{static getInstance(e,t){return z.instance||(z.instance=new z(e,t)),z.instance}constructor(e,t){this.pointerDown=new c.a(n=>{let i,s;return t.runOutsideAngular(()=>{i=e.listen("document","mousedown",e=>{n.next({clientX:e.clientX,clientY:e.clientY,event:e})}),S&&(s=e.listen("document","touchstart",e=>{n.next({clientX:e.touches[0].clientX,clientY:e.touches[0].clientY,event:e})}))}),()=>{i(),S&&s()}}).pipe(Object(d.a)()),this.pointerMove=new c.a(n=>{let i,s;return t.runOutsideAngular(()=>{i=e.listen("document","mousemove",e=>{n.next({clientX:e.clientX,clientY:e.clientY,event:e})}),S&&(s=e.listen("document","touchmove",e=>{n.next({clientX:e.targetTouches[0].clientX,clientY:e.targetTouches[0].clientY,event:e})}))}),()=>{i(),S&&s()}}).pipe(Object(d.a)()),this.pointerUp=new c.a(n=>{let i,s,a;return t.runOutsideAngular(()=>{i=e.listen("document","mouseup",e=>{n.next({clientX:e.clientX,clientY:e.clientY,event:e})}),S&&(s=e.listen("document","touchend",e=>{n.next({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY,event:e})}),a=e.listen("document","touchcancel",e=>{n.next({clientX:e.changedTouches[0].clientX,clientY:e.changedTouches[0].clientY,event:e})}))}),()=>{i(),S&&(s(),a())}}).pipe(Object(d.a)())}}let L=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=s.Qb({type:e}),e.\u0275inj=s.Pb({}),e})()}}]);
//# sourceMappingURL=default~app-app-shell-logged-in-routing-module~app-messaging-messaging-chat-groupchat-management-mod~5d8b11c9-es2015.71fbe1760900ff1065b6.js.map